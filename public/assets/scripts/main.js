/*! For license information please see main.js.LICENSE.txt */
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=0)}({"+mSJ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/rf6"),r=i("AKIq"),o=i("cWyK");e.default=function(t){if(!t)throw new Error("geojson is required");var e=[];return o.flattenEach(t,(function(t){!function(t,e){var i=[],o=t.geometry;if(null!==o){switch(o.type){case"Polygon":i=r.getCoords(o);break;case"LineString":i=[r.getCoords(o)]}i.forEach((function(i){(function(t,e){var i=[];return t.reduce((function(t,r){var o,s,a,l,u,h,c=n.lineString([t,r],e);return c.bbox=(s=r,a=(o=t)[0],l=o[1],u=s[0],h=s[1],[a<u?a:u,l<h?l:h,a>u?a:u,l>h?l:h]),i.push(c),r})),i})(i,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),n.featureCollection(e)}},"+uf4":function(t,e){window.addEventListener("load",(function(){var t=(new Date).getTime(),e=window.setInterval((function(){(new Date).getTime()-t>72e5?window.clearInterval(e):Vue.http.post("heartbeat").then((function(){t=(new Date).getTime()}),(function(){window.clearInterval(e)}))}),36e5)}))},"/rf6":function(t,e,i){"use strict";function n(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function r(t,e,i){return void 0===i&&(i={}),n({type:"Point",coordinates:t},e,i)}function o(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function s(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function a(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function h(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function c(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t*n}function d(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t/n}function p(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,i){switch(void 0===i&&(i={}),t){case"Point":return r(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return h(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,i){return void 0===i&&(i={}),a(t.map((function(t){return r(t,e)})),i)},e.polygon=o,e.polygons=function(t,e,i){return void 0===i&&(i={}),a(t.map((function(t){return o(t,e)})),i)},e.lineString=s,e.lineStrings=function(t,e,i){return void 0===i&&(i={}),a(t.map((function(t){return s(t,e)})),i)},e.featureCollection=a,e.multiLineString=l,e.multiPoint=u,e.multiPolygon=h,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},e.radiansToLength=c,e.lengthToRadians=d,e.lengthToDegrees=function(t,e){return p(d(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(d(t,e),i)},e.convertArea=function(t,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[i];if(!r)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},0:function(t,e,i){i("OMIv"),t.exports=i("e9hN")},1:function(t,e){},"11/I":function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.popover.top,\n.popover.left,\n.popover.right,\n.popover.bottom {\n  display: block;\n}\n.scale-enter {\n  -webkit-animation:scale-in 0.15s ease-in;\n          animation:scale-in 0.15s ease-in;\n}\n.scale-leave-active {\n  -webkit-animation:scale-out 0.15s ease-out;\n          animation:scale-out 0.15s ease-out;\n}\n@-webkit-keyframes scale-in {\n0% {\n    transform: scale(0);\n    opacity: 0;\n}\n100% {\n    transform: scale(1);\n    opacity: 1;\n}\n}\n@keyframes scale-in {\n0% {\n    transform: scale(0);\n    opacity: 0;\n}\n100% {\n    transform: scale(1);\n    opacity: 1;\n}\n}\n@-webkit-keyframes scale-out {\n0% {\n    transform: scale(1);\n    opacity: 1;\n}\n100% {\n    transform: scale(0);\n    opacity: 0;\n}\n}\n@keyframes scale-out {\n0% {\n    transform: scale(1);\n    opacity: 1;\n}\n100% {\n    transform: scale(0);\n    opacity: 0;\n}\n}\n",""])},"1KsK":function(t,e,i){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),i}},"1r6t":function(t,e){var i=function(){function t(t,e){return new z(null,t+"uniform sampler2D texture;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 coord=texCoord*texSize;"+e+"gl_FragColor=texture2D(texture,coord/texSize);vec2 clampedCoord=clamp(coord,vec2(0.0),texSize);if(coord!=clampedCoord){gl_FragColor.a*=max(0.0,1.0-length(coord-clampedCoord));}}")}function e(e,i,n){if(N.matrixWarp=N.matrixWarp||t("uniform mat3 matrix;uniform bool useTextureSpace;","if(useTextureSpace)coord=coord/texSize*2.0-1.0;vec3 warp=matrix*vec3(coord,1.0);coord=warp.xy/warp.z;if(useTextureSpace)coord=(coord*0.5+0.5)*texSize;"),4==(e=Array.prototype.concat.apply([],e)).length)e=[e[0],e[1],0,e[2],e[3],0,0,0,1];else if(9!=e.length)throw"can only warp with 2x2 or 3x3 matrix";return M.call(this,N.matrixWarp,{matrix:i?E(e):e,texSize:[this.width,this.height],useTextureSpace:0|n}),this}function i(e,i,n,r){return N.bulgePinch=N.bulgePinch||t("uniform float radius;uniform float strength;uniform vec2 center;","coord-=center;float distance=length(coord);if(distance<radius){float percent=distance/radius;if(strength>0.0){coord*=mix(1.0,smoothstep(0.0,radius/distance,percent),strength*0.75);}else{coord*=mix(1.0,pow(percent,1.0+strength*0.75)*radius/distance,1.0-percent);}}coord+=center;"),M.call(this,N.bulgePinch,{radius:n,strength:I(-1,r,1),center:[e,i],texSize:[this.width,this.height]}),this}function n(t,e){var i=T.apply(null,e),n=T.apply(null,t),r=function(t,e){return[t[0]*e[0]+t[1]*e[3]+t[2]*e[6],t[0]*e[1]+t[1]*e[4]+t[2]*e[7],t[0]*e[2]+t[1]*e[5]+t[2]*e[8],t[3]*e[0]+t[4]*e[3]+t[5]*e[6],t[3]*e[1]+t[4]*e[4]+t[5]*e[7],t[3]*e[2]+t[4]*e[5]+t[5]*e[8],t[6]*e[0]+t[7]*e[3]+t[8]*e[6],t[6]*e[1]+t[7]*e[4]+t[8]*e[7],t[6]*e[2]+t[7]*e[5]+t[8]*e[8]]}(E(i),n);return this.matrixWarp(r)}function r(e,i,n,r){return N.swirl=N.swirl||t("uniform float radius;uniform float angle;uniform vec2 center;","coord-=center;float distance=length(coord);if(distance<radius){float percent=(radius-distance)/radius;float theta=percent*percent*angle;float s=sin(theta);float c=cos(theta);coord=vec2(coord.x*c-coord.y*s,coord.x*s+coord.y*c);}coord+=center;"),M.call(this,N.swirl,{radius:n,center:[e,i],angle:r,texSize:[this.width,this.height]}),this}function o(t){return N.sepia=N.sepia||new z(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float r=color.r;float g=color.g;float b=color.b;color.r=min(1.0,(r*(1.0-(0.607*amount)))+(g*(0.769*amount))+(b*(0.189*amount)));color.g=min(1.0,(r*0.349*amount)+(g*(1.0-(0.314*amount)))+(b*0.168*amount));color.b=min(1.0,(r*0.272*amount)+(g*0.534*amount)+(b*(1.0-(0.869*amount))));gl_FragColor=color;}"),M.call(this,N.sepia,{amount:I(0,t,1)}),this}function s(t,e,i){return N.brightnessRGB=N.brightnessRGB||new z(null,"uniform sampler2D texture;uniform float r;uniform float g;uniform float b;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.r+=r;color.g+=g;color.b+=b;gl_FragColor=color;}"),M.call(this,N.brightnessRGB,{r:I(-1,t,1),g:I(-1,e,1),b:I(-1,i,1)}),this}function a(t){return N.vibrance=N.vibrance||new z(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;float mx=max(color.r,max(color.g,color.b));float amt=(mx-average)*(-amount*3.0);color.rgb=mix(color.rgb,vec3(mx),amt);gl_FragColor=color;}"),M.call(this,N.vibrance,{amount:I(-1,t,1)}),this}function l(t){return N.noise=N.noise||new z(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec4 color=texture2D(texture,texCoord);float diff=(rand(texCoord)-0.5)*amount;color.r+=diff;color.g+=diff;color.b+=diff;gl_FragColor=color;}"),M.call(this,N.noise,{amount:I(0,t,1)}),this}function u(t,e){return N.brightnessContrast=N.brightnessContrast||new z(null,"uniform sampler2D texture;uniform float brightness;uniform float contrast;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.rgb+=brightness;if(contrast>0.0){color.rgb=(color.rgb-0.5)/(1.0-contrast)+0.5;}else{color.rgb=(color.rgb-0.5)*(1.0+contrast)+0.5;}gl_FragColor=color;}"),M.call(this,N.brightnessContrast,{brightness:I(-1,t,1),contrast:I(-1,e,1)}),this}function h(t,e){return N.hueSaturation=N.hueSaturation||new z(null,"uniform sampler2D texture;uniform float hue;uniform float saturation;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float angle=hue*3.14159265;float s=sin(angle),c=cos(angle);vec3 weights=(vec3(2.0*c,-sqrt(3.0)*s-c,sqrt(3.0)*s-c)+1.0)/3.0;float len=length(color.rgb);color.rgb=vec3(dot(color.rgb,weights.xyz),dot(color.rgb,weights.zxy),dot(color.rgb,weights.yzx));float average=(color.r+color.g+color.b)/3.0;if(saturation>0.0){color.rgb+=(average-color.rgb)*(1.0-1.0/(1.001-saturation));}else{color.rgb+=(average-color.rgb)*(-saturation);}gl_FragColor=color;}"),M.call(this,N.hueSaturation,{hue:I(-1,t,1),saturation:I(-1,e,1)}),this}function c(t,e){return N.vignette=N.vignette||new z(null,"uniform sampler2D texture;uniform float size;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float dist=distance(texCoord,vec2(0.5,0.5));color.rgb*=smoothstep(0.8,size*0.799,dist*(amount+size));gl_FragColor=color;}"),M.call(this,N.vignette,{size:I(0,t,1),amount:I(0,e,1)}),this}function d(t){for(var e=new $(t),i=[],n=0;n<256;n++)i.push(I(0,Math.floor(256*e.interpolate(n/255)),255));return i}function p(t,e,i){t=d(t),1==arguments.length?e=i=t:(e=d(e),i=d(i));for(var n=[],r=0;r<256;r++)n.splice(n.length,0,t[r],e[r],i[r],255);return this._.extraTexture.initFromBytes(256,1,n),this._.extraTexture.use(1),N.curves=N.curves||new z(null,"uniform sampler2D texture;uniform sampler2D map;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.r=texture2D(map,vec2(color.r)).r;color.g=texture2D(map,vec2(color.g)).g;color.b=texture2D(map,vec2(color.b)).b;gl_FragColor=color;}"),N.curves.textures({map:1}),M.call(this,N.curves,{}),this}function f(t,e){return N.unsharpMask=N.unsharpMask||new z(null,"uniform sampler2D blurredTexture;uniform sampler2D originalTexture;uniform float strength;uniform float threshold;varying vec2 texCoord;void main(){vec4 blurred=texture2D(blurredTexture,texCoord);vec4 original=texture2D(originalTexture,texCoord);gl_FragColor=mix(blurred,original,1.0+strength);}"),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo((function(){z.getDefaultShader().drawRect()})),this._.extraTexture.use(1),this.triangleBlur(t),N.unsharpMask.textures({originalTexture:1}),M.call(this,N.unsharpMask,{strength:e}),this._.extraTexture.unuse(1),this}function g(t){N.denoise=N.denoise||new z(null,"uniform sampler2D texture;uniform float exponent;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec4 center=texture2D(texture,texCoord);vec4 color=vec4(0.0);float total=0.0;for(float x=-4.0;x<=4.0;x+=1.0){for(float y=-4.0;y<=4.0;y+=1.0){vec4 sample=texture2D(texture,texCoord+vec2(x,y)/texSize);float weight=1.0-abs(dot(sample.rgb-center.rgb,vec3(0.25)));weight=pow(weight,exponent);color+=sample*weight;total+=weight;}}gl_FragColor=color/total;}");for(var e=0;e<2;e++)M.call(this,N.denoise,{exponent:Math.max(0,t),texSize:[this.width,this.height]});return this}function m(t){return N.triangleBlur=N.triangleBlur||new z(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+U+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta*percent);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),M.call(this,N.triangleBlur,{delta:[t/this.width,0]}),M.call(this,N.triangleBlur,{delta:[0,t/this.height]}),this}function v(t,e,i,n,r,o){N.tiltShift=N.tiltShift||new z(null,"uniform sampler2D texture;uniform float blurRadius;uniform float gradientRadius;uniform vec2 start;uniform vec2 end;uniform vec2 delta;uniform vec2 texSize;varying vec2 texCoord;"+U+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);vec2 normal=normalize(vec2(start.y-end.y,end.x-start.x));float radius=smoothstep(0.0,1.0,abs(dot(texCoord*texSize-start,normal))/gradientRadius)*blurRadius;for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta/texSize*percent*radius);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}");var s=i-t,a=n-e,l=Math.sqrt(s*s+a*a);return M.call(this,N.tiltShift,{blurRadius:r,gradientRadius:o,start:[t,e],end:[i,n],delta:[s/l,a/l],texSize:[this.width,this.height]}),M.call(this,N.tiltShift,{blurRadius:r,gradientRadius:o,start:[t,e],end:[i,n],delta:[-a/l,s/l],texSize:[this.width,this.height]}),this}function y(t,e,i){N.lensBlurPrePass=N.lensBlurPrePass||new z(null,"uniform sampler2D texture;uniform float power;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color=pow(color,vec4(power));gl_FragColor=vec4(color);}");var n="uniform sampler2D texture0;uniform sampler2D texture1;uniform vec2 delta0;uniform vec2 delta1;uniform float power;varying vec2 texCoord;"+U+"vec4 sample(vec2 delta){float offset=random(vec3(delta,151.7182),0.0);vec4 color=vec4(0.0);float total=0.0;for(float t=0.0;t<=30.0;t++){float percent=(t+offset)/30.0;color+=texture2D(texture0,texCoord+delta*percent);total+=1.0;}return color/total;}";N.lensBlur0=N.lensBlur0||new z(null,n+"void main(){gl_FragColor=sample(delta0);}"),N.lensBlur1=N.lensBlur1||new z(null,n+"void main(){gl_FragColor=(sample(delta0)+sample(delta1))*0.5;}"),N.lensBlur2=N.lensBlur2||new z(null,n+"void main(){vec4 color=(sample(delta0)+2.0*texture2D(texture1,texCoord))/3.0;gl_FragColor=pow(color,vec4(power));}").textures({texture1:1});for(var r=[],o=0;o<3;o++){var s=i+o*Math.PI*2/3;r.push([t*Math.sin(s)/this.width,t*Math.cos(s)/this.height])}var a=Math.pow(10,I(-1,e,1));return M.call(this,N.lensBlurPrePass,{power:a}),this._.extraTexture.ensureFormat(this._.texture),M.call(this,N.lensBlur0,{delta0:r[0]},this._.texture,this._.extraTexture),M.call(this,N.lensBlur1,{delta0:r[1],delta1:r[2]},this._.extraTexture,this._.extraTexture),M.call(this,N.lensBlur0,{delta0:r[1]}),this._.extraTexture.use(1),M.call(this,N.lensBlur2,{power:1/a,delta0:r[2]}),this}function _(t,e,i){return N.zoomBlur=N.zoomBlur||new z(null,"uniform sampler2D texture;uniform vec2 center;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;"+U+"void main(){vec4 color=vec4(0.0);float total=0.0;vec2 toCenter=center-texCoord*texSize;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=0.0;t<=40.0;t++){float percent=(t+offset)/40.0;float weight=4.0*(percent-percent*percent);vec4 sample=texture2D(texture,texCoord+toCenter*percent*strength/texSize);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),M.call(this,N.zoomBlur,{center:[t,e],strength:i,texSize:[this.width,this.height]}),this}function b(t,e,i,n){return N.dotScreen=N.dotScreen||new z(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;gl_FragColor=vec4(vec3(average*10.0-5.0+pattern()),color.a);}"),M.call(this,N.dotScreen,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}function w(t){return N.ink=N.ink||new z(null,"uniform sampler2D texture;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 dx=vec2(1.0/texSize.x,0.0);vec2 dy=vec2(0.0,1.0/texSize.y);vec4 color=texture2D(texture,texCoord);float bigTotal=0.0;float smallTotal=0.0;vec3 bigAverage=vec3(0.0);vec3 smallAverage=vec3(0.0);for(float x=-2.0;x<=2.0;x+=1.0){for(float y=-2.0;y<=2.0;y+=1.0){vec3 sample=texture2D(texture,texCoord+dx*x+dy*y).rgb;bigAverage+=sample;bigTotal+=1.0;if(abs(x)+abs(y)<2.0){smallAverage+=sample;smallTotal+=1.0;}}}vec3 edge=max(vec3(0.0),bigAverage/bigTotal-smallAverage/smallTotal);gl_FragColor=vec4(color.rgb-dot(edge,edge)*strength*100000.0,color.a);}"),M.call(this,N.ink,{strength:t*t*t*t*t,texSize:[this.width,this.height]}),this}function x(t,e,i){return N.hexagonalPixelate=N.hexagonalPixelate||new z(null,"uniform sampler2D texture;uniform vec2 center;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 tex=(texCoord*texSize-center)/scale;tex.y/=0.866025404;tex.x-=tex.y*0.5;vec2 a;if(tex.x+tex.y-floor(tex.x)-floor(tex.y)<1.0)a=vec2(floor(tex.x),floor(tex.y));else a=vec2(ceil(tex.x),ceil(tex.y));vec2 b=vec2(ceil(tex.x),floor(tex.y));vec2 c=vec2(floor(tex.x),ceil(tex.y));vec3 TEX=vec3(tex.x,tex.y,1.0-tex.x-tex.y);vec3 A=vec3(a.x,a.y,1.0-a.x-a.y);vec3 B=vec3(b.x,b.y,1.0-b.x-b.y);vec3 C=vec3(c.x,c.y,1.0-c.x-c.y);float alen=length(TEX-A);float blen=length(TEX-B);float clen=length(TEX-C);vec2 choice;if(alen<blen){if(alen<clen)choice=a;else choice=c;}else{if(blen<clen)choice=b;else choice=c;}choice.x+=choice.y*0.5;choice.y*=0.866025404;choice*=scale/texSize;gl_FragColor=texture2D(texture,choice+center/texSize);}"),M.call(this,N.hexagonalPixelate,{center:[t,e],scale:i,texSize:[this.width,this.height]}),this}function S(t,e,i,n){return N.colorHalftone=N.colorHalftone||new z(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(float angle){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);vec3 cmy=1.0-color.rgb;float k=min(cmy.x,min(cmy.y,cmy.z));cmy=(cmy-k)/(1.0-k);cmy=clamp(cmy*10.0-3.0+vec3(pattern(angle+0.26179),pattern(angle+1.30899),pattern(angle)),0.0,1.0);k=clamp(k*10.0-5.0+pattern(angle+0.78539),0.0,1.0);gl_FragColor=vec4(1.0-cmy-k,color.a);}"),M.call(this,N.colorHalftone,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}function C(t){return N.edgeWork1=N.edgeWork1||new z(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+U+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec3 sample=texture2D(texture,texCoord+delta*percent).rgb;float average=(sample.r+sample.g+sample.b)/3.0;color.x+=average*weight;total.x+=weight;if(abs(t)<15.0){weight=weight*2.0-1.0;color.y+=average*weight;total.y+=weight;}}gl_FragColor=vec4(color/total,0.0,1.0);}"),N.edgeWork2=N.edgeWork2||new z(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+U+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec2 sample=texture2D(texture,texCoord+delta*percent).xy;color.x+=sample.x*weight;total.x+=weight;if(abs(t)<15.0){weight=weight*2.0-1.0;color.y+=sample.y*weight;total.y+=weight;}}float c=clamp(10000.0*(color.y/total.y-color.x/total.x)+0.5,0.0,1.0);gl_FragColor=vec4(c,c,c,1.0);}"),M.call(this,N.edgeWork1,{delta:[t/this.width,0]}),M.call(this,N.edgeWork2,{delta:[0,t/this.height]}),this}function T(t,e,i,n,r,o,s,a){var l=i-r,u=n-o,h=s-r,c=a-o,d=t-i+r-s,p=e-n+o-a,f=l*c-h*u,g=(d*c-h*p)/f,m=(l*p-d*u)/f;return[i-t+g*i,n-e+g*n,g,s-t+m*s,a-e+m*a,m,t,e,1]}function E(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],h=e*o*u-e*s*l-i*r*u+i*s*a+n*r*l-n*o*a;return[(o*u-s*l)/h,(n*l-i*u)/h,(i*s-n*o)/h,(s*a-r*u)/h,(e*u-n*a)/h,(n*r-e*s)/h,(r*l-o*a)/h,(i*a-e*l)/h,(e*o-i*r)/h]}function I(t,e,i){return Math.max(t,Math.min(e,i))}function k(t){return{_:t,loadContentsOf:function(t){N=this._.gl,this._.loadContentsOf(t)},destroy:function(){N=this._.gl,this._.destroy()}}}function A(t){return k(G.fromElement(t))}function P(t,e){var i=N.UNSIGNED_BYTE;if(N.getExtension("OES_texture_float")&&N.getExtension("OES_texture_float_linear")){var n=new G(100,100,N.RGBA,N.FLOAT);try{n.drawTo((function(){i=N.FLOAT}))}catch(t){}n.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=e,this._.texture=new G(t,e,N.RGBA,i),this._.spareTexture=new G(t,e,N.RGBA,i),this._.extraTexture=this._.extraTexture||new G(0,0,N.RGBA,i),this._.flippedShader=this._.flippedShader||new z(null,"uniform sampler2D texture;varying vec2 texCoord;void main(){gl_FragColor=texture2D(texture,vec2(texCoord.x,1.0-texCoord.y));}"),this._.isInitialized=!0}function R(t,e,i){return this._.isInitialized&&t._.width==this.width&&t._.height==this.height||P.call(this,e||t._.width,i||t._.height),t._.use(),this._.texture.drawTo((function(){z.getDefaultShader().drawRect()})),this}function L(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function M(t,e,i,n){(i||this._.texture).use(),this._.spareTexture.drawTo((function(){t.uniforms(e).drawRect()})),this._.spareTexture.swapWith(n||this._.texture)}function F(t){return t.parentNode.insertBefore(this,t),t.parentNode.removeChild(t),this}function O(){var t=new G(this._.texture.width,this._.texture.height,N.RGBA,N.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo((function(){z.getDefaultShader().drawRect()})),k(t)}function D(){var t=this._.texture.width,e=this._.texture.height,i=new Uint8Array(t*e*4);return this._.texture.drawTo((function(){N.readPixels(0,0,t,e,N.RGBA,N.UNSIGNED_BYTE,i)})),i}function j(t){return function(){return N=this._.gl,t.apply(this,arguments)}}function $(t){var e=t.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],t.sort((function(t,e){return t[0]-e[0]}));for(var i=0;i<e;i++)this.xa.push(t[i][0]),this.ya.push(t[i][1]);this.u[0]=0,this.y2[0]=0;for(i=1;i<e-1;++i){var n=this.xa[i+1]-this.xa[i-1],r=(this.xa[i]-this.xa[i-1])/n,o=r*this.y2[i-1]+2;this.y2[i]=(r-1)/o;var s=(this.ya[i+1]-this.ya[i])/(this.xa[i+1]-this.xa[i])-(this.ya[i]-this.ya[i-1])/(this.xa[i]-this.xa[i-1]);this.u[i]=(6*s/n-r*this.u[i-1])/o}this.y2[e-1]=0;for(i=e-2;i>=0;--i)this.y2[i]=this.y2[i]*this.y2[i+1]+this.u[i]}var N,B={},U="float random(vec3 scale,float seed){return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);}";B.canvas=function(){var t=document.createElement("canvas");try{N=t.getContext("experimental-webgl",{premultipliedAlpha:!1})}catch(t){N=null}if(!N)throw"This browser does not support WebGL";return t._={gl:N,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=j(A),t.draw=j(R),t.update=j(L),t.replace=j(F),t.contents=j(O),t.getPixelArray=j(D),t.brightnessContrast=j(u),t.brightnessRGB=j(s),t.hexagonalPixelate=j(x),t.hueSaturation=j(h),t.colorHalftone=j(S),t.triangleBlur=j(m),t.unsharpMask=j(f),t.perspective=j(n),t.matrixWarp=j(e),t.bulgePinch=j(i),t.tiltShift=j(v),t.dotScreen=j(b),t.edgeWork=j(C),t.lensBlur=j(y),t.zoomBlur=j(_),t.noise=j(l),t.denoise=j(g),t.curves=j(p),t.swirl=j(r),t.ink=j(w),t.vignette=j(c),t.vibrance=j(a),t.sepia=j(o),t},B.splineInterpolate=d;var G=function(){function t(t,e,i,n){this.gl=N,this.id=N.createTexture(),this.width=t,this.height=e,this.format=i,this.type=n,N.bindTexture(N.TEXTURE_2D,this.id),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),t&&e&&N.texImage2D(N.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}function e(t){null==i&&(i=document.createElement("canvas")),i.width=t.width,i.height=t.height;var e=i.getContext("2d");return e.clearRect(0,0,i.width,i.height),e}t.fromElement=function(e){var i=new t(0,0,N.RGBA,N.UNSIGNED_BYTE);return i.loadContentsOf(e),i},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,N.bindTexture(N.TEXTURE_2D,this.id),N.texImage2D(N.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,e,i){this.width=t,this.height=e,this.format=N.RGBA,this.type=N.UNSIGNED_BYTE,N.bindTexture(N.TEXTURE_2D,this.id),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,t,e,0,N.RGBA,this.type,new Uint8Array(i))},t.prototype.destroy=function(){N.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){N.activeTexture(N.TEXTURE0+(t||0)),N.bindTexture(N.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){N.activeTexture(N.TEXTURE0+(t||0)),N.bindTexture(N.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,e,i,n){if(1==arguments.length){var r=arguments[0];t=r.width,e=r.height,i=r.format,n=r.type}t==this.width&&e==this.height&&i==this.format&&n==this.type||(this.width=t,this.height=e,this.format=i,this.type=n,N.bindTexture(N.TEXTURE_2D,this.id),N.texImage2D(N.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(N.framebuffer=N.framebuffer||N.createFramebuffer(),N.bindFramebuffer(N.FRAMEBUFFER,N.framebuffer),N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_2D,this.id,0),N.checkFramebufferStatus(N.FRAMEBUFFER)!==N.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");N.viewport(0,0,this.width,this.height),t(),N.bindFramebuffer(N.FRAMEBUFFER,null)};var i=null;return t.prototype.fillUsingCanvas=function(t){return t(e(this)),this.format=N.RGBA,this.type=N.UNSIGNED_BYTE,N.bindTexture(N.TEXTURE_2D,this.id),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,i),this},t.prototype.toImage=function(t){this.use(),z.getDefaultShader().drawRect();var n=this.width*this.height*4,r=new Uint8Array(n),o=e(this),s=o.createImageData(this.width,this.height);N.readPixels(0,0,this.width,this.height,N.RGBA,N.UNSIGNED_BYTE,r);for(var a=0;a<n;a++)s.data[a]=r[a];o.putImageData(s,0,0),t.src=i.toDataURL()},t.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e},t}();$.prototype.interpolate=function(t){for(var e=0,i=this.ya.length-1;i-e>1;){var n=i+e>>1;this.xa[n]>t?i=n:e=n}var r=this.xa[i]-this.xa[e],o=(this.xa[i]-t)/r,s=(t-this.xa[e])/r;return o*this.ya[e]+s*this.ya[i]+((o*o*o-o)*this.y2[e]+(s*s*s-s)*this.y2[i])*(r*r)/6};var z=function(){function t(t){return"[object Number]"==Object.prototype.toString.call(t)}function e(t,e){var i=N.createShader(t);if(N.shaderSource(i,e),N.compileShader(i),!N.getShaderParameter(i,N.COMPILE_STATUS))throw"compile error: "+N.getShaderInfoLog(i);return i}function i(t,i){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=N.createProgram(),t=t||n,i="precision highp float;"+(i=i||r),N.attachShader(this.program,e(N.VERTEX_SHADER,t)),N.attachShader(this.program,e(N.FRAGMENT_SHADER,i)),N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw"link error: "+N.getProgramInfoLog(this.program)}var n="attribute vec2 vertex;attribute vec2 _texCoord;varying vec2 texCoord;void main(){texCoord=_texCoord;gl_Position=vec4(vertex*2.0-1.0,0.0,1.0);}",r="uniform sampler2D texture;varying vec2 texCoord;void main(){gl_FragColor=texture2D(texture,texCoord);}";return i.prototype.destroy=function(){N.deleteProgram(this.program),this.program=null},i.prototype.uniforms=function(e){for(var i in N.useProgram(this.program),e)if(e.hasOwnProperty(i)){var n=N.getUniformLocation(this.program,i);if(null!==n){var r=e[i];if(o=r,"[object Array]"==Object.prototype.toString.call(o))switch(r.length){case 1:N.uniform1fv(n,new Float32Array(r));break;case 2:N.uniform2fv(n,new Float32Array(r));break;case 3:N.uniform3fv(n,new Float32Array(r));break;case 4:N.uniform4fv(n,new Float32Array(r));break;case 9:N.uniformMatrix3fv(n,!1,new Float32Array(r));break;case 16:N.uniformMatrix4fv(n,!1,new Float32Array(r));break;default:throw"dont't know how to load uniform \""+i+'" of length '+r.length}else{if(!t(r))throw'attempted to set uniform "'+i+'" to invalid value '+(r||"undefined").toString();N.uniform1f(n,r)}}}var o;return this},i.prototype.textures=function(t){for(var e in N.useProgram(this.program),t)t.hasOwnProperty(e)&&N.uniform1i(N.getUniformLocation(this.program,e),t[e]);return this},i.prototype.drawRect=function(t,e,i,n){var r=N.getParameter(N.VIEWPORT);e=void 0!==e?(e-r[1])/r[3]:0,t=void 0!==t?(t-r[0])/r[2]:0,i=void 0!==i?(i-r[0])/r[2]:1,n=void 0!==n?(n-r[1])/r[3]:1,null==N.vertexBuffer&&(N.vertexBuffer=N.createBuffer()),N.bindBuffer(N.ARRAY_BUFFER,N.vertexBuffer),N.bufferData(N.ARRAY_BUFFER,new Float32Array([t,e,t,n,i,e,i,n]),N.STATIC_DRAW),null==N.texCoordBuffer&&(N.texCoordBuffer=N.createBuffer(),N.bindBuffer(N.ARRAY_BUFFER,N.texCoordBuffer),N.bufferData(N.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),N.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=N.getAttribLocation(this.program,"vertex"),N.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=N.getAttribLocation(this.program,"_texCoord"),N.enableVertexAttribArray(this.texCoordAttribute)),N.useProgram(this.program),N.bindBuffer(N.ARRAY_BUFFER,N.vertexBuffer),N.vertexAttribPointer(this.vertexAttribute,2,N.FLOAT,!1,0,0),N.bindBuffer(N.ARRAY_BUFFER,N.texCoordBuffer),N.vertexAttribPointer(this.texCoordAttribute,2,N.FLOAT,!1,0,0),N.drawArrays(N.TRIANGLE_STRIP,0,4)},i.getDefaultShader=function(){return N.defaultShader=N.defaultShader||new i,N.defaultShader},i}();return B}();t.exports=i},"1seS":function(t,e,i){"use strict";var n=Array.prototype.slice,r=i("1KsK"),o=Object.keys,s=o?function(t){return o(t)}:i("sYn3"),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return r(t)?a(n.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},"1u+m":function(t,e,i){"use strict";var n=function(t){return t!=t};t.exports=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!n(t)||!n(e))}},"2Nju":function(t,e,i){"use strict";var n=i("oNNP"),r=RegExp.prototype.exec,o=Object.getOwnPropertyDescriptor,s=Object.prototype.toString,a="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){if(!t||"object"!=typeof t)return!1;if(!a)return"[object RegExp]"===s.call(t);var e=o(t,"lastIndex");return!(!e||!n(e,"value"))&&function(t){try{var e=t.lastIndex;return t.lastIndex=0,r.call(t),!0}catch(t){return!1}finally{t.lastIndex=e}}(t)}},"45zb":function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,r=Object.prototype.toString,o=function(t){return!(n&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r.call(t)},s=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==r.call(t)&&"[object Function]"===r.call(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},"5xAX":function(t,e,i){"use strict";var n=i("82c2"),r=i("RLeF"),o=i("VwiP"),s=i("V+xs"),a=i("HH6Z"),l=r(o);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},"6ayh":function(t,e,i){"use strict";var n=TypeError,r=Object.getOwnPropertyDescriptor;if(r)try{r({},"")}catch(t){r=null}var o=function(){throw new n},s=r?function(){try{return o}catch(t){try{return r(arguments,"callee").get}catch(t){return o}}}():o,a=i("UVaH")(),l=Object.getPrototypeOf||function(t){return t.__proto__},u=void 0,h="undefined"==typeof Uint8Array?void 0:l(Uint8Array),c={"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"%ArrayIteratorPrototype%":a?l([][Symbol.iterator]()):void 0,"%ArrayPrototype%":Array.prototype,"%ArrayProto_entries%":Array.prototype.entries,"%ArrayProto_forEach%":Array.prototype.forEach,"%ArrayProto_keys%":Array.prototype.keys,"%ArrayProto_values%":Array.prototype.values,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":void 0,"%AsyncFunctionPrototype%":void 0,"%AsyncGenerator%":void 0,"%AsyncGeneratorFunction%":void 0,"%AsyncGeneratorPrototype%":void 0,"%AsyncIteratorPrototype%":u&&a&&Symbol.asyncIterator?u[Symbol.asyncIterator]():void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%Boolean%":Boolean,"%BooleanPrototype%":Boolean.prototype,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"%Date%":Date,"%DatePrototype%":Date.prototype,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%ErrorPrototype%":Error.prototype,"%eval%":eval,"%EvalError%":EvalError,"%EvalErrorPrototype%":EvalError.prototype,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"%Function%":Function,"%FunctionPrototype%":Function.prototype,"%Generator%":void 0,"%GeneratorFunction%":void 0,"%GeneratorPrototype%":void 0,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":a?l(l([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%JSONParse%":"object"==typeof JSON?JSON.parse:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&a?l((new Map)[Symbol.iterator]()):void 0,"%MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"%Math%":Math,"%Number%":Number,"%NumberPrototype%":Number.prototype,"%Object%":Object,"%ObjectPrototype%":Object.prototype,"%ObjProto_toString%":Object.prototype.toString,"%ObjProto_valueOf%":Object.prototype.valueOf,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"%PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"%Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"%Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"%Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%RangeErrorPrototype%":RangeError.prototype,"%ReferenceError%":ReferenceError,"%ReferenceErrorPrototype%":ReferenceError.prototype,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%RegExpPrototype%":RegExp.prototype,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&a?l((new Set)[Symbol.iterator]()):void 0,"%SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"%String%":String,"%StringIteratorPrototype%":a?l(""[Symbol.iterator]()):void 0,"%StringPrototype%":String.prototype,"%Symbol%":a?Symbol:void 0,"%SymbolPrototype%":a?Symbol.prototype:void 0,"%SyntaxError%":SyntaxError,"%SyntaxErrorPrototype%":SyntaxError.prototype,"%ThrowTypeError%":s,"%TypedArray%":h,"%TypedArrayPrototype%":h?h.prototype:void 0,"%TypeError%":n,"%TypeErrorPrototype%":n.prototype,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"%URIError%":URIError,"%URIErrorPrototype%":URIError.prototype,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},d=i("D3zA").call(Function.call,String.prototype.replace),p=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,f=/\\(\\)?/g,g=function(t){var e=[];return d(t,p,(function(t,i,n,r){e[e.length]=n?d(r,f,"$1"):i||t})),e},m=function(t,e){if(!(t in c))throw new SyntaxError("intrinsic "+t+" does not exist!");if(void 0===c[t]&&!e)throw new n("intrinsic "+t+" exists, but is not available. Please file an issue!");return c[t]};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new TypeError('"allowMissing" argument must be a boolean');for(var i=g(t),o=m("%"+(i.length>0?i[0]:"")+"%",e),s=1;s<i.length;s+=1)if(null!=o)if(r&&s+1>=i.length){var a=r(o,i[s]);if(!e&&!(i[s]in o))throw new n("base intrinsic for "+t+" exists, but the property is not available.");o=a?a.get||a.value:o[i[s]]}else o=o[i[s]];return o}},"7QHc":function(t,e,i){"use strict";var n=i("b7qQ");i.n(n).a},"7Xoj":function(t,e,i){"use strict";var n=i("8j4y");i.n(n).a},"82c2":function(t,e,i){"use strict";var n=i("1seS"),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,i,n){var r;(!(e in t)||"function"==typeof(r=n)&&"[object Function]"===o.call(r)&&n())&&(l?a(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},h=function(t,e){var i=arguments.length>2?arguments[2]:{},o=n(e);r&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)u(t,o[a],e[o[a]],i[o[a]])};h.supportsDescriptors=!!l,t.exports=h},"8j4y":function(t,e,i){var n=i("T1Mv");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},"8oxB":function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var l,u=[],h=!1,c=-1;function d(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&p())}function p(){if(!h){var t=a(d);h=!0;for(var e=u.length;e;){for(l=u,u=[];++c<e;)l&&l[c].run();c=-1,e=u.length}l=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new f(t,e)),1!==u.length||h||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"9tPo":function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?i+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},"A/RR":function(t,e,i){!function(t){"use strict";function e(t,e){return t>e?1:t<e?-1:0}var i=function(t,i){void 0===t&&(t=e),void 0===i&&(i=!1),this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!i},n={size:{configurable:!0}};function r(t,e,i){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!o(e,i)||e.isVertical()?e.prevInResult:e));var n=o(t,i);t.resultTransition=n?function(t,e){var i,n=!t.inOut,r=!t.otherInOut;switch(e){case 0:i=n&&r;break;case 1:i=n||r;break;case 3:i=n^r;break;case 2:i=t.isSubject?n&&!r:r&&!n}return i?1:-1}(t,i):0}function o(t,e){switch(t.type){case 0:switch(e){case 0:return!t.otherInOut;case 1:return t.otherInOut;case 2:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case 3:return!0}break;case 2:return 0===e||1===e;case 3:return 2===e;case 1:return!1}return!1}i.prototype.rotateLeft=function(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e},i.prototype.rotateRight=function(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e},i.prototype._splay=function(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}},i.prototype.splay=function(t){for(var e,i,n,r,o;t.parent;)(i=(e=t.parent).parent)&&i.parent?((n=i.parent).left===i?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),r=t.left,o=t.right,t===e.left?(i&&(i.left===e?(e.right?(i.left=e.right,i.left.parent=i):i.left=null,e.right=i,i.parent=e):(r?(i.right=r,r.parent=i):i.right=null,t.left=i,i.parent=t)),o?(e.left=o,o.parent=e):e.left=null,t.right=e,e.parent=t):(i&&(i.right===e?(e.left?(i.right=e.left,i.right.parent=i):i.right=null,e.left=i,i.parent=e):(o?(i.left=o,o.parent=i):i.left=null,t.right=i,i.parent=t)),r?(e.right=r,r.parent=e):e.right=null,t.left=e,e.parent=t)},i.prototype.replace=function(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)},i.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.insert=function(t,e){var i=this._root,n=null,r=this._compare;if(this._noDuplicates)for(;i;){if(n=i,0===r(i.key,t))return;i=r(i.key,t)<0?i.right:i.left}else for(;i;)n=i,i=r(i.key,t)<0?i.right:i.left;return i={key:t,data:e,left:null,right:null,parent:n},n?r(n.key,i.key)<0?n.right=i:n.left=i:this._root=i,this.splay(i),this._size++,i},i.prototype.find=function(t){for(var e=this._root,i=this._compare;e;){var n=i(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null},i.prototype.contains=function(t){for(var e=this._root,i=this._compare;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},i.prototype.remove=function(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0},i.prototype.removeNode=function(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0},i.prototype.erase=function(t){var e=this.find(t);if(e){this.splay(e);var i=e.left,n=e.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),n&&(i?r.right=n:this._root=n,n.parent=r),this._size--}},i.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},i.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},i.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},i.prototype.forEach=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)e?(i.push(e),e=e.left):i.length>0?(t(e=i.pop(),r++),e=e.right):n=!0;return this},i.prototype.range=function(t,e,i,n){for(var r=[],o=this._compare,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},i.prototype.keys=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.key),t=t.right):n=!0;return i},i.prototype.values=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.data),t=t.right):n=!0;return i},i.prototype.at=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},i.prototype.load=function(t,e,i){if(void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=!1),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return i&&function t(e,i,n,r,o){if(!(n>=r)){for(var s=e[n+r>>1],a=n-1,l=r+1;;){do{a++}while(o(e[a],s)<0);do{l--}while(o(e[l],s)>0);if(a>=l)break;var u=e[a];e[a]=e[l],e[l]=u,u=i[a],i[a]=i[l],i[l]=u}t(e,i,n,l,o),t(e,i,l+1,r,o)}}(t,e,0,n-1,this._compare),this._root=function t(e,i,n,r,o){var s=o-r;if(s>0){var a=r+Math.floor(s/2),l={key:i[a],data:n[a],parent:e};return l.left=t(l,i,n,r,a),l.right=t(l,i,n,a+1,o),l}return null}(null,t,e,0,n),this._size=n,this},i.prototype.min=function(){var t=this.minNode(this._root);return t?t.key:null},i.prototype.max=function(){var t=this.maxNode(this._root);return t?t.key:null},i.prototype.isEmpty=function(){return null===this._root},n.size.get=function(){return this._size},i.createTree=function(t,e,n,r,o){return new i(n,o).load(t,e,r)},Object.defineProperties(i.prototype,n);var s=function(t,e,i,n,r){this.left=e,this.point=t,this.otherEvent=i,this.isSubject=n,this.type=r||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},a={inResult:{configurable:!0}};function l(t,e){return t[0]===e[0]&&t[1]===e[1]}function u(t,e,i,n,r){var o,s,a,l,u=e[0],h=n[0],c=0,d=0;h>u==h>-u?(o=u,u=e[++c]):(o=h,h=n[++d]);var p=0;if(c<t&&d<i)for(h>u==h>-u?(a=o-((s=u+o)-u),u=e[++c]):(a=o-((s=h+o)-h),h=n[++d]),o=s,0!==a&&(r[p++]=a);c<t&&d<i;)h>u==h>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c]):(a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d]),o=s,0!==a&&(r[p++]=a);for(;c<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c],o=s,0!==a&&(r[p++]=a);for(;d<i;)a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d],o=s,0!==a&&(r[p++]=a);return 0===o&&0!==p||(r[p++]=o),p}function h(t){return new Float64Array(t)}s.prototype.isBelow=function(t){var e=this.point,i=this.otherEvent.point;return this.left?(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0:(i[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(i[1]-t[1])>0},s.prototype.isAbove=function(t){return!this.isBelow(t)},s.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},a.inResult.get=function(){return 0!==this.resultTransition},s.prototype.clone=function(){var t=new s(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.contourId=this.contourId,t.resultTransition=this.resultTransition,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t},Object.defineProperties(s.prototype,a);var c=h(4),d=h(8),p=h(12),f=h(16),g=h(4);function m(t,e,i,n,r,o){var s=(e-o)*(i-r),a=(t-r)*(n-o),l=s-a;if(0===s||0===a||s>0!=a>0)return l;var h=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(t,e,i,n,r,o,s){var a,l,h,m,v,y,_,b,w,x,S,C,T,E,I,k,A,P,R=t-r,L=i-r,M=e-o,F=n-o;v=(I=(b=R-(_=(y=134217729*R)-(y-R)))*(x=F-(w=(y=134217729*F)-(y-F)))-((E=R*F)-_*w-b*w-_*x))-(S=I-(A=(b=M-(_=(y=134217729*M)-(y-M)))*(x=L-(w=(y=134217729*L)-(y-L)))-((k=M*L)-_*w-b*w-_*x))),c[0]=I-(S+v)+(v-A),v=(T=E-((C=E+S)-(v=C-E))+(S-v))-(S=T-k),c[1]=T-(S+v)+(v-k),v=(P=C+S)-C,c[2]=C-(P-v)+(S-v),c[3]=P;var O=function(t,e){for(var i=e[0],n=1;n<t;n++)i+=e[n];return i}(4,c),D=22204460492503146e-32*s;if(O>=D||-O>=D)return O;if(a=t-(R+(v=t-R))+(v-r),h=i-(L+(v=i-L))+(v-r),l=e-(M+(v=e-M))+(v-o),m=n-(F+(v=n-F))+(v-o),0===a&&0===l&&0===h&&0===m)return O;if(D=11093356479670487e-47*s+33306690738754706e-32*Math.abs(O),(O+=R*m+F*a-(M*h+L*l))>=D||-O>=D)return O;v=(I=(b=a-(_=(y=134217729*a)-(y-a)))*(x=F-(w=(y=134217729*F)-(y-F)))-((E=a*F)-_*w-b*w-_*x))-(S=I-(A=(b=l-(_=(y=134217729*l)-(y-l)))*(x=L-(w=(y=134217729*L)-(y-L)))-((k=l*L)-_*w-b*w-_*x))),g[0]=I-(S+v)+(v-A),v=(T=E-((C=E+S)-(v=C-E))+(S-v))-(S=T-k),g[1]=T-(S+v)+(v-k),v=(P=C+S)-C,g[2]=C-(P-v)+(S-v),g[3]=P;var j=u(4,c,4,g,d);v=(I=(b=R-(_=(y=134217729*R)-(y-R)))*(x=m-(w=(y=134217729*m)-(y-m)))-((E=R*m)-_*w-b*w-_*x))-(S=I-(A=(b=M-(_=(y=134217729*M)-(y-M)))*(x=h-(w=(y=134217729*h)-(y-h)))-((k=M*h)-_*w-b*w-_*x))),g[0]=I-(S+v)+(v-A),v=(T=E-((C=E+S)-(v=C-E))+(S-v))-(S=T-k),g[1]=T-(S+v)+(v-k),v=(P=C+S)-C,g[2]=C-(P-v)+(S-v),g[3]=P;var $=u(j,d,4,g,p);v=(I=(b=a-(_=(y=134217729*a)-(y-a)))*(x=m-(w=(y=134217729*m)-(y-m)))-((E=a*m)-_*w-b*w-_*x))-(S=I-(A=(b=l-(_=(y=134217729*l)-(y-l)))*(x=h-(w=(y=134217729*h)-(y-h)))-((k=l*h)-_*w-b*w-_*x))),g[0]=I-(S+v)+(v-A),v=(T=E-((C=E+S)-(v=C-E))+(S-v))-(S=T-k),g[1]=T-(S+v)+(v-k),v=(P=C+S)-C,g[2]=C-(P-v)+(S-v),g[3]=P;var N=u($,p,4,g,f);return f[N-1]}(t,e,i,n,r,o,h)}function v(t,e,i){var n=m(t[0],t[1],e[0],e[1],i[0],i[1]);return n>0?-1:n<0?1:0}function y(t,e){var i=t.point,n=e.point;return i[0]>n[0]?1:i[0]<n[0]?-1:i[1]!==n[1]?i[1]>n[1]?1:-1:function(t,e,i,n){return t.left!==e.left?t.left?1:-1:0!==v(i,t.otherEvent.point,e.otherEvent.point)?t.isBelow(e.otherEvent.point)?-1:1:!t.isSubject&&e.isSubject?1:-1}(t,e,i)}function _(t,e,i){var n=new s(e,!1,t,t.isSubject),r=new s(e,!0,t.otherEvent,t.isSubject);return l(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=r.contourId=t.contourId,y(r,t.otherEvent)>0&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=n,i.push(r),i.push(n),i}function b(t,e){return t[0]*e[1]-t[1]*e[0]}function w(t,e){return t[0]*e[0]+t[1]*e[1]}function x(t,e,i){var n=function(t,e,i,n,r){var o=[e[0]-t[0],e[1]-t[1]],s=[n[0]-i[0],n[1]-i[1]];function a(t,e,i){return[t[0]+e*i[0],t[1]+e*i[1]]}var l=[i[0]-t[0],i[1]-t[1]],u=b(o,s),h=u*u,c=w(o,o);if(h>0){var d=b(l,s)/u;if(d<0||d>1)return null;var p=b(l,o)/u;return p<0||p>1?null:0===d||1===d?r?null:[a(t,d,o)]:0===p||1===p?r?null:[a(i,p,s)]:[a(t,d,o)]}if((h=(u=b(l,o))*u)>0)return null;var f=w(o,l)/c,g=f+w(o,s)/c,m=Math.min(f,g),v=Math.max(f,g);return m<=1&&v>=0?1===m?r?null:[a(t,m>0?m:0,o)]:0===v?r?null:[a(t,v<1?v:1,o)]:r&&0===m&&1===v?null:[a(t,m>0?m:0,o),a(t,v<1?v:1,o)]:null}(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=n?n.length:0;if(0===r)return 0;if(1===r&&(l(t.point,e.point)||l(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return l(t.point,n[0])||l(t.otherEvent.point,n[0])||_(t,n[0],i),l(e.point,n[0])||l(e.otherEvent.point,n[0])||_(e,n[0],i),1;var o=[],s=!1,a=!1;return l(t.point,e.point)?s=!0:1===y(t,e)?o.push(e,t):o.push(t,e),l(t.otherEvent.point,e.otherEvent.point)?a=!0:1===y(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&a||s?(e.type=1,t.type=e.inOut===t.inOut?2:3,s&&!a&&_(o[1].otherEvent,o[0].point,i),2):a?(_(o[0],o[1].point,i),3):o[0]!==o[3].otherEvent?(_(o[0],o[1].point,i),_(o[1],o[2].point,i),3):(_(o[0],o[1].point,i),_(o[3].otherEvent,o[2].point,i),3)}function S(t,e){if(t===e)return 0;if(0!==v(t.point,t.otherEvent.point,e.point)||0!==v(t.point,t.otherEvent.point,e.otherEvent.point))return l(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===y(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var i=t.point,n=e.point;return i[0]===n[0]&&i[1]===n[1]?(i=t.otherEvent.point,n=e.otherEvent.point,i[0]===n[0]&&i[1]===n[1]?0:t.contourId>e.contourId?1:-1):1===y(t,e)?1:-1}var C=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function T(t,e,i,n){var r,o=t+1,s=e[t].point,a=e.length;for(o<a&&(r=e[o].point);o<a&&r[0]===s[0]&&r[1]===s[1];){if(!i[o])return o;r=e[++o].point}for(o=t-1;i[o]&&o>n;)o--;return o}function E(t){var e,i,n=function(t){var e,i,n,r,o=[];for(i=0,n=t.length;i<n;i++)((e=t[i]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,i=0,n=o.length;i<n;i++)i+1<n&&1===y(o[i],o[i+1])&&(r=o[i],o[i]=o[i+1],o[i+1]=r,s=!1);for(i=0,n=o.length;i<n;i++)(e=o[i]).otherPos=i;for(i=0,n=o.length;i<n;i++)(e=o[i]).left||(r=e.otherPos,e.otherPos=e.otherEvent.otherPos,e.otherEvent.otherPos=r);return o}(t),r={},o=[],s=function(){if(!r[e]){var t=o.length,i=function(t,e,i){var n=new C;if(null!=t.prevInResult){var r=t.prevInResult,o=r.outputContourId;if(r.resultTransition>0){var s=e[o];if(null!=s.holeOf){var a=s.holeOf;e[a].holeIds.push(i),n.holeOf=a,n.depth=e[o].depth}else e[o].holeIds.push(i),n.holeOf=o,n.depth=e[o].depth+1}else n.holeOf=null,n.depth=e[o].depth}else n.holeOf=null,n.depth=0;return n}(n[e],o,t),s=function(e){r[e]=!0,n[e].outputContourId=t},a=e,l=e,u=n[e].point;for(i.points.push(u);s(a),s(a=n[a].otherPos),i.points.push(n[a].point),(a=T(a,n,r,l))!=l;);o.push(i)}};for(e=0,i=n.length;e<i;e++)s();return o}C.prototype.isExterior=function(){return null==this.holeOf};var I=A,k=A;function A(t,e){if(!(this instanceof A))return new A(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||P,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function P(t,e){return t<e?-1:t>e?1:0}A.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&i(e[s],a)<0&&(o=s,a=e[s]),i(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},I.default=k;var R=Math.max,L=Math.min,M=0;function F(t,e,i,n,r,o){var a,l,u,h,c,d;for(a=0,l=t.length-1;a<l;a++)if(u=t[a],h=t[a+1],c=new s(u,!1,void 0,e),d=new s(h,!1,c,e),c.otherEvent=d,u[0]!==h[0]||u[1]!==h[1]){c.contourId=d.contourId=i,o||(c.isExteriorRing=!1,d.isExteriorRing=!1),y(c,d)>0?d.left=!0:c.left=!0;var p=u[0],f=u[1];r[0]=L(r[0],p),r[1]=L(r[1],f),r[2]=R(r[2],p),r[3]=R(r[3],f),n.push(c),n.push(d)}}var O=[];function D(t,e,n){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var o=function(t,e,i){var n=null;return t.length*e.length==0&&(0===i?n=O:2===i?n=t:1!==i&&3!==i||(n=0===t.length?e:t)),n}(t,e,n);if(o)return o===O?null:o;var s=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],l=function(t,e,i,n,r){var o,s,a,l,u,h,c=new I(null,y);for(a=0,l=t.length;a<l;a++)for(u=0,h=(o=t[a]).length;u<h;u++)(s=0===u)&&M++,F(o[u],!0,M,c,i,s);for(a=0,l=e.length;a<l;a++)for(u=0,h=(o=e[a]).length;u<h;u++)s=0===u,2===r&&(s=!1),s&&M++,F(o[u],!1,M,c,n,s);return c}(t,e,s,a,n);if(o=function(t,e,i,n,r){var o=null;return(i[0]>n[2]||n[0]>i[2]||i[1]>n[3]||n[1]>i[3])&&(0===r?o=O:2===r?o=t:1!==r&&3!==r||(o=t.concat(e))),o}(t,e,s,a,n))return o===O?null:o;for(var u=E(function(t,e,n,o,s,a){for(var l,u,h,c=new i(S),d=[],p=Math.min(o[2],s[2]);0!==t.length;){var f=t.pop();if(d.push(f),0===a&&f.point[0]>p||2===a&&f.point[0]>o[2])break;if(f.left){u=l=c.insert(f),l=l!==(h=c.minNode())?c.prev(l):null,u=c.next(u);var g=l?l.key:null;if(r(f,g,a),u&&2===x(f,u.key,t)&&(r(f,g,a),r(f,u.key,a)),l&&2===x(l.key,f,t)){var m=l;r(g,(m=m!==h?c.prev(m):null)?m.key:null,a),r(f,g,a)}}else f=f.otherEvent,u=l=c.find(f),l&&u&&(l=l!==h?c.prev(l):null,u=c.next(u),c.remove(f),u&&l&&x(l.key,u.key,t))}return d}(l,0,0,s,a,n)),h=[],c=0;c<u.length;c++){var d=u[c];if(d.isExterior()){for(var p=[d.points],f=0;f<d.holeIds.length;f++){var g=d.holeIds[f];p.push(u[g].points)}h.push(p)}}return h}var j={UNION:1,DIFFERENCE:2,INTERSECTION:0,XOR:3};t.diff=function(t,e){return D(t,e,2)},t.intersection=function(t,e){return D(t,e,0)},t.operations=j,t.union=function(t,e){return D(t,e,1)},t.xor=function(t,e){return D(t,e,3)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},"A1R+":function(t,e,i){"use strict";t.exports=r,t.exports.default=r;var n=i("YcpW");function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],l(r,t.leaf?n(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!f(t,e))return i;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],f(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):p(t,a)?this._all(s,i):l.push(s));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!f(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],f(t,s=e.leaf?i(o):o)){if(e.leaf||p(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,l=this.toBBox(t),u=[],h=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],i=h.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!p(a,l)?n?(i++,a=n.children[i],s=!1):a=null:(u.push(a),h.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var l,u,h,c,d=Math.ceil(o/a),p=d*Math.ceil(Math.sqrt(a));for(m(t,e,i,p,this.compareMinX),l=e;l<=i;l+=p)for(m(t,l,h=Math.min(l+p-1,i),d,this.compareMinY),u=l;u<=h;u+=d)c=Math.min(u+d-1,h),r.children.push(this._build(t,u,c,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,l,u,h,d,p,f;n.push(e),!e.leaf&&n.length-1!==i;){for(h=d=1/0,r=0,o=e.children.length;r<o;r++)l=c(s=e.children[r]),p=t,f=s,(u=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l)<d?(d=u,h=l<h?l:h,a=s):u===d&&l<h&&(h=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),l(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,l,u,h,d,p,f,g,m,v,y;for(u=h=1/0,n=e;n<=i-e;n++)r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox),p=r,f=o,g=void 0,m=void 0,v=void 0,y=void 0,g=Math.max(p.minX,f.minX),m=Math.max(p.minY,f.minY),v=Math.min(p.maxX,f.maxX),y=Math.min(p.maxY,f.maxY),s=Math.max(0,v-g)*Math.max(0,y-m),l=c(r)+c(o),s<u?(u=s,d=n,h=l<h?l:h):s===u&&l<h&&(h=l,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,u=a(t,0,e,s),h=a(t,i-e,i,s),c=d(u)+d(h);for(r=e;r<i-e;r++)o=t.children[r],l(u,t.leaf?s(o):o),c+=d(u);for(r=i-e-1;r>=e;r--)o=t.children[r],l(h,t.leaf?s(o):o),c+=d(h);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)l(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},AAEp:function(t,e,i){"use strict";var n=i("XikC");i.n(n).a},AKIq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/rf6");e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,i){if(!e||!i)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,i){if(!t)throw new Error("No feature passed");if(!i)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,i){if(!t)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+i+", FeatureCollection required");for(var n=0,r=t.features;n<r.length;n++){var o=r[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},"BO+Y":function(t,e,i){var n=i("FlpK");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},BQ1l:function(t,e,i){var n=i("f66B"),r=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return n(t,e,{strict:!0})}r.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var i=this,n=o(t),r=o(e);return n.every((function(t){return this.some((function(e){return i.compare(t,e)}))}),r)}}return!1},r.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].toFixed(this.precision)!==e[i].toFixed(this.precision))return!1;return!0},r.prototype.compareLine=function(t,e,i,n){if(!s(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!n||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var a=this.compareCoord(r[i],o[i]);return this.direction||a?this.comparePath(r,o):!!this.compareCoord(r[i],o[o.length-(1+i)])&&this.comparePath(r.slice().reverse(),o)}},r.prototype.fixStartIndex=function(t,e){for(var i,n=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){n=r;break}return n>=0&&(i=[].concat(t.slice(n,t.length),t.slice(1,n+1))),i},r.prototype.comparePath=function(t,e){var i=this;return t.every((function(t,e){return i.compareCoord(t,this[e])}),e)},r.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var i=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length),r=this;return i.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),n)}return!1},r.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},r.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},r.prototype.removePseudo=function(t){return t},t.exports=r},CN2R:function(t,e){Array.prototype.find||(Array.prototype.find=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,r=arguments[1],o=0;o<n;o++)if(e=i[o],t.call(r,e,o,i))return e}),"undefined"!=typeof window&&(!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(t){"use strict";if("Element"in t){var e=t.Element.prototype,i=Object,n=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array.prototype.indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},o=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},s=function(t,e){if(""===e)throw new o("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new o("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(t,e)},a=function(t){for(var e=n.call(t.getAttribute("class")||""),i=e?e.split(/\s+/):[],r=0,o=i.length;r<o;r++)this.push(i[r]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},l=a.prototype=[],u=function(){return new a(this)};if(o.prototype=Error.prototype,l.item=function(t){return this[t]||null},l.contains=function(t){return-1!==s(this,t+="")},l.add=function(){var t,e=arguments,i=0,n=e.length,r=!1;do{t=e[i]+"",-1===s(this,t)&&(this.push(t),r=!0)}while(++i<n);r&&this._updateClassName()},l.remove=function(){var t,e,i=arguments,n=0,r=i.length,o=!1;do{for(t=i[n]+"",e=s(this,t);-1!==e;)this.splice(e,1),o=!0,e=s(this,t)}while(++n<r);o&&this._updateClassName()},l.toggle=function(t,e){t+="";var i=this.contains(t),n=i?!0!==e&&"remove":!1!==e&&"add";return n&&this[n](t),!0===e||!1===e?e:!i},l.toString=function(){return this.join(" ")},i.defineProperty){var h={get:u,enumerable:!0,configurable:!0};try{i.defineProperty(e,"classList",h)}catch(t){-2146823252===t.number&&(h.enumerable=!1,i.defineProperty(e,"classList",h))}}else i.prototype.__defineGetter__&&e.__defineGetter__("classList",u)}}(self):function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var i,n=arguments.length;for(i=0;i<n;i++)t=arguments[i],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var i=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:i.call(this,t)}}t=null}())},D3zA:function(t,e,i){"use strict";var n=i("aI7X");t.exports=Function.prototype.bind||n},DmXP:function(t,e,i){"use strict";var n=Date.prototype.getDay,r=Object.prototype.toString,o="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(o?function(t){try{return n.call(t),!0}catch(t){return!1}}(t):"[object Date]"===r.call(t))}},FlpK:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity .3s ease;\n}\n.fade-enter,\n.fade-leave-active {\n  height: 0;\n  opacity: 0;\n}\n.alert.top {\n  position: fixed;\n  top: 30px;\n  margin: 0 auto;\n  left: 0;\n  right: 0;\n  z-index: 1050;\n}\n.alert.top-right {\n  position: fixed;\n  top: 30px;\n  right: 50px;\n  z-index: 1050;\n}\n",""])},FpZJ:function(t,e,i){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},HH6Z:function(t,e,i){"use strict";var n=i("82c2").supportsDescriptors,r=i("V+xs"),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!n||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(u),i=o(e,"flags");return i&&i.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},HQVW:function(t,e,i){var n=i("Xf4S");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},I1BE:function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var r=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[i].concat(o).concat([r]).join("\n")}var s;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i})).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(n[o]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},INkZ:function(t,e,i){"use strict";(function(e,i){var n=Object.freeze({});function r(t){return null==t}function o(t){return null!=t}function s(t){return!0===t}function a(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function l(t){return null!==t&&"object"==typeof t}var u=Object.prototype.toString;function h(t){return"[object Object]"===u.call(t)}function c(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function d(t){return o(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function p(t){return null==t?"":Array.isArray(t)||h(t)&&t.toString===u?JSON.stringify(t,null,2):String(t)}function f(t){var e=parseFloat(t);return isNaN(e)?t:e}function g(t,e){for(var i=Object.create(null),n=t.split(","),r=0;r<n.length;r++)i[n[r]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}var m=g("slot,component",!0),v=g("key,ref,slot,slot-scope,is");function y(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var _=Object.prototype.hasOwnProperty;function b(t,e){return _.call(t,e)}function w(t){var e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}var x=/-(\w)/g,S=w((function(t){return t.replace(x,(function(t,e){return e?e.toUpperCase():""}))})),C=w((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),T=/\B([A-Z])/g,E=w((function(t){return t.replace(T,"-$1").toLowerCase()})),I=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function i(i){var n=arguments.length;return n?n>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i};function k(t,e){e=e||0;for(var i=t.length-e,n=new Array(i);i--;)n[i]=t[i+e];return n}function A(t,e){for(var i in e)t[i]=e[i];return t}function P(t){for(var e={},i=0;i<t.length;i++)t[i]&&A(e,t[i]);return e}function R(t,e,i){}var L=function(t,e,i){return!1},M=function(t){return t};function F(t,e){if(t===e)return!0;var i=l(t),n=l(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var r=Array.isArray(t),o=Array.isArray(e);if(r&&o)return t.length===e.length&&t.every((function(t,i){return F(t,e[i])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(r||o)return!1;var s=Object.keys(t),a=Object.keys(e);return s.length===a.length&&s.every((function(i){return F(t[i],e[i])}))}catch(t){return!1}}function O(t,e){for(var i=0;i<t.length;i++)if(F(t[i],e))return i;return-1}function D(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var j="data-server-rendered",$=["component","directive","filter"],N=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],B={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:L,isReservedAttr:L,isUnknownElement:L,getTagNamespace:R,parsePlatformTagName:M,mustUseProp:L,async:!0,_lifecycleHooks:N},U=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function G(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var z,V=new RegExp("[^"+U.source+".$_\\d]"),q="__proto__"in{},W="undefined"!=typeof window,K="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,X=K&&WXEnvironment.platform.toLowerCase(),H=W&&window.navigator.userAgent.toLowerCase(),Y=H&&/msie|trident/.test(H),Z=H&&H.indexOf("msie 9.0")>0,J=H&&H.indexOf("edge/")>0,Q=(H&&H.indexOf("android"),H&&/iphone|ipad|ipod|ios/.test(H)||"ios"===X),tt=(H&&/chrome\/\d+/.test(H),H&&/phantomjs/.test(H),H&&H.match(/firefox\/(\d+)/)),et={}.watch,it=!1;if(W)try{var nt={};Object.defineProperty(nt,"passive",{get:function(){it=!0}}),window.addEventListener("test-passive",null,nt)}catch(n){}var rt=function(){return void 0===z&&(z=!W&&!K&&void 0!==e&&e.process&&"server"===e.process.env.VUE_ENV),z},ot=W&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function st(t){return"function"==typeof t&&/native code/.test(t.toString())}var at,lt="undefined"!=typeof Symbol&&st(Symbol)&&"undefined"!=typeof Reflect&&st(Reflect.ownKeys);at="undefined"!=typeof Set&&st(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var ut=R,ht=0,ct=function(){this.id=ht++,this.subs=[]};ct.prototype.addSub=function(t){this.subs.push(t)},ct.prototype.removeSub=function(t){y(this.subs,t)},ct.prototype.depend=function(){ct.target&&ct.target.addDep(this)},ct.prototype.notify=function(){for(var t=this.subs.slice(),e=0,i=t.length;e<i;e++)t[e].update()},ct.target=null;var dt=[];function pt(t){dt.push(t),ct.target=t}function ft(){dt.pop(),ct.target=dt[dt.length-1]}var gt=function(t,e,i,n,r,o,s,a){this.tag=t,this.data=e,this.children=i,this.text=n,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},mt={child:{configurable:!0}};mt.child.get=function(){return this.componentInstance},Object.defineProperties(gt.prototype,mt);var vt=function(t){void 0===t&&(t="");var e=new gt;return e.text=t,e.isComment=!0,e};function yt(t){return new gt(void 0,void 0,void 0,String(t))}function _t(t){var e=new gt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var bt=Array.prototype,wt=Object.create(bt);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=bt[t];G(wt,t,(function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];var r,o=e.apply(this,i),s=this.__ob__;switch(t){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&s.observeArray(r),s.dep.notify(),o}))}));var xt=Object.getOwnPropertyNames(wt),St=!0;function Ct(t){St=t}var Tt=function(t){var e;this.value=t,this.dep=new ct,this.vmCount=0,G(t,"__ob__",this),Array.isArray(t)?(q?(e=wt,t.__proto__=e):function(t,e,i){for(var n=0,r=i.length;n<r;n++){var o=i[n];G(t,o,e[o])}}(t,wt,xt),this.observeArray(t)):this.walk(t)};function Et(t,e){var i;if(l(t)&&!(t instanceof gt))return b(t,"__ob__")&&t.__ob__ instanceof Tt?i=t.__ob__:St&&!rt()&&(Array.isArray(t)||h(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new Tt(t)),e&&i&&i.vmCount++,i}function It(t,e,i,n,r){var o=new ct,s=Object.getOwnPropertyDescriptor(t,e);if(!s||!1!==s.configurable){var a=s&&s.get,l=s&&s.set;a&&!l||2!==arguments.length||(i=t[e]);var u=!r&&Et(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):i;return ct.target&&(o.depend(),u&&(u.dep.depend(),Array.isArray(e)&&function t(e){for(var i=void 0,n=0,r=e.length;n<r;n++)(i=e[n])&&i.__ob__&&i.__ob__.dep.depend(),Array.isArray(i)&&t(i)}(e))),e},set:function(e){var n=a?a.call(t):i;e===n||e!=e&&n!=n||a&&!l||(l?l.call(t,e):i=e,u=!r&&Et(e),o.notify())}})}}function kt(t,e,i){if(Array.isArray(t)&&c(e))return t.length=Math.max(t.length,e),t.splice(e,1,i),i;if(e in t&&!(e in Object.prototype))return t[e]=i,i;var n=t.__ob__;return t._isVue||n&&n.vmCount?i:n?(It(n.value,e,i),n.dep.notify(),i):(t[e]=i,i)}function At(t,e){if(Array.isArray(t)&&c(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||b(t,e)&&(delete t[e],i&&i.dep.notify())}}Tt.prototype.walk=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)It(t,e[i])},Tt.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)Et(t[e])};var Pt=B.optionMergeStrategies;function Rt(t,e){if(!e)return t;for(var i,n,r,o=lt?Reflect.ownKeys(e):Object.keys(e),s=0;s<o.length;s++)"__ob__"!==(i=o[s])&&(n=t[i],r=e[i],b(t,i)?n!==r&&h(n)&&h(r)&&Rt(n,r):kt(t,i,r));return t}function Lt(t,e,i){return i?function(){var n="function"==typeof e?e.call(i,i):e,r="function"==typeof t?t.call(i,i):t;return n?Rt(n,r):r}:e?t?function(){return Rt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Mt(t,e){var i=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return i?function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}(i):i}function Ft(t,e,i,n){var r=Object.create(t||null);return e?A(r,e):r}Pt.data=function(t,e,i){return i?Lt(t,e,i):e&&"function"!=typeof e?t:Lt(t,e)},N.forEach((function(t){Pt[t]=Mt})),$.forEach((function(t){Pt[t+"s"]=Ft})),Pt.watch=function(t,e,i,n){if(t===et&&(t=void 0),e===et&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var r={};for(var o in A(r,t),e){var s=r[o],a=e[o];s&&!Array.isArray(s)&&(s=[s]),r[o]=s?s.concat(a):Array.isArray(a)?a:[a]}return r},Pt.props=Pt.methods=Pt.inject=Pt.computed=function(t,e,i,n){if(!t)return e;var r=Object.create(null);return A(r,t),e&&A(r,e),r},Pt.provide=Lt;var Ot=function(t,e){return void 0===e?t:e};function Dt(t,e,i){if("function"==typeof e&&(e=e.options),function(t,e){var i=t.props;if(i){var n,r,o={};if(Array.isArray(i))for(n=i.length;n--;)"string"==typeof(r=i[n])&&(o[S(r)]={type:null});else if(h(i))for(var s in i)r=i[s],o[S(s)]=h(r)?r:{type:r};t.props=o}}(e),function(t,e){var i=t.inject;if(i){var n=t.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]={from:i[r]};else if(h(i))for(var o in i){var s=i[o];n[o]=h(s)?A({from:o},s):{from:s}}}}(e),function(t){var e=t.directives;if(e)for(var i in e){var n=e[i];"function"==typeof n&&(e[i]={bind:n,update:n})}}(e),!e._base&&(e.extends&&(t=Dt(t,e.extends,i)),e.mixins))for(var n=0,r=e.mixins.length;n<r;n++)t=Dt(t,e.mixins[n],i);var o,s={};for(o in t)a(o);for(o in e)b(t,o)||a(o);function a(n){var r=Pt[n]||Ot;s[n]=r(t[n],e[n],i,n)}return s}function jt(t,e,i,n){if("string"==typeof i){var r=t[e];if(b(r,i))return r[i];var o=S(i);if(b(r,o))return r[o];var s=C(o);return b(r,s)?r[s]:r[i]||r[o]||r[s]}}function $t(t,e,i,n){var r=e[t],o=!b(i,t),s=i[t],a=Ut(Boolean,r.type);if(a>-1)if(o&&!b(r,"default"))s=!1;else if(""===s||s===E(t)){var l=Ut(String,r.type);(l<0||a<l)&&(s=!0)}if(void 0===s){s=function(t,e,i){if(b(e,"default")){var n=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i]?t._props[i]:"function"==typeof n&&"Function"!==Nt(e.type)?n.call(t):n}}(n,r,t);var u=St;Ct(!0),Et(s),Ct(u)}return s}function Nt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Bt(t,e){return Nt(t)===Nt(e)}function Ut(t,e){if(!Array.isArray(e))return Bt(e,t)?0:-1;for(var i=0,n=e.length;i<n;i++)if(Bt(e[i],t))return i;return-1}function Gt(t,e,i){pt();try{if(e)for(var n=e;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{if(!1===r[o].call(n,t,e,i))return}catch(t){Vt(t,n,"errorCaptured hook")}}Vt(t,e,i)}finally{ft()}}function zt(t,e,i,n,r){var o;try{(o=i?t.apply(e,i):t.call(e))&&!o._isVue&&d(o)&&!o._handled&&(o.catch((function(t){return Gt(t,n,r+" (Promise/async)")})),o._handled=!0)}catch(t){Gt(t,n,r)}return o}function Vt(t,e,i){if(B.errorHandler)try{return B.errorHandler.call(null,t,e,i)}catch(e){e!==t&&qt(e,null,"config.errorHandler")}qt(t,e,i)}function qt(t,e,i){if(!W&&!K||"undefined"==typeof console)throw t;console.error(t)}var Wt,Kt=!1,Xt=[],Ht=!1;function Yt(){Ht=!1;var t=Xt.slice(0);Xt.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&st(Promise)){var Zt=Promise.resolve();Wt=function(){Zt.then(Yt),Q&&setTimeout(R)},Kt=!0}else if(Y||"undefined"==typeof MutationObserver||!st(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Wt=void 0!==i&&st(i)?function(){i(Yt)}:function(){setTimeout(Yt,0)};else{var Jt=1,Qt=new MutationObserver(Yt),te=document.createTextNode(String(Jt));Qt.observe(te,{characterData:!0}),Wt=function(){Jt=(Jt+1)%2,te.data=String(Jt)},Kt=!0}function ee(t,e){var i;if(Xt.push((function(){if(t)try{t.call(e)}catch(t){Gt(t,e,"nextTick")}else i&&i(e)})),Ht||(Ht=!0,Wt()),!t&&"undefined"!=typeof Promise)return new Promise((function(t){i=t}))}var ie=new at;function ne(t){!function t(e,i){var n,r,o=Array.isArray(e);if(!(!o&&!l(e)||Object.isFrozen(e)||e instanceof gt)){if(e.__ob__){var s=e.__ob__.dep.id;if(i.has(s))return;i.add(s)}if(o)for(n=e.length;n--;)t(e[n],i);else for(n=(r=Object.keys(e)).length;n--;)t(e[r[n]],i)}}(t,ie),ie.clear()}var re=w((function(t){var e="&"===t.charAt(0),i="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=i?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:i,capture:n,passive:e}}));function oe(t,e){function i(){var t=arguments,n=i.fns;if(!Array.isArray(n))return zt(n,null,arguments,e,"v-on handler");for(var r=n.slice(),o=0;o<r.length;o++)zt(r[o],null,t,e,"v-on handler")}return i.fns=t,i}function se(t,e,i,n,o,a){var l,u,h,c;for(l in t)u=t[l],h=e[l],c=re(l),r(u)||(r(h)?(r(u.fns)&&(u=t[l]=oe(u,a)),s(c.once)&&(u=t[l]=o(c.name,u,c.capture)),i(c.name,u,c.capture,c.passive,c.params)):u!==h&&(h.fns=u,t[l]=h));for(l in e)r(t[l])&&n((c=re(l)).name,e[l],c.capture)}function ae(t,e,i){var n;t instanceof gt&&(t=t.data.hook||(t.data.hook={}));var a=t[e];function l(){i.apply(this,arguments),y(n.fns,l)}r(a)?n=oe([l]):o(a.fns)&&s(a.merged)?(n=a).fns.push(l):n=oe([a,l]),n.merged=!0,t[e]=n}function le(t,e,i,n,r){if(o(e)){if(b(e,i))return t[i]=e[i],r||delete e[i],!0;if(b(e,n))return t[i]=e[n],r||delete e[n],!0}return!1}function ue(t){return a(t)?[yt(t)]:Array.isArray(t)?function t(e,i){var n,l,u,h,c=[];for(n=0;n<e.length;n++)r(l=e[n])||"boolean"==typeof l||(h=c[u=c.length-1],Array.isArray(l)?l.length>0&&(he((l=t(l,(i||"")+"_"+n))[0])&&he(h)&&(c[u]=yt(h.text+l[0].text),l.shift()),c.push.apply(c,l)):a(l)?he(h)?c[u]=yt(h.text+l):""!==l&&c.push(yt(l)):he(l)&&he(h)?c[u]=yt(h.text+l.text):(s(e._isVList)&&o(l.tag)&&r(l.key)&&o(i)&&(l.key="__vlist"+i+"_"+n+"__"),c.push(l)));return c}(t):void 0}function he(t){return o(t)&&o(t.text)&&!1===t.isComment}function ce(t,e){if(t){for(var i=Object.create(null),n=lt?Reflect.ownKeys(t):Object.keys(t),r=0;r<n.length;r++){var o=n[r];if("__ob__"!==o){for(var s=t[o].from,a=e;a;){if(a._provided&&b(a._provided,s)){i[o]=a._provided[s];break}a=a.$parent}if(!a&&"default"in t[o]){var l=t[o].default;i[o]="function"==typeof l?l.call(e):l}}}return i}}function de(t,e){if(!t||!t.length)return{};for(var i={},n=0,r=t.length;n<r;n++){var o=t[n],s=o.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==e&&o.fnContext!==e||!s||null==s.slot)(i.default||(i.default=[])).push(o);else{var a=s.slot,l=i[a]||(i[a]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var u in i)i[u].every(pe)&&delete i[u];return i}function pe(t){return t.isComment&&!t.asyncFactory||" "===t.text}function fe(t,e,i){var r,o=Object.keys(e).length>0,s=t?!!t.$stable:!o,a=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(s&&i&&i!==n&&a===i.$key&&!o&&!i.$hasNormal)return i;for(var l in r={},t)t[l]&&"$"!==l[0]&&(r[l]=ge(e,l,t[l]))}else r={};for(var u in e)u in r||(r[u]=me(e,u));return t&&Object.isExtensible(t)&&(t._normalized=r),G(r,"$stable",s),G(r,"$key",a),G(r,"$hasNormal",o),r}function ge(t,e,i){var n=function(){var t=arguments.length?i.apply(null,arguments):i({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:ue(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return i.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0}),n}function me(t,e){return function(){return t[e]}}function ve(t,e){var i,n,r,s,a;if(Array.isArray(t)||"string"==typeof t)for(i=new Array(t.length),n=0,r=t.length;n<r;n++)i[n]=e(t[n],n);else if("number"==typeof t)for(i=new Array(t),n=0;n<t;n++)i[n]=e(n+1,n);else if(l(t))if(lt&&t[Symbol.iterator]){i=[];for(var u=t[Symbol.iterator](),h=u.next();!h.done;)i.push(e(h.value,i.length)),h=u.next()}else for(s=Object.keys(t),i=new Array(s.length),n=0,r=s.length;n<r;n++)a=s[n],i[n]=e(t[a],a,n);return o(i)||(i=[]),i._isVList=!0,i}function ye(t,e,i,n){var r,o=this.$scopedSlots[t];o?(i=i||{},n&&(i=A(A({},n),i)),r=o(i)||e):r=this.$slots[t]||e;var s=i&&i.slot;return s?this.$createElement("template",{slot:s},r):r}function _e(t){return jt(this.$options,"filters",t)||M}function be(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function we(t,e,i,n,r){var o=B.keyCodes[e]||i;return r&&n&&!B.keyCodes[e]?be(r,n):o?be(o,t):n?E(n)!==e:void 0}function xe(t,e,i,n,r){if(i&&l(i)){var o;Array.isArray(i)&&(i=P(i));var s=function(s){if("class"===s||"style"===s||v(s))o=t;else{var a=t.attrs&&t.attrs.type;o=n||B.mustUseProp(e,a,s)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var l=S(s),u=E(s);l in o||u in o||(o[s]=i[s],r&&((t.on||(t.on={}))["update:"+s]=function(t){i[s]=t}))};for(var a in i)s(a)}return t}function Se(t,e){var i=this._staticTrees||(this._staticTrees=[]),n=i[t];return n&&!e||Te(n=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n}function Ce(t,e,i){return Te(t,"__once__"+e+(i?"_"+i:""),!0),t}function Te(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Ee(t[n],e+"_"+n,i);else Ee(t,e,i)}function Ee(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function Ie(t,e){if(e&&h(e)){var i=t.on=t.on?A({},t.on):{};for(var n in e){var r=i[n],o=e[n];i[n]=r?[].concat(r,o):o}}return t}function ke(t,e,i,n){e=e||{$stable:!i};for(var r=0;r<t.length;r++){var o=t[r];Array.isArray(o)?ke(o,e,i):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return n&&(e.$key=n),e}function Ae(t,e){for(var i=0;i<e.length;i+=2){var n=e[i];"string"==typeof n&&n&&(t[e[i]]=e[i+1])}return t}function Pe(t,e){return"string"==typeof t?e+t:t}function Re(t){t._o=Ce,t._n=f,t._s=p,t._l=ve,t._t=ye,t._q=F,t._i=O,t._m=Se,t._f=_e,t._k=we,t._b=xe,t._v=yt,t._e=vt,t._u=ke,t._g=Ie,t._d=Ae,t._p=Pe}function Le(t,e,i,r,o){var a,l=this,u=o.options;b(r,"_uid")?(a=Object.create(r))._original=r:(a=r,r=r._original);var h=s(u._compiled),c=!h;this.data=t,this.props=e,this.children=i,this.parent=r,this.listeners=t.on||n,this.injections=ce(u.inject,r),this.slots=function(){return l.$slots||fe(t.scopedSlots,l.$slots=de(i,r)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return fe(t.scopedSlots,this.slots())}}),h&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=fe(t.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,i,n){var o=Ne(a,t,e,i,n,c);return o&&!Array.isArray(o)&&(o.fnScopeId=u._scopeId,o.fnContext=r),o}:this._c=function(t,e,i,n){return Ne(a,t,e,i,n,c)}}function Me(t,e,i,n,r){var o=_t(t);return o.fnContext=i,o.fnOptions=n,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function Fe(t,e){for(var i in e)t[S(i)]=e[i]}Re(Le.prototype);var Oe={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;Oe.prepatch(i,i)}else(t.componentInstance=function(t,e){var i={_isComponent:!0,_parentVnode:t,parent:e},n=t.data.inlineTemplate;return o(n)&&(i.render=n.render,i.staticRenderFns=n.staticRenderFns),new t.componentOptions.Ctor(i)}(t,He)).$mount(e?t.elm:void 0,e)},prepatch:function(t,e){var i=e.componentOptions;!function(t,e,i,r,o){var s=r.data.scopedSlots,a=t.$scopedSlots,l=!!(s&&!s.$stable||a!==n&&!a.$stable||s&&t.$scopedSlots.$key!==s.$key),u=!!(o||t.$options._renderChildren||l);if(t.$options._parentVnode=r,t.$vnode=r,t._vnode&&(t._vnode.parent=r),t.$options._renderChildren=o,t.$attrs=r.data.attrs||n,t.$listeners=i||n,e&&t.$options.props){Ct(!1);for(var h=t._props,c=t.$options._propKeys||[],d=0;d<c.length;d++){var p=c[d],f=t.$options.props;h[p]=$t(p,f,e,t)}Ct(!0),t.$options.propsData=e}i=i||n;var g=t.$options._parentListeners;t.$options._parentListeners=i,Xe(t,i,g),u&&(t.$slots=de(o,r.context),t.$forceUpdate())}(e.componentInstance=t.componentInstance,i.propsData,i.listeners,e,i.children)},insert:function(t){var e,i=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,Qe(n,"mounted")),t.data.keepAlive&&(i._isMounted?((e=n)._inactive=!1,ei.push(e)):Je(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?function t(e,i){if(!(i&&(e._directInactive=!0,Ze(e))||e._inactive)){e._inactive=!0;for(var n=0;n<e.$children.length;n++)t(e.$children[n]);Qe(e,"deactivated")}}(e,!0):e.$destroy())}},De=Object.keys(Oe);function je(t,e,i,a,u){if(!r(t)){var h=i.$options._base;if(l(t)&&(t=h.extend(t)),"function"==typeof t){var c;if(r(t.cid)&&void 0===(t=function(t,e){if(s(t.error)&&o(t.errorComp))return t.errorComp;if(o(t.resolved))return t.resolved;var i=Ue;if(i&&o(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i),s(t.loading)&&o(t.loadingComp))return t.loadingComp;if(i&&!o(t.owners)){var n=t.owners=[i],a=!0,u=null,h=null;i.$on("hook:destroyed",(function(){return y(n,i)}));var c=function(t){for(var e=0,i=n.length;e<i;e++)n[e].$forceUpdate();t&&(n.length=0,null!==u&&(clearTimeout(u),u=null),null!==h&&(clearTimeout(h),h=null))},p=D((function(i){t.resolved=Ge(i,e),a?n.length=0:c(!0)})),f=D((function(e){o(t.errorComp)&&(t.error=!0,c(!0))})),g=t(p,f);return l(g)&&(d(g)?r(t.resolved)&&g.then(p,f):d(g.component)&&(g.component.then(p,f),o(g.error)&&(t.errorComp=Ge(g.error,e)),o(g.loading)&&(t.loadingComp=Ge(g.loading,e),0===g.delay?t.loading=!0:u=setTimeout((function(){u=null,r(t.resolved)&&r(t.error)&&(t.loading=!0,c(!1))}),g.delay||200)),o(g.timeout)&&(h=setTimeout((function(){h=null,r(t.resolved)&&f(null)}),g.timeout)))),a=!1,t.loading?t.loadingComp:t.resolved}}(c=t,h)))return function(t,e,i,n,r){var o=vt();return o.asyncFactory=t,o.asyncMeta={data:e,context:i,children:n,tag:r},o}(c,e,i,a,u);e=e||{},bi(t),o(e.model)&&function(t,e){var i=t.model&&t.model.prop||"value",n=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[i]=e.model.value;var r=e.on||(e.on={}),s=r[n],a=e.model.callback;o(s)?(Array.isArray(s)?-1===s.indexOf(a):s!==a)&&(r[n]=[a].concat(s)):r[n]=a}(t.options,e);var p=function(t,e,i){var n=e.options.props;if(!r(n)){var s={},a=t.attrs,l=t.props;if(o(a)||o(l))for(var u in n){var h=E(u);le(s,l,u,h,!0)||le(s,a,u,h,!1)}return s}}(e,t);if(s(t.options.functional))return function(t,e,i,r,s){var a=t.options,l={},u=a.props;if(o(u))for(var h in u)l[h]=$t(h,u,e||n);else o(i.attrs)&&Fe(l,i.attrs),o(i.props)&&Fe(l,i.props);var c=new Le(i,l,s,r,t),d=a.render.call(null,c._c,c);if(d instanceof gt)return Me(d,i,c.parent,a);if(Array.isArray(d)){for(var p=ue(d)||[],f=new Array(p.length),g=0;g<p.length;g++)f[g]=Me(p[g],i,c.parent,a);return f}}(t,p,e,i,a);var f=e.on;if(e.on=e.nativeOn,s(t.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(t){for(var e=t.hook||(t.hook={}),i=0;i<De.length;i++){var n=De[i],r=e[n],o=Oe[n];r===o||r&&r._merged||(e[n]=r?$e(o,r):o)}}(e);var m=t.options.name||u;return new gt("vue-component-"+t.cid+(m?"-"+m:""),e,void 0,void 0,void 0,i,{Ctor:t,propsData:p,listeners:f,tag:u,children:a},c)}}}function $e(t,e){var i=function(i,n){t(i,n),e(i,n)};return i._merged=!0,i}function Ne(t,e,i,n,u,h){return(Array.isArray(i)||a(i))&&(u=n,n=i,i=void 0),s(h)&&(u=2),function(t,e,i,n,a){if(o(i)&&o(i.__ob__))return vt();if(o(i)&&o(i.is)&&(e=i.is),!e)return vt();var u,h,c;(Array.isArray(n)&&"function"==typeof n[0]&&((i=i||{}).scopedSlots={default:n[0]},n.length=0),2===a?n=ue(n):1===a&&(n=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(n)),"string"==typeof e)?(h=t.$vnode&&t.$vnode.ns||B.getTagNamespace(e),u=B.isReservedTag(e)?new gt(B.parsePlatformTagName(e),i,n,void 0,void 0,t):i&&i.pre||!o(c=jt(t.$options,"components",e))?new gt(e,i,n,void 0,void 0,t):je(c,i,t,n,e)):u=je(e,i,t,n);return Array.isArray(u)?u:o(u)?(o(h)&&function t(e,i,n){if(e.ns=i,"foreignObject"===e.tag&&(i=void 0,n=!0),o(e.children))for(var a=0,l=e.children.length;a<l;a++){var u=e.children[a];o(u.tag)&&(r(u.ns)||s(n)&&"svg"!==u.tag)&&t(u,i,n)}}(u,h),o(i)&&function(t){l(t.style)&&ne(t.style),l(t.class)&&ne(t.class)}(i),u):vt()}(t,e,i,n,u)}var Be,Ue=null;function Ge(t,e){return(t.__esModule||lt&&"Module"===t[Symbol.toStringTag])&&(t=t.default),l(t)?e.extend(t):t}function ze(t){return t.isComment&&t.asyncFactory}function Ve(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];if(o(i)&&(o(i.componentOptions)||ze(i)))return i}}function qe(t,e){Be.$on(t,e)}function We(t,e){Be.$off(t,e)}function Ke(t,e){var i=Be;return function n(){null!==e.apply(null,arguments)&&i.$off(t,n)}}function Xe(t,e,i){Be=t,se(e,i||{},qe,We,Ke,t),Be=void 0}var He=null;function Ye(t){var e=He;return He=t,function(){He=e}}function Ze(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function Je(t,e){if(e){if(t._directInactive=!1,Ze(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)Je(t.$children[i]);Qe(t,"activated")}}function Qe(t,e){pt();var i=t.$options[e],n=e+" hook";if(i)for(var r=0,o=i.length;r<o;r++)zt(i[r],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),ft()}var ti=[],ei=[],ii={},ni=!1,ri=!1,oi=0,si=0,ai=Date.now;if(W&&!Y){var li=window.performance;li&&"function"==typeof li.now&&ai()>document.createEvent("Event").timeStamp&&(ai=function(){return li.now()})}function ui(){var t,e;for(si=ai(),ri=!0,ti.sort((function(t,e){return t.id-e.id})),oi=0;oi<ti.length;oi++)(t=ti[oi]).before&&t.before(),e=t.id,ii[e]=null,t.run();var i=ei.slice(),n=ti.slice();oi=ti.length=ei.length=0,ii={},ni=ri=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Je(t[e],!0)}(i),function(t){for(var e=t.length;e--;){var i=t[e],n=i.vm;n._watcher===i&&n._isMounted&&!n._isDestroyed&&Qe(n,"updated")}}(n),ot&&B.devtools&&ot.emit("flush")}var hi=0,ci=function(t,e,i,n,r){this.vm=t,r&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++hi,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new at,this.newDepIds=new at,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!V.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}(e),this.getter||(this.getter=R)),this.value=this.lazy?void 0:this.get()};ci.prototype.get=function(){var t;pt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Gt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ne(t),ft(),this.cleanupDeps()}return t},ci.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},ci.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},ci.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==ii[e]){if(ii[e]=!0,ri){for(var i=ti.length-1;i>oi&&ti[i].id>t.id;)i--;ti.splice(i+1,0,t)}else ti.push(t);ni||(ni=!0,ee(ui))}}(this)},ci.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||l(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){Gt(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},ci.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ci.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},ci.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var di={enumerable:!0,configurable:!0,get:R,set:R};function pi(t,e,i){di.get=function(){return this[e][i]},di.set=function(t){this[e][i]=t},Object.defineProperty(t,i,di)}var fi={lazy:!0};function gi(t,e,i){var n=!rt();"function"==typeof i?(di.get=n?mi(e):vi(i),di.set=R):(di.get=i.get?n&&!1!==i.cache?mi(e):vi(i.get):R,di.set=i.set||R),Object.defineProperty(t,e,di)}function mi(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ct.target&&e.depend(),e.value}}function vi(t){return function(){return t.call(this,this)}}function yi(t,e,i,n){return h(i)&&(n=i,i=i.handler),"string"==typeof i&&(i=t[i]),t.$watch(e,i,n)}var _i=0;function bi(t){var e=t.options;if(t.super){var i=bi(t.super);if(i!==t.superOptions){t.superOptions=i;var n=function(t){var e,i=t.options,n=t.sealedOptions;for(var r in i)i[r]!==n[r]&&(e||(e={}),e[r]=i[r]);return e}(t);n&&A(t.extendOptions,n),(e=t.options=Dt(i,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function wi(t){this._init(t)}function xi(t){return t&&(t.Ctor.options.name||t.tag)}function Si(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:(i=t,"[object RegExp]"===u.call(i)&&t.test(e));var i}function Ci(t,e){var i=t.cache,n=t.keys,r=t._vnode;for(var o in i){var s=i[o];if(s){var a=xi(s.componentOptions);a&&!e(a)&&Ti(i,o,n,r)}}}function Ti(t,e,i,n){var r=t[e];!r||n&&r.tag===n.tag||r.componentInstance.$destroy(),t[e]=null,y(i,e)}!function(t){t.prototype._init=function(t){var e=this;e._uid=_i++,e._isVue=!0,t&&t._isComponent?function(t,e){var i=t.$options=Object.create(t.constructor.options),n=e._parentVnode;i.parent=e.parent,i._parentVnode=n;var r=n.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}(e,t):e.$options=Dt(bi(e.constructor),t||{},e),e._renderProxy=e,e._self=e,function(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(e),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&Xe(t,e)}(e),function(t){t._vnode=null,t._staticTrees=null;var e=t.$options,i=t.$vnode=e._parentVnode,r=i&&i.context;t.$slots=de(e._renderChildren,r),t.$scopedSlots=n,t._c=function(e,i,n,r){return Ne(t,e,i,n,r,!1)},t.$createElement=function(e,i,n,r){return Ne(t,e,i,n,r,!0)};var o=i&&i.data;It(t,"$attrs",o&&o.attrs||n,null,!0),It(t,"$listeners",e._parentListeners||n,null,!0)}(e),Qe(e,"beforeCreate"),function(t){var e=ce(t.$options.inject,t);e&&(Ct(!1),Object.keys(e).forEach((function(i){It(t,i,e[i])})),Ct(!0))}(e),function(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var i=t.$options.propsData||{},n=t._props={},r=t.$options._propKeys=[];t.$parent&&Ct(!1);var o=function(o){r.push(o);var s=$t(o,e,i,t);It(n,o,s),o in t||pi(t,"_props",o)};for(var s in e)o(s);Ct(!0)}(t,e.props),e.methods&&function(t,e){for(var i in t.$options.props,e)t[i]="function"!=typeof e[i]?R:I(e[i],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;h(e=t._data="function"==typeof e?function(t,e){pt();try{return t.call(e,e)}catch(t){return Gt(t,e,"data()"),{}}finally{ft()}}(e,t):e||{})||(e={});for(var i,n=Object.keys(e),r=t.$options.props,o=(t.$options.methods,n.length);o--;){var s=n[o];r&&b(r,s)||(void 0,36!==(i=(s+"").charCodeAt(0))&&95!==i&&pi(t,"_data",s))}Et(e,!0)}(t):Et(t._data={},!0),e.computed&&function(t,e){var i=t._computedWatchers=Object.create(null),n=rt();for(var r in e){var o=e[r],s="function"==typeof o?o:o.get;n||(i[r]=new ci(t,s||R,R,fi)),r in t||gi(t,r,o)}}(t,e.computed),e.watch&&e.watch!==et&&function(t,e){for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)yi(t,i,n[r]);else yi(t,i,n)}}(t,e.watch)}(e),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(e),Qe(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(wi),function(t){Object.defineProperty(t.prototype,"$data",{get:function(){return this._data}}),Object.defineProperty(t.prototype,"$props",{get:function(){return this._props}}),t.prototype.$set=kt,t.prototype.$delete=At,t.prototype.$watch=function(t,e,i){if(h(e))return yi(this,t,e,i);(i=i||{}).user=!0;var n=new ci(this,t,e,i);if(i.immediate)try{e.call(this,n.value)}catch(t){Gt(t,this,'callback for immediate watcher "'+n.expression+'"')}return function(){n.teardown()}}}(wi),function(t){var e=/^hook:/;t.prototype.$on=function(t,i){var n=this;if(Array.isArray(t))for(var r=0,o=t.length;r<o;r++)n.$on(t[r],i);else(n._events[t]||(n._events[t]=[])).push(i),e.test(t)&&(n._hasHookEvent=!0);return n},t.prototype.$once=function(t,e){var i=this;function n(){i.$off(t,n),e.apply(i,arguments)}return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)i.$off(t[n],e);return i}var o,s=i._events[t];if(!s)return i;if(!e)return i._events[t]=null,i;for(var a=s.length;a--;)if((o=s[a])===e||o.fn===e){s.splice(a,1);break}return i},t.prototype.$emit=function(t){var e=this._events[t];if(e){e=e.length>1?k(e):e;for(var i=k(arguments,1),n='event handler for "'+t+'"',r=0,o=e.length;r<o;r++)zt(e[r],this,i,this,n)}return this}}(wi),function(t){t.prototype._update=function(t,e){var i=this,n=i.$el,r=i._vnode,o=Ye(i);i._vnode=t,i.$el=r?i.__patch__(r,t):i.__patch__(i.$el,t,e,!1),o(),n&&(n.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Qe(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||y(e.$children,t),t._watcher&&t._watcher.teardown();for(var i=t._watchers.length;i--;)t._watchers[i].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Qe(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(wi),function(t){Re(t.prototype),t.prototype.$nextTick=function(t){return ee(t,this)},t.prototype._render=function(){var t,e=this,i=e.$options,n=i.render,r=i._parentVnode;r&&(e.$scopedSlots=fe(r.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=r;try{Ue=e,t=n.call(e._renderProxy,e.$createElement)}catch(i){Gt(i,e,"render"),t=e._vnode}finally{Ue=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof gt||(t=vt()),t.parent=r,t}}(wi);var Ei=[String,RegExp,Array],Ii={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Ei,exclude:Ei,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Ti(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",(function(e){Ci(t,(function(t){return Si(e,t)}))})),this.$watch("exclude",(function(e){Ci(t,(function(t){return!Si(e,t)}))}))},render:function(){var t=this.$slots.default,e=Ve(t),i=e&&e.componentOptions;if(i){var n=xi(i),r=this.include,o=this.exclude;if(r&&(!n||!Si(r,n))||o&&n&&Si(o,n))return e;var s=this.cache,a=this.keys,l=null==e.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):e.key;s[l]?(e.componentInstance=s[l].componentInstance,y(a,l),a.push(l)):(s[l]=e,a.push(l),this.max&&a.length>parseInt(this.max)&&Ti(s,a[0],a,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e={get:function(){return B}};Object.defineProperty(t,"config",e),t.util={warn:ut,extend:A,mergeOptions:Dt,defineReactive:It},t.set=kt,t.delete=At,t.nextTick=ee,t.observable=function(t){return Et(t),t},t.options=Object.create(null),$.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,A(t.options.components,Ii),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=k(arguments,1);return i.unshift(this),"function"==typeof t.install?t.install.apply(t,i):"function"==typeof t&&t.apply(null,i),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Dt(this.options,t),this}}(t),function(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,n=i.cid,r=t._Ctor||(t._Ctor={});if(r[n])return r[n];var o=t.name||i.options.name,s=function(t){this._init(t)};return(s.prototype=Object.create(i.prototype)).constructor=s,s.cid=e++,s.options=Dt(i.options,t),s.super=i,s.options.props&&function(t){var e=t.options.props;for(var i in e)pi(t.prototype,"_props",i)}(s),s.options.computed&&function(t){var e=t.options.computed;for(var i in e)gi(t.prototype,i,e[i])}(s),s.extend=i.extend,s.mixin=i.mixin,s.use=i.use,$.forEach((function(t){s[t]=i[t]})),o&&(s.options.components[o]=s),s.superOptions=i.options,s.extendOptions=t,s.sealedOptions=A({},s.options),r[n]=s,s}}(t),function(t){$.forEach((function(e){t[e]=function(t,i){return i?("component"===e&&h(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&"function"==typeof i&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}}))}(t)}(wi),Object.defineProperty(wi.prototype,"$isServer",{get:rt}),Object.defineProperty(wi.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(wi,"FunctionalRenderContext",{value:Le}),wi.version="2.6.11";var ki=g("style,class"),Ai=g("input,textarea,option,select,progress"),Pi=function(t,e,i){return"value"===i&&Ai(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},Ri=g("contenteditable,draggable,spellcheck"),Li=g("events,caret,typing,plaintext-only"),Mi=g("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Fi="http://www.w3.org/1999/xlink",Oi=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Di=function(t){return Oi(t)?t.slice(6,t.length):""},ji=function(t){return null==t||!1===t};function $i(t,e){return{staticClass:Ni(t.staticClass,e.staticClass),class:o(t.class)?[t.class,e.class]:e.class}}function Ni(t,e){return t?e?t+" "+e:t:e||""}function Bi(t){return Array.isArray(t)?function(t){for(var e,i="",n=0,r=t.length;n<r;n++)o(e=Bi(t[n]))&&""!==e&&(i&&(i+=" "),i+=e);return i}(t):l(t)?function(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}(t):"string"==typeof t?t:""}var Ui={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Gi=g("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),zi=g("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Vi=function(t){return Gi(t)||zi(t)};function qi(t){return zi(t)?"svg":"math"===t?"math":void 0}var Wi=Object.create(null),Ki=g("text,number,password,search,email,tel,url");function Xi(t){return"string"==typeof t?document.querySelector(t)||document.createElement("div"):t}var Hi=Object.freeze({createElement:function(t,e){var i=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i},createElementNS:function(t,e){return document.createElementNS(Ui[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,i){t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),Yi={create:function(t,e){Zi(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Zi(t,!0),Zi(e))},destroy:function(t){Zi(t,!0)}};function Zi(t,e){var i=t.data.ref;if(o(i)){var n=t.context,r=t.componentInstance||t.elm,s=n.$refs;e?Array.isArray(s[i])?y(s[i],r):s[i]===r&&(s[i]=void 0):t.data.refInFor?Array.isArray(s[i])?s[i].indexOf(r)<0&&s[i].push(r):s[i]=[r]:s[i]=r}}var Ji=new gt("",{},[]),Qi=["create","activate","update","remove","destroy"];function tn(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&o(t.data)===o(e.data)&&function(t,e){if("input"!==t.tag)return!0;var i,n=o(i=t.data)&&o(i=i.attrs)&&i.type,r=o(i=e.data)&&o(i=i.attrs)&&i.type;return n===r||Ki(n)&&Ki(r)}(t,e)||s(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&r(e.asyncFactory.error))}function en(t,e,i){var n,r,s={};for(n=e;n<=i;++n)o(r=t[n].key)&&(s[r]=n);return s}var nn={create:rn,update:rn,destroy:function(t){rn(t,Ji)}};function rn(t,e){(t.data.directives||e.data.directives)&&function(t,e){var i,n,r,o=t===Ji,s=e===Ji,a=sn(t.data.directives,t.context),l=sn(e.data.directives,e.context),u=[],h=[];for(i in l)n=a[i],r=l[i],n?(r.oldValue=n.value,r.oldArg=n.arg,ln(r,"update",e,t),r.def&&r.def.componentUpdated&&h.push(r)):(ln(r,"bind",e,t),r.def&&r.def.inserted&&u.push(r));if(u.length){var c=function(){for(var i=0;i<u.length;i++)ln(u[i],"inserted",e,t)};o?ae(e,"insert",c):c()}if(h.length&&ae(e,"postpatch",(function(){for(var i=0;i<h.length;i++)ln(h[i],"componentUpdated",e,t)})),!o)for(i in a)l[i]||ln(a[i],"unbind",t,t,s)}(t,e)}var on=Object.create(null);function sn(t,e){var i,n,r=Object.create(null);if(!t)return r;for(i=0;i<t.length;i++)(n=t[i]).modifiers||(n.modifiers=on),r[an(n)]=n,n.def=jt(e.$options,"directives",n.name);return r}function an(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function ln(t,e,i,n,r){var o=t.def&&t.def[e];if(o)try{o(i.elm,t,i,n,r)}catch(n){Gt(n,i.context,"directive "+t.name+" "+e+" hook")}}var un=[Yi,nn];function hn(t,e){var i=e.componentOptions;if(!(o(i)&&!1===i.Ctor.options.inheritAttrs||r(t.data.attrs)&&r(e.data.attrs))){var n,s,a=e.elm,l=t.data.attrs||{},u=e.data.attrs||{};for(n in o(u.__ob__)&&(u=e.data.attrs=A({},u)),u)s=u[n],l[n]!==s&&cn(a,n,s);for(n in(Y||J)&&u.value!==l.value&&cn(a,"value",u.value),l)r(u[n])&&(Oi(n)?a.removeAttributeNS(Fi,Di(n)):Ri(n)||a.removeAttribute(n))}}function cn(t,e,i){t.tagName.indexOf("-")>-1?dn(t,e,i):Mi(e)?ji(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):Ri(e)?t.setAttribute(e,function(t,e){return ji(e)||"false"===e?"false":"contenteditable"===t&&Li(e)?e:"true"}(e,i)):Oi(e)?ji(i)?t.removeAttributeNS(Fi,Di(e)):t.setAttributeNS(Fi,e,i):dn(t,e,i)}function dn(t,e,i){if(ji(i))t.removeAttribute(e);else{if(Y&&!Z&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var n=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",n)};t.addEventListener("input",n),t.__ieph=!0}t.setAttribute(e,i)}}var pn={create:hn,update:hn};function fn(t,e){var i=e.elm,n=e.data,s=t.data;if(!(r(n.staticClass)&&r(n.class)&&(r(s)||r(s.staticClass)&&r(s.class)))){var a=function(t){for(var e=t.data,i=t,n=t;o(n.componentInstance);)(n=n.componentInstance._vnode)&&n.data&&(e=$i(n.data,e));for(;o(i=i.parent);)i&&i.data&&(e=$i(e,i.data));return function(t,e){return o(t)||o(e)?Ni(t,Bi(e)):""}(e.staticClass,e.class)}(e),l=i._transitionClasses;o(l)&&(a=Ni(a,Bi(l))),a!==i._prevClass&&(i.setAttribute("class",a),i._prevClass=a)}}var gn,mn,vn,yn,_n,bn,wn={create:fn,update:fn},xn=/[\w).+\-_$\]]/;function Sn(t){var e,i,n,r,o,s=!1,a=!1,l=!1,u=!1,h=0,c=0,d=0,p=0;for(n=0;n<t.length;n++)if(i=e,e=t.charCodeAt(n),s)39===e&&92!==i&&(s=!1);else if(a)34===e&&92!==i&&(a=!1);else if(l)96===e&&92!==i&&(l=!1);else if(u)47===e&&92!==i&&(u=!1);else if(124!==e||124===t.charCodeAt(n+1)||124===t.charCodeAt(n-1)||h||c||d){switch(e){case 34:a=!0;break;case 39:s=!0;break;case 96:l=!0;break;case 40:d++;break;case 41:d--;break;case 91:c++;break;case 93:c--;break;case 123:h++;break;case 125:h--}if(47===e){for(var f=n-1,g=void 0;f>=0&&" "===(g=t.charAt(f));f--);g&&xn.test(g)||(u=!0)}}else void 0===r?(p=n+1,r=t.slice(0,n).trim()):m();function m(){(o||(o=[])).push(t.slice(p,n).trim()),p=n+1}if(void 0===r?r=t.slice(0,n).trim():0!==p&&m(),o)for(n=0;n<o.length;n++)r=Cn(r,o[n]);return r}function Cn(t,e){var i=e.indexOf("(");if(i<0)return'_f("'+e+'")('+t+")";var n=e.slice(0,i),r=e.slice(i+1);return'_f("'+n+'")('+t+(")"!==r?","+r:r)}function Tn(t,e){console.error("[Vue compiler]: "+t)}function En(t,e){return t?t.map((function(t){return t[e]})).filter((function(t){return t})):[]}function In(t,e,i,n,r){(t.props||(t.props=[])).push(Dn({name:e,value:i,dynamic:r},n)),t.plain=!1}function kn(t,e,i,n,r){(r?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Dn({name:e,value:i,dynamic:r},n)),t.plain=!1}function An(t,e,i,n){t.attrsMap[e]=i,t.attrsList.push(Dn({name:e,value:i},n))}function Pn(t,e,i,n,r,o,s,a){(t.directives||(t.directives=[])).push(Dn({name:e,rawName:i,value:n,arg:r,isDynamicArg:o,modifiers:s},a)),t.plain=!1}function Rn(t,e,i){return i?"_p("+e+',"'+t+'")':t+e}function Ln(t,e,i,r,o,s,a,l){var u;(r=r||n).right?l?e="("+e+")==='click'?'contextmenu':("+e+")":"click"===e&&(e="contextmenu",delete r.right):r.middle&&(l?e="("+e+")==='click'?'mouseup':("+e+")":"click"===e&&(e="mouseup")),r.capture&&(delete r.capture,e=Rn("!",e,l)),r.once&&(delete r.once,e=Rn("~",e,l)),r.passive&&(delete r.passive,e=Rn("&",e,l)),r.native?(delete r.native,u=t.nativeEvents||(t.nativeEvents={})):u=t.events||(t.events={});var h=Dn({value:i.trim(),dynamic:l},a);r!==n&&(h.modifiers=r);var c=u[e];Array.isArray(c)?o?c.unshift(h):c.push(h):u[e]=c?o?[h,c]:[c,h]:h,t.plain=!1}function Mn(t,e,i){var n=Fn(t,":"+e)||Fn(t,"v-bind:"+e);if(null!=n)return Sn(n);if(!1!==i){var r=Fn(t,e);if(null!=r)return JSON.stringify(r)}}function Fn(t,e,i){var n;if(null!=(n=t.attrsMap[e]))for(var r=t.attrsList,o=0,s=r.length;o<s;o++)if(r[o].name===e){r.splice(o,1);break}return i&&delete t.attrsMap[e],n}function On(t,e){for(var i=t.attrsList,n=0,r=i.length;n<r;n++){var o=i[n];if(e.test(o.name))return i.splice(n,1),o}}function Dn(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function jn(t,e,i){var n=i||{},r=n.number,o="$$v";n.trim&&(o="(typeof $$v === 'string'? $$v.trim(): $$v)"),r&&(o="_n("+o+")");var s=$n(e,o);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+s+"}"}}function $n(t,e){var i=function(t){if(t=t.trim(),gn=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<gn-1)return(yn=t.lastIndexOf("."))>-1?{exp:t.slice(0,yn),key:'"'+t.slice(yn+1)+'"'}:{exp:t,key:null};for(mn=t,yn=_n=bn=0;!Bn();)Un(vn=Nn())?zn(vn):91===vn&&Gn(vn);return{exp:t.slice(0,_n),key:t.slice(_n+1,bn)}}(t);return null===i.key?t+"="+e:"$set("+i.exp+", "+i.key+", "+e+")"}function Nn(){return mn.charCodeAt(++yn)}function Bn(){return yn>=gn}function Un(t){return 34===t||39===t}function Gn(t){var e=1;for(_n=yn;!Bn();)if(Un(t=Nn()))zn(t);else if(91===t&&e++,93===t&&e--,0===e){bn=yn;break}}function zn(t){for(var e=t;!Bn()&&(t=Nn())!==e;);}var Vn,qn="__r";function Wn(t,e,i){var n=Vn;return function r(){null!==e.apply(null,arguments)&&Hn(t,r,i,n)}}var Kn=Kt&&!(tt&&Number(tt[1])<=53);function Xn(t,e,i,n){if(Kn){var r=si,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=r||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}Vn.addEventListener(t,e,it?{capture:i,passive:n}:i)}function Hn(t,e,i,n){(n||Vn).removeEventListener(t,e._wrapper||e,i)}function Yn(t,e){if(!r(t.data.on)||!r(e.data.on)){var i=e.data.on||{},n=t.data.on||{};Vn=e.elm,function(t){if(o(t.__r)){var e=Y?"change":"input";t[e]=[].concat(t.__r,t[e]||[]),delete t.__r}o(t.__c)&&(t.change=[].concat(t.__c,t.change||[]),delete t.__c)}(i),se(i,n,Xn,Hn,Wn,e.context),Vn=void 0}}var Zn,Jn={create:Yn,update:Yn};function Qn(t,e){if(!r(t.data.domProps)||!r(e.data.domProps)){var i,n,s=e.elm,a=t.data.domProps||{},l=e.data.domProps||{};for(i in o(l.__ob__)&&(l=e.data.domProps=A({},l)),a)i in l||(s[i]="");for(i in l){if(n=l[i],"textContent"===i||"innerHTML"===i){if(e.children&&(e.children.length=0),n===a[i])continue;1===s.childNodes.length&&s.removeChild(s.childNodes[0])}if("value"===i&&"PROGRESS"!==s.tagName){s._value=n;var u=r(n)?"":String(n);tr(s,u)&&(s.value=u)}else if("innerHTML"===i&&zi(s.tagName)&&r(s.innerHTML)){(Zn=Zn||document.createElement("div")).innerHTML="<svg>"+n+"</svg>";for(var h=Zn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;h.firstChild;)s.appendChild(h.firstChild)}else if(n!==a[i])try{s[i]=n}catch(t){}}}}function tr(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var i=!0;try{i=document.activeElement!==t}catch(t){}return i&&t.value!==e}(t,e)||function(t,e){var i=t.value,n=t._vModifiers;if(o(n)){if(n.number)return f(i)!==f(e);if(n.trim)return i.trim()!==e.trim()}return i!==e}(t,e))}var er={create:Qn,update:Qn},ir=w((function(t){var e={},i=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach((function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function nr(t){var e=rr(t.style);return t.staticStyle?A(t.staticStyle,e):e}function rr(t){return Array.isArray(t)?P(t):"string"==typeof t?ir(t):t}var or,sr=/^--/,ar=/\s*!important$/,lr=function(t,e,i){if(sr.test(e))t.style.setProperty(e,i);else if(ar.test(i))t.style.setProperty(E(e),i.replace(ar,""),"important");else{var n=hr(e);if(Array.isArray(i))for(var r=0,o=i.length;r<o;r++)t.style[n]=i[r];else t.style[n]=i}},ur=["Webkit","Moz","ms"],hr=w((function(t){if(or=or||document.createElement("div").style,"filter"!==(t=S(t))&&t in or)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<ur.length;i++){var n=ur[i]+e;if(n in or)return n}}));function cr(t,e){var i=e.data,n=t.data;if(!(r(i.staticStyle)&&r(i.style)&&r(n.staticStyle)&&r(n.style))){var s,a,l=e.elm,u=n.staticStyle,h=n.normalizedStyle||n.style||{},c=u||h,d=rr(e.data.style)||{};e.data.normalizedStyle=o(d.__ob__)?A({},d):d;var p=function(t,e){for(var i,n={},r=t;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=nr(r.data))&&A(n,i);(i=nr(t.data))&&A(n,i);for(var o=t;o=o.parent;)o.data&&(i=nr(o.data))&&A(n,i);return n}(e);for(a in c)r(p[a])&&lr(l,a,"");for(a in p)(s=p[a])!==c[a]&&lr(l,a,null==s?"":s)}}var dr={create:cr,update:cr},pr=/\s+/;function fr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(pr).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function gr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(pr).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");(i=i.trim())?t.setAttribute("class",i):t.removeAttribute("class")}}function mr(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&A(e,vr(t.name||"v")),A(e,t),e}return"string"==typeof t?vr(t):void 0}}var vr=w((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),yr=W&&!Z,_r="transition",br="animation",wr="transition",xr="transitionend",Sr="animation",Cr="animationend";yr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(wr="WebkitTransition",xr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Sr="WebkitAnimation",Cr="webkitAnimationEnd"));var Tr=W?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Er(t){Tr((function(){Tr(t)}))}function Ir(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),fr(t,e))}function kr(t,e){t._transitionClasses&&y(t._transitionClasses,e),gr(t,e)}function Ar(t,e,i){var n=Rr(t,e),r=n.type,o=n.timeout,s=n.propCount;if(!r)return i();var a=r===_r?xr:Cr,l=0,u=function(){t.removeEventListener(a,h),i()},h=function(e){e.target===t&&++l>=s&&u()};setTimeout((function(){l<s&&u()}),o+1),t.addEventListener(a,h)}var Pr=/\b(transform|all)(,|$)/;function Rr(t,e){var i,n=window.getComputedStyle(t),r=(n[wr+"Delay"]||"").split(", "),o=(n[wr+"Duration"]||"").split(", "),s=Lr(r,o),a=(n[Sr+"Delay"]||"").split(", "),l=(n[Sr+"Duration"]||"").split(", "),u=Lr(a,l),h=0,c=0;return e===_r?s>0&&(i=_r,h=s,c=o.length):e===br?u>0&&(i=br,h=u,c=l.length):c=(i=(h=Math.max(s,u))>0?s>u?_r:br:null)?i===_r?o.length:l.length:0,{type:i,timeout:h,propCount:c,hasTransform:i===_r&&Pr.test(n[wr+"Property"])}}function Lr(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map((function(e,i){return Mr(e)+Mr(t[i])})))}function Mr(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Fr(t,e){var i=t.elm;o(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var n=mr(t.data.transition);if(!r(n)&&!o(i._enterCb)&&1===i.nodeType){for(var s=n.css,a=n.type,u=n.enterClass,h=n.enterToClass,c=n.enterActiveClass,d=n.appearClass,p=n.appearToClass,g=n.appearActiveClass,m=n.beforeEnter,v=n.enter,y=n.afterEnter,_=n.enterCancelled,b=n.beforeAppear,w=n.appear,x=n.afterAppear,S=n.appearCancelled,C=n.duration,T=He,E=He.$vnode;E&&E.parent;)T=E.context,E=E.parent;var I=!T._isMounted||!t.isRootInsert;if(!I||w||""===w){var k=I&&d?d:u,A=I&&g?g:c,P=I&&p?p:h,R=I&&b||m,L=I&&"function"==typeof w?w:v,M=I&&x||y,F=I&&S||_,O=f(l(C)?C.enter:C),j=!1!==s&&!Z,$=jr(L),N=i._enterCb=D((function(){j&&(kr(i,P),kr(i,A)),N.cancelled?(j&&kr(i,k),F&&F(i)):M&&M(i),i._enterCb=null}));t.data.show||ae(t,"insert",(function(){var e=i.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),L&&L(i,N)})),R&&R(i),j&&(Ir(i,k),Ir(i,A),Er((function(){kr(i,k),N.cancelled||(Ir(i,P),$||(Dr(O)?setTimeout(N,O):Ar(i,a,N)))}))),t.data.show&&(e&&e(),L&&L(i,N)),j||$||N()}}}function Or(t,e){var i=t.elm;o(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var n=mr(t.data.transition);if(r(n)||1!==i.nodeType)return e();if(!o(i._leaveCb)){var s=n.css,a=n.type,u=n.leaveClass,h=n.leaveToClass,c=n.leaveActiveClass,d=n.beforeLeave,p=n.leave,g=n.afterLeave,m=n.leaveCancelled,v=n.delayLeave,y=n.duration,_=!1!==s&&!Z,b=jr(p),w=f(l(y)?y.leave:y),x=i._leaveCb=D((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),_&&(kr(i,h),kr(i,c)),x.cancelled?(_&&kr(i,u),m&&m(i)):(e(),g&&g(i)),i._leaveCb=null}));v?v(S):S()}function S(){x.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),d&&d(i),_&&(Ir(i,u),Ir(i,c),Er((function(){kr(i,u),x.cancelled||(Ir(i,h),b||(Dr(w)?setTimeout(x,w):Ar(i,a,x)))}))),p&&p(i,x),_||b||x())}}function Dr(t){return"number"==typeof t&&!isNaN(t)}function jr(t){if(r(t))return!1;var e=t.fns;return o(e)?jr(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function $r(t,e){!0!==e.data.show&&Fr(e)}var Nr=function(t){var e,i,n={},l=t.modules,u=t.nodeOps;for(e=0;e<Qi.length;++e)for(n[Qi[e]]=[],i=0;i<l.length;++i)o(l[i][Qi[e]])&&n[Qi[e]].push(l[i][Qi[e]]);function h(t){var e=u.parentNode(t);o(e)&&u.removeChild(e,t)}function c(t,e,i,r,a,l,h){if(o(t.elm)&&o(l)&&(t=l[h]=_t(t)),t.isRootInsert=!a,!function(t,e,i,r){var a=t.data;if(o(a)){var l=o(t.componentInstance)&&a.keepAlive;if(o(a=a.hook)&&o(a=a.init)&&a(t,!1),o(t.componentInstance))return d(t,e),p(i,t.elm,r),s(l)&&function(t,e,i,r){for(var s,a=t;a.componentInstance;)if(o(s=(a=a.componentInstance._vnode).data)&&o(s=s.transition)){for(s=0;s<n.activate.length;++s)n.activate[s](Ji,a);e.push(a);break}p(i,t.elm,r)}(t,e,i,r),!0}}(t,e,i,r)){var c=t.data,g=t.children,m=t.tag;o(m)?(t.elm=t.ns?u.createElementNS(t.ns,m):u.createElement(m,t),y(t),f(t,g,e),o(c)&&v(t,e),p(i,t.elm,r)):s(t.isComment)?(t.elm=u.createComment(t.text),p(i,t.elm,r)):(t.elm=u.createTextNode(t.text),p(i,t.elm,r))}}function d(t,e){o(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,m(t)?(v(t,e),y(t)):(Zi(t),e.push(t))}function p(t,e,i){o(t)&&(o(i)?u.parentNode(i)===t&&u.insertBefore(t,e,i):u.appendChild(t,e))}function f(t,e,i){if(Array.isArray(e))for(var n=0;n<e.length;++n)c(e[n],i,t.elm,null,!0,e,n);else a(t.text)&&u.appendChild(t.elm,u.createTextNode(String(t.text)))}function m(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return o(t.tag)}function v(t,i){for(var r=0;r<n.create.length;++r)n.create[r](Ji,t);o(e=t.data.hook)&&(o(e.create)&&e.create(Ji,t),o(e.insert)&&i.push(t))}function y(t){var e;if(o(e=t.fnScopeId))u.setStyleScope(t.elm,e);else for(var i=t;i;)o(e=i.context)&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),i=i.parent;o(e=He)&&e!==t.context&&e!==t.fnContext&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function _(t,e,i,n,r,o){for(;n<=r;++n)c(i[n],o,t,e,!1,i,n)}function b(t){var e,i,r=t.data;if(o(r))for(o(e=r.hook)&&o(e=e.destroy)&&e(t),e=0;e<n.destroy.length;++e)n.destroy[e](t);if(o(e=t.children))for(i=0;i<t.children.length;++i)b(t.children[i])}function w(t,e,i){for(;e<=i;++e){var n=t[e];o(n)&&(o(n.tag)?(x(n),b(n)):h(n.elm))}}function x(t,e){if(o(e)||o(t.data)){var i,r=n.remove.length+1;for(o(e)?e.listeners+=r:e=function(t,e){function i(){0==--i.listeners&&h(t)}return i.listeners=e,i}(t.elm,r),o(i=t.componentInstance)&&o(i=i._vnode)&&o(i.data)&&x(i,e),i=0;i<n.remove.length;++i)n.remove[i](t,e);o(i=t.data.hook)&&o(i=i.remove)?i(t,e):e()}else h(t.elm)}function S(t,e,i,n){for(var r=i;r<n;r++){var s=e[r];if(o(s)&&tn(t,s))return r}}function C(t,e,i,a,l,h){if(t!==e){o(e.elm)&&o(a)&&(e=a[l]=_t(e));var d=e.elm=t.elm;if(s(t.isAsyncPlaceholder))o(e.asyncFactory.resolved)?I(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(t.isStatic)&&e.key===t.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=t.componentInstance;else{var p,f=e.data;o(f)&&o(p=f.hook)&&o(p=p.prepatch)&&p(t,e);var g=t.children,v=e.children;if(o(f)&&m(e)){for(p=0;p<n.update.length;++p)n.update[p](t,e);o(p=f.hook)&&o(p=p.update)&&p(t,e)}r(e.text)?o(g)&&o(v)?g!==v&&function(t,e,i,n,s){for(var a,l,h,d=0,p=0,f=e.length-1,g=e[0],m=e[f],v=i.length-1,y=i[0],b=i[v],x=!s;d<=f&&p<=v;)r(g)?g=e[++d]:r(m)?m=e[--f]:tn(g,y)?(C(g,y,n,i,p),g=e[++d],y=i[++p]):tn(m,b)?(C(m,b,n,i,v),m=e[--f],b=i[--v]):tn(g,b)?(C(g,b,n,i,v),x&&u.insertBefore(t,g.elm,u.nextSibling(m.elm)),g=e[++d],b=i[--v]):tn(m,y)?(C(m,y,n,i,p),x&&u.insertBefore(t,m.elm,g.elm),m=e[--f],y=i[++p]):(r(a)&&(a=en(e,d,f)),r(l=o(y.key)?a[y.key]:S(y,e,d,f))?c(y,n,t,g.elm,!1,i,p):tn(h=e[l],y)?(C(h,y,n,i,p),e[l]=void 0,x&&u.insertBefore(t,h.elm,g.elm)):c(y,n,t,g.elm,!1,i,p),y=i[++p]);d>f?_(t,r(i[v+1])?null:i[v+1].elm,i,p,v,n):p>v&&w(e,d,f)}(d,g,v,i,h):o(v)?(o(t.text)&&u.setTextContent(d,""),_(d,null,v,0,v.length-1,i)):o(g)?w(g,0,g.length-1):o(t.text)&&u.setTextContent(d,""):t.text!==e.text&&u.setTextContent(d,e.text),o(f)&&o(p=f.hook)&&o(p=p.postpatch)&&p(t,e)}}}function T(t,e,i){if(s(i)&&o(t.parent))t.parent.data.pendingInsert=e;else for(var n=0;n<e.length;++n)e[n].data.hook.insert(e[n])}var E=g("attrs,class,staticClass,staticStyle,key");function I(t,e,i,n){var r,a=e.tag,l=e.data,u=e.children;if(n=n||l&&l.pre,e.elm=t,s(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(l)&&(o(r=l.hook)&&o(r=r.init)&&r(e,!0),o(r=e.componentInstance)))return d(e,i),!0;if(o(a)){if(o(u))if(t.hasChildNodes())if(o(r=l)&&o(r=r.domProps)&&o(r=r.innerHTML)){if(r!==t.innerHTML)return!1}else{for(var h=!0,c=t.firstChild,p=0;p<u.length;p++){if(!c||!I(c,u[p],i,n)){h=!1;break}c=c.nextSibling}if(!h||c)return!1}else f(e,u,i);if(o(l)){var g=!1;for(var m in l)if(!E(m)){g=!0,v(e,i);break}!g&&l.class&&ne(l.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,a){if(!r(e)){var l,h=!1,d=[];if(r(t))h=!0,c(e,d);else{var p=o(t.nodeType);if(!p&&tn(t,e))C(t,e,d,null,null,a);else{if(p){if(1===t.nodeType&&t.hasAttribute(j)&&(t.removeAttribute(j),i=!0),s(i)&&I(t,e,d))return T(e,d,!0),t;l=t,t=new gt(u.tagName(l).toLowerCase(),{},[],void 0,l)}var f=t.elm,g=u.parentNode(f);if(c(e,d,f._leaveCb?null:g,u.nextSibling(f)),o(e.parent))for(var v=e.parent,y=m(e);v;){for(var _=0;_<n.destroy.length;++_)n.destroy[_](v);if(v.elm=e.elm,y){for(var x=0;x<n.create.length;++x)n.create[x](Ji,v);var S=v.data.hook.insert;if(S.merged)for(var E=1;E<S.fns.length;E++)S.fns[E]()}else Zi(v);v=v.parent}o(g)?w([t],0,0):o(t.tag)&&b(t)}}return T(e,d,h),e.elm}o(t)&&b(t)}}({nodeOps:Hi,modules:[pn,wn,Jn,er,dr,W?{create:$r,activate:$r,remove:function(t,e){!0!==t.data.show?Or(t,e):e()}}:{}].concat(un)});Z&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&Kr(t,"input")}));var Br={inserted:function(t,e,i,n){"select"===i.tag?(n.elm&&!n.elm._vOptions?ae(i,"postpatch",(function(){Br.componentUpdated(t,e,i)})):Ur(t,e,i.context),t._vOptions=[].map.call(t.options,Vr)):("textarea"===i.tag||Ki(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",qr),t.addEventListener("compositionend",Wr),t.addEventListener("change",Wr),Z&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){Ur(t,e,i.context);var n=t._vOptions,r=t._vOptions=[].map.call(t.options,Vr);r.some((function(t,e){return!F(t,n[e])}))&&(t.multiple?e.value.some((function(t){return zr(t,r)})):e.value!==e.oldValue&&zr(e.value,r))&&Kr(t,"change")}}};function Ur(t,e,i){Gr(t,e,i),(Y||J)&&setTimeout((function(){Gr(t,e,i)}),0)}function Gr(t,e,i){var n=e.value,r=t.multiple;if(!r||Array.isArray(n)){for(var o,s,a=0,l=t.options.length;a<l;a++)if(s=t.options[a],r)o=O(n,Vr(s))>-1,s.selected!==o&&(s.selected=o);else if(F(Vr(s),n))return void(t.selectedIndex!==a&&(t.selectedIndex=a));r||(t.selectedIndex=-1)}}function zr(t,e){return e.every((function(e){return!F(e,t)}))}function Vr(t){return"_value"in t?t._value:t.value}function qr(t){t.target.composing=!0}function Wr(t){t.target.composing&&(t.target.composing=!1,Kr(t.target,"input"))}function Kr(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function Xr(t){return!t.componentInstance||t.data&&t.data.transition?t:Xr(t.componentInstance._vnode)}var Hr={model:Br,show:{bind:function(t,e,i){var n=e.value,r=(i=Xr(i)).data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&r?(i.data.show=!0,Fr(i,(function(){t.style.display=o}))):t.style.display=n?o:"none"},update:function(t,e,i){var n=e.value;!n!=!e.oldValue&&((i=Xr(i)).data&&i.data.transition?(i.data.show=!0,n?Fr(i,(function(){t.style.display=t.__vOriginalDisplay})):Or(i,(function(){t.style.display="none"}))):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,i,n,r){r||(t.style.display=t.__vOriginalDisplay)}}},Yr={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Zr(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Zr(Ve(e.children)):t}function Jr(t){var e={},i=t.$options;for(var n in i.propsData)e[n]=t[n];var r=i._parentListeners;for(var o in r)e[S(o)]=r[o];return e}function Qr(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var to=function(t){return t.tag||ze(t)},eo=function(t){return"show"===t.name},io={name:"transition",props:Yr,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(to)).length){var n=this.mode,r=i[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return r;var o=Zr(r);if(!o)return r;if(this._leaving)return Qr(t,r);var s="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?s+"comment":s+o.tag:a(o.key)?0===String(o.key).indexOf(s)?o.key:s+o.key:o.key;var l=(o.data||(o.data={})).transition=Jr(this),u=this._vnode,h=Zr(u);if(o.data.directives&&o.data.directives.some(eo)&&(o.data.show=!0),h&&h.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(o,h)&&!ze(h)&&(!h.componentInstance||!h.componentInstance._vnode.isComment)){var c=h.data.transition=A({},l);if("out-in"===n)return this._leaving=!0,ae(c,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Qr(t,r);if("in-out"===n){if(ze(o))return u;var d,p=function(){d()};ae(l,"afterEnter",p),ae(l,"enterCancelled",p),ae(c,"delayLeave",(function(t){d=t}))}}return r}}},no=A({tag:String,moveClass:String},Yr);function ro(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function oo(t){t.data.newPos=t.elm.getBoundingClientRect()}function so(t){var e=t.data.pos,i=t.data.newPos,n=e.left-i.left,r=e.top-i.top;if(n||r){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+n+"px,"+r+"px)",o.transitionDuration="0s"}}delete no.mode;var ao={Transition:io,TransitionGroup:{props:no,beforeMount:function(){var t=this,e=this._update;this._update=function(i,n){var r=Ye(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),e.call(t,i,n)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],s=Jr(this),a=0;a<r.length;a++){var l=r[a];l.tag&&null!=l.key&&0!==String(l.key).indexOf("__vlist")&&(o.push(l),i[l.key]=l,(l.data||(l.data={})).transition=s)}if(n){for(var u=[],h=[],c=0;c<n.length;c++){var d=n[c];d.data.transition=s,d.data.pos=d.elm.getBoundingClientRect(),i[d.key]?u.push(d):h.push(d)}this.kept=t(e,null,u),this.removed=h}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(ro),t.forEach(oo),t.forEach(so),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var i=t.elm,n=i.style;Ir(i,e),n.transform=n.WebkitTransform=n.transitionDuration="",i.addEventListener(xr,i._moveCb=function t(n){n&&n.target!==i||n&&!/transform$/.test(n.propertyName)||(i.removeEventListener(xr,t),i._moveCb=null,kr(i,e))})}})))},methods:{hasMove:function(t,e){if(!yr)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){gr(i,t)})),fr(i,e),i.style.display="none",this.$el.appendChild(i);var n=Rr(i);return this.$el.removeChild(i),this._hasMove=n.hasTransform}}}};wi.config.mustUseProp=Pi,wi.config.isReservedTag=Vi,wi.config.isReservedAttr=ki,wi.config.getTagNamespace=qi,wi.config.isUnknownElement=function(t){if(!W)return!0;if(Vi(t))return!1;if(t=t.toLowerCase(),null!=Wi[t])return Wi[t];var e=document.createElement(t);return t.indexOf("-")>-1?Wi[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Wi[t]=/HTMLUnknownElement/.test(e.toString())},A(wi.options.directives,Hr),A(wi.options.components,ao),wi.prototype.__patch__=W?Nr:R,wi.prototype.$mount=function(t,e){return function(t,e,i){var n;return t.$el=e,t.$options.render||(t.$options.render=vt),Qe(t,"beforeMount"),n=function(){t._update(t._render(),i)},new ci(t,n,R,{before:function(){t._isMounted&&!t._isDestroyed&&Qe(t,"beforeUpdate")}},!0),i=!1,null==t.$vnode&&(t._isMounted=!0,Qe(t,"mounted")),t}(this,t=t&&W?Xi(t):void 0,e)},W&&setTimeout((function(){B.devtools&&ot&&ot.emit("init",wi)}),0);var lo,uo=/\{\{((?:.|\r?\n)+?)\}\}/g,ho=/[-.*+?^${}()|[\]\/\\]/g,co=w((function(t){var e=t[0].replace(ho,"\\$&"),i=t[1].replace(ho,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+i,"g")})),po={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var i=Fn(t,"class");i&&(t.staticClass=JSON.stringify(i));var n=Mn(t,"class",!1);n&&(t.classBinding=n)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}},fo={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var i=Fn(t,"style");i&&(t.staticStyle=JSON.stringify(ir(i)));var n=Mn(t,"style",!1);n&&(t.styleBinding=n)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},go=g("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),mo=g("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),vo=g("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),yo=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,_o=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,bo="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+U.source+"]*",wo="((?:"+bo+"\\:)?"+bo+")",xo=new RegExp("^<"+wo),So=/^\s*(\/?)>/,Co=new RegExp("^<\\/"+wo+"[^>]*>"),To=/^<!DOCTYPE [^>]+>/i,Eo=/^<!\--/,Io=/^<!\[/,ko=g("script,style,textarea",!0),Ao={},Po={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},Ro=/&(?:lt|gt|quot|amp|#39);/g,Lo=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,Mo=g("pre,textarea",!0),Fo=function(t,e){return t&&Mo(t)&&"\n"===e[0]};function Oo(t,e){var i=e?Lo:Ro;return t.replace(i,(function(t){return Po[t]}))}var Do,jo,$o,No,Bo,Uo,Go,zo,Vo=/^@|^v-on:/,qo=/^v-|^@|^:|^#/,Wo=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Ko=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Xo=/^\(|\)$/g,Ho=/^\[.*\]$/,Yo=/:(.*)$/,Zo=/^:|^\.|^v-bind:/,Jo=/\.[^.\]]+(?=[^\]]*$)/g,Qo=/^v-slot(:|$)|^#/,ts=/[\r\n]/,es=/\s+/g,is=w((function(t){return(lo=lo||document.createElement("div")).innerHTML=t,lo.textContent})),ns="_empty_";function rs(t,e,i){return{type:1,tag:t,attrsList:e,attrsMap:hs(e),rawAttrsMap:{},parent:i,children:[]}}function os(t,e){var i,n;(n=Mn(i=t,"key"))&&(i.key=n),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=Mn(t,"ref");e&&(t.ref=e,t.refInFor=function(t){for(var e=t;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=Fn(t,"scope"),t.slotScope=e||Fn(t,"slot-scope")):(e=Fn(t,"slot-scope"))&&(t.slotScope=e);var i=Mn(t,"slot");if(i&&(t.slotTarget='""'===i?'"default"':i,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||kn(t,"slot",i,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot"))),"template"===t.tag){var n=On(t,Qo);if(n){var r=ls(n),o=r.name,s=r.dynamic;t.slotTarget=o,t.slotTargetDynamic=s,t.slotScope=n.value||ns}}else{var a=On(t,Qo);if(a){var l=t.scopedSlots||(t.scopedSlots={}),u=ls(a),h=u.name,c=u.dynamic,d=l[h]=rs("template",[],t);d.slotTarget=h,d.slotTargetDynamic=c,d.children=t.children.filter((function(t){if(!t.slotScope)return t.parent=d,!0})),d.slotScope=a.value||ns,t.children=[],t.plain=!1}}}(t),function(t){"slot"===t.tag&&(t.slotName=Mn(t,"name"))}(t),function(t){var e;(e=Mn(t,"is"))&&(t.component=e),null!=Fn(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var r=0;r<$o.length;r++)t=$o[r](t,e)||t;return function(t){var e,i,n,r,o,s,a,l,u=t.attrsList;for(e=0,i=u.length;e<i;e++)if(n=r=u[e].name,o=u[e].value,qo.test(n))if(t.hasBindings=!0,(s=us(n.replace(qo,"")))&&(n=n.replace(Jo,"")),Zo.test(n))n=n.replace(Zo,""),o=Sn(o),(l=Ho.test(n))&&(n=n.slice(1,-1)),s&&(s.prop&&!l&&"innerHtml"===(n=S(n))&&(n="innerHTML"),s.camel&&!l&&(n=S(n)),s.sync&&(a=$n(o,"$event"),l?Ln(t,'"update:"+('+n+")",a,null,!1,0,u[e],!0):(Ln(t,"update:"+S(n),a,null,!1,0,u[e]),E(n)!==S(n)&&Ln(t,"update:"+E(n),a,null,!1,0,u[e])))),s&&s.prop||!t.component&&Go(t.tag,t.attrsMap.type,n)?In(t,n,o,u[e],l):kn(t,n,o,u[e],l);else if(Vo.test(n))n=n.replace(Vo,""),(l=Ho.test(n))&&(n=n.slice(1,-1)),Ln(t,n,o,s,!1,0,u[e],l);else{var h=(n=n.replace(qo,"")).match(Yo),c=h&&h[1];l=!1,c&&(n=n.slice(0,-(c.length+1)),Ho.test(c)&&(c=c.slice(1,-1),l=!0)),Pn(t,n,r,o,c,l,s,u[e])}else kn(t,n,JSON.stringify(o),u[e]),!t.component&&"muted"===n&&Go(t.tag,t.attrsMap.type,n)&&In(t,n,"true",u[e])}(t),t}function ss(t){var e;if(e=Fn(t,"v-for")){var i=function(t){var e=t.match(Wo);if(e){var i={};i.for=e[2].trim();var n=e[1].trim().replace(Xo,""),r=n.match(Ko);return r?(i.alias=n.replace(Ko,"").trim(),i.iterator1=r[1].trim(),r[2]&&(i.iterator2=r[2].trim())):i.alias=n,i}}(e);i&&A(t,i)}}function as(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function ls(t){var e=t.name.replace(Qo,"");return e||"#"!==t.name[0]&&(e="default"),Ho.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function us(t){var e=t.match(Jo);if(e){var i={};return e.forEach((function(t){i[t.slice(1)]=!0})),i}}function hs(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i].name]=t[i].value;return e}var cs=/^xmlns:NS\d+/,ds=/^NS\d+:/;function ps(t){return rs(t.tag,t.attrsList.slice(),t.parent)}var fs,gs,ms=[po,fo,{preTransformNode:function(t,e){if("input"===t.tag){var i,n=t.attrsMap;if(!n["v-model"])return;if((n[":type"]||n["v-bind:type"])&&(i=Mn(t,"type")),n.type||i||!n["v-bind"]||(i="("+n["v-bind"]+").type"),i){var r=Fn(t,"v-if",!0),o=r?"&&("+r+")":"",s=null!=Fn(t,"v-else",!0),a=Fn(t,"v-else-if",!0),l=ps(t);ss(l),An(l,"type","checkbox"),os(l,e),l.processed=!0,l.if="("+i+")==='checkbox'"+o,as(l,{exp:l.if,block:l});var u=ps(t);Fn(u,"v-for",!0),An(u,"type","radio"),os(u,e),as(l,{exp:"("+i+")==='radio'"+o,block:u});var h=ps(t);return Fn(h,"v-for",!0),An(h,":type",i),os(h,e),as(l,{exp:r,block:h}),s?l.else=!0:a&&(l.elseif=a),l}}}}],vs={expectHTML:!0,modules:ms,directives:{model:function(t,e,i){var n=e.value,r=e.modifiers,o=t.tag,s=t.attrsMap.type;if(t.component)return jn(t,n,r),!1;if("select"===o)!function(t,e,i){var n='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i&&i.number?"_n(val)":"val")+"});";Ln(t,"change",n=n+" "+$n(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),null,!0)}(t,n,r);else if("input"===o&&"checkbox"===s)!function(t,e,i){var n=i&&i.number,r=Mn(t,"value")||"null",o=Mn(t,"true-value")||"true",s=Mn(t,"false-value")||"false";In(t,"checked","Array.isArray("+e+")?_i("+e+","+r+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),Ln(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+s+");if(Array.isArray($$a)){var $$v="+(n?"_n("+r+")":r)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+$n(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+$n(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+$n(e,"$$c")+"}",null,!0)}(t,n,r);else if("input"===o&&"radio"===s)!function(t,e,i){var n=i&&i.number,r=Mn(t,"value")||"null";In(t,"checked","_q("+e+","+(r=n?"_n("+r+")":r)+")"),Ln(t,"change",$n(e,r),null,!0)}(t,n,r);else if("input"===o||"textarea"===o)!function(t,e,i){var n=t.attrsMap.type,r=i||{},o=r.lazy,s=r.number,a=r.trim,l=!o&&"range"!==n,u=o?"change":"range"===n?qn:"input",h="$event.target.value";a&&(h="$event.target.value.trim()"),s&&(h="_n("+h+")");var c=$n(e,h);l&&(c="if($event.target.composing)return;"+c),In(t,"value","("+e+")"),Ln(t,u,c,null,!0),(a||s)&&Ln(t,"blur","$forceUpdate()")}(t,n,r);else if(!B.isReservedTag(o))return jn(t,n,r),!1;return!0},text:function(t,e){e.value&&In(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&In(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:go,mustUseProp:Pi,canBeLeftOpenTag:mo,isReservedTag:Vi,getTagNamespace:qi,staticKeys:function(t){return t.reduce((function(t,e){return t.concat(e.staticKeys||[])}),[]).join(",")}(ms)},ys=w((function(t){return g("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))}));var _s=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,bs=/\([^)]*?\);*$/,ws=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,xs={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Ss={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Cs=function(t){return"if("+t+")return null;"},Ts={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Cs("$event.target !== $event.currentTarget"),ctrl:Cs("!$event.ctrlKey"),shift:Cs("!$event.shiftKey"),alt:Cs("!$event.altKey"),meta:Cs("!$event.metaKey"),left:Cs("'button' in $event && $event.button !== 0"),middle:Cs("'button' in $event && $event.button !== 1"),right:Cs("'button' in $event && $event.button !== 2")};function Es(t,e){var i=e?"nativeOn:":"on:",n="",r="";for(var o in t){var s=Is(t[o]);t[o]&&t[o].dynamic?r+=o+","+s+",":n+='"'+o+'":'+s+","}return n="{"+n.slice(0,-1)+"}",r?i+"_d("+n+",["+r.slice(0,-1)+"])":i+n}function Is(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map((function(t){return Is(t)})).join(",")+"]";var e=ws.test(t.value),i=_s.test(t.value),n=ws.test(t.value.replace(bs,""));if(t.modifiers){var r="",o="",s=[];for(var a in t.modifiers)if(Ts[a])o+=Ts[a],xs[a]&&s.push(a);else if("exact"===a){var l=t.modifiers;o+=Cs(["ctrl","shift","alt","meta"].filter((function(t){return!l[t]})).map((function(t){return"$event."+t+"Key"})).join("||"))}else s.push(a);return s.length&&(r+=function(t){return"if(!$event.type.indexOf('key')&&"+t.map(ks).join("&&")+")return null;"}(s)),o&&(r+=o),"function($event){"+r+(e?"return "+t.value+"($event)":i?"return ("+t.value+")($event)":n?"return "+t.value:t.value)+"}"}return e||i?t.value:"function($event){"+(n?"return "+t.value:t.value)+"}"}function ks(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var i=xs[t],n=Ss[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(i)+",$event.key,"+JSON.stringify(n)+")"}var As={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(i){return"_b("+i+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:R},Ps=function(t){this.options=t,this.warn=t.warn||Tn,this.transforms=En(t.modules,"transformCode"),this.dataGenFns=En(t.modules,"genData"),this.directives=A(A({},As),t.directives);var e=t.isReservedTag||L;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Rs(t,e){var i=new Ps(e);return{render:"with(this){return "+(t?Ls(t,i):'_c("div")')+"}",staticRenderFns:i.staticRenderFns}}function Ls(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return Ms(t,e);if(t.once&&!t.onceProcessed)return Fs(t,e);if(t.for&&!t.forProcessed)return Ds(t,e);if(t.if&&!t.ifProcessed)return Os(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var i=t.slotName||'"default"',n=Bs(t,e),r="_t("+i+(n?","+n:""),o=t.attrs||t.dynamicAttrs?zs((t.attrs||[]).concat(t.dynamicAttrs||[]).map((function(t){return{name:S(t.name),value:t.value,dynamic:t.dynamic}}))):null,s=t.attrsMap["v-bind"];return!o&&!s||n||(r+=",null"),o&&(r+=","+o),s&&(r+=(o?"":",null")+","+s),r+")"}(t,e);var i;if(t.component)i=function(t,e,i){var n=e.inlineTemplate?null:Bs(e,i,!0);return"_c("+t+","+js(e,i)+(n?","+n:"")+")"}(t.component,t,e);else{var n;(!t.plain||t.pre&&e.maybeComponent(t))&&(n=js(t,e));var r=t.inlineTemplate?null:Bs(t,e,!0);i="_c('"+t.tag+"'"+(n?","+n:"")+(r?","+r:"")+")"}for(var o=0;o<e.transforms.length;o++)i=e.transforms[o](t,i);return i}return Bs(t,e)||"void 0"}function Ms(t,e){t.staticProcessed=!0;var i=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Ls(t,e)+"}"),e.pre=i,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function Fs(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return Os(t,e);if(t.staticInFor){for(var i="",n=t.parent;n;){if(n.for){i=n.key;break}n=n.parent}return i?"_o("+Ls(t,e)+","+e.onceId+++","+i+")":Ls(t,e)}return Ms(t,e)}function Os(t,e,i,n){return t.ifProcessed=!0,function t(e,i,n,r){if(!e.length)return r||"_e()";var o=e.shift();return o.exp?"("+o.exp+")?"+s(o.block)+":"+t(e,i,n,r):""+s(o.block);function s(t){return n?n(t,i):t.once?Fs(t,i):Ls(t,i)}}(t.ifConditions.slice(),e,i,n)}function Ds(t,e,i,n){var r=t.for,o=t.alias,s=t.iterator1?","+t.iterator1:"",a=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(n||"_l")+"(("+r+"),function("+o+s+a+"){return "+(i||Ls)(t,e)+"})"}function js(t,e){var i="{",n=function(t,e){var i=t.directives;if(i){var n,r,o,s,a="directives:[",l=!1;for(n=0,r=i.length;n<r;n++){o=i[n],s=!0;var u=e.directives[o.name];u&&(s=!!u(t,o,e.warn)),s&&(l=!0,a+='{name:"'+o.name+'",rawName:"'+o.rawName+'"'+(o.value?",value:("+o.value+"),expression:"+JSON.stringify(o.value):"")+(o.arg?",arg:"+(o.isDynamicArg?o.arg:'"'+o.arg+'"'):"")+(o.modifiers?",modifiers:"+JSON.stringify(o.modifiers):"")+"},")}return l?a.slice(0,-1)+"]":void 0}}(t,e);n&&(i+=n+","),t.key&&(i+="key:"+t.key+","),t.ref&&(i+="ref:"+t.ref+","),t.refInFor&&(i+="refInFor:true,"),t.pre&&(i+="pre:true,"),t.component&&(i+='tag:"'+t.tag+'",');for(var r=0;r<e.dataGenFns.length;r++)i+=e.dataGenFns[r](t);if(t.attrs&&(i+="attrs:"+zs(t.attrs)+","),t.props&&(i+="domProps:"+zs(t.props)+","),t.events&&(i+=Es(t.events,!1)+","),t.nativeEvents&&(i+=Es(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(i+="slot:"+t.slotTarget+","),t.scopedSlots&&(i+=function(t,e,i){var n=t.for||Object.keys(e).some((function(t){var i=e[t];return i.slotTargetDynamic||i.if||i.for||$s(i)})),r=!!t.if;if(!n)for(var o=t.parent;o;){if(o.slotScope&&o.slotScope!==ns||o.for){n=!0;break}o.if&&(r=!0),o=o.parent}var s=Object.keys(e).map((function(t){return Ns(e[t],i)})).join(",");return"scopedSlots:_u(["+s+"]"+(n?",null,true":"")+(!n&&r?",null,false,"+function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return e>>>0}(s):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(i+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var o=function(t,e){var i=t.children[0];if(i&&1===i.type){var n=Rs(i,e.options);return"inlineTemplate:{render:function(){"+n.render+"},staticRenderFns:["+n.staticRenderFns.map((function(t){return"function(){"+t+"}"})).join(",")+"]}"}}(t,e);o&&(i+=o+",")}return i=i.replace(/,$/,"")+"}",t.dynamicAttrs&&(i="_b("+i+',"'+t.tag+'",'+zs(t.dynamicAttrs)+")"),t.wrapData&&(i=t.wrapData(i)),t.wrapListeners&&(i=t.wrapListeners(i)),i}function $s(t){return 1===t.type&&("slot"===t.tag||t.children.some($s))}function Ns(t,e){var i=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!i)return Os(t,e,Ns,"null");if(t.for&&!t.forProcessed)return Ds(t,e,Ns);var n=t.slotScope===ns?"":String(t.slotScope),r="function("+n+"){return "+("template"===t.tag?t.if&&i?"("+t.if+")?"+(Bs(t,e)||"undefined")+":undefined":Bs(t,e)||"undefined":Ls(t,e))+"}",o=n?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+r+o+"}"}function Bs(t,e,i,n,r){var o=t.children;if(o.length){var s=o[0];if(1===o.length&&s.for&&"template"!==s.tag&&"slot"!==s.tag){var a=i?e.maybeComponent(s)?",1":",0":"";return""+(n||Ls)(s,e)+a}var l=i?function(t,e){for(var i=0,n=0;n<t.length;n++){var r=t[n];if(1===r.type){if(Us(r)||r.ifConditions&&r.ifConditions.some((function(t){return Us(t.block)}))){i=2;break}(e(r)||r.ifConditions&&r.ifConditions.some((function(t){return e(t.block)})))&&(i=1)}}return i}(o,e.maybeComponent):0,u=r||Gs;return"["+o.map((function(t){return u(t,e)})).join(",")+"]"+(l?","+l:"")}}function Us(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function Gs(t,e){return 1===t.type?Ls(t,e):3===t.type&&t.isComment?(n=t,"_e("+JSON.stringify(n.text)+")"):"_v("+(2===(i=t).type?i.expression:Vs(JSON.stringify(i.text)))+")";var i,n}function zs(t){for(var e="",i="",n=0;n<t.length;n++){var r=t[n],o=Vs(r.value);r.dynamic?i+=r.name+","+o+",":e+='"'+r.name+'":'+o+","}return e="{"+e.slice(0,-1)+"}",i?"_d("+e+",["+i.slice(0,-1)+"])":e}function Vs(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function qs(t,e){try{return new Function(t)}catch(i){return e.push({err:i,code:t}),R}}function Ws(t){var e=Object.create(null);return function(i,n,r){(n=A({},n)).warn,delete n.warn;var o=n.delimiters?String(n.delimiters)+i:i;if(e[o])return e[o];var s=t(i,n),a={},l=[];return a.render=qs(s.render,l),a.staticRenderFns=s.staticRenderFns.map((function(t){return qs(t,l)})),e[o]=a}}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b");var Ks,Xs,Hs=(Ks=function(t,e){var i=function(t,e){Do=e.warn||Tn,Uo=e.isPreTag||L,Go=e.mustUseProp||L,zo=e.getTagNamespace||L,e.isReservedTag,$o=En(e.modules,"transformNode"),No=En(e.modules,"preTransformNode"),Bo=En(e.modules,"postTransformNode"),jo=e.delimiters;var i,n,r=[],o=!1!==e.preserveWhitespace,s=e.whitespace,a=!1,l=!1;function u(t){if(h(t),a||t.processed||(t=os(t,e)),r.length||t===i||i.if&&(t.elseif||t.else)&&as(i,{exp:t.elseif,block:t}),n&&!t.forbidden)if(t.elseif||t.else)s=t,(u=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(n.children))&&u.if&&as(u,{exp:s.elseif,block:s});else{if(t.slotScope){var o=t.slotTarget||'"default"';(n.scopedSlots||(n.scopedSlots={}))[o]=t}n.children.push(t),t.parent=n}var s,u;t.children=t.children.filter((function(t){return!t.slotScope})),h(t),t.pre&&(a=!1),Uo(t.tag)&&(l=!1);for(var c=0;c<Bo.length;c++)Bo[c](t,e)}function h(t){if(!l)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var i,n,r=[],o=e.expectHTML,s=e.isUnaryTag||L,a=e.canBeLeftOpenTag||L,l=0;t;){if(i=t,n&&ko(n)){var u=0,h=n.toLowerCase(),c=Ao[h]||(Ao[h]=new RegExp("([\\s\\S]*?)(</"+h+"[^>]*>)","i")),d=t.replace(c,(function(t,i,n){return u=n.length,ko(h)||"noscript"===h||(i=i.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),Fo(h,i)&&(i=i.slice(1)),e.chars&&e.chars(i),""}));l+=t.length-d.length,t=d,E(h,l-u,l)}else{var p=t.indexOf("<");if(0===p){if(Eo.test(t)){var f=t.indexOf("--\x3e");if(f>=0){e.shouldKeepComment&&e.comment(t.substring(4,f),l,l+f+3),S(f+3);continue}}if(Io.test(t)){var g=t.indexOf("]>");if(g>=0){S(g+2);continue}}var m=t.match(To);if(m){S(m[0].length);continue}var v=t.match(Co);if(v){var y=l;S(v[0].length),E(v[1],y,l);continue}var _=C();if(_){T(_),Fo(_.tagName,t)&&S(1);continue}}var b=void 0,w=void 0,x=void 0;if(p>=0){for(w=t.slice(p);!(Co.test(w)||xo.test(w)||Eo.test(w)||Io.test(w)||(x=w.indexOf("<",1))<0);)p+=x,w=t.slice(p);b=t.substring(0,p)}p<0&&(b=t),b&&S(b.length),e.chars&&b&&e.chars(b,l-b.length,l)}if(t===i){e.chars&&e.chars(t);break}}function S(e){l+=e,t=t.substring(e)}function C(){var e=t.match(xo);if(e){var i,n,r={tagName:e[1],attrs:[],start:l};for(S(e[0].length);!(i=t.match(So))&&(n=t.match(_o)||t.match(yo));)n.start=l,S(n[0].length),n.end=l,r.attrs.push(n);if(i)return r.unarySlash=i[1],S(i[0].length),r.end=l,r}}function T(t){var i=t.tagName,l=t.unarySlash;o&&("p"===n&&vo(i)&&E(n),a(i)&&n===i&&E(i));for(var u=s(i)||!!l,h=t.attrs.length,c=new Array(h),d=0;d<h;d++){var p=t.attrs[d],f=p[3]||p[4]||p[5]||"",g="a"===i&&"href"===p[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;c[d]={name:p[1],value:Oo(f,g)}}u||(r.push({tag:i,lowerCasedTag:i.toLowerCase(),attrs:c,start:t.start,end:t.end}),n=i),e.start&&e.start(i,c,u,t.start,t.end)}function E(t,i,o){var s,a;if(null==i&&(i=l),null==o&&(o=l),t)for(a=t.toLowerCase(),s=r.length-1;s>=0&&r[s].lowerCasedTag!==a;s--);else s=0;if(s>=0){for(var u=r.length-1;u>=s;u--)e.end&&e.end(r[u].tag,i,o);r.length=s,n=s&&r[s-1].tag}else"br"===a?e.start&&e.start(t,[],!0,i,o):"p"===a&&(e.start&&e.start(t,[],!1,i,o),e.end&&e.end(t,i,o))}E()}(t,{warn:Do,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,o,s,h,c){var d=n&&n.ns||zo(t);Y&&"svg"===d&&(o=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];cs.test(n.name)||(n.name=n.name.replace(ds,""),e.push(n))}return e}(o));var p,f=rs(t,o,n);d&&(f.ns=d),"style"!==(p=f).tag&&("script"!==p.tag||p.attrsMap.type&&"text/javascript"!==p.attrsMap.type)||rt()||(f.forbidden=!0);for(var g=0;g<No.length;g++)f=No[g](f,e)||f;a||(function(t){null!=Fn(t,"v-pre")&&(t.pre=!0)}(f),f.pre&&(a=!0)),Uo(f.tag)&&(l=!0),a?function(t){var e=t.attrsList,i=e.length;if(i)for(var n=t.attrs=new Array(i),r=0;r<i;r++)n[r]={name:e[r].name,value:JSON.stringify(e[r].value)},null!=e[r].start&&(n[r].start=e[r].start,n[r].end=e[r].end);else t.pre||(t.plain=!0)}(f):f.processed||(ss(f),function(t){var e=Fn(t,"v-if");if(e)t.if=e,as(t,{exp:e,block:t});else{null!=Fn(t,"v-else")&&(t.else=!0);var i=Fn(t,"v-else-if");i&&(t.elseif=i)}}(f),function(t){null!=Fn(t,"v-once")&&(t.once=!0)}(f)),i||(i=f),s?u(f):(n=f,r.push(f))},end:function(t,e,i){var o=r[r.length-1];r.length-=1,n=r[r.length-1],u(o)},chars:function(t,e,i){if(n&&(!Y||"textarea"!==n.tag||n.attrsMap.placeholder!==t)){var r,u,h,c=n.children;(t=l||t.trim()?"script"===(r=n).tag||"style"===r.tag?t:is(t):c.length?s?"condense"===s&&ts.test(t)?"":" ":o?" ":"":"")&&(l||"condense"!==s||(t=t.replace(es," ")),!a&&" "!==t&&(u=function(t,e){var i=e?co(e):uo;if(i.test(t)){for(var n,r,o,s=[],a=[],l=i.lastIndex=0;n=i.exec(t);){(r=n.index)>l&&(a.push(o=t.slice(l,r)),s.push(JSON.stringify(o)));var u=Sn(n[1].trim());s.push("_s("+u+")"),a.push({"@binding":u}),l=r+n[0].length}return l<t.length&&(a.push(o=t.slice(l)),s.push(JSON.stringify(o))),{expression:s.join("+"),tokens:a}}}(t,jo))?h={type:2,expression:u.expression,tokens:u.tokens,text:t}:" "===t&&c.length&&" "===c[c.length-1].text||(h={type:3,text:t}),h&&c.push(h))}},comment:function(t,e,i){if(n){var r={type:3,text:t,isComment:!0};n.children.push(r)}}}),i}(t.trim(),e);!1!==e.optimize&&function(t,e){t&&(fs=ys(e.staticKeys||""),gs=e.isReservedTag||L,function t(e){if(e.static=function(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||m(t.tag)||!gs(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(fs))))}(e),1===e.type){if(!gs(e.tag)&&"slot"!==e.tag&&null==e.attrsMap["inline-template"])return;for(var i=0,n=e.children.length;i<n;i++){var r=e.children[i];t(r),r.static||(e.static=!1)}if(e.ifConditions)for(var o=1,s=e.ifConditions.length;o<s;o++){var a=e.ifConditions[o].block;t(a),a.static||(e.static=!1)}}}(t),function t(e,i){if(1===e.type){if((e.static||e.once)&&(e.staticInFor=i),e.static&&e.children.length&&(1!==e.children.length||3!==e.children[0].type))return void(e.staticRoot=!0);if(e.staticRoot=!1,e.children)for(var n=0,r=e.children.length;n<r;n++)t(e.children[n],i||!!e.for);if(e.ifConditions)for(var o=1,s=e.ifConditions.length;o<s;o++)t(e.ifConditions[o].block,i)}}(t,!1))}(i,e);var n=Rs(i,e);return{ast:i,render:n.render,staticRenderFns:n.staticRenderFns}},function(t){function e(e,i){var n=Object.create(t),r=[],o=[];if(i)for(var s in i.modules&&(n.modules=(t.modules||[]).concat(i.modules)),i.directives&&(n.directives=A(Object.create(t.directives||null),i.directives)),i)"modules"!==s&&"directives"!==s&&(n[s]=i[s]);n.warn=function(t,e,i){(i?o:r).push(t)};var a=Ks(e.trim(),n);return a.errors=r,a.tips=o,a}return{compile:e,compileToFunctions:Ws(e)}})(vs),Ys=(Hs.compile,Hs.compileToFunctions);function Zs(t){return(Xs=Xs||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',Xs.innerHTML.indexOf("&#10;")>0}var Js=!!W&&Zs(!1),Qs=!!W&&Zs(!0),ta=w((function(t){var e=Xi(t);return e&&e.innerHTML})),ea=wi.prototype.$mount;wi.prototype.$mount=function(t,e){if((t=t&&Xi(t))===document.body||t===document.documentElement)return this;var i=this.$options;if(!i.render){var n=i.template;if(n)if("string"==typeof n)"#"===n.charAt(0)&&(n=ta(n));else{if(!n.nodeType)return this;n=n.innerHTML}else t&&(n=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(n){var r=Ys(n,{outputSourceRange:!1,shouldDecodeNewlines:Js,shouldDecodeNewlinesForHref:Qs,delimiters:i.delimiters,comments:i.comments},this),o=r.render,s=r.staticRenderFns;i.render=o,i.staticRenderFns=s}}return ea.call(this,t,e)},wi.compile=Ys,t.exports=wi}).call(this,i("yLpj"),i("URgk").setImmediate)},K6oq:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.dropdown-menu > li > a {\n  cursor: pointer;\n}\n",""])},"O3R+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cWyK");function r(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(o(t[i]))}return e}function o(t){var e,i,n,r,o,a,l=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(n=u-2,r=u-1,o=0):a===u-1?(n=u-1,r=0,o=1):(n=a,r=a+1,o=a+2),e=t[n],i=t[r],l+=(s(t[o][0])-s(e[0]))*Math.sin(s(i[1]));l=6378137*l*6378137/2}return l}function s(t){return t*Math.PI/180}e.default=function(t){return n.geomReduce(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return r(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=r(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},OMIv:function(t,e,i){"use strict";i.r(e);var n=i("XuX8"),r=i.n(n);function o(t){this.state=2,this.value=void 0,this.deferred=[];var e=this;try{t((function(t){e.resolve(t)}),(function(t){e.reject(t)}))}catch(t){e.reject(t)}}o.reject=function(t){return new o((function(e,i){i(t)}))},o.resolve=function(t){return new o((function(e,i){e(t)}))},o.all=function(t){return new o((function(e,i){var n=0,r=[];function s(i){return function(o){r[i]=o,(n+=1)===t.length&&e(r)}}0===t.length&&e(r);for(var a=0;a<t.length;a+=1)o.resolve(t[a]).then(s(a),i)}))},o.race=function(t){return new o((function(e,i){for(var n=0;n<t.length;n+=1)o.resolve(t[n]).then(e,i)}))};var s=o.prototype;function a(t,e){this.promise=t instanceof Promise?t:new Promise(t.bind(e)),this.context=e}s.resolve=function(t){var e=this;if(2===e.state){if(t===e)throw new TypeError("Promise settled with itself.");var i=!1;try{var n=t&&t.then;if(null!==t&&"object"==typeof t&&"function"==typeof n)return void n.call(t,(function(t){i||e.resolve(t),i=!0}),(function(t){i||e.reject(t),i=!0}))}catch(t){return void(i||e.reject(t))}e.state=0,e.value=t,e.notify()}},s.reject=function(t){if(2===this.state){if(t===this)throw new TypeError("Promise settled with itself.");this.state=1,this.value=t,this.notify()}},s.notify=function(){var t,e=this;u((function(){if(2!==e.state)for(;e.deferred.length;){var t=e.deferred.shift(),i=t[0],n=t[1],r=t[2],o=t[3];try{0===e.state?r("function"==typeof i?i.call(void 0,e.value):e.value):1===e.state&&("function"==typeof n?r(n.call(void 0,e.value)):o(e.value))}catch(t){o(t)}}}),t)},s.then=function(t,e){var i=this;return new o((function(n,r){i.deferred.push([t,e,n,r]),i.notify()}))},s.catch=function(t){return this.then(void 0,t)},"undefined"==typeof Promise&&(window.Promise=o),a.all=function(t,e){return new a(Promise.all(t),e)},a.resolve=function(t,e){return new a(Promise.resolve(t),e)},a.reject=function(t,e){return new a(Promise.reject(t),e)},a.race=function(t,e){return new a(Promise.race(t),e)};var l=a.prototype;l.bind=function(t){return this.context=t,this},l.then=function(t,e){return t&&t.bind&&this.context&&(t=t.bind(this.context)),e&&e.bind&&this.context&&(e=e.bind(this.context)),new a(this.promise.then(t,e),this.context)},l.catch=function(t){return t&&t.bind&&this.context&&(t=t.bind(this.context)),new a(this.promise.catch(t),this.context)},l.finally=function(t){return this.then((function(e){return t.call(this),e}),(function(e){return t.call(this),Promise.reject(e)}))};var u,h={}.hasOwnProperty,c=[].slice,d=!1,p="undefined"!=typeof window;function f(t){return t?t.replace(/^\s*|\s*$/g,""):""}function g(t){return t?t.toLowerCase():""}var m=Array.isArray;function v(t){return"string"==typeof t}function y(t){return"function"==typeof t}function _(t){return null!==t&&"object"==typeof t}function b(t){return _(t)&&Object.getPrototypeOf(t)==Object.prototype}function w(t,e,i){var n=a.resolve(t);return arguments.length<2?n:n.then(e,i)}function x(t,e,i){return y(i=i||{})&&(i=i.call(e)),T(t.bind({$vm:e,$options:i}),t,{$options:i})}function S(t,e){var i,n;if(m(t))for(i=0;i<t.length;i++)e.call(t[i],t[i],i);else if(_(t))for(n in t)h.call(t,n)&&e.call(t[n],t[n],n);return t}var C=Object.assign||function(t){var e=c.call(arguments,1);return e.forEach((function(e){E(t,e)})),t};function T(t){var e=c.call(arguments,1);return e.forEach((function(e){E(t,e,!0)})),t}function E(t,e,i){for(var n in e)i&&(b(e[n])||m(e[n]))?(b(e[n])&&!b(t[n])&&(t[n]={}),m(e[n])&&!m(t[n])&&(t[n]=[]),E(t[n],e[n],i)):void 0!==e[n]&&(t[n]=e[n])}function I(t,e,i){var n=function(t){var e=["+","#",".","/",";","?","&"],i=[];return{vars:i,expand:function(n){return t.replace(/\{([^{}]+)\}|([^{}]+)/g,(function(t,r,o){if(r){var s=null,a=[];if(-1!==e.indexOf(r.charAt(0))&&(s=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach((function(t){var e=/([^:*]*)(?::(\d+)|(\*))?/.exec(t);a.push.apply(a,function(t,e,i,n){var r=t[i],o=[];if(k(r)&&""!==r)if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)r=r.toString(),n&&"*"!==n&&(r=r.substring(0,parseInt(n,10))),o.push(P(e,r,A(e)?i:null));else if("*"===n)Array.isArray(r)?r.filter(k).forEach((function(t){o.push(P(e,t,A(e)?i:null))})):Object.keys(r).forEach((function(t){k(r[t])&&o.push(P(e,r[t],t))}));else{var s=[];Array.isArray(r)?r.filter(k).forEach((function(t){s.push(P(e,t))})):Object.keys(r).forEach((function(t){k(r[t])&&(s.push(encodeURIComponent(t)),s.push(P(e,r[t].toString())))})),A(e)?o.push(encodeURIComponent(i)+"="+s.join(",")):0!==s.length&&o.push(s.join(","))}else";"===e?o.push(encodeURIComponent(i)):""!==r||"&"!==e&&"?"!==e?""===r&&o.push(""):o.push(encodeURIComponent(i)+"=");return o}(n,s,e[1],e[2]||e[3])),i.push(e[1])})),s&&"+"!==s){var l=",";return"?"===s?l="&":"#"!==s&&(l=s),(0!==a.length?s:"")+a.join(l)}return a.join(",")}return R(o)}))}}}(t),r=n.expand(e);return i&&i.push.apply(i,n.vars),r}function k(t){return null!=t}function A(t){return";"===t||"&"===t||"?"===t}function P(t,e,i){return e="+"===t||"#"===t?R(e):encodeURIComponent(e),i?encodeURIComponent(i)+"="+e:e}function R(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map((function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t)),t})).join("")}function L(t,e){var i,n=this||{},r=t;return v(t)&&(r={url:t,params:e}),r=T({},L.options,n.$options,r),L.transforms.forEach((function(t){v(t)&&(t=L.transform[t]),y(t)&&(i=function(t,e,i){return function(n){return t.call(i,n,e)}}(t,i,n.$vm))})),i(r)}function M(t){return new a((function(e){var i=new XDomainRequest,n=function(n){var r=n.type,o=0;"load"===r?o=200:"error"===r&&(o=500),e(t.respondWith(i.responseText,{status:o}))};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl()),t.timeout&&(i.timeout=t.timeout),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.onprogress=function(){},i.send(t.getBody())}))}L.options={url:"",root:null,params:{}},L.transform={template:function(t){var e=[],i=I(t.url,t.params,e);return e.forEach((function(e){delete t.params[e]})),i},query:function(t,e){var i=Object.keys(L.options.params),n={},r=e(t);return S(t.params,(function(t,e){-1===i.indexOf(e)&&(n[e]=t)})),(n=L.params(n))&&(r+=(-1==r.indexOf("?")?"?":"&")+n),r},root:function(t,e){var i,n,r=e(t);return v(t.root)&&!/^(https?:)?\//.test(r)&&(i=t.root,n="/",r=(i&&void 0===n?i.replace(/\s+$/,""):i&&n?i.replace(new RegExp("["+n+"]+$"),""):i)+"/"+r),r}},L.transforms=["template","query","root"],L.params=function(t){var e=[],i=encodeURIComponent;return e.add=function(t,e){y(e)&&(e=e()),null===e&&(e=""),this.push(i(t)+"="+i(e))},function t(e,i,n){var r,o=m(i),s=b(i);S(i,(function(i,a){r=_(i)||m(i),n&&(a=n+"["+(s||r?a:"")+"]"),!n&&o?e.add(i.name,i.value):r?t(e,i,a):e.add(a,i)}))}(e,t),e.join("&").replace(/%20/g,"+")},L.parse=function(t){var e=document.createElement("a");return document.documentMode&&(e.href=t,t=e.href),e.href=t,{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",port:e.port,host:e.host,hostname:e.hostname,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):""}};var F=p&&"withCredentials"in new XMLHttpRequest;function O(t){return new a((function(e){var i,n,r=t.jsonp||"callback",o=t.jsonpCallback||"_jsonp"+Math.random().toString(36).substr(2),s=null;i=function(i){var r=i.type,a=0;"load"===r&&null!==s?a=200:"error"===r&&(a=500),a&&window[o]&&(delete window[o],document.body.removeChild(n)),e(t.respondWith(s,{status:a}))},window[o]=function(t){s=JSON.stringify(t)},t.abort=function(){i({type:"abort"})},t.params[r]=o,t.timeout&&setTimeout(t.abort,t.timeout),(n=document.createElement("script")).src=t.getUrl(),n.type="text/javascript",n.async=!0,n.onload=i,n.onerror=i,document.body.appendChild(n)}))}function D(t){return new a((function(e){var i=new XMLHttpRequest,n=function(n){var r=t.respondWith("response"in i?i.response:i.responseText,{status:1223===i.status?204:i.status,statusText:1223===i.status?"No Content":f(i.statusText)});S(f(i.getAllResponseHeaders()).split("\n"),(function(t){r.headers.append(t.slice(0,t.indexOf(":")),t.slice(t.indexOf(":")+1))})),e(r)};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl(),!0),t.timeout&&(i.timeout=t.timeout),t.responseType&&"responseType"in i&&(i.responseType=t.responseType),(t.withCredentials||t.credentials)&&(i.withCredentials=!0),t.crossOrigin||t.headers.set("X-Requested-With","XMLHttpRequest"),y(t.progress)&&"GET"===t.method&&i.addEventListener("progress",t.progress),y(t.downloadProgress)&&i.addEventListener("progress",t.downloadProgress),y(t.progress)&&/^(POST|PUT)$/i.test(t.method)&&i.upload.addEventListener("progress",t.progress),y(t.uploadProgress)&&i.upload&&i.upload.addEventListener("progress",t.uploadProgress),t.headers.forEach((function(t,e){i.setRequestHeader(e,t)})),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.send(t.getBody())}))}function j(t){var e=i(1);return new a((function(i){var n,r=t.getUrl(),o=t.getBody(),s=t.method,a={};t.headers.forEach((function(t,e){a[e]=t})),e(r,{body:o,method:s,headers:a}).then(n=function(e){var n=t.respondWith(e.body,{status:e.statusCode,statusText:f(e.statusMessage)});S(e.headers,(function(t,e){n.headers.set(e,t)})),i(n)},(function(t){return n(t.response)}))}))}function $(t){return(t.client||(p?D:j))(t)}var N=function(t){var e=this;this.map={},S(t,(function(t,i){return e.append(i,t)}))};function B(t,e){return Object.keys(t).reduce((function(t,i){return g(e)===g(i)?i:t}),null)}N.prototype.has=function(t){return null!==B(this.map,t)},N.prototype.get=function(t){var e=this.map[B(this.map,t)];return e?e.join():null},N.prototype.getAll=function(t){return this.map[B(this.map,t)]||[]},N.prototype.set=function(t,e){this.map[function(t){if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return f(t)}(B(this.map,t)||t)]=[f(e)]},N.prototype.append=function(t,e){var i=this.map[B(this.map,t)];i?i.push(f(e)):this.set(t,e)},N.prototype.delete=function(t){delete this.map[B(this.map,t)]},N.prototype.deleteAll=function(){this.map={}},N.prototype.forEach=function(t,e){var i=this;S(this.map,(function(n,r){S(n,(function(n){return t.call(e,n,r,i)}))}))};var U=function(t,e){var i,n=e.url,r=e.headers,o=e.status,s=e.statusText;this.url=n,this.ok=o>=200&&o<300,this.status=o||0,this.statusText=s||"",this.headers=new N(r),this.body=t,v(t)?this.bodyText=t:(i=t,"undefined"!=typeof Blob&&i instanceof Blob&&(this.bodyBlob=t,function(t){return 0===t.type.indexOf("text")||-1!==t.type.indexOf("json")}(t)&&(this.bodyText=function(t){return new a((function(e){var i=new FileReader;i.readAsText(t),i.onload=function(){e(i.result)}}))}(t))))};U.prototype.blob=function(){return w(this.bodyBlob)},U.prototype.text=function(){return w(this.bodyText)},U.prototype.json=function(){return w(this.text(),(function(t){return JSON.parse(t)}))},Object.defineProperty(U.prototype,"data",{get:function(){return this.body},set:function(t){this.body=t}});var G=function(t){var e;this.body=null,this.params={},C(this,t,{method:(e=t.method||"GET",e?e.toUpperCase():"")}),this.headers instanceof N||(this.headers=new N(this.headers))};G.prototype.getUrl=function(){return L(this)},G.prototype.getBody=function(){return this.body},G.prototype.respondWith=function(t,e){return new U(t,C(e||{},{url:this.getUrl()}))};var z={"Content-Type":"application/json;charset=utf-8"};function V(t){var e=this||{},i=function(t){var e=[$],i=[];function n(n){for(;e.length;){var r=e.pop();if(y(r)){var o=void 0,s=void 0;if(_(o=r.call(t,n,(function(t){return s=t}))||s))return new a((function(e,n){i.forEach((function(e){o=w(o,(function(i){return e.call(t,i)||i}),n)})),w(o,e,n)}),t);y(o)&&i.unshift(o)}else l="Invalid interceptor of type "+typeof r+", must be a function","undefined"!=typeof console&&d&&console.warn("[VueResource warn]: "+l)}var l}return _(t)||(t=null),n.use=function(t){e.push(t)},n}(e.$vm);return function(t){var e=c.call(arguments,1);e.forEach((function(e){for(var i in e)void 0===t[i]&&(t[i]=e[i])}))}(t||{},e.$options,V.options),V.interceptors.forEach((function(t){v(t)&&(t=V.interceptor[t]),y(t)&&i.use(t)})),i(new G(t)).then((function(t){return t.ok?t:a.reject(t)}),(function(t){var e;return t instanceof Error&&(e=t,"undefined"!=typeof console&&console.error(e)),a.reject(t)}))}function q(t,e,i,n){var r=this||{},o={};return S(i=C({},q.actions,i),(function(i,s){i=T({url:t,params:C({},e)},n,i),o[s]=function(){return(r.$http||V)(W(i,arguments))}})),o}function W(t,e){var i,n=C({},t),r={};switch(e.length){case 2:r=e[0],i=e[1];break;case 1:/^(POST|PUT|PATCH)$/i.test(n.method)?i=e[0]:r=e[0];break;case 0:break;default:throw"Expected up to 2 arguments [params, body], got "+e.length+" arguments"}return n.body=i,n.params=C({},n.params,r),n}function K(t){K.installed||(!function(t){var e=t.config,i=t.nextTick;u=i,d=e.debug||!e.silent}(t),t.url=L,t.http=V,t.resource=q,t.Promise=a,Object.defineProperties(t.prototype,{$url:{get:function(){return x(t.url,this,this.$options.url)}},$http:{get:function(){return x(t.http,this,this.$options.http)}},$resource:{get:function(){return t.resource.bind(this)}},$promise:{get:function(){var e=this;return function(i){return new t.Promise(i,e)}}}}))}V.options={},V.headers={put:z,post:z,patch:z,delete:z,common:{Accept:"application/json, text/plain, */*"},custom:{}},V.interceptor={before:function(t){y(t.before)&&t.before.call(this,t)},method:function(t){t.emulateHTTP&&/^(PUT|PATCH|DELETE)$/i.test(t.method)&&(t.headers.set("X-HTTP-Method-Override",t.method),t.method="POST")},jsonp:function(t){"JSONP"==t.method&&(t.client=O)},json:function(t){var e=t.headers.get("Content-Type")||"";return _(t.body)&&0===e.indexOf("application/json")&&(t.body=JSON.stringify(t.body)),function(t){return t.bodyText?w(t.text(),(function(e){var i,n;if(0===(t.headers.get("Content-Type")||"").indexOf("application/json")||(n=(i=e).match(/^\s*(\[|\{)/))&&{"[":/]\s*$/,"{":/}\s*$/}[n[1]].test(i))try{t.body=JSON.parse(e)}catch(e){t.body=null}else t.body=e;return t})):t}},form:function(t){var e;e=t.body,"undefined"!=typeof FormData&&e instanceof FormData?t.headers.delete("Content-Type"):_(t.body)&&t.emulateJSON&&(t.body=L.params(t.body),t.headers.set("Content-Type","application/x-www-form-urlencoded"))},header:function(t){S(C({},V.headers.common,t.crossOrigin?{}:V.headers.custom,V.headers[g(t.method)]),(function(e,i){t.headers.has(i)||t.headers.set(i,e)}))},cors:function(t){if(p){var e=L.parse(location.href),i=L.parse(t.getUrl());i.protocol===e.protocol&&i.host===e.host||(t.crossOrigin=!0,t.emulateHTTP=!1,F||(t.client=M))}}},V.interceptors=["before","method","jsonp","json","form","header","cors"],["get","delete","head","jsonp"].forEach((function(t){V[t]=function(e,i){return this(C(i||{},{url:e,method:t}))}})),["post","put","patch"].forEach((function(t){V[t]=function(e,i,n){return this(C(n||{},{url:e,method:t,body:i}))}})),q.actions={get:{method:"GET"},save:{method:"POST"},query:{method:"GET"},update:{method:"PUT"},remove:{method:"DELETE"},delete:{method:"DELETE"}},"undefined"!=typeof window&&window.Vue&&window.Vue.use(K);var X=K;i("CN2R");var H,Y=Array.prototype,Z=new Error("Passed arguments must be of Node"),J=[],Q=[],tt=function(){if("undefined"!=typeof window){function t(t){return t instanceof window.Node}function e(t){return t instanceof window.NodeList||t instanceof u||t instanceof window.HTMLCollection||t instanceof Array}class u{constructor(e){var i=e;if(e[0]===window?i=[window]:"string"==typeof e[0]?(i=(e[1]||document).querySelectorAll(e[0]),e[1]&&(this.owner=e[1])):0 in e&&!t(e[0])&&e[0]&&"length"in e[0]&&(i=e[0],e[1]&&(this.owner=e[1])),i){for(var n in i)this[n]=i[n];this.length=i.length}else this.length=0;window.prueba=this}concat(...i){var n=Y.slice.call(this);return Y.forEach.call(i,i=>{if(t(i))~n.indexOf(i)||n.push(i);else{if(!e(i))throw Error("Concat arguments must be of a Node, NodeList, HTMLCollection, or Array of (Node, NodeList, HTMLCollection, Array)");!function i(r){Y.forEach.call(r,r=>{t(r)?~n.indexOf(r)||n.push(r):e(r)&&i(r)})}(i)}}),l(n,this)}delete(){var t=n(this).filter(t=>(t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t),document.body.contains(t)));return t.length&&console.warn("NodeList: Some nodes could not be deleted."),t}each(...t){return Y.forEach.apply(this,t),this}filter(...t){return l(Y.filter.apply(this,t),this)}find(i){var r=[];if("string"==typeof i&&n(this).forEach(t=>{r.push(t.querySelectorAll(i))}),t(i)&&n(this).forEach(t=>{t!==i&&t.contains(i)&&r.push(i)}),e(i)){var o=n(i);n(this).forEach(t=>{o.forEach(e=>{t!==e&&t.contains(e)&&r.push(e)})})}return n(r,this.owner)}forEach(...t){return Y.forEach.apply(this,t),this}includes(t,e){return~this.indexOf(t,e)}map(...i){var r=Y.map.apply(this,i);return r.some(i=>t(i)||e(i))?n(r,this):r}parent(){return n(this.map(t=>t.parentNode),this)}pop(t){"number"!=typeof t&&(t=1);for(var e=[],i=Y.pop.bind(this);t--;)e.push(i());return l(e,this)}push(...e){return Y.forEach.call(e,e=>{if(!t(e))throw Z;~this.indexOf(e)||Y.push.call(this,e)}),this}shift(t){"number"!=typeof t&&(t=1);for(var e=[];t--;)e.push(Y.shift.call(this));return 1==e.length?e[0]:l(e,this)}slice(...t){return l(Y.slice.apply(this,t),this)}splice(...e){for(var i=2,n=e.length;i<n;i++)if(!t(e[i]))throw Z;return Y.splice.apply(this,e),this}unshift(...e){var i=Y.unshift.bind(this);return Y.forEach.call(e,e=>{if(!t(e))throw Z;~this.indexOf(e)||i(e)}),this}addClass(t){return this.toggleClass(t,!0)}removeClass(t){return this.toggleClass(t,!1)}toggleClass(t,e=null){var i=null==e?"toggle":e?"add":"remove";return"string"==typeof t&&(t=t.trim().replace(/\s+/," ").split(" ")),this.each(e=>t.forEach(t=>e.classList[i](t)))}get(t){var e=[];return this.each(i=>{null!==i&&(i=i[t]),e.push(i)}),n(e,this)}set(t,e){return t.constructor===Object?this.each(e=>{if(e)for(var i in t)i in e&&(e[i]=t[i])}):this.each(i=>{t in i&&(i[t]=e)}),this}call(...t){const e=Y.shift.call(t);let i=[],r=!0;return this.each(n=>{n&&n[e]instanceof Function?(n=n[e].apply(n,t),i.push(n),r&&void 0!==n&&(r=!1)):i.push(void 0)}),r?this:n(i,this)}item(t){return l([this[t]],this)}get asArray(){return Y.slice.call(this)}on(e,i,n){if("string"==typeof e&&(e=e.trim().replace(/\s+/," ").split(" ")),!this||!this.length)return this;if(void 0===n&&(n=i,i=null),!n)return this;var r=n;return n=i?function(t){var e=l(i,this);e.length&&e.some(e=>{var i=e.contains(t.target);return i&&r.call(e,t,e),i})}:function(t){r.apply(this,[t,this])},this.each(i=>{e.forEach(e=>{(i===window||t(i))&&(i.addEventListener(e,n,!1),Q.push({el:i,event:e,callback:n}))})}),this}off(t,e){return t instanceof Function&&(e=t,t=null),t=t instanceof Array?t:"string"==typeof t?t.trim().replace(/\s+/," ").split(" "):null,this.each(i=>{Q=Q.filter(n=>!!(!n||n.el!==i||e&&e!==n.callback||t&&!~t.indexOf(n.event))||(n.el.removeEventListener(n.event,n.callback),!1))}),this}onBlur(t){return this&&this.length&&t?(this.each(e=>{J.push({el:e,callback:t})}),H||(H=t=>{J.forEach(e=>{e.el.contains(t.target)||e.el===t.target||e.callback.call(e.el,t,e.el)})},document.addEventListener("click",H,!1),document.addEventListener("touchstart",H,!1)),this):this}offBlur(t){return this.each(e=>{J=J.filter(i=>!(i&&i.el===e&&(!t||i.callback===t))&&e)}),this}}var i=u.prototype;function n(n,r){var o=[];return Y.forEach.call(n,s=>{if(t(s))~o.indexOf(s)||o.push(s);else if(e(s))for(var a in s)~o.indexOf(s[a])||o.push(s[a]);else if(null!==s)return n.get=i.get,n.set=i.set,n.call=i.call,n.owner=r,n}),l(o,r)}var r=["join","copyWithin","fill","find","forEach"];Object.getOwnPropertyNames(Y).forEach(t=>{~r.indexOf(t)||void 0!==i[t]||(i[t]=Y[t])}),"undefined"!=typeof window&&window.Symbol&&Symbol.iterator&&(i[Symbol.iterator]=i.values=Y[Symbol.iterator]);var o=document.createElement("div");function s(t){i[t]||(o[t]instanceof Function?i[t]=(...e)=>{var r=[],o=!0;for(var s in i){var a=i[s];a&&a[t]instanceof Function?(a=a[t].apply(a,e),r.push(a),o&&void 0!==a&&(o=!1)):r.push(void 0)}return o?this:n(r,this)}:Object.defineProperty(i,t,{get(){var e=[];return this.each(i=>{null!==i&&(i=i[t]),e.push(i)}),n(e,this)},set(e){this.each(i=>{i&&t in i&&(i[t]=e)})}}))}for(var a in o)s(a);function l(...t){return new u(t)}return window.NL=l,l}}();const et={boolean:t=>"string"==typeof t?""===t||"true"===t||"false"!==t&&"null"!==t&&"undefined"!==t&&t:t,number:(t,e=null)=>"number"==typeof t?t:null==t||isNaN(Number(t))?e:Number(t),string:t=>null==t?"":t+"",pattern:t=>t instanceof Function||t instanceof RegExp?t:"string"==typeof t?new RegExp(t):null};function it(t,e,i=100){function n(t){return/^[0-9]+$/.test(t)?Number(t)||1:null}var r;return function(...o){r&&clearTimeout(r),r=setTimeout(()=>{t.apply(this,o)},n(e)||n(this[e])||i)}}var nt=[];function rt(t){nt.forEach(e=>{e.node.contains(t.target)||e.callback(t)})}function ot(t,e){nt.length||document.addEventListener("click",rt,!1),nt.push({node:t,callback:e})}function st(t,e){(nt=nt.filter(i=>i.node!==t||!!e&&i.callback!==e)).length||document.removeEventListener("click",rt,!1)}var at={bind(t,e){st(t,e.value),"function"!=typeof e.value||ot(t,e.value)},update(t,e){e.value!==e.oldValue&&(st(t,e.oldValue),ot(t,e.value))},unbind(t,e){st(t,e.value)}};const lt="_vue_scroll_handler",ut=["resize","scroll"];function ht(t,e){ct(t);var i=e.value;"function"!=typeof i||(t[lt]=function(t){i(t)},ut.forEach((function(e){window.addEventListener(e,t[lt],!1)})),document.addEventListener("load",t[lt],!1),setTimeout((function(){t[lt]()}),0))}function ct(t){ut.forEach((function(e){window.removeEventListener(e,t[lt],!1)})),document.removeEventListener("load",t[lt],!1),delete t[lt]}var dt={bind:ht,unbind:ct,update(t,e){e.value!==e.oldValue&&ht(t,e)}},pt={props:{dismissable:{type:Boolean,default:!1},duration:{default:0},placement:{type:String},type:{type:String},value:{type:Boolean,default:!0},width:{type:String}},data(){return{val:this.value}},computed:{durationNum(){return et.number(this.duration,0)}},watch:{val(t){t&&this.durationNum>0&&this._delayClose(),this.$emit("input",t)},value(t){this.val!==t&&(this.val=t)}},created(){this._delayClose=it((function(){this.val=!1}),"durationNum")}};i("y653");function ft(t,e,i,n,r,o,s,a){var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=i,u._compiled=!0),n&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var h=u.render;u.render=function(t,e){return l.call(e),h(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:u}}var gt=ft(pt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.val,expression:"val"}],class:["alert","alert-"+t.type,t.placement],style:{width:t.width},attrs:{role:"alert"}},[i("button",{directives:[{name:"show",rawName:"v-show",value:t.dismissable,expression:"dismissable"}],staticClass:"close",attrs:{type:"button"},on:{click:function(e){t.val=!1}}},[i("span",[t._v("")])]),t._v(" "),t._t("default")],2)])}),[],!1,null,null,null).exports,mt={props:{value:{type:String},format:{default:"MM/dd/yyyy"},disabledDaysOfWeek:{type:Array,default:()=>[]},width:{type:String},clearButton:{type:Boolean,default:!1},lang:{type:String,default:"undefined"!=typeof navigator?navigator.language:"zh-CN"},placeholder:{type:String},iconsFont:{type:String,default:"glyphicon"}},data(){return{currDate:new Date,dateRange:[],decadeRange:[],displayDayView:!1,displayMonthView:!1,displayYearView:!1,val:this.value}},watch:{currDate(){this.getDateRange()},format(){this.val=this.stringify(this.currDate)},val(t,e){this.$emit("input",t)},value(t){this.val!==t&&(this.val=t)}},computed:{text(){return function(t="en"){return"undefined"!=typeof window&&window.VueStrapLang?window.VueStrapLang(t):{daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],limit:"Limit reached ({{limit}} items max).",loading:"Loading...",minLength:"Min. Length",months:["January","February","March","April","May","June","July","August","September","October","November","December"],notSelected:"Nothing Selected",required:"Required",search:"Search"}}(this.lang)},preBtnClasses(){return`datepicker-preBtn ${this.iconsFont} ${this.iconsFont}-chevron-left`},nextBtnClasses(){return`datepicker-nextBtn ${this.iconsFont} ${this.iconsFont}-chevron-right`},disabledDaysArray(){return this.disabledDaysOfWeek.map(t=>parseInt(t,10))}},methods:{close(){this.displayDayView=this.displayMonthView=this.displayYearView=!1},inputClick(){this.currDate=this.parse(this.val)||this.parse(new Date),this.displayMonthView||this.displayYearView?this.displayDayView=!1:this.displayDayView=!this.displayDayView},preNextDecadeClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();this.currDate=0===t?new Date(e-10,i,n):new Date(e+10,i,n)},preNextMonthClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();if(0===t){const t=this.getYearMonth(e,i-1);this.currDate=new Date(t.year,t.month,n)}else{const t=this.getYearMonth(e,i+1);this.currDate=new Date(t.year,t.month,n)}},preNextYearClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();this.currDate=0===t?new Date(e-1,i,n):new Date(e+1,i,n)},yearSelect(t){this.displayYearView=!1,this.displayMonthView=!0,this.currDate=new Date(t,this.currDate.getMonth(),this.currDate.getDate())},daySelect(t){if("datepicker-item-disable"===t.sclass)return!1;this.currDate=t.date,this.val=this.stringify(this.currDate),this.displayDayView=!1},switchMonthView(){this.displayDayView=!1,this.displayMonthView=!0},switchDecadeView(){this.displayMonthView=!1,this.displayYearView=!0},monthSelect(t){this.displayMonthView=!1,this.displayDayView=!0,this.currDate=new Date(this.currDate.getFullYear(),t,this.currDate.getDate())},getYearMonth:(t,e)=>(e>11?(t++,e=0):e<0&&(t--,e=11),{year:t,month:e}),stringifyDecadeHeader(t){const e=t.getFullYear().toString(),i=e.substring(0,e.length-1)+0;return i+"-"+(parseInt(i,10)+10)},stringifyDayHeader(t){return this.text.months[t.getMonth()]+" "+t.getFullYear()},parseMonth(t){return this.text.months[t.getMonth()]},stringifyYearHeader:t=>t.getFullYear(),stringify(t,e=this.format){if(t||(t=this.parse()),!t)return"";const i=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=this.parseMonth(t);return e.replace(/yyyy/g,i).replace(/yy/g,i).replace(/MMMM/g,o).replace(/MMM/g,o.substring(0,3)).replace(/MM/g,("0"+n).slice(-2)).replace(/M(?!a)/g,n).replace(/dd/g,("0"+r).slice(-2)).replace(/d/g,r)},parse(t){if(null==t&&(t=this.val),!t)return new Date;let e=10!==t.length||"dd-MM-yyyy"!==this.format&&"dd/MM/yyyy"!==this.format?new Date(t):new Date(t.substring(6,10),t.substring(3,5)-1,t.substring(0,2));return isNaN(e.getFullYear())?new Date:e},getDayCount:(t,e)=>1===e&&(t%400==0||t%4==0&&t%100!=0)?29:[31,28,31,30,31,30,31,31,30,31,30,31][e],getDateRange(){this.dateRange=[],this.decadeRange=[];const t={year:this.currDate.getFullYear(),month:this.currDate.getMonth(),day:this.currDate.getDate()},e=t.year.toString(),i=e.substring(0,e.length-1)+0-1;for(let t=0;t<12;t++)this.decadeRange.push({text:i+t});let n=new Date(t.year,t.month,1).getDay()+1;0===n&&(n=7);const r=this.getDayCount(t.year,t.month);if(n>1){const e=this.getYearMonth(t.year,t.month-1),i=this.getDayCount(e.year,e.month);for(let t=1;t<n;t++){const r=i-n+t+1,o=new Date(e.year,e.month,r);let s="datepicker-item-gray";this.disabledDaysArray.indexOf(o.getDay())>-1&&(s="datepicker-item-disable"),this.dateRange.push({text:r,date:o,sclass:s})}}for(let e=1;e<=r;e++){const i=new Date(t.year,t.month,e);let n="";this.disabledDaysArray.indexOf(i.getDay())>-1&&(n="datepicker-item-disable"),e==t.day&&i.getFullYear()==t.year&&i.getMonth()==t.month&&(n="datepicker-dateRange-item-active"),this.dateRange.push({text:e,date:i,sclass:n})}if(this.dateRange.length<42){const e=42-this.dateRange.length,i=this.getYearMonth(t.year,t.month+1);for(let t=1;t<=e;t++){const e=new Date(i.year,i.month,t);let n="datepicker-item-gray";this.disabledDaysArray.indexOf(e.getDay())>-1&&(n="datepicker-item-disable"),this.dateRange.push({text:t,date:e,sclass:n})}}}},mounted(){this.$emit("child-created",this),this.currDate=this.parse(this.val)||this.parse(new Date),this._blur=t=>{this.$el.contains(t.target)||this.close()},window.addEventListener("click",this._blur)},beforeDestroy(){window.removeEventListener("click",this._blur)}},vt=(i("ktXi"),ft(mt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"datepicker"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"form-control datepicker-input",class:{"with-reset-button":t.clearButton},style:{width:t.width},attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.val},on:{click:t.inputClick,input:function(e){e.target.composing||(t.val=e.target.value)}}}),t._v(" "),t.clearButton&&t.val?i("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){t.val=""}}},[i("span",[t._v("")])]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayDayView,expression:"displayDayView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextMonthClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextMonthClick(1)}}}),t._v(" "),i("p",{on:{click:t.switchMonthView}},[t._v(t._s(t.stringifyDayHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-weekRange"},t._l(t.text.daysOfWeek,(function(e){return i("span",[t._v(t._s(e))])})),0),t._v(" "),i("div",{staticClass:"datepicker-dateRange"},t._l(t.dateRange,(function(e){return i("span",{class:e.sclass,on:{click:function(i){return t.daySelect(e)}}},[t._v(t._s(e.text))])})),0)])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayMonthView,expression:"displayMonthView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextYearClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextYearClick(1)}}}),t._v(" "),i("p",{on:{click:t.switchDecadeView}},[t._v(t._s(t.stringifyYearHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-monthRange"},[t._l(t.text.months,(function(e,n){return[i("span",{class:{"datepicker-dateRange-item-active":t.text.months[t.parse(t.val).getMonth()]===e&&t.currDate.getFullYear()===t.parse(t.val).getFullYear()},domProps:{textContent:t._s(e.substr(0,3))},on:{click:function(e){return t.monthSelect(n)}}})]}))],2)])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayYearView,expression:"displayYearView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextDecadeClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextDecadeClick(1)}}}),t._v(" "),i("p",[t._v(t._s(t.stringifyDecadeHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-monthRange decadeRange"},[t._l(t.decadeRange,(function(e){return[i("span",{class:{"datepicker-dateRange-item-active":t.parse(t.val).getFullYear()===e.text},domProps:{textContent:t._s(e.text)},on:{click:function(i){return i.stopPropagation(),t.yearSelect(e.text)}}})]}))],2)])])])])}),[],!1,null,null,null).exports),yt=ft({directives:{ClickOutside:at},props:{disabled:{type:Boolean,default:!1},size:{type:String,default:null},text:{type:String,default:null},type:{type:String,default:"default"},value:{type:Boolean,default:!1}},data(){return{show:this.value}},watch:{show(t){this.$emit("input",t)},value(t){this.show=t}},computed:{buttonSize(){return~["lg","sm","xs"].indexOf(this.size)?"btn-"+this.size:""},inInput(){return this.$parent._input},isLi(){return this.$parent._isTabs||this.$parent._navbar||this.$parent.menu},menu(){return!this.$parent||this.$parent.navbar},slots(){return this._slotContents},submenu(){return this.$parent&&(this.$parent.menu||this.$parent.submenu)}},methods:{blur(){this.show=!1},toggle(){this.disabled||(this.show=!this.show)}},mounted(){tt("ul",this.$el).on("click","li>a",t=>{this.show=!1})},beforeDestroy(){tt("ul",this.$el).off()}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(t.isLi?"li":"div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.blur,expression:"blur"}],tag:"div",class:[{open:t.show,disabled:t.disabled,dropdown:t.isLi,"input-group-btn":t.inInput,"btn-group":!t.isLi&&!t.inInput}]},[t._t("before"),t._v(" "),t.isLi?i("a",{class:["dropdown-toggle",t.buttonSize,{disabled:t.disabled}],attrs:{role:"button"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.show=!1},click:function(e){return e.preventDefault(),t.toggle(e)}}},[t._t("button",[t._v(t._s(t.text))]),t._v(" "),i("span",{staticClass:"caret"})],2):i("button",{class:["btn btn-"+t.type,t.buttonSize,"dropdown-toggle"],attrs:{type:"button",disabled:t.disabled},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.show=!1},click:function(e){return e.preventDefault(),t.toggle(e)}}},[t._t("button",[t._v(t._s(t.text))]),t._v(" "),i("span",{staticClass:"caret"})],2),t._v(" "),t._t("dropdown-menu",[i("ul",{staticClass:"dropdown-menu"},[t._t("default")],2)])],2)}),[],!1,null,null,null).exports,_t={mixins:[{props:{content:{type:String},effect:{type:String,default:"fade"},header:{type:Boolean,default:!0},placement:{type:String,default:"top"},title:{type:String},trigger:{type:String}},data:()=>({top:0,left:0,show:!1}),computed:{events(){return{contextmenu:["contextmenu"],hover:["mouseleave","mouseenter"],focus:["blur","focus"]}[this.trigger]||["click"]}},methods:{beforeEnter(){this.position(),setTimeout(()=>this.position(),30)},position(){this.$nextTick(()=>{var t=this.$refs.popover,e=this.$refs.trigger.children[0];switch(this.placement){case"top":this.left=e.offsetLeft-t.offsetWidth/2+e.offsetWidth/2,this.top=e.offsetTop-t.offsetHeight;break;case"left":this.left=e.offsetLeft-t.offsetWidth,this.top=e.offsetTop+e.offsetHeight/2-t.offsetHeight/2;break;case"right":this.left=e.offsetLeft+e.offsetWidth,this.top=e.offsetTop+e.offsetHeight/2-t.offsetHeight/2;break;case"bottom":this.left=e.offsetLeft-t.offsetWidth/2+e.offsetWidth/2,this.top=e.offsetTop+e.offsetHeight;break;default:console.warn("Wrong placement prop")}t.style.top=this.top+"px",t.style.left=this.left+"px"})},toggle(t){t&&"contextmenu"===this.trigger&&t.preventDefault(),this.show=!this.show,this.show&&this.beforeEnter()}},mounted(){let t=this.$refs.trigger.children[0];if(!t)return console.error("Could not find trigger v-el in your component that uses popoverMixin.");("focus"!==this.trigger||~t.tabIndex||(t=tt("a,input,select,textarea,button",t),t.length))&&this.events.forEach(e=>{tt(t).on(e,this.toggle)})},beforeDestroy(){this._trigger&&tt(this._trigger).off()}}],props:{trigger:{type:String,default:"click"}}},bt=(i("vvbw"),ft(_t,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{ref:"trigger"},[t._t("default"),t._v(" "),i("transition",{attrs:{name:t.effect}},[t.show?i("div",{ref:"popover",class:["popover",t.placement]},[i("div",{staticClass:"arrow"}),t._v(" "),t.title?i("h3",{staticClass:"popover-title"},[t._t("title",[t._v(t._s(t.title))])],2):t._e(),t._v(" "),i("div",{staticClass:"popover-content"},[t._t("content",[i("span",{domProps:{innerHTML:t._s(t.content)}})])],2)]):t._e()])],2)}),[],!1,null,null,null).exports),wt=ft({props:{disabled:{type:Boolean,default:!1},header:{type:String}},data:()=>({fadein:!1}),computed:{active(){var t=!this._tabs||this._tabs.show===this;return this.fadein=!1,t&&setTimeout(()=>{this.fadein=!0},0),t},index(){return this._tabs.tabs.indexOf(this)},transition(){return this._tabs?this._tabs.effect:null}},created(){this._isTab=!0;let t=this;for(;!this._tabs&&t.$parent;)t._isTabGroup&&(t.tabs.push(this),this._tabGroup=t),t._isTabs&&(t.tabs.push(this),this._tabs=t,this._tabGroup||t.headers.push(this)),t=t.$parent;if(!this._tabs)throw Error("tab depend on tabs.")},beforeDestroy(){if(this._tabGroup&&(this._tabGroup.tabs=this._tabGroup.tabs.filter(t=>t!==this)),this._tabs&&(this._tabs.tabs=this._tabs.tabs.filter(t=>t!==this)),this._tabs&&(this._tabs.active===this.index&&(this._tabs.index=0),this._ingroup)){let t=this.$parent.tabs.indexOf(this);~t&&this.$parent.tabs.splice(t,1)}if(this._tabs){let t=this._tabs.tabs.indexOf(this);~t&&this._tabs.tabs.splice(t,1)}}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"panel",class:["tab-pane",{"active fade":this.active,in:this.fadein}],attrs:{role:"tabpanel"}},[this._t("default")],2)}),[],!1,null,null,null).exports,xt={props:{disabled:{type:Boolean,default:!1},header:{type:String}},data:()=>({show:!1,tabs:[]}),computed:{active(){return~this.tabs.indexOf(this._tabs.show)}},methods:{blur(){this.show=!1},toggle(){this.show=!this.show}},created(){if(this._isTabGroup=!0,this.$parent){if(this.$parent._isTabGroup)throw Error("Can't nest tab-groups.");if(!this.$parent._isTabs)throw Error("tab-group depend on tabs.")}this._tabs=this.$parent,this._tabs.headers.push(this)}},St=(i("7QHc"),ft(xt,(function(){var t=this.$createElement;return(this._self._c||t)("span",[this._t("default")],2)}),[],!1,null,null,null).exports),Ct={components:{dropdown:yt},props:{justified:!1,navStyle:{type:String,default:null},value:{type:Number,default:0}},data(){return{index:this.value||0,headers:[],tabs:[]}},watch:{index(t){this.$emit("active",t),this.$emit("input",t)},value(t){this.index=t}},computed:{navStyleClass(){return["nav",~["pills","stacked"].indexOf(this.navStyle)?"nav-"+this.navStyle:"nav-tabs",{"nav-justified":et.boolean(this.justified),"nav-pills":"stacked"===this.navStyle}]},show(){return this.tabs[this.index]||this.tabs[0]}},methods:{select(t){t.disabled||(this.index=this.tabs.indexOf(t))}},created(){this._isTabs=!0}},Tt=(i("7Xoj"),ft(Ct,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{tabs:""}},[i("ul",{class:t.navStyleClass,attrs:{role:"tablist"}},[t._l(t.headers,(function(e){return[e._isTab?i("li",{class:{active:e.active,disabled:e.disabled},on:{click:function(i){return i.preventDefault(),t.select(e)}}},[t._t("header",[i("a",{attrs:{href:"#"},domProps:{innerHTML:t._s(e.header)}})])],2):t._e(),t._v(" "),e._isTabGroup?i("dropdown",{class:{active:e.active},attrs:{text:e.header,disabled:e.disabled}},t._l(e.tabs,(function(e){return i("li",{class:{disabled:e.disabled}},[i("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.select(e)}}},[t._v(t._s(e.header))])])})),0):t._e()]}))],2),t._v(" "),i("div",{staticClass:"tab-content"},[t._t("default")],2)])}),[],!1,null,null,null).exports),Et={props:{async:{type:String},data:{type:Array},delay:{type:Number,default:300},asyncKey:{type:String,default:null},limit:{type:Number,default:8},matchCase:{type:Boolean,default:!1},matchStart:{type:Boolean,default:!1},matchProperty:{type:String},onHit:{type:Function,default:t=>t},placeholder:{type:String},template:{type:String},type:{type:String,default:"text"},value:{type:String,default:""}},data(){return{asign:"",showDropdown:!1,noResults:!0,current:0,items:[],val:this.value}},computed:{templateComp(){return{template:"string"==typeof this.template?"<span>"+this.template+"</span>":this.template,props:{item:{default:null}}}}},watch:{val(t,e){this.$emit("input",t),t!==e&&t!==this.asign&&this.__update()},value(t){this.val!==t&&(this.val=t)}},methods:{setItems(t){this.async?(this.items=this.asyncKey?t[this.asyncKey]:t,this.items=this.items.slice(0,this.limit)):this.items=(t||[]).filter(t=>{if("object"==typeof t){if(!this.matchProperty)return!0;t=t[this.matchProperty]}t=this.matchCase?t:t.toLowerCase();var e=this.matchCase?this.val:this.val.toLowerCase();return this.matchStart?0===t.indexOf(e):-1!==t.indexOf(e)}).slice(0,this.limit),this.showDropdown=this.items.length>0},setValue(t){this.asign=t,this.val=t,this.items=[],this.loading=!1,this.showDropdown=!1,this.current=0},clear(){this.reset(),this.$emit("clear")},reset(){this.setValue(null)},setActive(t){this.current=t},isActive(t){return this.current===t},hit(){0!==this.items.length&&this.setValue(this.onHit(this.items[this.current],this))},up(){this.current>0?this.current--:this.current=this.items.length-1},down(){this.current<this.items.length-1?this.current++:this.current=0}},created(){this.__update=it((function(){var t,e,i,n;this.val?(this.asign="",this.async?(t=this.async+this.val,e=new window.XMLHttpRequest,i={},n={then:(t,e)=>n.done(t).fail(e),catch:t=>n.fail(t),always:t=>n.done(t).fail(t)},["done","fail"].forEach(t=>{i[t]=[],n[t]=e=>(e instanceof Function&&i[t].push(e),n)}),n.done(JSON.parse),e.onreadystatechange=()=>{if(4===e.readyState){let o={status:e.status};if(200===e.status)try{var t=e.responseText;for(var n in i.done){var r=i.done[n](t);void 0!==r&&(t=r)}}catch(t){i.fail.forEach(e=>e(t))}else i.fail.forEach(t=>t(o))}},e.open("GET",t),e.setRequestHeader("Accept","application/json"),e.send(),n).then(t=>{this.setItems(t)}):this.data&&this.setItems(this.data)):this.reset()}),"delay",300)}},It=(i("AAEp"),ft(Et,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{open:t.showDropdown},style:{position:"relative"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"form-control",attrs:{autocomplete:"off",placeholder:t.placeholder,type:t.type},domProps:{value:t.val},on:{blur:function(e){t.showDropdown=!1},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.down(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.hit(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.clear(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.up(e))}],input:function(e){e.target.composing||(t.val=e.target.value)}}}),t._v(" "),i("ul",{ref:"dropdown",staticClass:"dropdown-menu"},t._l(t.items,(function(e,n){return i("li",{class:{active:t.isActive(n)}},[i("a",{on:{mousedown:function(e){return e.preventDefault(),t.hit(e)},mousemove:function(e){return t.setActive(n)}}},[i(t.templateComp,{tag:"component",attrs:{item:e}})],1)])})),0)])}),[],!1,null,null,null).exports),kt={directives:{ClickOutside:at,Scroll:dt},utils:{$:tt,coerce:et},alert:gt,datepicker:vt,dropdown:yt,popover:bt,tab:wt,tabGroup:St,tabs:Tt,typeahead:It};window.Vue=r.a,window.Vue.use(X),window.VueStrap=kt;var At=function(t,e){window.addEventListener("load",(function(){var i=document.getElementById(t);i&&(e instanceof Vue||(e=new Vue(e)),e.$mount(i))}))},Pt=function(t){t=Array.isArray(t)?t:t.split("."),window.biigle||(window.biigle={});for(var e=window.biigle,i=0,n=t.length;i<n;i++)e.hasOwnProperty(t[i])||(e[t[i]]={}),e=e[t[i]];return e},Rt=Vue.resource("api/v1/annotations{/id}",{},{attachLabel:{method:"POST",url:"api/v1/annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/annotation-labels{/annotation_label_id}"}}),Lt=Vue.resource("api/v1/images{/id}",{},{getFile:{method:"GET",url:"api/v1/images{/id}/file"},getAnnotations:{method:"GET",url:"api/v1/images{/id}/annotations"},saveAnnotations:{method:"POST",url:"api/v1/images{/id}/annotations"}}),Mt=Vue.resource("api/v1/labels{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/label_tree_id}/labels"}}),Ft=Vue.resource("api/v1/label-sources{/id}/find"),Ot=Vue.resource("api/v1/label-trees{/id}",{},{addAuthorizedProject:{method:"POST",url:"api/v1/label-trees{/id}/authorized-projects"},removeAuthorizedProject:{method:"DELETE",url:"api/v1/label-trees{/id}/authorized-projects{/project_id}"},addUser:{method:"POST",url:"api/v1/label-trees{/id}/users"},updateUser:{method:"PUT",url:"api/v1/label-trees{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/label-trees{/id}/users{/user_id}"}}),Dt=Vue.resource("api/v1/label-tree-versions{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/id}/version"}}),jt=Vue.resource("api/v1/notifications{/id}",{},{markRead:{method:"PUT"}}),$t=Vue.resource("api/v1/projects{/id}",{},{queryVolumes:{method:"GET",url:"api/v1/projects{/id}/volumes"},saveVolume:{method:"POST",url:"api/v1/projects{/id}/volumes"},attachVolume:{method:"POST",url:"api/v1/projects{/id}/volumes{/volume_id}"},detachVolume:{method:"DELETE",url:"api/v1/projects{/id}/volumes{/volume_id}"},addUser:{method:"POST",url:"api/v1/projects{/id}/users{/user_id}"},updateUser:{method:"PUT",url:"api/v1/projects{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/projects{/id}/users{/user_id}"},queryAvailableLabelTrees:{method:"GET",url:"api/v1/projects{/id}/label-trees/available"},attachLabelTree:{method:"POST",url:"api/v1/projects{/id}/label-trees"},detachLabelTree:{method:"DELETE",url:"api/v1/projects{/id}/label-trees{/label_tree_id}"}}),Nt=Vue.resource("api/v1/users{/id}",{},{find:{method:"GET",url:"api/v1/users/find{/query}"}}),Bt=Vue.resource("api/v1/volumes{/id}"),Ut=ft({props:{active:{type:Boolean,required:!0},fancy:{type:Boolean,default:!1}},computed:{classObject:function(){return{"loader--active":this.active,"loader--fancy":this.fancy}}}},(function(){var t=this.$createElement;return(this._self._c||t)("span",{staticClass:"loader",class:this.classObject})}),[],!1,null,null,null).exports,Gt=ft({components:{loader:Ut},props:{active:{type:Boolean,required:!0}},computed:{classObject:function(){return{"loader-block--active":this.active}}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loader-block",class:this.classObject},[e("loader",{attrs:{active:this.active,fancy:!0}})],1)}),[],!1,null,null,null).exports,zt=ft({props:{member:{type:Object,required:!0},ownId:{type:Number,required:!0},editing:{type:Boolean,required:!0},roles:{type:Array,required:!0}},data:function(){return{roleId:null}},computed:{isOwnUser:function(){return this.member.id===this.ownId},name:function(){return this.member.firstname+" "+this.member.lastname},role:function(){var t=this;return this.roles.find((function(e){return t.member.role_id===e.id}))}},methods:{removeMember:function(){this.$emit("remove",this.member)},changeRole:function(){this.$emit("update",this.member,{role_id:this.roleId})}},created:function(){this.roleId=this.member.role_id}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"list-group-item clearfix"},[i("span",{staticClass:"pull-right"},[t.editing&&!t.isOwnUser?i("span",[i("form",{staticClass:"form-inline"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.roleId,expression:"roleId"}],staticClass:"form-control input-sm",attrs:{title:"Change the role of "+t.name},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.roleId=e.target.multiple?i:i[0]},t.changeRole]}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default btn-sm",attrs:{type:"button",title:"Remove "+t.name},on:{click:t.removeMember}},[t._v("Remove")])])]):i("span",[i("span",{staticClass:"text-muted",domProps:{textContent:t._s(t.role.name)}})])]),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.isOwnUser?i("span",{staticClass:"text-muted"},[t._v("(you)")]):t._e()])}),[],!1,null,null,null).exports,Vt=ft({components:{typeahead:VueStrap.typeahead},props:{items:{type:Array,required:!0},placeholder:{type:String,default:"Item name"},disabled:{type:Boolean,default:!1},value:{type:String,default:""},clearOnSelect:{type:Boolean,default:!1},template:{default:"{{item.name}}"}},methods:{selectItem:function(t){if(t)return this.$emit("select",t),this.clearOnSelect?null:t.name},clear:function(){this.$emit("select",void 0)},updateValue:function(){this.$refs.typeahead.setValue(this.value)},emitFocus:function(t){this.$emit("focus",t)},emitBlur:function(t){this.$emit("blur",t)}},watch:{value:function(){this.updateValue()}},mounted:function(){this.updateValue(),this.$refs.typeahead.$el.firstChild.addEventListener("focus",this.emitFocus),this.$refs.typeahead.$el.firstChild.addEventListener("blur",this.emitBlur)}},(function(){var t=this.$createElement;return(this._self._c||t)("typeahead",{ref:"typeahead",staticClass:"typeahead clearfix",attrs:{"match-property":"name",data:this.items,disabled:this.disabled,"on-hit":this.selectItem,placeholder:this.placeholder,template:this.template},on:{clear:this.clear}})}),[],!1,null,null,null).exports,qt=ft({data:function(){return{editing:!1}},methods:{startEditing:function(){this.editing=!0,this.$emit("editing.start")},finishEditing:function(){this.editing=!1,this.$emit("editing.stop")},toggleEditing:function(){this.editing?this.finishEditing():this.startEditing()}}},void 0,void 0,!1,null,null,null).exports,Wt={},Kt=function(t,e,i){Wt.hasOwnProperty(i)&&window.clearTimeout(Wt[i]),Wt[i]=window.setTimeout(t,e)},Xt=new Vue({data:{params:{}},methods:{setSlug:function(t){var e=window.location.pathname.replace(/\/$/,""),i=e.substring(0,e.lastIndexOf("/")+1)+t;this.replaceState(window.location.href.replace(e,i))},set:function(t){this.params=t,this.updateSearch()},unset:function(t){delete this.params[t],this.updateSearch()},get:function(t){return this.params[t]},updateSearch:function(){var t=[],e=window.location.href;for(var i in this.params)this.params.hasOwnProperty(i)&&t.push(i+"="+this.params[i]);t=t.length>0?"?"+t.join("&"):"",window.location.search?this.replaceState(e.replace(window.location.search,t)):-1!==e.indexOf("#")?window.location.hash?this.replaceState(e.replace(window.location.hash,t+window.location.hash)):this.replaceState(e.slice(0,-1)+t):this.replaceState(e+t)},replaceState:function(t){history.replaceState(null,null,t)}},created:function(){var t=window.location.search.substr(1);if(t)for(var e,i=(t=t.split("&")).length-1;i>=0;i--)e=t[i].split("="),this.params[e[0]]=e[1]}}),Ht={},Yt={},Zt=function(t,e,i){Yt[i]=t,Ht.hasOwnProperty(i)||(Ht[i]=window.setTimeout((function(){Yt[i](),delete Ht[i]}),e))},Jt=new Vue({data:{max:1,all:[]},methods:{post:function(t,e){document.fullscreenElement&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),this.all.unshift({id:Date.now(),type:t,text:e}),this.all.length>this.max&&this.all.pop()},danger:function(t){this.post("danger",t)},warning:function(t){this.post("warning",t)},success:function(t){this.post("success",t)},info:function(t){this.post("info",t)},close:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},handleErrorResponse:function(t){var e=t.body;if(e){if(422===t.status&&e.errors){for(var i in e.errors)this.danger(e.errors[i][0]);return}if(e.message)return void this.danger(e.message);if("string"==typeof e)return void this.danger(e)}403===t.status?this.danger("You have no permission to do that."):401===t.status?this.danger("Please log in (again)."):this.danger("The server didn't respond, sorry.")},handleResponseError:function(t){return this.handleErrorResponse(t)}}}),Qt=Jt.handleErrorResponse,te=ft(Jt,void 0,void 0,!1,null,null,null).exports,ee=ft({mixins:[qt],components:{typeahead:Vt,memberListItem:zt,loader:Ut},data:function(){return{selectedMember:null,selectedRole:null,users:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},props:{members:{type:Array,required:!0},roles:{type:Array,required:!0},ownId:{type:Number,required:!0},defaultRole:{type:Number},loading:{type:Boolean,default:!1}},computed:{classObject:function(){return{"panel-warning":this.editing}},availableUsers:function(){return this.users.filter(this.isntMember)},canAttachMember:function(){return!this.loading&&this.selectedMember&&this.selectedRole},hasMembers:function(){return this.members.length>0},selectedMemberName:function(){return this.selectedMember?this.selectedMember.name:""},memberIds:function(){return this.members.map((function(t){return t.id}))}},methods:{selectMember:function(t){this.selectedMember=t},attachMember:function(){var t={id:this.selectedMember.id,role_id:this.selectedRole,firstname:this.selectedMember.firstname,lastname:this.selectedMember.lastname};this.$emit("attach",t),this.selectedMember=null},updateMember:function(t,e){this.$emit("update",t,e)},removeMember:function(t){this.$emit("remove",t)},loadUsers:function(){Nt.query().then(this.usersLoaded,te.handleResponseError)},usersLoaded:function(t){t.data.forEach((function(t){t.name=t.firstname+" "+t.lastname})),Vue.set(this,"users",t.data)},isntMember:function(t){return-1===this.memberIds.indexOf(t.id)}},created:function(){this.defaultRole?this.selectedRole=this.defaultRole:this.selectedRole=this.roles[0].id,this.$once("editing.start",this.loadUsers)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel panel-default",class:t.classObject},[i("div",{staticClass:"panel-heading"},[t._v("\n        Members\n        "),i("span",{staticClass:"pull-right"},[i("loader",{attrs:{active:t.loading}}),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",class:{active:t.editing},attrs:{title:"Edit members"},on:{click:t.toggleEditing}},[i("span",{staticClass:"fa fa-pencil-alt",attrs:{"aria-hidden":"true"}})])],1)]),t._v(" "),t.editing?i("div",{staticClass:"panel-body"},[i("form",{staticClass:"form-inline",on:{submit:function(e){return e.preventDefault(),t.attachMember(e)}}},[i("div",{staticClass:"form-group"},[i("typeahead",{attrs:{items:t.availableUsers,placeholder:"User name",value:t.selectedMemberName,template:t.typeaheadTemplate},on:{select:t.selectMember}}),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedRole,expression:"selectedRole"}],staticClass:"form-control",attrs:{title:"Role of the new user"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedRole=e.target.multiple?i:i[0]}}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.canAttachMember}},[t._v("Add")])],1)])]):t._e(),t._v(" "),i("ul",{staticClass:"list-group list-group-restricted"},[t._l(t.members,(function(e){return i("member-list-item",{key:e.id,attrs:{member:e,"own-id":t.ownId,editing:t.editing,roles:t.roles},on:{update:t.updateMember,remove:t.removeMember}})})),t._v(" "),t.hasMembers?t._e():i("li",{staticClass:"list-group-item list-group-item-info"},[t._t("default")],2)],2)])}),[],!1,null,null,null).exports,ie=ft({props:{active:{type:Boolean,required:!0},title:{type:String,default:""},titleOn:{type:String,default:""},titleOff:{type:String,default:""},type:{type:String,default:"info"},icon:{type:String,default:"power-off"}},computed:{currentTitle:function(){return this.active?this.titleOn||this.title:this.titleOff||this.title},label:function(){return this.$slots.default?this.$slots.default[0].text:""},objectClass:function(){var t={active:this.active};return t["btn-".concat(this.type)]=this.active,t},iconClass:function(){return"fa-".concat(this.icon)}},methods:{handleClick:function(){this.active?this.$emit("off"):this.$emit("on")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"power-toggle"},[i("button",{staticClass:"btn btn-default",class:t.objectClass,attrs:{type:"button",title:t.currentTitle},on:{click:t.handleClick}},[i("i",{staticClass:"fa fa-fw",class:t.iconClass})]),t._v(" "),t.label?i("span",{staticClass:"power-toggle__label",domProps:{textContent:t._s(t.label)}}):t._e()])}),[],!1,null,null,null).exports,ne=ft({props:{tab:{type:Object,required:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}}},computed:{highlightClass:function(){return"string"==typeof this.tab.highlight?"btn-".concat(this.tab.highlight):"btn-info"},iconClass:function(){return"fa fa-".concat(this.tab.icon)},chevronClass:function(){return"fa fa-chevron-".concat(this.direction)},classObject:function(){var t={active:this.open};return!1!==this.tab.highlight&&(t[this.highlightClass]=!0),t},disabled:function(){return this.tab.disabled},href:function(){return this.disabled?null:this.tab.href},open:function(){return this.tab.open}},methods:{toggle:function(t){this.disabled||this.href||(t.preventDefault(),this.open?this.$parent.$emit("close",this.tab.name):this.$parent.$emit("open",this.tab.name))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"sidebar__button btn btn-default btn-lg",class:t.classObject,attrs:{href:t.href,disabled:t.disabled,title:t.tab.title},on:{click:t.toggle}},[t.open?i("span",{class:t.chevronClass,attrs:{"aria-hidden":"true"}}):i("span",{class:t.iconClass,attrs:{"aria-hidden":"true"}})])}),[],!1,null,null,null).exports,re=new Vue,oe=ft(new Vue({data:{activeListenerSetName:"default",listenerSets:{default:{}},compatibilityMaps:[{hyper:"os",meta:"os",super:"os"},{meta:"os",scrolllock:"Scroll"," ":"spacebar",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up",crsel:"crsel",delete:"del",exsel:"exsel",contextmenu:"apps",escape:"esc"}],ignoredTags:["input","textarea","select"],pressedKeysArray:[]},computed:{activeListenerSet:function(){return this.listenerSets[this.activeListenerSetName]||{}},pressedKeys:function(){return this.pressedKeysArray.slice().sort().join("+")}},methods:{isKeyIdentifier:function(t){return"string"==typeof t||t instanceof String},prepareKeys:function(t){var e=this;return Array.isArray(t)||(t=t.split("+")),t.slice().map((function(t){if(!e.isKeyIdentifier(t))throw"".concat(t," is not a valid key.");return t.toLowerCase()})).sort()},shouldIgnoreTarget:function(t){return-1!==this.ignoredTags.indexOf(t.target.tagName.toLowerCase())},handleKeyDown:function(t){t=t||event,this.shouldIgnoreTarget(t)||(this.pressedKeysArray.push(t.key.toLowerCase()),this.maybeInjectModifierKeys(t),this.handleKeyEvents(t,this.pressedKeys))},maybeInjectModifierKeys:function(t){t.altKey&&-1===this.pressedKeysArray.indexOf("alt")&&this.pressedKeysArray.push("alt"),t.ctrlKey&&-1===this.pressedKeysArray.indexOf("control")&&this.pressedKeysArray.push("control"),t.metaKey&&-1===this.pressedKeysArray.indexOf("meta")&&this.pressedKeysArray.push("meta"),t.shiftKey&&-1===this.pressedKeysArray.indexOf("shift")&&this.pressedKeysArray.push("shift")},handleKeyUp:function(t){var e=this.pressedKeysArray.indexOf(t.key.toLowerCase());-1!==e&&this.pressedKeysArray.splice(e,1)},handleKeyEvents:function(t,e){this.activeListenerSet.hasOwnProperty(e)&&this.executeCallbacks(this.activeListenerSet[e],t)},clearPressedKeys:function(){this.pressedKeysArray=[]},executeCallbacks:function(t,e){e.preventDefault();for(var i=t.length-1;i>=0;i--)if(!1===t[i].callback(e))return},on:function(t,e,i,n){var r=this,o=(t=this.prepareKeys(t)).join("+");this.compatibilityMaps.forEach((function(s){var a=t.map((function(t){return s.hasOwnProperty(t)?s[t]:t}));o!==a.join("+")&&r.on(a,e,i,n)}));var s={callback:e,priority:i=i||0};n=n||"default",this.listenerSets.hasOwnProperty(n)||(this.listenerSets[n]={});var a=this.listenerSets[n];if(a.hasOwnProperty(o)){var l,u=a[o];for(l=0;l<u.length&&!(u[l].priority>=i);l++);l===u.length-1?u.push(s):u.splice(l,0,s)}else a[o]=[s]},off:function(t,e,i){t=this.prepareKeys(t).join("+"),i=i||"default";var n=this.listenerSets[i];if(n&&n.hasOwnProperty(t))for(var r=n[t],o=r.length-1;o>=0;o--)if(r[o].callback===e){r.splice(o,1);break}},setActiveSet:function(t){this.activeListenerSetName=t}},created:function(){document.body.addEventListener("keydown",this.handleKeyDown),document.body.addEventListener("keyup",this.handleKeyUp),window.addEventListener("focus",this.clearPressedKeys)}}),void 0,void 0,!1,null,null,null).exports,se=ft({components:{sidebarButton:ne},data:function(){return{open:!1,tabs:[],lastOpenedTab:null,tabIdSequence:0}},props:{openTab:{type:String},showButtons:{type:Boolean,default:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}},toggleOnKeyboard:{type:Boolean,default:!1}},computed:{classObject:function(){return{"sidebar--open":this.open,"sidebar--left":this.isLeft,"sidebar--right":!this.isLeft}},isLeft:function(){return"left"===this.direction}},methods:{registerTab:function(t){t.id=this.tabIdSequence++,this.tabs.push(t)},handleOpenTab:function(t){this.open=!0,this.lastOpenedTab=t,this.$emit("toggle",t),re.$emit("sidebar.toggle",t),re.$emit("sidebar.open.".concat(t))},handleCloseTab:function(t){this.open=!1,this.$emit("toggle",t),re.$emit("sidebar.toggle",t),re.$emit("sidebar.close.".concat(t))},toggleLastOpenedTab:function(t){this.open?(t.preventDefault(),this.$emit("close",this.lastOpenedTab)):this.lastOpenedTab?(t.preventDefault(),this.$emit("open",this.lastOpenedTab)):this.tabs.length>0&&(t.preventDefault(),this.$emit("open",this.tabs[0].name))}},watch:{openTab:function(t){this.$emit("open",t)}},created:function(){this.$on("open",this.handleOpenTab),this.$on("close",this.handleCloseTab),this.toggleOnKeyboard&&oe.on("Tab",this.toggleLastOpenedTab)},mounted:function(){this.openTab&&this.$emit("open",this.openTab)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("aside",{staticClass:"sidebar",class:t.classObject},[t.showButtons?i("div",{staticClass:"sidebar__buttons"},t._l(t.tabs,(function(e){return i("sidebar-button",{key:e.id,attrs:{tab:e,direction:t.direction}})})),1):t._e(),t._v(" "),i("div",{staticClass:"sidebar__tabs"},[t._t("default")],2)])}),[],!1,null,null,null).exports,ae=ft({data:function(){return{id:null,open:!1}},props:{name:{type:String,required:!0},icon:{type:String,required:!0},title:{type:String},href:{type:String},disabled:{type:Boolean,default:!1},highlight:{default:!1}},computed:{classObject:function(){return{"sidebar__tab--open":this.open}}},beforeCreate:function(){var t=this;this.$parent.$on("open",(function(e){t.open=e===t.name})),this.$parent.$on("close",(function(){t.open=!1})),this.$parent.registerTab(this)}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"sidebar__tab",class:this.classObject},[this._t("default")],2)}),[],!1,null,null,null).exports,le=ft({components:{loader:Ut,loaderBlock:Gt},data:function(){return{instancesLoading:0}},computed:{loading:function(){return this.instancesLoading>0}},watch:{loading:function(t){this.$emit("loading",t)}},methods:{startLoading:function(){this.instancesLoading+=1},finishLoading:function(){this.instancesLoading>0&&(this.instancesLoading-=1)},handleErrorResponse:function(t){return te.handleErrorResponse(t)}}},void 0,void 0,!1,null,null,null).exports,ue=ft(Vue.extend({data:function(){return{urlParams:[],storageKey:"biigle.settings",defaults:{},data:{}}},methods:{set:function(t,e){e===this.defaults[t]?this.delete(t):this.has(t)?this.data[t]=e:Vue.set(this.data,t,e),Kt(this.persist,100,this.storageKey)},delete:function(t){Vue.delete(this.data,t),this.persist()},get:function(t){return this.has(t)?this.data[t]:this.defaults[t]},has:function(t){return this.data.hasOwnProperty(t)},persist:function(){Object.keys(this.data).length>0?window.localStorage.setItem(this.storageKey,JSON.stringify(this.data)):window.localStorage.removeItem(this.storageKey)},restoreFromLocalStorage:function(){var t=JSON.parse(window.localStorage.getItem(this.storageKey));t&&Vue.set(this,"data",t)},restoreFromUrlParams:function(t){var e=this,i=Xt.params;(t=t||Object.keys(i)).forEach((function(t){i.hasOwnProperty(t)&&Vue.set(e.data,t,i[t])}))},watch:function(t,e){return this.$watch("data.".concat(t),e)}},created:function(){this.restoreFromLocalStorage(),this.urlParams.length>0&&this.restoreFromUrlParams(this.urlParams)}}),void 0,void 0,!1,null,null,null).exports;window.biigle={},window.biigle.$mount=At,window.biigle.$declare=function(t,e){var i=(t=t.split(".")).pop();return Pt(t)[i]=e,e},window.biigle.$require=Pt,biigle.$declare("api.annotations",Rt),biigle.$declare("api.images",Lt),biigle.$declare("api.labels",Mt),biigle.$declare("api.labelSource",Ft),biigle.$declare("api.labelTree",Ot),biigle.$declare("api.labelTreeVersion",Dt),biigle.$declare("api.notifications",jt),biigle.$declare("api.projects",$t),biigle.$declare("api.users",Nt),biigle.$declare("api.volumes",Bt),biigle.$declare("core.components.loader",Ut),biigle.$declare("core.components.loaderBlock",Gt),biigle.$declare("core.components.membersPanel",ee),biigle.$declare("core.components.powerToggle",ie),biigle.$declare("core.components.sidebar",se),biigle.$declare("core.components.sidebarTab",ae),biigle.$declare("core.components.typeahead",Vt),biigle.$declare("messages",te),biigle.$declare("messages.store",te),window.$biiglePostMessage=te.post,biigle.$declare("core.mixins.editor",qt),biigle.$declare("core.mixins.loader",le),biigle.$declare("core.models.Settings",ue),biigle.$declare("utils.debounce",Kt),biigle.$declare("utils.urlParams",Xt),biigle.$declare("urlParams",Xt),biigle.$declare("utils.throttle",Zt),biigle.$declare("events",re),biigle.$declare("keyboard",oe),biigle.$declare("core.keyboard",oe);var he=ft({components:{message:{props:{id:{type:Number,required:!0},text:{type:String,required:!0},type:{type:String,default:"info"}},computed:{typeClass:function(){return"alert-".concat(this.type)}},methods:{close:function(){te.close(this.id)},cancelTimeout:function(){this.closeTimeoutId&&(window.clearTimeout(this.closeTimeoutId),this.closeTimeoutId=null)}},mounted:function(){"danger"!==this.type&&(this.closeTimeoutId=window.setTimeout(this.close,15e3))}}},data:function(){return{messages:te.all}},mounted:function(){var t=biigle.$require("staticMessage");t.text&&t.type&&this.$nextTick((function(){te.post(t.type,t.text)}))}},void 0,void 0,!1,null,null,null).exports,ce=ft(new Vue({data:{all:[],initialized:!1},computed:{unread:function(){return this.all.filter((function(t){return null===t.read_at}))},count:function(){return this.all.length},countUnread:function(){return this.unread.length}},methods:{remove:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},initialize:function(){if(!this.initialized){var t=biigle.$require("initialNotifications");this.all=t||[],this.initialized=!0}}}}),void 0,void 0,!1,null,null,null).exports,de=ft({components:{notification:{props:["item","removeItem"],data:function(){return{isLoading:!1}},computed:{classObject:function(){return this.item.data.type?"panel-".concat(this.item.data.type):"panel-default"},isUnread:function(){return null===this.item.read_at}},methods:{markRead:function(){var t=this;return this.isLoading=!0,jt.markRead({id:this.item.id},{}).then((function(){t.item.read_at=new Date,t.removeItem&&ce.remove(t.item.id)})).catch(te.handleErrorResponse).finally((function(){t.isLoading=!1}))},markReadAndOpenLink:function(){var t=this.item.data.actionLink;this.item.read_at?window.location=t:this.markRead().finally((function(){window.location=t}))}}}},data:function(){return{notifications:[]}},computed:{hasNotifications:function(){return ce.count>0},hasUnreadNotifications:function(){return ce.countUnread>0}},created:function(){ce.initialize(),this.notifications=ce.all}},void 0,void 0,!1,null,null,null).exports,pe=ft({computed:{unread:function(){return ce.initialized?ce.countUnread:parseInt(this.$el.attributes.unread.value)},hasUnread:function(){return this.unread>0},unreadText:function(){return this.hasUnread?this.unread:"no"},title:function(){return"You have ".concat(this.unreadText," unread notification(s)")}}},void 0,void 0,!1,null,null,null).exports,fe=ft({computed:{count:function(){return ce.countUnread}}},void 0,void 0,!1,null,null,null).exports,ge=ft({data:function(){return{body:""}},beforeMount:function(){var t=document.getElementById("system-messages-edit-form").querySelector('textarea[name="body"]');t&&(this.body=t.value)}},void 0,void 0,!1,null,null,null).exports;At("messages-display",he),At("notifications-list",de),At("notifications-navbar-indicator",pe),At("notifications-unread-count",fe),At("system-messages-edit-form",ge);i("+uf4");var me=ft({name:"label-tree-label",data:function(){return{hover:!1,editing:!1,oldName:"",oldColor:"",newName:"",newColor:""}},props:{label:{type:Object,required:!0},showFavourites:{type:Boolean,required:!1},editable:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{showColor:function(){return!this.expandable||!this.hover},showChevronUp:function(){return!this.showColor&&this.label.open},showChevronDown:function(){return!this.showColor&&!this.label.open},classObject:function(){return{"label-tree-label--selected":this.label.selected,"label-tree-label--expandable":this.expandable,"label-tree-label--editing":this.editing}},colorStyle:function(){return{"background-color":"#"+this.label.color}},chevronStyle:function(){return{color:"#"+this.label.color}},favouriteClass:function(){return{selected:this.label.favourite}},favouriteTitle:function(){return(this.label.favourite?"Remove":"Add")+" as favourite"},editTitle:function(){return"Edit label "+this.label.name},deleteTitle:function(){return"Remove label "+this.label.name},expandable:function(){return!this.flat&&!!this.label.children}},methods:{toggleSelect:function(t){this.editing||(t.preventDefault(),this.label.selected?this.$emit("deselect",this.label,t):this.$emit("select",this.label,t))},editThis:function(){this.editing=!0,this.oldName=this.label.name,this.oldColor=this.label.color,this.newName=this.label.name,this.newColor="#"+this.label.color},saveThis:function(){var t=this;this.label.name=this.newName,this.label.color=this.newColor.substr(1),this.editing=!1,this.oldName===this.label.name&&this.oldColor===this.label.color||this.emitSave(this.label,(function(){return t.editing=!0}))},revertThis:function(){this.editing=!1,this.label.name=this.oldName,this.label.color=this.oldColor},deleteThis:function(){this.emitDelete(this.label)},toggleOpen:function(t){this.editing||(this.expandable?this.label.open=!this.label.open:this.toggleSelect(t))},toggleFavourite:function(){this.label.favourite?this.emitRemoveFavourite(this.label):this.emitAddFavourite(this.label)},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitDelete:function(t){this.$emit("delete",t)},emitSave:function(t,e){this.$emit("save",t,e)},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},doHover:function(){this.hover=!0},dontHover:function(){this.hover=!1}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"label-tree-label",class:t.classObject},[i("div",{staticClass:"label-tree-label__name",on:{click:t.toggleOpen,mouseover:t.doHover,mouseleave:t.dontHover}},[t.editing?i("span",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newColor,expression:"newColor"}],staticClass:"form-control input-sm label-tree-color-input",attrs:{type:"color"},domProps:{value:t.newColor},on:{input:function(e){e.target.composing||(t.newColor=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.newName,expression:"newName"}],staticClass:"form-control input-sm label-tree-label__name-input",attrs:{type:"text"},domProps:{value:t.newName},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveThis(e)},input:function(e){e.target.composing||(t.newName=e.target.value)}}})]):i("span",[i("span",{directives:[{name:"show",rawName:"v-show",value:t.showColor,expression:"showColor"}],staticClass:"label-tree-label__color",style:t.colorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronDown,expression:"showChevronDown"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--down",style:t.chevronStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronUp,expression:"showChevronUp"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--up",style:t.chevronStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)},on:{click:function(e){return e.stopPropagation(),t.toggleSelect(e)},mouseenter:t.dontHover}})]),t._v(" "),i("span",{staticClass:"label-tree-label__buttons"},[t.showFavourites?i("button",{staticClass:"label-tree-label__favourite",class:t.favouriteClass,attrs:{type:"button",title:t.favouriteTitle},on:{click:function(e){return e.stopPropagation(),t.toggleFavourite(e)}}},[i("span",{staticClass:"fa fa-star",attrs:{"aria-hidden":"true",title:""}})]):t._e(),t._v(" "),t.editable&&!t.editing?i("button",{attrs:{title:t.editTitle},on:{click:function(e){return e.stopPropagation(),t.editThis(e)}}},[i("span",{staticClass:"fa fa-pencil-alt",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.editing?i("button",{staticClass:"text-danger",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.editing?i("button",{attrs:{title:"Revert changes"},on:{click:function(e){return e.stopPropagation(),t.revertThis(e)}}},[i("span",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.editing?i("button",{staticClass:"text-success",attrs:{title:"Save changes"},on:{click:function(e){return e.stopPropagation(),t.saveThis(e)}}},[i("span",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}})]):t._e()])]),t._v(" "),t.expandable&&t.label.open?i("ul",{staticClass:"label-tree__list"},t._l(t.label.children,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),1):t._e()])}),[],!1,null,null,null),ve=ft({data:function(){return{collapsed:!1}},components:{labelTreeLabel:me.exports},props:{name:{type:String,required:!0},labels:{type:Array,required:!0},showTitle:{type:Boolean,default:!0},standalone:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{labelMap:function(){for(var t={},e=this.labels.length-1;e>=0;e--)t[this.labels[e].id]=this.labels[e];return t},compiledLabels:function(){var t={null:[]};return this.flat?this.labels.forEach((function(e){t.null.push(e)})):(this.labels.forEach((function(e){t.hasOwnProperty(e.parent_id)?t[e.parent_id].push(e):t[e.parent_id]=[e]})),this.labels.forEach((function(e){t.hasOwnProperty(e.id)?Vue.set(e,"children",t[e.id]):(Vue.set(e,"children",void 0),e.open=!1)}))),t},rootLabels:function(){return this.compiledLabels.null},collapseTitle:function(){return this.collapsed?"Expand":"Collapse"},hasNoLabels:function(){return 0===this.rootLabels.length}},methods:{hasLabel:function(t){return this.labelMap.hasOwnProperty(t)},getLabel:function(t){return this.labelMap[t]},getParents:function(t){for(var e=[];null!==t.parent_id;)t=this.getLabel(t.parent_id),e.unshift(t.id);return e},getSiblings:function(t){return null===t.parent_id?this.rootLabels:this.getLabel(t.parent_id).children},selectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!0}))},deselectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!1}))},selectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!0,e.selectChildren(t)}))},deselectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!1,e.deselectChildren(t)}))},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitSave:function(t,e){this.$emit("save",t,e)},emitDelete:function(t){this.$emit("delete",t)},conditionSelectSiblings:function(t){return this.allowSelectSiblings&&t.altKey},conditionSelectChildren:function(t){return this.allowSelectChildren&&t.ctrlKey},selectLabel:function(t,e){var i=this;this.multiselect||this.clearSelectedLabels(),t&&this.hasLabel(t.id)&&(t.selected=!0,this.collapsed=!1,this.flat||(this.getParents(t).forEach((function(t){i.getLabel(t).open=!0})),this.multiselect&&(this.conditionSelectSiblings(e)&&this.selectSiblings(t),this.conditionSelectChildren(e)&&(this.selectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.selectChildren)))))},deselectLabel:function(t,e){this.hasLabel(t.id)&&(t.selected=!1,this.conditionSelectSiblings(e)&&this.deselectSiblings(t),this.conditionSelectChildren(e)&&(this.deselectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.deselectChildren)))},clearSelectedLabels:function(){this.labels.forEach((function(t){t.selected=!1}))},collapse:function(){if(this.collapsed)this.collapsed=!1;else{var t=!1;this.labels.forEach((function(e){t|=e.open,e.open=!1})),this.collapsed=!t}},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},addFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!0)},removeFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!1)}},created:function(){this.labels.forEach((function(t){t.hasOwnProperty("open")||Vue.set(t,"open",!1),t.hasOwnProperty("selected")||Vue.set(t,"selected",!1),t.hasOwnProperty("favourite")||Vue.set(t,"favourite",!1)})),this.standalone?(this.$on("select",this.selectLabel),this.$on("deselect",this.deselectLabel)):(this.$parent.$on("select",this.selectLabel),this.$parent.$on("deselect",this.deselectLabel),this.$parent.$on("clear",this.clearSelectedLabels),this.$parent.$on("add-favourite",this.addFavouriteLabel),this.$parent.$on("remove-favourite",this.removeFavouriteLabel))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree"},[t.showTitle?i("h4",{staticClass:"label-tree__title"},[t.collapsible?i("button",{staticClass:"btn btn-default btn-xs pull-right",attrs:{title:t.collapseTitle,type:"button"},on:{click:function(e){return e.stopPropagation(),t.collapse(e)}}},[t.collapsed?i("span",{staticClass:"fa fa-chevron-down",attrs:{"aria-hidden":"true"}}):i("span",{staticClass:"fa fa-chevron-up",attrs:{"aria-hidden":"true"}})]):t._e(),t._v("\n        "+t._s(t.name)+"\n    ")]):t._e(),t._v(" "),t.collapsed?t._e():i("ul",{staticClass:"label-tree__list"},[t._l(t.rootLabels,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites,flat:t.flat},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),t._v(" "),t.hasNoLabels?i("li",{staticClass:"text-muted"},[t._v("No labels")]):t._e()],2)])}),[],!1,null,null,null).exports,ye=ft({mixins:[Vt],props:{template:{default:'<span class="label-typeahead-item"><span v-if="item.color" :style="{\'background-color\': \'#\' + item.color}" class="label-color"></span><span v-text="item.name"></span></span>'}}},void 0,void 0,!1,null,null,null).exports,_e=ft({components:{typeahead:ye,labelTree:ve},data:function(){return{favourites:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.tree.versionedName"></small>'}},props:{trees:{type:Array,required:!0},id:{type:String},typeahead:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},computed:{localeCompareSupportsLocales:function(){try{"foo".localeCompare("bar","i")}catch(t){return"RangeError"===t.name}return!1},labels:function(){var t=[];if(this.trees.forEach((function(e){Array.prototype.push.apply(t,e.labels)})),this.localeCompareSupportsLocales){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});t.sort((function(t,i){return e.compare(t.name,i.name)}))}else t.sort((function(t,e){return t.name<e.name?-1:1}));return t},favouriteIds:function(){return this.favourites.map((function(t){return t.id}))},canHaveMoreFavourites:function(){return this.favourites.length<10},hasFavourites:function(){return this.favourites.length>0},ownId:function(){if(this.id)return this.id;var t=[];for(var e in this.trees)this.trees.hasOwnProperty(e)&&t.push(this.trees[e].id);return t.join("-")},favouriteStorageKey:function(){return"biigle.label-trees.".concat(this.ownId,".favourites")}},methods:{handleSelect:function(t,e){t&&this.$emit("select",t,e)},handleDeselect:function(t,e){this.$emit("deselect",t,e)},clear:function(){this.$emit("clear")},handleAddFavourite:function(t){this.canHaveMoreFavourites&&(this.$emit("add-favourite",t),this.favourites.push(t),this.updateFavouriteStorage())},handleRemoveFavourite:function(t){this.$emit("remove-favourite",t);var e=this.favourites.indexOf(t);-1!==e&&this.favourites.splice(e,1),this.updateFavouriteStorage()},updateFavouriteStorage:function(){this.hasFavourites?localStorage.setItem(this.favouriteStorageKey,JSON.stringify(this.favouriteIds)):localStorage.removeItem(this.favouriteStorageKey)},selectFavourite:function(t){this.favourites[t]&&this.handleSelect(this.favourites[t])}},watch:{trees:{immediate:!0,handler:function(t){t.forEach((function(t){t.version?t.versionedName=t.name+" @ "+t.version.name:t.versionedName=t.name,t.labels.forEach((function(e){e.tree=t}))}))}}},mounted:function(){var t=this;if(this.showFavourites){var e=JSON.parse(localStorage.getItem(this.favouriteStorageKey));if(e){var i=[];this.labels.forEach((function(t){var n=e.indexOf(t.id);-1!==n&&(i[n]=t)})),i.filter(Boolean).forEach((function(e){t.handleAddFavourite(e)}))}for(var n=function(e,i){oe.on(e,(function(){t.selectFavourite(i)}),0,t.listenerSet)},r=1;r<=9;r++)n(r.toString(),r-1);n("0",9)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-trees"},[t.typeahead||t.clearable?i("div",{staticClass:"label-trees__head"},[t.clearable?i("button",{staticClass:"btn btn-default",attrs:{title:"Clear selected labels",type:"button"},on:{click:t.clear}},[i("span",{staticClass:"fa fa-times fa-fw",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.typeahead?i("typeahead",{attrs:{items:t.labels,template:t.typeaheadTemplate,placeholder:"Find label"},on:{select:t.handleSelect}}):t._e()],1):t._e(),t._v(" "),i("div",{staticClass:"label-trees__body"},[t.hasFavourites?i("label-tree",{attrs:{name:"Favourites",labels:t.favourites,"show-favourites":t.showFavourites,flat:!0,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"remove-favourite":t.handleRemoveFavourite}}):t._e(),t._v(" "),t._l(t.trees,(function(e){return i("label-tree",{key:e.id,attrs:{name:e.versionedName,labels:e.labels,multiselect:t.multiselect,"allow-select-siblings":t.allowSelectSiblings,"allow-select-children":t.allowSelectChildren,"show-favourites":t.showFavourites,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"add-favourite":t.handleAddFavourite,"remove-favourite":t.handleRemoveFavourite}})}))],2)])}),[],!1,null,null,null).exports;biigle.$declare("labelTrees.components.labelTrees",_e),biigle.$declare("labelTrees.components.labelTypeahead",ye);var be=ft({mixins:[le,qt],data:function(){return{labelTree:null,ownProjects:[],authorizedProjects:[],authorizedOwnProjects:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>',privateId:null}},components:{typeahead:Vt},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateId},classObject:function(){return{"panel-warning":this.editing}},authorizableProjects:function(){var t=this;return this.ownProjects.filter((function(e){for(var i=t.authorizedProjects.length-1;i>=0;i--)if(t.authorizedProjects[i].id===e.id)return!1;return!0}))},hasAuthorizedProjects:function(){return this.authorizedProjects.length>0}},methods:{fetchOwnProjects:function(){var t=this;$t.query().then((function(e){Vue.set(t,"ownProjects",e.body)}),Qt)},addAuthorizedProject:function(t){var e=this;t&&(this.startLoading(),Ot.addAuthorizedProject({id:this.labelTree.id},{id:t.id}).then((function(){return e.authorizedProjectAdded(t)}),Qt).finally(this.finishLoading))},authorizedProjectAdded:function(t){this.authorizedProjects.push(t),this.authorizedOwnProjects.push(t.id)},removeAuthorizedProject:function(t){var e=this;this.startLoading(),Ot.removeAuthorizedProject({id:this.labelTree.id,project_id:t.id}).then((function(){return e.authorizedProjectRemoved(t)}),Qt).finally(this.finishLoading)},authorizedProjectRemoved:function(t){var e;for(e=this.authorizedProjects.length-1;e>=0;e--)this.authorizedProjects[e].id===t.id&&this.authorizedProjects.splice(e,1);-1!==(e=this.authorizedOwnProjects.indexOf(t.id))&&this.authorizedOwnProjects.splice(e,1)},isOwnProject:function(t){return-1!==this.authorizedOwnProjects.indexOf(t.id)}},created:function(){this.privateId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.authorizedProjects=biigle.$require("labelTrees.authorizedProjects"),this.authorizedOwnProjects=biigle.$require("labelTrees.authorizedOwnProjects"),this.$once("editing.start",this.fetchOwnProjects)}},void 0,void 0,!1,null,null,null).exports,we=[0,.5,.9],xe=[360,1,1],Se=[0,2,2],Ce=function(){for(var t,e=[0,0,0],i=e.length-1;i>=0;i--)t=10*Se[i],e[i]=(xe[i]-we[i])*Math.random()+we[i],e[i]=0!==t?Math.round(e[i]*t)/t:Math.round(e[i]);return"#"+function(t){return t.map((function(t){return 1===(t=t.toString(16)).length?"0"+t:t}))}(function(t){var e,i=t[0]/60,n=Math.floor(i),r=i-n,o=[t[2]*(1-t[1]),t[2]*(1-t[1]*r),t[2]*(1-t[1]*(1-r))];switch(n){case 1:e=[o[1],t[2],o[0]];break;case 2:e=[o[0],t[2],o[2]];break;case 3:e=[o[0],o[1],t[2]];break;case 4:e=[o[2],o[0],t[2]];break;case 5:e=[t[2],o[0],o[1]];break;default:e=[t[2],o[2],o[0]]}return e.map((function(t){return Math.round(255*t)}))}(e)).join("")},Te=ft({props:{labels:{type:Array,required:!0},color:{type:String,default:""},parent:{type:Object,default:null},name:{type:String,default:""}},components:{typeahead:ye},computed:{selectedColor:{get:function(){return this.color},set:function(t){this.$emit("color",t)}},selectedName:{get:function(){return this.name},set:function(t){this.$emit("name",t)}},selectedParent:function(){return this.parent?this.parent.name:""},hasNoLabels:function(){return 0===this.labels.length},hasNoParent:function(){return!this.parent},hasNoName:function(){return!this.name}},methods:{refreshColor:function(){this.selectedColor=Ce()},resetParent:function(){this.$emit("parent",null)},selectLabel:function(t){this.$emit("parent",t)}}},void 0,void 0,!1,null,null,null).exports,Ee=ft({mixins:[Te],methods:{submit:function(){var t={name:this.selectedName,color:this.selectedColor};this.parent&&(t.parent_id=this.parent.id),this.$emit("submit",t)}}},void 0,void 0,!1,null,null,null).exports,Ie=ft({props:{item:{type:Object,required:!0},recursive:{type:Boolean,required:!0},labels:{type:Array,required:!0},parent:{type:Object,default:null}},computed:{classification:function(){return this.item.parents.join(" > ")},buttonTitle:function(){return this.recursive?"Add ".concat(this.item.name," and all WoRMS parents as new labels"):this.parent?"Add ".concat(this.item.name," as a child of ").concat(this.parent.name):"Add ".concat(this.item.name," as a root label")},classObject:function(){return{"list-group-item-success":this.selected}},selected:function(){var t=this;return this.labels.some((function(e){return e.source_id==t.item.aphia_id}))}},methods:{select:function(){this.selected||this.$emit("select",this.item)}}},void 0,void 0,!1,null,null,null),ke=ft({mixins:[Te],components:{wormsResultItem:Ie.exports},data:function(){return{results:[],recursive:!1,hasSearched:!1,unaccepted:!1,worms:null}},computed:{hasResults:function(){return this.results.length>0},recursiveButtonClass:function(){return{active:this.recursive,"btn-info":this.recursive}},unacceptedButtonClass:function(){return{active:this.unaccepted,"btn-info":this.unaccepted}}},methods:{findName:function(){var t=this;this.$emit("load-start");var e={id:this.worms.id,query:this.selectedName};this.unaccepted&&(e.unaccepted="true"),Ft.query(e).then(this.updateResults,Qt).finally((function(){t.hasSearched=!0,t.$emit("load-finish")}))},updateResults:function(t){this.results=t.data},importItem:function(t){var e={name:t.name,color:this.selectedColor,source_id:t.aphia_id,label_source_id:this.worms.id};this.recursive?e.recursive="true":this.parent&&(e.parent_id=this.parent.id),this.$emit("submit",e)},toggleRecursive:function(){this.recursive=!this.recursive},toggleUnaccepted:function(){this.unaccepted=!this.unaccepted}},created:function(){this.worms=biigle.$require("labelTrees.wormsLabelSource")}},void 0,void 0,!1,null,null,null).exports,Ae=ft({mixins:[le,qt],data:function(){return{labelTree:null,labels:[],selectedColor:Ce(),selectedLabel:null,selectedName:""}},components:{tabs:VueStrap.tabs,tab:VueStrap.tab,labelTree:ve,manualLabelForm:Ee,wormsLabelForm:ke},computed:{classObject:function(){return{"panel-warning":this.editing}}},methods:{saveLabel:function(t,e){this.startLoading(),Mt.update({id:t.id},{name:t.name,color:t.color}).catch((function(t){e(),Qt(t)})).finally(this.finishLoading)},deleteLabel:function(t){var e=this;this.startLoading(),Mt.delete({id:t.id}).then((function(){e.labelDeleted(t)}),Qt).finally(this.finishLoading)},labelDeleted:function(t){this.selectedLabel&&this.selectedLabel.id===t.id&&this.deselectLabel(t);for(var e=this.labels.length-1;e>=0;e--)if(this.labels[e].id===t.id){this.labels.splice(e,1);break}},selectLabel:function(t){this.selectedLabel=t,t?(this.selectedColor="#"+t.color,this.$emit("select",t),re.$emit("selectLabel",t)):(this.$emit("clear"),re.$emit("selectLabel",null))},deselectLabel:function(t){this.selectedLabel=null,this.$emit("deselect",t),re.$emit("selectLabel",null)},selectColor:function(t){this.selectedColor=t},selectName:function(t){this.selectedName=t},insertLabel:function(t){Vue.set(t,"open",!1),Vue.set(t,"selected",!1);for(var e=t.name.toLowerCase(),i=0,n=this.labels.length;i<n;i++)if(this.labels[i].name.toLowerCase()>=e)return void this.labels.splice(i,0,t);this.labels.push(t)},createLabel:function(t){this.loading||(this.startLoading(),Mt.save({label_tree_id:this.labelTree.id},t).then(this.labelCreated,Qt).finally(this.finishLoading))},labelCreated:function(t){t.data.forEach(this.insertLabel),this.selectedColor=Ce(),this.selectedName=""}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.labels=biigle.$require("labelTrees.labels")}},void 0,void 0,!1,null,null,null).exports,Pe=ft({mixins:[le],data:function(){return{labelTree:null,members:[],roles:[],defaultRole:null,userId:null}},components:{membersPanel:ee},methods:{attachMember:function(t){var e=this;this.startLoading(),Ot.addUser({id:this.labelTree.id},{id:t.id,role_id:t.role_id}).then((function(){return e.memberAttached(t)}),Qt).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),Ot.updateUser({id:this.labelTree.id,user_id:t.id},{role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),Qt).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),Ot.removeUser({id:this.labelTree.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),Qt).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.members=biigle.$require("labelTrees.members"),this.roles=biigle.$require("labelTrees.roles"),this.defaultRole=biigle.$require("labelTrees.defaultRoleId"),this.userId=biigle.$require("labelTrees.userId")}},void 0,void 0,!1,null,null,null).exports,Re=ft({props:{item:{type:Object,required:!0},disabled:{type:Boolean,required:!1}},computed:{leftLabel:function(){return this.item.left},rightLabel:function(){return this.item.right},hasLeft:function(){return null!==this.leftLabel},hasRight:function(){return null!==this.rightLabel},labelToAdd:function(){return!this.hasLeft&&this.hasRight},labelToRemove:function(){return this.hasLeft&&!this.hasRight},labelsSame:function(){return this.hasLeft&&this.hasRight},leftColorStyle:function(){return{"background-color":"#"+this.leftLabel.color}},rightColorStyle:function(){return{"background-color":"#"+this.rightLabel.color}},classObject:function(){return{success:this.labelToAdd&&!this.accepted,"label-tree-diff-row--added":this.labelToAdd&&this.accepted,danger:this.labelToRemove&&!this.accepted,"label-tree-diff-row--removed":this.labelToRemove&&this.accepted}},labelStyle:function(){return{"padding-left":22*this.item.level+"px"}},addButtonClass:function(){return{"btn-success":this.accepted}},removeButtonClass:function(){return{"btn-danger":this.accepted}},accepted:function(){return this.item.accepted},acceptable:function(){return this.item.acceptable},labelAdded:function(){return this.labelToAdd&&this.accepted},removeTitle:function(){return this.acceptable?"Accept the deletion":"This label cannot be deleted because it or one of its child labels is used"}},methods:{emitResolved:function(){this.$emit("accepted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"label-tree-diff-row",class:t.classObject},[i("td",{staticClass:"label-tree-diff-row__button"},[t.labelToAdd?i("button",{staticClass:"btn btn-sm btn-default",class:t.addButtonClass,attrs:{disabled:t.disabled,title:"Accept the addition"},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-plus"})]):t._e(),t._v(" "),t.labelToRemove?i("button",{staticClass:"btn btn-sm btn-default",class:t.removeButtonClass,attrs:{title:t.removeTitle,disabled:!t.acceptable||t.disabled},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-minus"})]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__left"},[t.hasLeft?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.leftColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.leftLabel.name)}})])]):t._e(),t._v(" "),t.labelAdded?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})])]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__right"},[i("div",{staticClass:"label-tree-label",style:t.labelStyle},[t.hasRight?i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})]):t._e()])])])}),[],!1,null,null,null),Le=ft({components:{labelTreeDiffRow:Re.exports},data:function(){return{diff:[]}},props:{leftLabels:{type:Array,required:!0},leftName:{type:String,default:""},rightLabels:{type:Array,required:!0},rightName:{type:String,default:""},usedLabels:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1}},computed:{leftLabelsById:function(){var t={};return this.leftLabels.forEach((function(e){t[e.id]=e})),t},leftLabelsAsTree:function(){var t=this.generateChildMap(this.leftLabels);return this.generateLabelsAsTree(t.null,t)},rightLabelsAsTree:function(){var t=this.generateChildMap(this.rightLabels);return this.generateLabelsAsTree(t.null,t)},usedLabelMap:function(){var t=this,e={};return this.usedLabels.forEach((function(i){do{e[i]=null,i=t.leftLabelsById[i].parent_id}while(null!==i)})),e},cannotResolveAll:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&e.accepted:t}),!0)},cannotResolveNone:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&!e.accepted:t}),!0)},hasDiff:function(){return this.diff.length>0}},methods:{generateChildMap:function(t){var e={};return t.forEach((function(t){e.hasOwnProperty(t.parent_id)?e[t.parent_id].push(t):e[t.parent_id]=[t]})),e},generateLabelsAsTree:function(t,e){var i=this;return t.map((function(t){return e.hasOwnProperty(t.id)?t.children=i.generateLabelsAsTree(e[t.id],e):t.children=[],t})).sort((function(t,e){return t.name+"-"+t.color<=e.name+"-"+e.color?-1:1}))},generateTreeDiff:function(t,e,i,n){var r=this;for(t=t.slice(),e=e.slice(),i=i||[],n=n||0;t.length>0&&e.length>0;){var o=t[0],s=e[0];o.name===s.name?(t.shift(),e.shift(),i.push({id:o.id,level:n,left:o,right:s}),this.generateTreeDiff(o.children,s.children,i,n+1)):o.name<s.name?(t.shift(),i.push({id:o.id,level:n,accepted:!1,acceptable:!this.usedLabelMap.hasOwnProperty(o.id),left:o,right:null}),this.generateTreeDiff(o.children,[],i,n+1)):(e.shift(),i.push({id:s.id,level:n,accepted:!1,acceptable:!0,left:null,right:s}),this.generateTreeDiff([],s.children,i,n+1))}return t.length>0&&t.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!r.usedLabelMap.hasOwnProperty(t.id),left:t,right:null}),r.generateTreeDiff(t.children,[],i,n+1)})),e.length>0&&e.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!0,left:null,right:t}),r.generateTreeDiff([],t.children,i,n+1)})),i},filterRelevantItems:function(t){var e=[];return t.forEach((function(t,i){null!==t.left&&null!==t.right||e.push(i)})),e.forEach((function(e){t[e].relevant=!0;for(var i=t[e].level,n=e;n>=0&&i>0;)t[n].level<i&&(t[n].relevant=!0,i=t[n].level),n-=1})),t.filter((function(t){return t.relevant}))},handleResolved:function(t){t.acceptable&&(t.accepted?(this.cancelResolved(t),null===t.left?this.acceptCancelAddAllChildren(t):null===t.right&&this.acceptCancelDeleteAllParents(t)):(this.setResolved(t),null===t.left?this.acceptAddAllParents(t):null===t.right&&this.acceptDeleteAllChildren(t)))},cancelResolved:function(t){null===t.left?this.$emit("cancel-add",t.right):null===t.right&&this.$emit("cancel-remove",t.left),t.accepted=!1},setResolved:function(t){null===t.left?this.$emit("add",t.right):null===t.right&&this.$emit("remove",t.left),t.accepted=!0},acceptAll:function(){var t=this;this.diff.forEach((function(e){e.accepted||t.handleResolved(e)}))},acceptNone:function(){var t=this;this.diff.forEach((function(e){e.accepted&&t.handleResolved(e)}))},doForAllChildren:function(t,e){for(var i=t.level+1,n=this.diff.indexOf(t)+1;this.diff[n]&&this.diff[n].level>=i;)e.call(this,this.diff[n]),n+=1},doForAllParents:function(t,e){for(var i=t.level,n=this.diff.indexOf(t)-1;i>0&&n>=0;)this.diff[n].level<i&&(i=this.diff[n].level,e.call(this,this.diff[n])),n-=1},acceptDeleteAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.right&&this.setResolved(t)}))},acceptCancelAddAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.left&&this.cancelResolved(t)}))},acceptAddAllParents:function(t){this.doForAllParents(t,(function(t){null===t.left&&this.setResolved(t)}))},acceptCancelDeleteAllParents:function(t){this.doForAllParents(t,(function(t){null===t.right&&this.cancelResolved(t)}))},setLeftParentIds:function(t){var e={};return t.forEach((function(t){t.right&&t.left&&(e[t.right.id]=t.left.id)})),t.forEach((function(t){t.right&&t.right.parent_id&&(t.right.left_parent_id=e[t.right.parent_id])})),t}},created:function(){var t=this.generateTreeDiff(this.leftLabelsAsTree,this.rightLabelsAsTree);t=this.filterRelevantItems(t),t=this.setLeftParentIds(t),this.diff=t}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree-diff"},[t.hasDiff?i("div",[i("button",{staticClass:"btn btn-default",attrs:{title:"Accept all merge items",disabled:t.cannotResolveAll},on:{click:t.acceptAll}},[t._v("\n                Accept all\n        ")]),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{title:"Set all merge items as not accepted",disabled:t.cannotResolveNone},on:{click:t.acceptNone}},[t._v("\n                Accept none\n        ")])]):t._e(),t._v(" "),t.hasDiff?i("table",{staticClass:"table table-hover"},[i("thead",[i("tr",[i("th"),t._v(" "),i("th",{domProps:{textContent:t._s(t.leftName)}}),t._v(" "),i("th",{domProps:{textContent:t._s(t.rightName)}})])]),t._v(" "),i("tbody",t._l(t.diff,(function(e){return i("label-tree-diff-row",{key:e.id,attrs:{item:e,disabled:t.disabled},on:{accepted:t.handleResolved}})})),1)]):i("div",{staticClass:"text-center lead"},[t._v("\n        The label trees are identical.\n    ")])])}),[],!1,null,null,null).exports,Me=Vue.resource("api/v1/label-trees{/id}/merge-labels"),Fe=ft({mixins:[le],components:{labelTreeDiff:Le},data:function(){return{baseTree:null,mergeTree:null,usedLabels:[],toAdd:[],toRemove:[],merged:!1}},computed:{baseTreeLabels:function(){return this.baseTree.labels},mergeTreeLabels:function(){return this.mergeTree.labels},cannotMerge:function(){return this.loading||0===this.toAdd.length&&0===this.toRemove.length},disableDiff:function(){return this.loading||this.merged}},methods:{handleAdd:function(t){-1===this.toAdd.indexOf(t)&&this.toAdd.push(t)},handleRemove:function(t){-1===this.toRemove.indexOf(t)&&this.toRemove.push(t)},handleCancelAdd:function(t){var e=this.toAdd.indexOf(t);-1!==e&&this.toAdd.splice(e,1)},handleCancelRemove:function(t){var e=this.toRemove.indexOf(t);-1!==e&&this.toRemove.splice(e,1)},bundleToAdd:function(t){var e={};t.forEach((function(t){e[t.id]={name:t.name,color:t.color,parent_id:t.parent_id,left_parent_id:t.left_parent_id}}));var i=[];return Object.keys(e).forEach((function(t){var n=e[t];n.parent_id&&e.hasOwnProperty(n.parent_id)?(e[n.parent_id].children?e[n.parent_id].children.push(n):e[n.parent_id].children=[n],delete n.parent_id,delete n.left_parent_id):(delete n.parent_id,n.left_parent_id&&(n.parent_id=n.left_parent_id),delete n.left_parent_id,i.push(n))})),i},bundleToRemove:function(t){return t.map((function(t){return t.id}))},submitMerge:function(){this.startLoading();var t=this.bundleToAdd(this.toAdd),e=this.bundleToRemove(this.toRemove);Me.save({id:this.baseTree.id},{create:t,remove:e}).then(this.handleMergeSuccess,this.handleMergeError)},handleMergeError:function(t){this.finishLoading(),Qt(t)},handleMergeSuccess:function(){this.merged=!0}},created:function(){this.baseTree=biigle.$require("labelTrees.baseTree"),this.mergeTree=biigle.$require("labelTrees.mergeTree"),this.usedLabels=biigle.$require("labelTrees.usedLabels")}},void 0,void 0,!1,null,null,null).exports,Oe=ft({components:{typeahead:Vt},data:function(){return{mergeUrlTemplate:null,mergeCandidates:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>',chosenCandidate:null}},computed:{cannotContinue:function(){return null===this.chosenCandidate},continueUrl:function(){return this.chosenCandidate?this.mergeUrlTemplate.replace(":id",this.chosenCandidate.id):""}},methods:{parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t},chooseCandidate:function(t){this.chosenCandidate=t}},created:function(){this.mergeUrlTemplate=biigle.$require("labelTrees.mergeUrlTemplate"),this.mergeCandidates=biigle.$require("labelTrees.mergeCandidates").map(this.parseLabelTreeVersionedName)}},void 0,void 0,!1,null,null,null).exports,De=ft({mixins:[le,qt],data:function(){return{labelTree:null,name:null,description:null,visibility_id:null,userId:null,redirectUrl:null,privateVisibilityId:null}},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateVisibilityId},hasDescription:function(){return!!this.description},isChanged:function(){return this.name!==this.labelTree.name||this.description!==this.labelTree.description||parseInt(this.visibility_id)!==this.labelTree.visibility_id}},methods:{discardChanges:function(){this.finishEditing(),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id},leaveTree:function(){confirm("Do you really want to revoke your membership of label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),Ot.removeUser({id:this.labelTree.id,user_id:this.userId}).then(this.treeLeft,Qt).finally(this.finishLoading))},treeLeft:function(){var t=this;this.isPrivate?(te.success("You left the label tree. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)):location.reload()},deleteTree:function(){confirm("Do you really want to delete the label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),Ot.delete({id:this.labelTree.id}).then(this.treeDeleted,Qt).finally(this.finishLoading))},treeDeleted:function(){var t=this;te.success("The label tree was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),Ot.update({id:this.labelTree.id},{name:this.name,description:this.description,visibility_id:this.visibility_id}).then(this.changesSaved,Qt).finally(this.finishLoading)},changesSaved:function(){this.labelTree.name=this.name,this.labelTree.description=this.description,this.labelTree.visibility_id=parseInt(this.visibility_id),this.finishEditing()}},created:function(){this.privateVisibilityId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.userId=biigle.$require("labelTrees.userId"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl"),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id}},void 0,void 0,!1,null,null,null).exports,je=ft({mixins:[le],data:function(){return{version:null,redirectUrl:null}},methods:{deleteVersion:function(){this.startLoading(),Dt.delete({id:this.version.id}).then(this.deleteSuccess,Qt)},deleteSuccess:function(){var t=this;te.success("The label tree version was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)}},created:function(){this.version=biigle.$require("labelTrees.version"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl")}},void 0,void 0,!1,null,null,null).exports,$e=ft({mixins:[le],data:function(){return{doi:"",doiSaved:!1,version:null}},computed:{doiUrl:function(){return"https://doi.org/"+this.doi},doiTitle:function(){return"DOI: "+this.doi}},methods:{cleanDoi:function(t){return t.replace(/^https?:\/\/doi\.org\//,"")},saveDoi:function(){this.doi=this.cleanDoi(this.doi),Dt.update({id:this.version.id},{doi:this.doi}).then(this.handleDoiSaved,Qt)},handleDoiSaved:function(){this.doiSaved=!0}},created:function(){this.version=biigle.$require("labelTrees.version")}},void 0,void 0,!1,null,null,null).exports;biigle.$mount("label-tree-version-title",je),biigle.$mount("label-tree-version-toolbar",$e),biigle.$mount("label-trees-authorized-projects",be),biigle.$mount("label-trees-labels",Ae),biigle.$mount("label-trees-members",Pe),biigle.$mount("label-trees-title",De),biigle.$mount("merge-label-trees-container",Fe),biigle.$mount("merge-label-trees-index-container",Oe);var Ne=ft({props:{id:{type:Number,required:!0},thumbUris:{required:!0},removable:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove this volume"},icon:{type:String}},data:function(){return{index:0,uris:[],hovered:!1}},computed:{progress:function(){return 100*this.index/(this.uris.length-1)+"%"},showFallback:function(){return!1===this.uris[this.index]},showPreview:function(){return this.hovered&&this.someLoaded},someLoaded:function(){return this.uris.reduce((function(t,e){return t||!1!==e}),!1)},iconClass:function(){return this.icon?"fa-"+this.icon:""}},methods:{thumbShown:function(t){return this.index===t&&!this.failed[t]},updateIndex:function(t){var e=this.$el.getBoundingClientRect();this.index=Math.max(0,Math.floor(this.uris.length*(t.clientX-e.left)/e.width))},remove:function(){this.$emit("remove",this.id)},failed:function(t){this.uris.splice(t,1,!1)},updateHovered:function(){this.hovered=!0}},created:function(){Array.isArray(this.thumbUris)?this.uris=this.thumbUris.slice():this.uris=this.thumbUris.split(",")}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"preview-thumbnail",on:{mousemove:function(e){return t.updateIndex(e)},mouseenter:t.updateHovered}},[t.icon?i("i",{staticClass:"preview-thumbnail__icon fas fa-lg",class:t.iconClass}):t._e(),t._v(" "),t.removable?i("span",{staticClass:"preview-thumbnail__close close",attrs:{title:t.removeTitle},on:{click:function(e){return e.preventDefault(),t.remove(e)}}},[t._v("")]):t._e(),t._v(" "),t.showPreview?i("div",{staticClass:"preview-thumbnail__images"},t._l(t.uris,(function(e,n){return i("img",{directives:[{name:"show",rawName:"v-show",value:t.thumbShown(n),expression:"thumbShown(i)"}],attrs:{src:e},on:{error:function(e){return t.failed(n)}}})})),0):i("div",{staticClass:"preview-thumbnail__fallback"},[t._t("default")],2),t._v(" "),t._t("caption"),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.someLoaded,expression:"someLoaded"}],staticClass:"preview-thumbnail__progress",style:{width:t.progress}})],2)}),[],!1,null,null,null).exports;biigle.$declare("projects.components.previewThumbnail",Ne);var Be=ft({components:{previewThumbnail:Ne}},void 0,void 0,!1,null,null,null).exports,Ue=ft({mixins:[le,qt],components:{typeahead:Vt,loader:Ut},data:function(){return{project:null,labelTrees:[],availableLabelTrees:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>'}},computed:{classObject:function(){return{"panel-warning":this.editing}},hasNoLabelTrees:function(){return 0===this.labelTrees.length},labelTreeIds:function(){return this.labelTrees.map((function(t){return t.id}))},attachableLabelTrees:function(){var t=this;return this.availableLabelTrees.filter((function(e){return-1===t.labelTreeIds.indexOf(e.id)}))}},methods:{fetchAvailableLabelTrees:function(){$t.queryAvailableLabelTrees({id:this.project.id}).then(this.availableLabelTreesFetched,Qt)},availableLabelTreesFetched:function(t){this.availableLabelTrees=t.data.map(this.parseLabelTreeVersionedName)},attachTree:function(t){var e=this;t&&(this.startLoading(),$t.attachLabelTree({id:this.project.id},{id:t.id}).then((function(){return e.treeAttached(t)}),Qt).finally(this.finishLoading))},treeAttached:function(t){for(var e=this.availableLabelTrees.length-1;e>=0;e--)this.availableLabelTrees[e].id===t.id&&this.availableLabelTrees.splice(e,1);this.labelTrees.push(t)},removeTree:function(t){var e=this;this.startLoading(),$t.detachLabelTree({id:this.project.id,label_tree_id:t.id}).then((function(){return e.treeRemoved(t)}),Qt).finally(this.finishLoading)},treeRemoved:function(t){for(var e=this.labelTrees.length-1;e>=0;e--)this.labelTrees[e].id===t.id&&this.labelTrees.splice(e,1);this.availableLabelTrees.push(t)},parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t}},created:function(){this.$once("editing.start",this.fetchAvailableLabelTrees),this.labelTrees=biigle.$require("projects.labelTrees").map(this.parseLabelTreeVersionedName),this.project=biigle.$require("projects.project")}},void 0,void 0,!1,null,null,null).exports,Ge=ft({mixins:[le],data:function(){return{project:null,members:[],roles:[],defaultRole:null,userId:null}},components:{membersPanel:ee},methods:{attachMember:function(t){var e=this;this.startLoading(),$t.addUser({id:this.project.id,user_id:t.id},{project_role_id:t.role_id}).then((function(){return e.memberAttached(t)}),Qt).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),$t.updateUser({id:this.project.id,user_id:t.id},{project_role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),Qt).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),$t.removeUser({id:this.project.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),Qt).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},created:function(){this.project=biigle.$require("projects.project"),this.members=biigle.$require("projects.members"),this.roles=biigle.$require("projects.roles"),this.defaultRole=biigle.$require("projects.defaultRoleId"),this.userId=biigle.$require("projects.userId")}},void 0,void 0,!1,null,null,null).exports,ze=ft({mixins:[le,qt],data:function(){return{project:null,name:null,description:null,userId:null,redirectUrl:null}},computed:{hasDescription:function(){return!!this.description.length},isChanged:function(){return this.name!==this.project.name||this.description!==this.project.description}},methods:{discardChanges:function(){this.name=this.project.name,this.description=this.project.description,this.finishEditing()},leaveProject:function(){confirm('Do you really want to revoke your membership of project "'.concat(this.project.name,'"?'))&&(this.startLoading(),$t.removeUser({id:this.project.id,user_id:this.userId}).then(this.projectLeft,Qt).finally(this.finishLoading))},projectLeft:function(){var t=this;te.success("You left the project. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},deleteProject:function(){confirm("Do you really want to delete the project ".concat(this.project.name,"?"))&&(this.startLoading(),$t.delete({id:this.project.id}).then(this.projectDeleted,this.maybeForceDeleteProject).finally(this.finishLoading))},maybeForceDeleteProject:function(t){400===t.status?confirm("Deleting this project will delete one or more volumes with all annotations! Do you want to continue?")&&(this.startLoading(),$t.delete({id:this.project.id},{force:!0}).then(this.projectDeleted,Qt).finally(this.finishLoading)):Qt(t)},projectDeleted:function(){var t=this;te.success("The project was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),$t.update({id:this.project.id},{name:this.name,description:this.description}).then(this.changesSaved,Qt).finally(this.finishLoading)},changesSaved:function(){this.project.name=this.name,this.project.description=this.description,this.finishEditing()}},created:function(){this.project=biigle.$require("projects.project"),this.name=this.project.name,this.description=this.project.description,this.userId=biigle.$require("projects.userId"),this.redirectUrl=biigle.$require("projects.redirectUrl")}},void 0,void 0,!1,null,null,null).exports,Ve=Vue.resource("api/v1/projects{/id}/attachable-volumes"),qe=ft({mixins:[le,qt],data:function(){return{project:null,volumes:[],attachableVolumes:[],filterString:"",fullHeight:0}},components:{previewThumbnail:Ne,typeahead:Vt},computed:{filteredVolumes:function(){if(this.hasFiltering){var t=this.filterString.toLowerCase();return this.volumes.filter((function(e){return-1!==e.name.toLowerCase().indexOf(t)}))}return this.volumes},hasFiltering:function(){return this.filterString.length>0},filterInputClass:function(){return this.hasFiltering?"panel-filter--active":""},hasVolumes:function(){return this.volumes.length>0},panelStyle:function(){return this.hasFiltering?{height:this.fullHeight+"px"}:{}},hasNoMatchingVolumes:function(){return this.hasVolumes&&0===this.filteredVolumes.length}},methods:{removeVolume:function(t){var e=this;this.startLoading(),$t.detachVolume({id:this.project.id,volume_id:t}).then((function(){return e.volumeRemoved(t)}),(function(i){400===i.status?confirm("The volume you are about to remove belongs only to this project and will be deleted. Are you sure you want to delete this volume?")&&e.forceRemoveVolume(t):Qt(i)})).finally(this.finishLoading)},forceRemoveVolume:function(t){var e=this;this.startLoading(),$t.detachVolume({id:this.project.id,volume_id:t},{force:!0}).then((function(){return e.volumeRemoved(t)}),Qt).finally(this.finishLoading)},volumeRemoved:function(t){for(var e=this.volumes.length-1;e>=0;e--)this.volumes[e].id===t&&(this.attachableVolumes.unshift(this.volumes[e]),this.volumes.splice(e,1));this.$nextTick(this.updateFullHeight)},hasVolume:function(t){for(var e=this.volumes.length-1;e>=0;e--)if(this.volumes[e].id===t)return!0;return!1},attachVolume:function(t){var e=this;t&&!this.hasVolume(t.id)&&(this.startLoading(),$t.attachVolume({id:this.project.id,volume_id:t.id},{}).then((function(){return e.volumeAttached(t)}),Qt).finally(this.finishLoading))},volumeAttached:function(t){this.volumes.unshift(t);for(var e=this.attachableVolumes.length-1;e>=0;e--)this.attachableVolumes[e].id===t.id&&this.attachableVolumes.splice(e,1);this.$nextTick(this.updateFullHeight)},fetchAttachableVolumes:function(){Ve.get({id:this.project.id}).then(this.attachableVolumesFetched,Qt)},attachableVolumesFetched:function(t){this.attachableVolumes=t.data},clearFiltering:function(){this.filterString=""},updateFullHeight:function(){this.fullHeight=this.$el.offsetHeight}},created:function(){this.project=biigle.$require("projects.project"),this.volumes=biigle.$require("projects.volumes"),this.$once("editing.start",this.fetchAttachableVolumes)},mounted:function(){this.updateFullHeight()}},void 0,void 0,!1,null,null,null).exports;biigle.$mount("projects-dashboard-main",Be),biigle.$mount("projects-label-trees",Ue),biigle.$mount("projects-members",Ge),biigle.$mount("projects-show-volume-list",qe),biigle.$mount("projects-title",ze);var We=ft({props:{rule:{type:Object,required:!0}},data:function(){return{name:this.rule.id}},computed:{dataName:function(){return this.rule.data?this.rule.data.name:""}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("strong",[t._v("with"),t.rule.negate?i("span",[t._v("out")]):t._e()]),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.dataName?i("strong",{domProps:{textContent:t._s(t.dataName)}}):t._e()])}),[],!1,null,null,null).exports,Ke=ft({components:{typeahead:Vt},props:{volumeId:{type:Number,required:!0}},data:function(){return{items:[],placeholder:"",selectedItem:null,typeaheadTemplate:void 0}},computed:{value:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},gotItems:function(t){this.items=t.data},parseUsernames:function(t){return t.data=t.data.map((function(t){return t.name=t.firstname+" "+t.lastname,t})),t},submit:function(){this.$emit("select",this.selectedItem)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-select"},[i("typeahead",{attrs:{items:t.items,value:t.value,placeholder:t.placeholder,template:t.typeaheadTemplate},on:{select:t.select}}),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.selectedItem},on:{click:t.submit}},[t._v("Add rule")])],1)}),[],!1,null,null,null).exports,Xe=Vue.resource("api/v1/volumes{/id}",{},{queryImagesWithImageLabels:{method:"GET",url:"api/v1/volumes{/id}/images/filter/labels"},queryImagesWithImageLabel:{method:"GET",url:"api/v1/volumes{/id}/images/filter/image-label{/label_id}"},queryImagesWithImageLabelFromUser:{method:"GET",url:"api/v1/volumes{/id}/images/filter/image-label-user{/user_id}"},queryImagesWithFilename:{method:"GET",url:"api/v1/volumes{/id}/images/filter/filename{/pattern}"},queryUsedImageLabels:{method:"GET",url:"api/v1/volumes{/id}/image-labels"},queryFilenames:{method:"GET",url:"api/v1/volumes{/id}/filenames"},queryImageLabels:{method:"GET",url:"api/v1/volumes{/id}/images/labels"},queryUsers:{method:"GET",url:"api/v1/volumes{/id}/users"},queryImages:{method:"GET",url:"api/v1/volumes{/id}/images"},saveImages:{method:"POST",url:"api/v1/volumes{/id}/images"},queryImagesWithAnnotations:{method:"GET",url:"api/v1/volumes{/id}/images/filter/annotations"},queryImagesWithAnnotationLabel:{method:"GET",url:"api/v1/volumes{/id}/images/filter/annotation-label{/label_id}"},queryImagesWithAnnotationFromUser:{method:"GET",url:"api/v1/volumes{/id}/images/filter/annotation-user{/user_id}"},queryAnnotationLabels:{method:"GET",url:"api/v1/volumes{/id}/annotation-labels"}}),He=[{id:"imageLabels",label:"image labels",help:"All images that (don't) have image labels attached.",listComponent:{mixins:[We],data:function(){return{name:"image labels"}}},getSequence:function(t){return Xe.queryImagesWithImageLabels({id:t})}},{id:"imageLabel",label:"image label",help:"All images that (don't) have the given image label attached.",listComponent:{mixins:[We],data:function(){return{name:"image label"}}},selectComponent:{mixins:[Ke],components:{typeahead:ye},data:function(){return{placeholder:"Label name"}},created:function(){Xe.queryUsedImageLabels({id:this.volumeId}).then(this.gotItems,Qt)}},getSequence:function(t,e){return Xe.queryImagesWithImageLabel({id:t,label_id:e.id})}},{id:"imageLabelUser",label:"image label from user",help:"All images that (don't) have one or more image labels attached by the given user.",listComponent:{mixins:[We],data:function(){return{name:"image label from user"}}},selectComponent:{mixins:[Ke],data:function(){return{placeholder:"User name",typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},created:function(){Xe.queryUsers({id:this.volumeId}).then(this.parseUsernames,Qt).then(this.gotItems)}},getSequence:function(t,e){return Xe.queryImagesWithImageLabelFromUser({id:t,user_id:e.id})}},{id:"filename",label:"filename",help:"All images that (don't) have a filename matching the given pattern. A pattern may contain the wildcard character * that matches any string of zero or more characters.",listComponent:{mixins:[We],computed:{dataName:function(){return this.rule.data}}},selectComponent:{template:'<div class="filter-select">\n            <div class="typeahead">\n                <input class="form-control" type="text" v-model="selectedItem" placeholder="Filename pattern">\n            </div>\n            <button type="submit" class="btn btn-default" @click="submit" :disabled="!selectedItem">Add rule</button>\n        </div>',mixins:[Ke]},getSequence:function(t,e){return Xe.queryImagesWithFilename({id:t,pattern:e})}},{id:"annotations",label:"annotations",help:"All images that (don't) contain annotations.",listComponent:We,getSequence:function(t){return Xe.queryImagesWithAnnotations({id:t})}},{id:"annotationLabels",label:"annotation with label",help:"All images that (don't) contain one or more annotations with the given label.",listComponent:{mixins:[We],data:function(){return{name:"annotation with label"}}},selectComponent:{mixins:[Ke],components:{typeahead:ye},data:function(){return{placeholder:"Label name"}},created:function(){Xe.queryAnnotationLabels({id:this.volumeId}).then(this.gotItems,Qt)}},getSequence:function(t,e){return Xe.queryImagesWithAnnotationLabel({id:t,label_id:e.id})}},{id:"annotationUser",label:"annotations from user",help:"All images that (don't) contain one or more annotations from the given user.",listComponent:{mixins:[We],data:function(){return{name:"annotations from user"}}},selectComponent:{mixins:[Ke],data:function(){return{placeholder:"User name",typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},created:function(){Xe.queryUsers({id:this.volumeId}).then(this.parseUsernames,Qt).then(this.gotItems)}},getSequence:function(t,e){return Xe.queryImagesWithAnnotationFromUser({id:t,user_id:e.id})}}],Ye=ft({data:function(){return{url:"",timeout:null}},props:{image:{type:Object,required:!0},emptyUrl:{type:String,required:!0},selectable:{type:Boolean,required:!1},selectedIcon:{type:String,default:"check"},selectedFade:{type:Boolean,default:!0},smallIcon:{type:Boolean,default:!1}},computed:{classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.selectable,"image-grid__image--fade":this.selectedFade,"image-grid__image--small-icon":this.smallIcon}},selected:function(){return!1},iconClass:function(){return"fa-"+this.selectedIcon},showIcon:function(){return this.selectable||this.selected}},methods:{toggleSelect:function(t){this.selectable&&this.$emit("select",this.image,t)},gotBlob:function(t){var e=window.URL||window.webkitURL;this.url=e.createObjectURL(t.body),this.image.blob=this.url},showEmptyImage:function(){this.url=this.emptyUrl}},created:function(){var t=this;this.image.url?this.url=this.image.url:this.image.blob?this.url=this.image.blob:this.getUrl?this.url=this.getUrl():this.getBlob&&(this.timeout=setTimeout((function(){return t.getBlob().then(t.gotBlob)}),50))},beforeDestroy:function(){clearTimeout(this.timeout)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"image-grid__image",class:t.classObject},[t.showIcon?i("div",{staticClass:"image-icon"},[i("i",{staticClass:"fas",class:t.iconClass})]):t._e(),t._v(" "),i("img",{attrs:{src:t.url||t.emptyUrl},on:{click:t.toggleSelect,error:t.showEmptyImage}})])}),[],!1,null,null,null).exports,Ze=ft({data:function(){return{scrolling:!1}},props:{progress:{type:Number,required:!0}},computed:{isAtTop:function(){return 0===this.progress},isAtBottom:function(){return 1===this.progress},progressHeight:function(){return 100*this.progress+"%"}},methods:{top:function(){this.$emit("top")},prevPage:function(){this.$emit("prev-page")},prevRow:function(){this.$emit("prev-row")},beginScrolling:function(){this.scrolling=!0},stopScrolling:function(){this.scrolling=!1},scroll:function(t){this.scrolling&&this.jump(t)},jump:function(t){var e=t.target.getBoundingClientRect();this.$emit("jump",(t.clientY-e.top)/e.height)},nextRow:function(){this.$emit("next-row")},nextPage:function(){this.$emit("next-page")},bottom:function(){this.$emit("bottom")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid-progress"},[i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to top ",disabled:t.isAtTop},on:{click:t.top}},[i("span",{staticClass:"fa fa-fast-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous page  / ",disabled:t.isAtTop},on:{click:t.prevPage}},[i("span",{staticClass:"fa fa-step-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous row  ",disabled:t.isAtTop},on:{click:t.prevRow}},[i("span",{staticClass:"fa fa-chevron-up"})])]),t._v(" "),i("div",{staticClass:"image-grid-progress__bar",on:{mousedown:t.beginScrolling,mouseup:t.stopScrolling,mouseleave:t.stopScrolling,mousemove:function(e){return e.preventDefault(),t.scroll(e)},click:t.jump}},[i("div",{staticClass:"image-grid-progress__wrapper"},[i("div",{staticClass:"image-grid-progress__inner",style:{height:t.progressHeight}})])]),t._v(" "),i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next row  ",disabled:t.isAtBottom},on:{click:t.nextRow}},[i("span",{staticClass:"fa fa-chevron-down"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next page  / ",disabled:t.isAtBottom},on:{click:t.nextPage}},[i("span",{staticClass:"fa fa-step-forward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to bottom ",disabled:t.isAtBottom},on:{click:t.bottom}},[i("span",{staticClass:"fa fa-fast-forward fa-rotate-90"})])])])}),[],!1,null,null,null),Je=ft({data:function(){return{clientWidth:0,clientHeight:0,offset:0,imagesOffset:0,imagesOffsetTimeout:null}},components:{imageGridImage:Ye,imageGridProgress:Ze.exports},props:{images:{type:Array,required:!0},emptyUrl:{type:String,required:!0},width:{type:Number,default:135},height:{type:Number,default:180},margin:{type:Number,default:8},initialOffset:{type:Number,default:0},selectable:{type:Boolean,default:!1},selectedIcon:{type:String,default:"check"},listenerSet:{type:String,default:"default"}},computed:{columns:function(){return Math.max(1,Math.floor(this.clientWidth/(this.width+this.margin)))},rows:function(){return Math.max(1,Math.floor(this.clientHeight/(this.height+this.margin)))},imagesOffsetEnd:function(){return this.imagesOffset+this.columns*this.rows},displayedImages:function(){return this.images.slice(this.imagesOffset,this.imagesOffsetEnd)},progress:function(){return this.offset/(this.columns*this.lastRow)},lastRow:function(){return Math.max(0,Math.ceil(this.images.length/this.columns)-this.rows)},lastOffset:function(){return this.lastRow*this.columns},canScroll:function(){return this.lastRow>0}},methods:{updateDimensions:function(){this.$refs.images&&(this.clientHeight=this.$refs.images.clientHeight,this.clientWidth=this.$refs.images.clientWidth)},scrollRows:function(t,e){this.setOffset(this.offset+this.columns*t,e)},scroll:function(t){this.scrollRows(t.deltaY>=0?1:-1,!0)},advanceRow:function(){this.scrollRows(1)},advancePage:function(){this.scrollRows(this.rows)},reverseRow:function(){this.scrollRows(-1)},reversePage:function(){this.scrollRows(-this.rows)},jumpToPercent:function(t){this.setOffset(this.columns*Math.round(this.lastRow*t))},jumpToStart:function(){this.jumpToPercent(0)},jumpToEnd:function(){this.jumpToPercent(1)},emitSelect:function(t,e){this.$emit("select",t,e)},setOffset:function(t,e){var i=this;this.offset=Math.max(0,Math.min(this.lastOffset,t)),clearTimeout(this.imagesOffsetTimeout),e?this.imagesOffsetTimeout=setTimeout((function(){i.imagesOffset=i.offset}),25):this.imagesOffset=this.offset}},watch:{lastOffset:function(){this.setOffset(this.offset)},offset:function(){this.$emit("scroll",this.offset)}},created:function(){oe.on("ArrowUp",this.reverseRow,0,this.listenerSet),oe.on("w",this.reverseRow,0,this.listenerSet),oe.on("ArrowDown",this.advanceRow,0,this.listenerSet),oe.on("s",this.advanceRow,0,this.listenerSet),oe.on("ArrowLeft",this.reversePage,0,this.listenerSet),oe.on("a",this.reversePage,0,this.listenerSet),oe.on("ArrowRight",this.advancePage,0,this.listenerSet),oe.on("d",this.advancePage,0,this.listenerSet),oe.on("PageUp",this.reversePage,0,this.listenerSet),oe.on("PageDown",this.advancePage,0,this.listenerSet),oe.on("Home",this.jumpToStart,0,this.listenerSet),oe.on("End",this.jumpToEnd,0,this.listenerSet),this.setOffset(this.initialOffset)},mounted:function(){window.addEventListener("resize",this.updateDimensions),this.$on("resize",this.updateDimensions),this.$nextTick(this.updateDimensions),this.$watch("canScroll",this.updateDimensions)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,selectable:t.selectable,"selected-icon":t.selectedIcon},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports,Qe=Vue.resource("api/v1/image-labels{/id}",{},{query:{method:"GET",url:"api/v1/images{/image_id}/labels"},save:{method:"POST",url:"api/v1/images{/image_id}/labels"}}),ti=ft({props:{item:{type:Object,required:!0},deletable:{type:Boolean,default:!1}},data:function(){return{deleting:!1}},computed:{label:function(){return this.item.label},colorStyle:function(){return{"background-color":"#"+this.label.color}},deleteTitle:function(){return"Detach label "+this.label.name},title:function(){return"Attached by ".concat(this.item.user.firstname," ").concat(this.item.user.lastname)},classObject:function(){return{"image-label--deleting":this.deleting}}},methods:{deleteThis:function(){var t=this;this.deleting||(this.deleting=!0,Qe.delete({id:this.item.id}).then(this.deleted,Qt).finally((function(){return t.deleting=!1})))},deleted:function(){this.$emit("deleted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"image-label",class:t.classObject},[i("span",{staticClass:"image-label__color",style:t.colorStyle}),t._v(" "),i("span",{attrs:{title:t.title},domProps:{textContent:t._s(t.label.name)}}),t._v(" "),!t.deleting&&t.deletable?i("button",{staticClass:"close image-label__delete",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("")])]):t._e()])}),[],!1,null,null,null),ei=ft({components:{listItem:ti.exports},props:{imageLabels:{type:Array,required:!0},userId:{type:Number,required:!0},isAdmin:{type:Boolean,default:!1}},computed:{hasImageLabels:function(){return this.imageLabels.length>0}},methods:{canDelete:function(t){return!0===this.isAdmin||this.userId===t.user.id},emitDeleted:function(t){this.$emit("deleted",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"image-label-list"},[t._l(t.imageLabels,(function(e){return i("list-item",{key:e.id,attrs:{item:e,deletable:t.canDelete(e)},on:{deleted:t.emitDeleted}})})),t._v(" "),t.hasImageLabels?t._e():i("li",{staticClass:"text-muted"},[t._v("No image labels")])],2)}),[],!1,null,null,null).exports,ii=ft({props:{activeSorter:{type:String,default:""}},computed:{active:function(){return this.activeSorter===this.id},classObject:function(){return{active:this.active}}},methods:{getSequence:function(){return new Vue.Promise.resolve([])},handleClick:function(){this.active||this.$emit("select",this)}}},(function(){var t=this.$createElement;return(this._self._c||t)("button",{staticClass:"list-group-item",class:this.classObject,attrs:{title:this.title},domProps:{textContent:this._s(this.text)},on:{click:this.handleClick}})}),[],!1,null,null,null).exports,ni=[{id:"filename",component:{mixins:[ii],data:function(){return{imageIds:[],title:"Sort images by filename",text:"Filename",id:"filename"}},methods:{getSequence:function(){return new Vue.Promise.resolve(this.imageIds)}},created:function(){this.imageIds=biigle.$require("volumes.imageIds")}}},{id:"random",component:{mixins:[ii],data:function(){return{imageIds:[],title:"Sort images randomly",text:"Random",id:"random"}},methods:{shuffle:function(t){var e,i,n;for(e=t.length-1;e>0;e--)i=Math.floor(Math.random()*(e+1)),n=t[e],t[e]=t[i],t[i]=n;return t},getSequence:function(){var t=this.shuffle(this.imageIds.slice());return new Vue.Promise.resolve(t)},handleClick:function(){this.$emit("select",this)}},created:function(){this.imageIds=biigle.$require("volumes.imageIds")}}}];biigle.$declare("annotations.api.volumes",Xe),biigle.$declare("api.imageLabels",Qe),biigle.$declare("volumes.components.filterListComponent",We),biigle.$declare("volumes.components.imageGrid",Je),biigle.$declare("volumes.components.imageGridImage",Ye),biigle.$declare("volumes.components.imageLabelList",ei),biigle.$declare("volumes.components.sortComponent",ii),biigle.$declare("volumes.mixins.sortComponent",ii),biigle.$declare("volumes.stores.filters",He),biigle.$declare("volumes.stores.sorters",ni);var ri=ft({props:["session","editing","editId"],computed:{title:function(){return this.editing?"Edit this annotation session":this.session.name},active:function(){var t=new Date;return this.session.starts_at_iso8601<t&&this.session.ends_at_iso8601>=t},currentlyEdited:function(){return this.session.id===this.editId},classObject:function(){return{"session--active":this.active,"list-group-item-info":this.currentlyEdited}}},methods:{edit:function(){this.editing&&!this.currentlyEdited&&this.$emit("edit",this.session)}}},void 0,void 0,!1,null,null,null).exports,oi=Vue.resource("api/v1/annotation-sessions{/id}",{},{query:{method:"GET",url:"api/v1/volumes{/volume_id}/annotation-sessions"},save:{method:"POST",url:"api/v1/volumes{/volume_id}/annotation-sessions"}}),si=ft({props:["user"],computed:{name:function(){return this.user.firstname+" "+this.user.lastname},title:function(){return"Remove "+this.name}},methods:{remove:function(){this.$emit("remove",this.user)}}},void 0,void 0,!1,null,null,null).exports,ai=ft({mixins:[le,qt],data:function(){return{volumeId:null,sessions:null,editedSession:{name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]},users:[],errors:{},typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},components:{typeahead:Vt,listItem:ri,userTag:si,datepicker:VueStrap.datepicker},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},hasSessions:function(){return this.sessions.length>0},hasNewSession:function(){return void 0===this.editedSession.id},availableUsers:function(){var t=this.editedSession.users.map((function(t){return t.id}));return this.users.filter((function(e){return-1===t.indexOf(e.id)}))},orderedSessions:function(){return this.sessions.slice().sort((function(t,e){return e.starts_at_iso8601.getTime()-t.starts_at_iso8601.getTime()}))}},methods:{clone:function(t){return JSON.parse(JSON.stringify(t))},submit:function(t){var e=this;if(!this.loading){this.startLoading();var i=this.editedSession;if(this.hasNewSession)oi.save({volume_id:this.volumeId},this.packSession(i)).then(this.sessionSaved).catch(this.handleErrorResponse).finally(this.finishLoading);else{var n={id:i.id};!0===t&&(n.force=1),oi.update(n,this.packSession(i)).then((function(){return e.sessionUpdated(i)})).catch(this.handleConfirm("Use the Force and update the annotation session?",this.submit)).finally(this.finishLoading)}}},sessionUpdated:function(t){for(var e=this.sessions.length-1;e>=0;e--)this.sessions[e].id===t.id&&(this.sessions.splice(e,1,t),this.clearEditedSession())},sessionSaved:function(t){this.sessions.push(this.parseSession(t.data)),this.clearEditedSession()},packSession:function(t){return(t=this.clone(t)).users=t.users.map((function(t){return t.id})),t.starts_at=t.starts_at_iso8601,t.ends_at=t.ends_at_iso8601,delete t.starts_at_iso8601,delete t.ends_at_iso8601,t},handleConfirm:function(t,e){var i=this;return function(n){400===n.status?(i.finishLoading(),confirm(n.data.message+" "+t)&&e(!0)):i.handleErrorResponse(n)}},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:Qt(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join(" ")},editSession:function(t){this.editedSession=this.clone(t)},deleteSession:function(t){var e=this;if(!this.loading&&!this.hasNewSession&&(!0===t||confirm("Are you sure you want to delete the annotation session '".concat(this.editedSession.name,"'?")))){this.startLoading();var i=this.editedSession.id,n={id:i};!0===t&&(n.force=1),oi.delete(n).then((function(){return e.sessionDeleted(i)})).catch(this.handleConfirm("Use the Force and delete the annotation session?",this.deleteSession)).finally(this.finishLoading)}},sessionDeleted:function(t){for(var e=this.sessions.length-1;e>=0;e--)if(this.sessions[e].id===t)return this.sessions.splice(e,1),void this.clearEditedSession()},clearEditedSession:function(){this.editedSession={name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]}},loadUsers:function(){Xe.queryUsers({id:this.volumeId}).then(this.usersLoaded,Qt)},usersLoaded:function(t){t.data.forEach((function(t){t.name=t.firstname+" "+t.lastname})),Vue.set(this,"users",t.data)},selectUser:function(t){this.editedSession.users.push(t)},removeUser:function(t){for(var e=this.editedSession.users.length-1;e>=0;e--)this.editedSession.users[e].id===t.id&&this.editedSession.users.splice(e,1)},stringifyDate:function(t){var e=t.getMonth()+1;return e=e<10?"0"+e:e,t.getFullYear()+"-"+e+"-"+t.getDate()},parseDate:function(t){if(t)return t=t.split("-"),new Date(t[0],t[1]-1,t[2])},parseSession:function(t){var e=new Date(t.starts_at_iso8601);return t.starts_at_iso8601=e,t.starts_at=this.stringifyDate(e),e=new Date(t.ends_at_iso8601),t.ends_at_iso8601=e,t.ends_at=this.stringifyDate(e),t},setStartsAt:function(t){this.editedSession.starts_at_iso8601=this.parseDate(t),this.editedSession.starts_at=t},setEndsAt:function(t){this.editedSession.ends_at_iso8601=this.parseDate(t),this.editedSession.ends_at=t}},watch:{editedSession:function(){this.errors={}},loading:function(t){t&&(this.errors={})}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.sessions=biigle.$require("volumes.annotationSessions").map(this.parseSession),this.$once("editing.start",this.loadUsers)}},void 0,void 0,!1,null,null,null).exports,li=Vue.resource("api/v1/volumes/browser/directories{/disk}",{},{getImages:{method:"GET",url:"api/v1/volumes/browser/images{/disk}"}}),ui=ft({mixins:[le],data:function(){return{disks:[],url:null,filenames:null,browsing:!1,storageDisk:null,breadCrumbs:[],currentDirectories:[],loadingBrowser:!1,directoryCache:{},fileCache:{}}},computed:{showFilenameWarning:function(){return this.filenames.includes(".tif")},hasDirectories:function(){return this.currentDirectories.length>0},buttonClass:function(){return{"btn-info":this.browsing}},canGoBack:function(){return this.breadCrumbs.length>0||this.disks.length>1},hasCurrentDirectory:function(){return this.breadCrumbs.length>0},currentDirectory:function(){return this.hasCurrentDirectory?this.breadCrumbs[this.breadCrumbs.length-1]:null}},methods:{toggleBrowse:function(){this.browsing=!this.browsing},fetchDirectories:function(t,e){var i=this,n=t+"://"+e;if(!this.directoryCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=li.get({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.directoryCache[n]=r}return this.directoryCache[n]},showDirectories:function(t){this.currentDirectories=t.body},openDirectory:function(t){this.breadCrumbs.push(t)},goBack:function(){this.breadCrumbs.length>0?this.breadCrumbs.pop():this.disks.length>1&&(this.storageDisk=null)},goTo:function(t){t>=-1&&t<this.breadCrumbs.length&&(this.breadCrumbs=this.breadCrumbs.slice(0,t+1))},fetchImages:function(t,e){var i=this,n=t+"://"+e;if(!this.fileCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=li.getImages({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.fileCache[n]=r}return this.fileCache[n]},setImages:function(t){this.filenames=t.body.join(", ")},selectDirectory:function(t){var e=this,i=this.breadCrumbs.slice();t&&i.push(t),this.fetchImages(this.storageDisk,i.join("/")).then(this.setImages).then((function(){return e.url=e.storageDisk+"://"+i.join("/")})).catch(Qt)}},watch:{storageDisk:function(t){t&&this.fetchDirectories(t,"").then(this.showDirectories,Qt)},breadCrumbs:function(t){this.fetchDirectories(this.storageDisk,t.join("/")).then(this.showDirectories).catch((function(e){t.pop(),Qt(e)}))}},created:function(){this.disks=biigle.$require("volumes.disks"),this.url=biigle.$require("volumes.url"),this.filenames=biigle.$require("volumes.filenames"),1===this.disks.length&&(this.storageDisk=this.disks[0])},mounted:function(){this.$refs.nameInput.focus()}},void 0,void 0,!1,null,null,null).exports,hi=ft(new Vue({data:{count:0}}),void 0,void 0,!1,null,null,null).exports,ci=ft({data:function(){return{imageIds:[]}},computed:{count:function(){return hi.count},text:function(){return this.count===this.imageIds.length?this.count:this.count+" of "+this.imageIds.length}},created:function(){this.imageIds=biigle.$require("volumes.imageIds")}},void 0,void 0,!1,null,null,null).exports,di=ft({props:["image"],computed:{classObject:function(){return{"list-group-item-success":this.image.isNew}},title:function(){return"Delete image #"+this.image.id}},methods:{remove:function(){this.$emit("remove",this.image)}}},void 0,void 0,!1,null,null,null),pi=ft({mixins:[le,qt],data:function(){return{volumeId:null,filenames:"",images:[],errors:{}}},components:{imageItem:di.exports},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},orderedImages:function(){return this.images.slice().sort((function(t,e){return t.filename<e.filename?-1:1}))},hasNoImages:function(){return!this.loading&&0===this.images.length}},methods:{submit:function(){this.loading||(this.startLoading(),Xe.saveImages({id:this.volumeId},{images:this.filenames}).then(this.imagesSaved).catch(this.handleErrorResponse).finally(this.finishLoading))},imagesSaved:function(t){for(var e=t.data.length-1;e>=0;e--)t.data[e].isNew=!0,this.images.push(t.data[e]);this.filenames=""},handleRemove:function(t){var e=this;!this.loading&&confirm("Do you really want to delete the image #".concat(t.id," (").concat(t.filename,")? All annotations will be lost!"))&&(this.startLoading(),Lt.delete({id:t.id}).then((function(){return e.imageRemoved(t.id)})).catch(Qt).finally(this.finishLoading))},imageRemoved:function(t){for(var e=this.images,i=e.length-1;i>=0;i--)if(e[i].id===t)return void e.splice(i,1)},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:Qt(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join("\n")},setImages:function(t){for(var e in t.body)t.body.hasOwnProperty(e),this.images.push({id:e,filename:t.body[e]})}},watch:{loading:function(t){t&&(this.errors={})}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.startLoading(),Xe.queryFilenames({id:this.volumeId}).then(this.setImages,Qt).finally(this.finishLoading)}},void 0,void 0,!1,null,null,null).exports,fi=Vue.resource("api/v1/volumes{/id}/images/metadata"),gi=ft({mixins:[le],data:function(){return{volumeId:null,csv:void 0,error:!1,success:!1,message:void 0}},methods:{handleSuccess:function(){this.error=!1,this.success=!0},handleError:function(t){this.success=!1,t.data.file?Array.isArray(t.data.file)?this.error=t.data.file[0]:this.error=t.data.file:Qt(t)},submit:function(){if(this.csv){this.startLoading();var t=new FormData;t.append("file",this.csv),fi.save({id:this.volumeId},t).bind(this).then(this.handleSuccess,this.handleError).finally(this.finishLoading)}},setCsv:function(t){this.csv=t.target.files[0]}},created:function(){this.volumeId=biigle.$require("volumes.id")}},void 0,void 0,!1,null,null,null).exports,mi=ft({components:{previewThumbnail:Ne}},void 0,void 0,!1,null,null,null).exports;function vi(t){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var yi=ft({mixins:[le],components:{powerToggle:ie},props:{volumeId:{type:Number,required:!0},imageIds:{type:Array,required:!0},showFilenames:{type:Boolean,default:!1},loadingFilenames:{type:Boolean,default:!1}},data:function(){return{filters:He,rules:[],selectedFilterId:null,negate:!1,mode:"filter",operator:"and"}},computed:{selectedFilter:function(){return this.getFilter(this.selectedFilterId)},hasSelectComponent:function(){return this.selectedFilter&&this.selectedFilter.selectComponent},selectComponent:function(){return this.selectedFilter.selectComponent},hasRules:function(){return this.rules.length>0},sequence:function(){if(!this.hasRules)return this.imageIds;var t={},e={},i=0,n=0;return this.rules.forEach((function(r){r.negate?(i++,r.sequence.forEach((function(t){e[t]=e[t]+1||1}))):(n++,r.sequence.forEach((function(e){t[e]=t[e]+1||1})))})),"and"===this.operator?n>0?this.imageIds.filter((function(i){return t[i]===n&&!e.hasOwnProperty(i)})):this.imageIds.filter((function(t){return!e.hasOwnProperty(t)})):i>0?this.imageIds.filter((function(n){return t.hasOwnProperty(n)||e[n]!==i})):this.imageIds.filter((function(e){return t.hasOwnProperty(e)}))},inFilterMode:function(){return"filter"===this.mode},inFlagMode:function(){return"flag"===this.mode},usesAndOperator:function(){return"and"===this.operator},usesOrOperator:function(){return"or"===this.operator},helpText:function(){return this.selectedFilter?this.selectedFilter.help:null},rulesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.rules")},modeStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.mode")},operatorStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.operator")}},methods:{filterValid:function(t){return"string"==typeof t.id&&"string"==typeof t.label&&"object"===vi(t.listComponent)&&"function"==typeof t.getSequence},getFilter:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t)return this.filters[e];return null},hasRule:function(t){return-1!==this.rules.findIndex((function(e){return e.id===t.id&&e.negate===t.negate&&e.data===t.data}))},addRule:function(t){var e=this;if(this.selectedFilter){var i={id:this.selectedFilter.id,data:t,negate:this.negate};this.hasRule(i)||(this.startLoading(),this.selectedFilter.getSequence(this.volumeId,t).catch(Qt).then((function(t){return e.ruleAdded(i,t)})).finally(this.finishLoading))}},refreshRule:function(t){var e=this.getFilter(t.id);e&&(this.startLoading(),e.getSequence(this.volumeId,t.data).catch(Qt).then((function(e){return t.sequence=e.data})).finally(this.finishLoading))},ruleAdded:function(t,e){t.sequence=e.data,this.rules.push(t)},removeRule:function(t){this.rules.splice(t,1)},reset:function(){this.rules=[],this.selectedFilterId=null,this.negate=!1,this.mode="filter",this.operator="and"},activateFilterMode:function(){this.mode="filter"},activateFlagMode:function(){this.mode="flag"},activateAndOperator:function(){this.operator="and"},activateOrOperator:function(){this.operator="or"},emitUpdate:function(){this.$emit("update",this.sequence,this.mode,this.hasRules)},getListComponent:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t.id)return this.filters[e].listComponent},enableFilenames:function(){this.$emit("enable-filenames")},disableFilenames:function(){this.$emit("disable-filenames")}},watch:{sequence:function(){this.emitUpdate()},mode:function(){this.emitUpdate(),"filter"!==this.mode?localStorage.setItem(this.modeStorageKey,this.mode):localStorage.removeItem(this.modeStorageKey)},operator:function(){this.emitUpdate(),"and"!==this.operator?localStorage.setItem(this.operatorStorageKey,this.operator):localStorage.removeItem(this.operatorStorageKey)},rules:{handler:function(){this.rules.length>0?localStorage.setItem(this.rulesStorageKey,JSON.stringify(this.rules)):localStorage.removeItem(this.rulesStorageKey)},deep:!0}},created:function(){for(var t,e=0;e<this.filters.length;e++)t=this.filters[e],this.filterValid(t)||(console.error("Filter ".concat(t.id," invalid. Ignoring...")),this.filters.splice(e,1));var i=JSON.parse(localStorage.getItem(this.rulesStorageKey));i&&(this.rules=i);var n=localStorage.getItem(this.modeStorageKey);n&&(this.mode=n);var r=localStorage.getItem(this.operatorStorageKey);r&&(this.operator=r)}},void 0,void 0,!1,null,null,null).exports,_i=ft({mixins:[Ye,le],components:{imageLabelList:ei},data:function(){return{userId:null,isAdmin:!1,attachingSuccess:null,timeout:null,saving:!1,showAnnotationRoute:null}},props:{selectedLabel:{type:Object,default:null},showFilename:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1}},computed:{alreadyHasSelectedLabel:function(){var t=this.selectedLabel;return this.image.labels.reduce((function(e,i){return e||t.id===i.label_id}),!1)},showAnnotationLink:function(){return this.showAnnotationRoute?this.showAnnotationRoute+this.image.id:""},selected:function(){return this.image.flagged},canBeSelected:function(){return this.selectable&&this.selectedLabel&&!this.alreadyHasSelectedLabel&&!this.saving},classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.canBeSelected,"image-grid__image--saving":this.selectable&&this.saving,"image-grid__image--success":!0===this.attachingSuccess,"image-grid__image--error":!1===this.attachingSuccess}},title:function(){return this.canBeSelected?"Attach "+this.selectedLabel.name:""}},methods:{handleClick:function(){var t=this;this.canBeSelected&&(this.saving=!0,Qe.save({image_id:this.image.id},{label_id:this.selectedLabel.id}).then(this.labelAttached,this.attachingFailed).finally(this.resetSuccess).finally((function(){return t.saving=!1})))},labelAttached:function(t){this.attachingSuccess=!0,this.image.labels.push(t.data)},attachingFailed:function(t){this.attachingSuccess=!1,Qt(t)},resetSuccess:function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return t.attachingSuccess=null}),3e3)},removeImageLabel:function(t){var e=this.image.labels.indexOf(t);-1!==e&&this.image.labels.splice(e,1)}},created:function(){this.userId=biigle.$require("volumes.userId"),this.isAdmin=biigle.$require("volumes.isAdmin"),this.showAnnotationRoute=biigle.$require("largo.showAnnotationRoute")}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"image-grid__image image-grid__image--volume",class:t.classObject,attrs:{title:t.title}},[!t.selectable&&t.image.annotateUrl?i("a",{staticClass:"image-link",attrs:{href:t.image.annotateUrl,title:"Annotate this image"}},[i("img",{attrs:{src:t.url||t.emptyUrl},on:{error:t.showEmptyImage}})]):i("img",{attrs:{src:t.url||t.emptyUrl},on:{click:t.handleClick,error:t.showEmptyImage}}),t._v(" "),t.showFilename?i("span",{staticClass:"image-filename",attrs:{title:t.image.filename},domProps:{textContent:t._s(t.image.filename)}}):t._e(),t._v(" "),i("div",{staticClass:"image-buttons"},[t.image.imageUrl?i("a",{staticClass:"image-button",attrs:{href:t.image.imageUrl,title:"View image information"}},[i("span",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}})]):t._e()]),t._v(" "),t.showLabels?i("div",{staticClass:"image-labels",on:{wheel:function(t){t.stopPropagation()}}},[i("image-label-list",{attrs:{"image-labels":t.image.labels,"user-id":t.userId,"is-admin":t.isAdmin},on:{deleted:t.removeImageLabel}})],1):t._e()])}),[],!1,null,null,null),bi=ft({mixins:[Je],components:{imageGridImage:_i.exports},props:{selectedLabel:{type:Object,default:null},showFilenames:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,"selected-label":t.selectedLabel,selectable:t.selectable,"selected-fade":!1,"show-filename":t.showFilenames,"show-labels":t.showLabels},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports,wi=ft({mixins:[le],components:{labelTrees:_e,powerToggle:ie},props:{volumeId:{type:Number,required:!0},showLabels:{type:Boolean,default:!1},loadingLabels:{type:Boolean,default:!1}},data:function(){return{labelTrees:[]}},methods:{handleSelectedLabel:function(t){this.$emit("select",t)},handleDeselectedLabel:function(t){this.$emit("deselect",t)},enableLabels:function(){this.$emit("enable-labels")},disableLabels:function(){this.$emit("disable-labels")}},created:function(){this.labelTrees=biigle.$require("volumes.labelTrees")}},void 0,void 0,!1,null,null,null).exports,xi=ft({mixins:[le],props:{volumeId:{type:Number,required:!0},imageIds:{type:Array,required:!0}},data:function(){return{sorters:ni,direction:!0,activeSorter:null,privateSequence:[]}},computed:{defaultSorter:function(){return this.sorters[0]},isActive:function(){return this.activeSorter!==this.defaultSorter.id||!this.direction},isSortedAscending:function(){return this.direction},isSortedDescending:function(){return!this.direction},sorterStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.sorter")},directionStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.direction")},sequence:function(){return this.direction?this.privateSequence:this.privateSequence.slice().reverse()}},methods:{reset:function(){this.direction=!0,this.activeSorter=this.defaultSorter.id,this.privateSequence=biigle.$require("volumes.imageIds")},sortAscending:function(){this.direction=!0},sortDescending:function(){this.direction=!1},handleSelect:function(t){var e=this;this.loading||(this.startLoading(),t.getSequence().then((function(i){e.activeSorter=t.id,e.privateSequence=i})).catch(Qt).finally(this.finishLoading))},isValidSequence:function(t){for(var e={},i=this.imageIds,n=t.length-1;n>=0;n--)e[t[n]]=!0;for(var r=i.length-1;r>=0;r--)if(!e.hasOwnProperty(i[r]))return!1;return!0}},watch:{sequence:function(){this.$emit("update",this.sequence,this.isActive)},privateSequence:function(){this.activeSorter===this.defaultSorter.id?localStorage.removeItem(this.sorterStorageKey):localStorage.setItem(this.sorterStorageKey,JSON.stringify({id:this.activeSorter,sequence:this.privateSequence}))},direction:function(){this.direction?localStorage.removeItem(this.directionStorageKey):localStorage.setItem(this.directionStorageKey,this.direction)}},created:function(){this.privateSequence=biigle.$require("volumes.imageIds");var t=JSON.parse(localStorage.getItem(this.sorterStorageKey));t&&this.isValidSequence(t.sequence)?(this.activeSorter=t.id,this.privateSequence=t.sequence):(this.activeSorter=this.defaultSorter.id,localStorage.removeItem(this.sorterStorageKey));var e=JSON.parse(localStorage.getItem(this.directionStorageKey));null!==e&&(this.direction=e)}},void 0,void 0,!1,null,null,null).exports,Si=ft({mixins:[le],components:{sidebar:se,sidebarTab:ae,imageGrid:bi,filterTab:yi,sortingTab:xi,labelsTab:wi},data:function(){return{imageIds:[],images:[],filterSequence:[],filterMode:null,filterActive:!1,sortingSequence:[],sortingActive:!1,volumeId:null,imageLabelMode:!1,selectedLabel:null,loadingFilenames:!1,showFilenames:!1,filenamesPromise:null,loadingLabels:!1,showLabels:!1,labelsPromise:null,settings:null}},computed:{sortingMap:function(){var t={};return this.sortingSequence.forEach((function(e,i){t[e]=i})),t},sortedImages:function(){var t=this.sortingMap,e=[];return this.images.forEach((function(i){e[t[i.id]]=i})),e},filterMap:function(){var t={};return this.filterSequence.forEach((function(e){t[e]=null})),t},imagesToShow:function(){var t=this.filterMap;return"flag"===this.filterMode?this.sortedImages.map((function(e){return e.flagged=t.hasOwnProperty(e.id),e})):this.sortedImages.filter((function(e){return e.flagged=!1,t.hasOwnProperty(e.id)}))},imageIdsToShow:function(){return this.imagesToShow.map((function(t){return t.id}))},imagesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".images")},offsetStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".offset")},initialOffset:function(){return parseInt(Xt.get("offset"))||parseInt(localStorage.getItem(this.offsetStorageKey))||0},filterEmpty:function(){return this.filterActive&&0===this.filterSequence.length}},methods:{handleSidebarToggle:function(){var t=this;this.$nextTick((function(){return t.$refs.imageGrid.$emit("resize")}))},handleSidebarOpen:function(t){this.imageLabelMode="labels"===t},handleSidebarClose:function(){this.imageLabelMode=!1},toggleLoading:function(t){t?this.startLoading():this.finishLoading()},updateFilterSequence:function(t,e,i){this.filterSequence=t,this.filterMode=e,this.filterActive=i},handleImageGridScroll:function(t){t>0?(Xt.set({offset:t}),localStorage.setItem(this.offsetStorageKey,t)):(Xt.unset("offset"),localStorage.removeItem(this.offsetStorageKey))},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},updateSortingSequence:function(t,e){this.sortingSequence=t,this.sortingActive=e},enableFilenames:function(){var t=this;this.filenamesPromise||(this.loadingFilenames=!0,this.filenamesPromise=Xe.queryFilenames({id:this.volumeId}).then(this.setFilenames).finally((function(){return t.loadingFilenames=!1}))),this.filenamesPromise.then((function(){return t.showFilenames=!0}))},disableFilenames:function(){this.showFilenames=!1},setFilenames:function(t){this.images.forEach((function(e){e.filename=t.body[e.id]}))},enableLabels:function(){var t=this;this.labelsPromise||(this.loadingLabels=!0,this.labelsPromise=Xe.queryImageLabels({id:this.volumeId}).then(this.setLabels).finally((function(){return t.loadingLabels=!1}))),this.labelsPromise.then((function(){return t.showLabels=!0}))},disableLabels:function(){this.showLabels=!1},setLabels:function(t){this.images.forEach((function(e){e.labels=t.body[e.id]}))},restoreSettings:function(){!0===this.settings.get("showFilenames")&&this.enableFilenames(),!0===this.settings.get("showLabels")&&this.enableLabels()}},watch:{imageIdsToShow:function(t){var e=this.imageIds,i=t.length===e.length;if(i)for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n]){i=!1;break}i?localStorage.removeItem(this.imagesStorageKey):localStorage.setItem(this.imagesStorageKey,JSON.stringify(t)),hi.count=t.length},showFilenames:function(t){this.settings.set("showFilenames",t)},showLabels:function(t){this.settings.set("showLabels",t)}},created:function(){var t=biigle.$require("volumes.imageUuids"),e=biigle.$require("volumes.thumbUri"),i=biigle.$require("volumes.annotateUri"),n=biigle.$require("volumes.imageUri");this.imageIds=biigle.$require("volumes.imageIds"),this.filterSequence=this.imageIds,this.sortingSequence=this.imageIds,this.volumeId=biigle.$require("volumes.volumeId"),this.settings=new ue({data:{storageKey:"biigle.volumes.settings",defaults:{showFilenames:!1,showLabels:!1}}}),this.images=this.imageIds.map((function(r){return{id:r,url:e.replace(":uuid",(o=t[r],o[0]+o[1]+"/"+o[2]+o[3]+"/"+o)),annotateUrl:i.replace(":id",r),imageUrl:n.replace(":id",r),flagged:!1,filename:null,labels:[]};var o})),this.restoreSettings()}},void 0,void 0,!1,null,null,null).exports;biigle.$mount("annotation-session-panel",ai),biigle.$mount("create-volume-form",ui),biigle.$mount("image-count",ci),biigle.$mount("image-panel",pi),biigle.$mount("search-results",mi),biigle.$mount("volume-container",Si),biigle.$mount("volume-metadata-upload",gi);var Ci="postrender",Ti="movestart",Ei="moveend";function Ii(){return function(){throw new Error("Unimplemented abstract method.")}()}var ki=0;function Ai(t){return t.ol_uid||(t.ol_uid=String(++ki))}var Pi="propertychange",Ri="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function Li(t){for(var e in t)delete t[e]}function Mi(t){var e=[];for(var i in t)e.push(t[i]);return e}function Fi(t){var e;for(e in t)return!1;return!e}function Oi(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function Di(t,e){var i=ji(t);return i?i[e]:void 0}function ji(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function $i(t,e){var i=Di(t,e);if(i){for(var n=0,r=i.length;n<r;++n)t.removeEventListener(e,i[n].boundListener),Li(i[n]);i.length=0;var o=ji(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function Ni(t,e,i,n,r){var o=ji(t,!0),s=o[e];s||(s=o[e]=[]);var a=Oi(s,i,n,!1);return a?r||(a.callOnce=!1):(a={bindTo:n,callOnce:!!r,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&Gi(t),i.call(n,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function Bi(t,e,i,n){return Ni(t,e,i,n,!0)}function Ui(t,e,i,n){var r=Di(t,e);if(r){var o=Oi(r,i,n,!0);o&&Gi(o)}}function Gi(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=Di(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&$i(t.target,t.type)}Li(t)}}var zi=function(){this.disposed_=!1};zi.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},zi.prototype.disposeInternal=function(){};var Vi=zi;function qi(){return!0}function Wi(){return!1}function Ki(){}var Xi=function(t){this.propagationStopped,this.type=t,this.target=null};function Hi(t){t.stopPropagation()}Xi.prototype.preventDefault=function(){this.propagationStopped=!0},Xi.prototype.stopPropagation=function(){this.propagationStopped=!0};var Yi=Xi,Zi=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Yi(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,Ki);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){!function(t){var e=ji(t);if(e)for(var i in e)$i(t,i)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=Ki,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(Vi),Ji="change",Qi="clear",tn="contextmenu",en="click",nn="dblclick",rn="error",on="keydown",sn="keypress",an="load",ln="mousedown",un="mousewheel",hn="MSPointerDown",cn="resize",dn="touchstart",pn="wheel";var fn=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Ji)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=Ni(this,t[r],e);return n}return Ni(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=Bi(this,t[r],e);return n}return Bi(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)Ui(this,t[i],e);else Ui(this,t,e)},e}(Zi),gn=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),mn={};function vn(t){return mn.hasOwnProperty(t)?mn[t]:mn[t]="change:"+t}var yn,_n,bn=function(t){function e(e){t.call(this),Ai(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return Ri({},this.values_)},e.prototype.notify=function(t,e){var i;i=vn(t),this.dispatchEvent(new gn(i,t,e)),i=Pi,this.dispatchEvent(new gn(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(fn),wn="bottom-left",xn="bottom-center",Sn="bottom-right",Cn="center-left",Tn="center-center",En="center-right",In="top-left",kn="top-center",An="top-right",Pn=(_n={},function(t){if(yn||(yn=document.createElement("div").style),!(t in _n)){yn.font=t;var e=yn.fontFamily;if(yn.font="",!e)return null;_n[t]=e.split(/,\s?/)}return _n[t]});function Rn(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function Ln(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function Mn(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function Fn(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function On(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Dn(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var jn=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+("v"+"5.3.0".split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function $n(t,e){if(!t)throw new jn(e)}var Nn="bottom-left",Bn="bottom-right",Un="top-left",Gn="top-right",zn=0,Vn=1,qn=2,Wn=4,Kn=8,Xn=16;function Hn(t){for(var e=nr(),i=0,n=t.length;i<n;++i)hr(e,t[i]);return e}function Yn(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Zn(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Jn(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function Qn(t,e){return er(t,e[0],e[1])}function tr(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function er(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function ir(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=zn;return s<i?l|=Xn:s>r&&(l|=Wn),a<n?l|=Kn:a>o&&(l|=qn),l===zn&&(l=Vn),l}function nr(){return[1/0,1/0,-1/0,-1/0]}function rr(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function or(t){return rr(1/0,1/0,-1/0,-1/0,t)}function sr(t,e){var i=t[0],n=t[1];return rr(i,n,i,n,e)}function ar(t,e,i,n,r){return dr(or(r),t,e,i,n)}function lr(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ur(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function hr(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function cr(t,e){for(var i=0,n=e.length;i<n;++i)hr(t,e[i]);return t}function dr(t,e,i,n,r){for(;i<n;i+=r)pr(t,e[i],e[i+1]);return t}function pr(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function fr(t,e,i){var n;return(n=e.call(i,mr(t)))||(n=e.call(i,vr(t)))||(n=e.call(i,Cr(t)))?n:(n=e.call(i,Sr(t)))||!1}function gr(t){var e=0;return Ir(t)||(e=Tr(t)*wr(t)),e}function mr(t){return[t[0],t[1]]}function vr(t){return[t[2],t[1]]}function yr(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function _r(t,e){var i;return e===Nn?i=mr(t):e===Bn?i=vr(t):e===Un?i=Sr(t):e===Gn?i=Cr(t):$n(!1,13),i}function br(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),l=Math.sin(i),u=o*a,h=o*l,c=s*a,d=s*l,p=t[0],f=t[1],g=p-u+d,m=p-u-d,v=p+u-d,y=p+u+d,_=f-h-c,b=f-h+c,w=f+h+c,x=f+h-c;return rr(Math.min(g,m,v,y),Math.min(_,b,w,x),Math.max(g,m,v,y),Math.max(_,b,w,x),r)}function wr(t){return t[3]-t[1]}function xr(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return Er(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):or(n),n}function Sr(t){return[t[0],t[3]]}function Cr(t){return[t[2],t[3]]}function Tr(t){return t[2]-t[0]}function Er(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ir(t){return t[2]<t[0]||t[3]<t[1]}var kr="element",Ar="map",Pr="offset",Rr="position",Lr="positioning",Mr=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,Ni(this,vn(kr),this.handleElementChanged,this),Ni(this,vn(Ar),this.handleMapChanged,this),Ni(this,vn(Pr),this.handleOffsetChanged,this),Ni(this,vn(Rr),this.handlePositionChanged,this),Ni(this,vn(Lr),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:In),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(kr)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(Ar)},e.prototype.getOffset=function(){return this.get(Pr)},e.prototype.getPosition=function(){return this.get(Rr)},e.prototype.getPositioning=function(){return this.get(Lr)},e.prototype.handleElementChanged=function(){Dn(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(On(this.element),Gi(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Ni(t,Ci,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(Rr)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(kr,t)},e.prototype.setMap=function(t){this.set(Ar,t)},e.prototype.setOffset=function(t){this.set(Pr,t)},e.prototype.setPosition=function(t){this.set(Rr,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[Ln(i),Mn(i)]),r=this.autoPanMargin;if(!tr(e,n)){var o=n[0]-e[0],s=e[2]-n[2],a=n[1]-e[1],l=e[3]-n[3],u=[0,0];if(o<0?u[0]=o-r:s<0&&(u[0]=Math.abs(s)+r),a<0?u[1]=a-r:l<0&&(u[1]=Math.abs(l)+r),0!==u[0]||0!==u[1]){var h=t.getView().getCenter(),c=t.getPixelFromCoordinate(h),d=[c[0]+u[0],c[1]+u[1]];t.getView().animate({center:t.getCoordinateFromPixel(d),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},e.prototype.setPositioning=function(t){this.set(Lr,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var o=n[0],s=n[1];if(r==Sn||r==En||r==An){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-o)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),r!=xn&&r!=Tn&&r!=kn||(o-=this.element.offsetWidth/2);var l=Math.round(t[0]+o)+"px";this.rendered.left_!=l&&(this.rendered.left_=i.left=l)}if(r==wn||r==xn||r==Sn){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var u=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=u&&(this.rendered.bottom_=i.bottom=u)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),r!=Cn&&r!=Tn&&r!=En||(s-=this.element.offsetHeight/2);var h=Math.round(t[1]+s)+"px";this.rendered.top_!=h&&(this.rendered.top_=i.top=h)}},e.prototype.getOptions=function(){return this.options},e}(bn),Fr=ft({props:{watch:{required:!0,type:String},position:{required:!0,type:Array},show:{required:!0,type:Boolean},positioning:{type:String,default:"top-left"}},data:function(){return{annotations:[]}},computed:{hasAnnotations:function(){return this.annotations.length>0},showThis:function(){return this.show&&this.hasAnnotations}},methods:{updateAnnotations:function(t){this.annotations=t.map((function(t){return t.get("annotation")}))}},watch:{show:{immediate:!0,handler:function(t){t?this.$parent.$on(this.watch,this.updateAnnotations):this.$parent.$off(this.watch,this.updateAnnotations)}},position:function(t){this.overlay.setPosition(t)},showThis:function(t){t?this.$parent.map.addOverlay(this.overlay):this.$parent.map.removeOverlay(this.overlay)}},mounted:function(){this.overlay=new Mr({element:this.$el,offset:[15,0],positioning:this.positioning})},beforeDestroy:function(){this.$parent.map.removeOverlay(this.overlay)}},void 0,void 0,!1,null,null,null).exports,Or=ft({mixins:[Fr],computed:{annotationLabels:function(){return this.annotations.map((function(t){return t.labels.map((function(t){return t.label.name}))}))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.annotationLabels,(function(e){return i("li",[i("ul",{staticClass:"annotation-tooltip__labels"},t._l(e,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])})),0)])}),[],!1,null,null,null).exports,Dr=ft({props:{image:{required:!0},areas:{required:!0}},data:function(){return{unitMultipliers:[1e3,1,.01,.001,1e-6,1e-9],unitNames:["km","m","cm","mm","m","nm"]}},computed:{area:function(){return this.areas&&this.image&&this.areas[this.image.id]||-1},hasArea:function(){return-1!==this.area},pxWidthInMeter:function(){return Math.sqrt(this.area/(this.image.width*this.image.height))}},methods:{powerOfTen:function(t){return Math.pow(10,Math.floor(Math.log10(t)))}}},void 0,void 0,!1,null,null,null).exports;function jr(t,e){return t>e?1:t<e?-1:0}function $r(t,e){return t.indexOf(e)>=0}function Nr(t,e,i){var n,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(i>0){for(n=1;n<r;++n)if(t[n]<e)return n-1}else if(i<0){for(n=1;n<r;++n)if(t[n]<=e)return n}else for(n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function Br(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function Ur(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function Gr(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}var zr="XY",Vr="XYZ",qr="XYM",Wr="XYZM",Kr="Point",Xr="LineString",Hr="LinearRing",Yr="Polygon",Zr="MultiPoint",Jr="MultiLineString",Qr="MultiPolygon",to="GeometryCollection",eo="Circle",io="Rectangle",no="Ellipse";function ro(t,e,i,n,r,o){for(var s=o||[],a=0,l=e;l<i;l+=n){var u=t[l],h=t[l+1];s[a++]=r[0]*u+r[2]*h+r[4],s[a++]=r[1]*u+r[3]*h+r[5]}return o&&s.length!=a&&(s.length=a),s}function oo(t,e,i){return Math.min(Math.max(t,e),i)}var so="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function ao(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var l=((t-i)*s+(e-n)*a)/(s*s+a*a);l>1?(i=r,n=o):l>0&&(i+=s*l,n+=a*l)}return lo(t,e,i,n)}function lo(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function uo(t){return t*Math.PI/180}function ho(t,e){var i=t%e;return i*e<0?i+e:i}function co(t,e,i){return t+i*(e-t)}function po(t,e,i){var n=i||6371008.8,r=uo(t[1]),o=uo(e[1]),s=(o-r)/2,a=uo(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var fo={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},go={};go[fo.DEGREES]=2*Math.PI*6370997/360,go[fo.FEET]=.3048,go[fo.METERS]=1,go[fo.USFEET]=1200/3937;var mo=fo,vo=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};vo.prototype.canWrapX=function(){return this.canWrapX_},vo.prototype.getCode=function(){return this.code_},vo.prototype.getExtent=function(){return this.extent_},vo.prototype.getUnits=function(){return this.units_},vo.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||go[this.units_]},vo.prototype.getWorldExtent=function(){return this.worldExtent_},vo.prototype.getAxisOrientation=function(){return this.axisOrientation_},vo.prototype.isGlobal=function(){return this.global_},vo.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},vo.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},vo.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},vo.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},vo.prototype.setWorldExtent=function(t){this.worldExtent_=t},vo.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},vo.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var yo=vo,_o=6378137*Math.PI,bo=[-_o,-_o,_o,_o],wo=[-180,-85,180,85],xo=function(t){function e(e){t.call(this,{code:e,units:mo.METERS,extent:bo,global:!0,worldExtent:wo,getPointResolution:function(t,e){return t/so(e[1]/6378137)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(yo),So=[new xo("EPSG:3857"),new xo("EPSG:102100"),new xo("EPSG:102113"),new xo("EPSG:900913"),new xo("urn:ogc:def:crs:EPSG:6.18:3:3857"),new xo("urn:ogc:def:crs:EPSG::3857"),new xo("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Co(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=_o,a=0;a<n;a+=r){o[a]=s*t[a]/180;var l=6378137*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));l>s?l=s:l<-s&&(l=-s),o[a+1]=l}return o}function To(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/_o,o[s+1]=360*Math.atan(Math.exp(t[s+1]/6378137))/Math.PI-90;return o}var Eo=[-180,-90,180,90],Io=6378137*Math.PI/180,ko=function(t){function e(e,i){t.call(this,{code:e,units:mo.DEGREES,extent:Eo,axisOrientation:i,global:!0,metersPerUnit:Io,worldExtent:Eo})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(yo),Ao=[new ko("CRS:84"),new ko("EPSG:4326","neu"),new ko("urn:ogc:def:crs:EPSG::4326","neu"),new ko("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ko("urn:ogc:def:crs:OGC:1.3:CRS84"),new ko("urn:ogc:def:crs:OGC:2:84"),new ko("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ko("urn:x-ogc:def:crs:EPSG:4326","neu")],Po={};var Ro,Lo,Mo,Fo={};function Oo(t,e,i){var n=t.getCode(),r=e.getCode();n in Fo||(Fo[n]={}),Fo[n][r]=i}function Do(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function jo(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function $o(t){!function(t,e){Po[t]=e}(t.getCode(),t),Oo(t,t,Do)}function No(t){return"string"==typeof t?Po[t]||null:t||null}function Bo(t,e,i,n){var r,o=(t=No(t)).getPointResolutionFunc();if(o)r=o(e,i);else if(t.getUnits()==mo.DEGREES&&!n||n==mo.DEGREES)r=e;else{var s=Vo(t,No("EPSG:4326")),a=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];r=(po((a=s(a,a,2)).slice(0,2),a.slice(2,4))+po(a.slice(4,6),a.slice(6,8)))/2;var l=n?go[n]:t.getMetersPerUnit();void 0!==l&&(r/=l)}return r}function Uo(t){!function(t){t.forEach($o)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Oo(e,t,Do)}))}))}function Go(t,e){return t?"string"==typeof t?No(t):t:No(e)}function zo(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Vo(t,e)===Do)&&i}function Vo(t,e){var i=function(t,e){var i;return t in Fo&&e in Fo[t]&&(i=Fo[t][e]),i}(t.getCode(),e.getCode());return i||(i=jo),i}function qo(t,e){return Vo(No(t),No(e))}function Wo(t,e,i){return qo(e,i)(t,void 0,t.length)}Uo(So),Uo(Ao),Ro=So,Lo=Co,Mo=To,Ao.forEach((function(t){Ro.forEach((function(e){Oo(t,e,Lo),Oo(e,t,Mo)}))}));var Ko=new Array(6);function Xo(t){return Yo(t,1,0,0,1,0,0)}function Ho(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],p=e[5];return t[0]=i*l+r*u,t[1]=n*l+o*u,t[2]=i*h+r*c,t[3]=n*h+o*c,t[4]=i*d+r*p+s,t[5]=n*d+o*p+a,t}function Yo(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function Zo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Jo(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Qo(t,e,i){return Ho(t,Yo(Ko,e,0,0,i,0,0))}function ts(t,e,i){return Ho(t,Yo(Ko,1,0,0,1,e,i))}function es(t,e,i,n,r,o,s,a){var l=Math.sin(o),u=Math.cos(o);return t[0]=n*u,t[1]=r*l,t[2]=-n*l,t[3]=r*u,t[4]=s*n*u-a*n*l+e,t[5]=s*r*l+a*r*u+i,t}var is=[1,0,0,1,0,0];function ns(t){var e;return t==zr?e=2:t==Vr||t==qr?e=3:t==Wr&&(e=4),e}var rs=function(t){function e(){t.call(this),this.layout=zr,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Ii()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(Li(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=ns(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){Ii()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=ns(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=zr,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=zr:3==t?e=Vr:4==t&&(e=Wr);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=Math.cos(r),u=Math.sin(r),h=o[0],c=o[1],d=0,p=e;p<i;p+=n){var f=t[p]-h,g=t[p+1]-c;a[d++]=h+f*l-g*u,a[d++]=c+f*u+g*l;for(var m=p+2;m<p+n;++m)a[d++]=t[m]}s&&a.length!=d&&(a.length=d)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=yr(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var l=a||[],u=s[0],h=s[1],c=0,d=e;d<i;d+=n){var p=t[d]-u,f=t[d+1]-h;l[c++]=u+r*p,l[c++]=h+o*f;for(var g=d+2;g<d+n;++g)l[c++]=t[g]}a&&l.length!=c&&(l.length=c)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=0,u=e;u<i;u+=n){a[l++]=t[u]+r,a[l++]=t[u+1]+o;for(var h=u+2;h<u+n;++h)a[l++]=t[h]}s&&a.length!=l&&(a.length=l)}(i,0,i.length,n,t,e,i),this.changed()}},e}(function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return Ii()},e.prototype.closestPointXY=function(t,e,i,n){return Ii()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Ii()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){Ii()},e.prototype.scale=function(t,e,i){Ii()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Ii()},e.prototype.getType=function(){return Ii()},e.prototype.applyTransform=function(t){Ii()},e.prototype.intersectsExtent=function(t){return Ii()},e.prototype.translate=function(t,e){Ii()},e.prototype.transform=function(t,e){var i=No(t),n=i.getUnits()==mo.TILE_PIXELS?function(t,n,r){var o=i.getExtent(),s=i.getWorldExtent(),a=wr(s)/wr(o);return es(is,s[0],s[3],a,-a,0,0,0),ro(t,0,t.length,r,is,n),qo(i,e)(t,n,r)}:qo(i,e);return this.applyTransform(n),this},e}(bn));function os(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=s*a-o*l,o=a,s=l}return r/2}function ss(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=os(t,e,a,n),e=a}return r}function as(t,e,i,n,r,o,s){var a,l=t[e],u=t[e+1],h=t[i]-l,c=t[i+1]-u;if(0===h&&0===c)a=e;else{var d=((r-l)*h+(o-u)*c)/(h*h+c*c);if(d>1)a=i;else{if(d>0){for(var p=0;p<n;++p)s[p]=co(t[e+p],t[i+p],d);return void(s.length=n)}a=e}}for(var f=0;f<n;++f)s[f]=t[a+f];s.length=n}function ls(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],l=t[e+1],u=lo(o,s,a,l);u>r&&(r=u),o=a,s=l}return r}function us(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=ls(t,e,a,n,r),e=a}return r}function hs(t,e,i,n,r,o,s,a,l,u,h){if(e==i)return u;var c,d;if(0===r){if((d=lo(s,a,t[e],t[e+1]))<u){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,d}return u}for(var p=h||[NaN,NaN],f=e+n;f<i;)if(as(t,f-n,f,n,s,a,p),(d=lo(s,a,p[0],p[1]))<u){for(u=d,c=0;c<n;++c)l[c]=p[c];l.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(as(t,i-n,e,n,s,a,p),(d=lo(s,a,p[0],p[1]))<u)){for(u=d,c=0;c<n;++c)l[c]=p[c];l.length=n}return u}function cs(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=hs(t,e,f,n,r,o,s,a,l,u,c),e=f}return u}function ds(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function ps(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function fs(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=ps(t,e,i[a],n);o[s++]=u,e=u}return o.length=s,o}function gs(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function ms(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=gs(t,e,u,n,o[s]),e=u}return o.length=s,o}function vs(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=ms(t,e,u,n,o[s]),e=u[u.length-1]}return o.length=s,o}function ys(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var u=[e,i-n],h=0;u.length>0;){for(var c=u.pop(),d=u.pop(),p=0,f=t[d],g=t[d+1],m=t[c],v=t[c+1],y=d+n;y<c;y+=n){var _=ao(t[y],t[y+1],f,g,m,v);_>p&&(h=y,p=_)}p>r&&(l[(h-e)/n]=1,d+n<h&&u.push(d,h),h+n<c&&u.push(h,c))}for(var b=0;b<a;++b)l[b]&&(o[s++]=t[e+b*n],o[s++]=t[e+b*n+1]);return s}function _s(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=ys(t,e,h,n,r,o,s),a.push(s),e=h}return s}function bs(t,e){return e*Math.round(t/e)}function ws(t,e,i,n,r,o,s){if(e==i)return s;var a,l,u=bs(t[e],r),h=bs(t[e+1],r);e+=n,o[s++]=u,o[s++]=h;do{if(a=bs(t[e],r),l=bs(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=l,s}while(a==u&&l==h);for(;e<i;){var c=bs(t[e],r),d=bs(t[e+1],r);if(e+=n,c!=a||d!=l){var p=a-u,f=l-h,g=c-u,m=d-h;p*m==f*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(f<0&&m<f||f==m||f>0&&m>f)?(a=c,l=d):(o[s++]=a,o[s++]=l,u=a,h=l,a=c,l=d)}}return o[s++]=a,o[s++]=l,s}function xs(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=ws(t,e,h,n,r,o,s),a.push(s),e=h}return s}function Ss(t,e){return e=e?Math.pow(10,e):1e3,t.map((function(t){return t.map((function(t){return t.map((function(t){return Math.round(t*e)/e}))}))}))}var Cs=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Jn(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ls(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return os(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return gs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,zr)},e.prototype.getType=function(){return Hr},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ps(this.flatCoordinates,0,t,this.stride),this.changed()},e}(rs),Ts=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=lo(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return sr(this.flatCoordinates,t)},e.prototype.getType=function(){return Kr},e.prototype.intersectsExtent=function(t){return er(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ds(this.flatCoordinates,0,t,this.stride),this.changed()},e}(rs);function Es(t,e,i,n,r){return!fr(r,(function(r){return!Is(t,e,i,n,r[0],r[1])}))}function Is(t,e,i,n,r,o){for(var s=0,a=t[i-n],l=t[i-n+1];e<i;e+=n){var u=t[e],h=t[e+1];l<=o?h>o&&(u-a)*(o-l)-(r-a)*(h-l)>0&&s++:h<=o&&(u-a)*(o-l)-(r-a)*(h-l)<0&&s--,a=u,l=h}return 0!==s}function ks(t,e,i,n,r,o){if(0===i.length)return!1;if(!Is(t,e,i[0],n,r,o))return!1;for(var s=1,a=i.length;s<a;++s)if(Is(t,i[s-1],i[s],n,r,o))return!1;return!0}function As(t,e,i,n,r,o,s){for(var a,l,u,h,c,d,p,f=r[o+1],g=[],m=0,v=i.length;m<v;++m){var y=i[m];for(h=t[y-n],d=t[y-n+1],a=e;a<y;a+=n)c=t[a],p=t[a+1],(f<=d&&p<=f||d<=f&&f<=p)&&(u=(f-d)/(p-d)*(c-h)+h,g.push(u)),h=c,d=p}var _=NaN,b=-1/0;for(g.sort(jr),h=g[0],a=1,l=g.length;a<l;++a){c=g[a];var w=Math.abs(c-h);w>b&&ks(t,e,i,n,u=(h+c)/2,f)&&(_=u,b=w),h=c}return isNaN(_)&&(_=r[o]),s?(s.push(_,f,b),s):[_,f,b]}function Ps(t,e,i,n,r,o){for(var s,a=[t[e],t[e+1]],l=[];e+n<i;e+=n){if(l[0]=t[e+n],l[1]=t[e+n+1],s=r.call(o,a,l))return s;a[0]=l[0],a[1]=l[1]}return!1}function Rs(t,e,i,n,r){var o=dr([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!Er(r,o)&&(!!tr(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||Ps(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,r=ir(t,e),o=ir(t,i);if(r===Vn||o===Vn)n=!0;else{var s,a,l=t[0],u=t[1],h=t[2],c=t[3],d=e[0],p=e[1],f=i[0],g=i[1],m=(g-p)/(f-d);o&qn&&!(r&qn)&&(n=(s=f-(g-c)/m)>=l&&s<=h),n||!(o&Wn)||r&Wn||(n=(a=g-(f-h)*m)>=u&&a<=c),n||!(o&Kn)||r&Kn||(n=(s=f-(g-u)/m)>=l&&s<=h),n||!(o&Xn)||r&Xn||(n=(a=g-(f-l)*m)>=u&&a<=c)}return n}(r,t,e)})))))}function Ls(t,e,i,n,r){if(!function(t,e,i,n,r){return!!Rs(t,e,i,n,r)||(!!Is(t,e,i,n,r[0],r[1])||(!!Is(t,e,i,n,r[0],r[3])||(!!Is(t,e,i,n,r[2],r[1])||!!Is(t,e,i,n,r[2],r[3]))))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(Es(t,i[o-1],i[o],n,r)&&!Rs(t,i[o-1],i[o],n,r))return!1;return!0}function Ms(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function Fs(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=(a-o)*(l+s),o=a,s=l}return r>0}function Os(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=Fs(t,e,l,n);if(0===s){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function Ds(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=Fs(t,e,l,n);(0===s?o&&u||!o&&!u:o&&!u||!o&&u)&&Ms(t,e,l,n),e=l}return e}function js(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)e=Ds(t,e,i[o],n,r);return e}var $s=function(t){function e(e,i,n){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&n?(this.setFlatCoordinates(i,e),this.ends_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?Ur(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Jn(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(us(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cs(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return ks(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return ss(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Ds(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,ms(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=yr(this.getExtent());this.flatInteriorPoint_=As(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Ts(this.getFlatInteriorPoint(),qr)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Cs(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],l=new Cs(e.slice(r,a),t);n.push(l),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Os(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ds(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=xs(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,zr,n)},e.prototype.getType=function(){return Yr},e.prototype.intersectsExtent=function(t){return Ls(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=fs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(rs),Ns=$s;function Bs(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new $s(o,zr,[o.length])}function Us(t,e,i){for(var n=e||32,r=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=r*(n+1),l=new Array(a),u=0;u<a;u+=r){l[u]=0,l[u+1]=0;for(var h=2;h<r;h++)l[u+h]=s[h]}var c=[l.length],d=new $s(l,o,c);return Gs(d,s,t.getRadius(),i),d}function Gs(t,e,i,n){for(var r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=n||0,l=0;l<=s;++l){var u=l*o,h=a+2*ho(l,s)*Math.PI/s;r[u]=e[0]+i*Math.cos(h),r[u+1]=e[1]+i*Math.sin(h)}t.changed()}var zs=function(t){function e(e,i,n){if(t.call(this),void 0!==n&&void 0===i)this.setFlatCoordinates(n,e);else{var r=i||0;this.setCenterAndRadius(e,r,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<n){if(0===a)for(var l=0;l<this.stride;++l)i[l]=r[l];else{var u=this.getRadius()/Math.sqrt(a);i[0]=r[0]+u*o,i[1]=r[1]+u*s;for(var h=2;h<this.stride;++h)i[h]=r[h]}return i.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return rr(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return eo},e.prototype.intersectsExtent=function(t){if(Er(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||fr(t,this.intersectsCoordinate,this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,r=ds(n,0,t,this.stride);n[r++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[r++]=n[o];n.length=r,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e}(rs);zs.prototype.transform;var Vs=zs;function qs(t,e,i,n,r,o){var s=NaN,a=NaN,l=(i-e)/n;if(1===l)s=t[e],a=t[e+1];else if(2==l)s=(1-r)*t[e]+r*t[e+n],a=(1-r)*t[e+1]+r*t[e+n+1];else if(0!==l){for(var u=t[e],h=t[e+1],c=0,d=[0],p=e+n;p<i;p+=n){var f=t[p],g=t[p+1];c+=Math.sqrt((f-u)*(f-u)+(g-h)*(g-h)),d.push(c),u=f,h=g}var m=r*c,v=function(t,e,i){for(var n,r,o=i||jr,s=0,a=t.length,l=!1;s<a;)(r=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,l=!r);return l?s:~s}(d,m);if(v<0){var y=(m-d[-v-2])/(d[-v-1]-d[-v-2]),_=e+(-v-2)*n;s=co(t[_],t[_+n],y),a=co(t[_+1],t[_+n+1],y)}else s=t[e+v*n],a=t[e+v*n+1]}return o?(o[0]=s,o[1]=a,o):[s,a]}function Ws(t,e,i,n,r,o){if(i==e)return null;var s;if(r<t[e+n-1])return o?((s=t.slice(e,e+n))[n-1]=r,s):null;if(t[i-1]<r)return o?((s=t.slice(i-n,i))[n-1]=r,s):null;if(r==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,l=i/n;a<l;){var u=a+l>>1;r<t[(u+1)*n-1]?l=u:a=u+1}var h=t[a*n-1];if(r==h)return t.slice((a-1)*n,(a-1)*n+n);var c=(r-h)/(t[(a+1)*n-1]-h);s=[];for(var d=0;d<n-1;++d)s.push(co(t[(a-1)*n+d],t[a*n+d],c));return s.push(r),s}function Ks(t,e,i,n){for(var r=t[e],o=t[e+1],s=0,a=e+n;a<i;a+=n){var l=t[a],u=t[a+1];s+=Math.sqrt((l-r)*(l-r)+(u-o)*(u-o)),r=l,o=u}return s}var Xs=function(t){function e(e,i){t.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendCoordinate=function(t){this.flatCoordinates?Ur(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Jn(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ls(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return Ps(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=qr&&this.layout!=Wr)return null;var i=void 0!==e&&e;return Ws(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return gs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return qs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Ks(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,zr)},e.prototype.getType=function(){return Xr},e.prototype.intersectsExtent=function(t){return Rs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ps(this.flatCoordinates,0,t,this.stride),this.changed()},e}(rs),Hs=ft({mixins:[Fr,Dr],data:function(){return{measuredGeometries:[]}},computed:{areaUnitMultipliers:function(){return this.unitMultipliers.map((function(t){return Math.pow(t,2)}))}},methods:{updateGeometries:function(t){var e=this;this.measuredGeometries=t.map((function(t){return t.getGeometry()})).filter((function(t){return e.isAeraGeometry(t)||e.isLengthGeometry(t)})).map((function(t){return e.measure(t)}))},measure:function(t){return t.getArea?this.formatArea(t.getArea()):t.getLength?this.formatLength(t.getLength()):t.getRadius?this.formatArea(Math.pow(t.getRadius(),2)*Math.PI):""},isAeraGeometry:function(t){return t instanceof Ns||t instanceof Vs},isLengthGeometry:function(t){return t instanceof Xs},formatArea:function(t){var e="px";if(this.hasArea){t*=Math.pow(this.pxWidthInMeter,2);var i=this.unitNearest(t,this.areaUnitMultipliers,.001);e=this.unitNames[i]+"",t/=this.areaUnitMultipliers[i]}return this.formatMeasurement(t,e,3)},formatLength:function(t){var e="px";if(this.hasArea){t*=this.pxWidthInMeter;var i=this.unitNearest(t,this.unitMultipliers);e=this.unitNames[i],t/=this.unitMultipliers[i]}return this.formatMeasurement(t,e)},formatMeasurement:function(t,e,i){return i=Math.pow(10,i||1),Math.round(t*i)/i+" "+e},unitNearest:function(t,e,i){if(0===t)return e.length-1;var n,r;for(i=i||1,r=e.length-1;r>=0&&!((n=t/e[r])>=i&&n<1e3);r--);return r}},watch:{show:function(t){t?this.$parent.$on(this.watch,this.updateGeometries):this.$parent.$off(this.watch,this.updateGeometries)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.measuredGeometries,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])}),[],!1,null,null,null),Ys=ft({components:{labelTooltip:Or,measureTooltip:Hs.exports},props:{showLabelTooltip:{type:Boolean,default:!1},showMeasureTooltip:{type:Boolean,default:!1}},computed:{showAnnotationTooltip:function(){return this.isDefaultInteractionMode&&(this.showLabelTooltip||this.showMeasureTooltip)}},data:function(){return{hoveredFeaturesHash:""}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])}},watch:{showAnnotationTooltip:function(t){t?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}}},void 0,void 0,!1,null,null,null).exports,Zs={SINGLECLICK:"singleclick",CLICK:en,DBLCLICK:nn,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};function Js(t){return Math.pow(t,3)}function Qs(t){return 1-Js(1-t)}function ta(t){return 3*t*t-2*t*t*t}function ea(t){return t}var ia="active";function na(t,e,i,n){e=t.constrainRotation(e,0),ra(t,e,i,n)}function ra(t,e,i,n){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&n>0?t.animate({rotation:e,anchor:i,duration:n,easing:Qs}):t.rotate(e,i)}}function oa(t,e,i,n){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(void 0!==o){var s=t.getResolutions();o=oo(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==r){var a=t.getCenter(),l=t.calculateCenterZoom(o,i);l=t.constrainCenter(l),i=[(o*a[0]-r*l[0])/(o-r),(o*a[1]-r*l[1])/(o-r)]}sa(t,o,i,n)}function sa(t,e,i,n){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&n)t.animate({resolution:e,anchor:i,duration:n,easing:Qs});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}var aa=function(t){function e(e){t.call(this),e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get(ia)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(ia,t)},e.prototype.setMap=function(t){this.map_=t},e}(bn);function la(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]}var ua=function(t){function e(e){var i=e||{};t.call(this,i),i.handleDownEvent&&(this.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(this.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(this.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(this.handleUpEvent=i.handleUpEvent),i.stopDown&&(this.stopDown=i.stopDown),this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Zs.POINTERDRAG)this.handleDragEvent(t);else if(t.type==Zs.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Zs.POINTERDOWN){var n=this.handleDownEvent(t);n&&t.preventDefault(),this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Zs.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Zs.POINTERDOWN||e===Zs.POINTERDRAG||e===Zs.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==Zs.POINTERUP?delete this.trackedPointers_[i]:(t.type==Zs.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=Mi(this.trackedPointers_)}},e}(aa);function ha(t){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ca(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function da(t,e){return(da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ga(t);if(e){var r=ga(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return fa(this,i)}}function fa(t,e){return!e||"object"!==ha(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ma,va=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(o,t);var e,i,n,r=pa(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.features=void 0!==t.features?t.features:null,e.currentFeature=void 0,e.map=t.map,e}return e=o,(i=[{key:"toggleActive",value:function(t){if(t.oldValue){var e=this.map.getTargetElement();e&&(e.style.cursor="")}}},{key:"handleDownEvent",value:function(t){return this.currentFeature=this.featuresAtPixel(t.pixel,t.map),!!this.currentFeature}},{key:"handleUpEvent",value:function(){this.currentFeature&&this.currentFeature.get("annotation")&&this.dispatchEvent({type:"attach",feature:this.currentFeature}),this.currentFeature=void 0}},{key:"handleMoveEvent",value:function(t){var e=t.map.getTargetElement(),i=this.featuresAtPixel(t.pixel,t.map);e.style.cursor=i?"pointer":""}},{key:"featuresAtPixel",value:function(t,e){var i=null,n=e.forEachFeatureAtPixel(t,(function(t){return t}),this);return this.handlesFeature(n)&&(i=n),i}},{key:"handlesFeature",value:function(t){return!!this.features&&-1!==this.features.getArray().indexOf(t)}}])&&ca(e.prototype,i),n&&ca(e,n),o}(ua),ya=ft({computed:{isAttaching:function(){return"attach"===this.interactionMode}},methods:{toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attach"},handleAttachLabel:function(t){this.$emit("attach",t.feature.get("annotation"),this.selectedLabel)}},watch:{isAttaching:function(t){this.canAdd&&(t&&!this.hasSelectedLabel?this.requireSelectedLabel():ma.setActive(t))},selectedLabel:function(t){!t&&this.isAttaching&&this.resetInteractionMode()}},mounted:function(){this.canAdd&&((ma=new va({features:this.annotationFeatures,map:this.map})).setActive(!1),ma.on("attach",this.handleAttachLabel),this.map.addInteraction(ma),oe.on("l",this.toggleAttaching,0,this.listenerSet))}},void 0,void 0,!1,null,null,null).exports,_a=0,ba=1,wa=2,xa=3,Sa=function(t){function e(e,i,n,r){t.call(this),this.extent=e,this.pixelRatio_=n,this.resolution=i,this.state=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(Ji)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Ii()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Ii()},e}(Zi);function Ca(t,e,i,n){var r=Wo(i,e,t),o=Bo(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var l=t.getExtent();if(!l||Qn(l,r)){var u=Bo(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function Ta(t,e,i,n){var r=i-t,o=n-e,s=Math.sqrt(r*r+o*o);return[Math.round(i+r/s),Math.round(n+o/s)]}function Ea(t,e,i,n,r,o,s,a,l,u,h){var c=Rn(Math.round(i*t),Math.round(i*e));if(0===l.length)return c.canvas;c.scale(i,i);var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){ur(d,t.extent)}));var p=Tr(d),f=wr(d),g=Rn(Math.round(i*p/n),Math.round(i*f/n)),m=i/n;l.forEach((function(t,e,i){var n=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=Tr(t.extent),s=wr(t.extent);g.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,n*m,r*m,o*m,s*m)}));var v=Sr(s);return a.getTriangles().forEach((function(t,e,r){var s=t.source,a=t.target,l=s[0][0],u=s[0][1],h=s[1][0],p=s[1][1],f=s[2][0],m=s[2][1],y=(a[0][0]-v[0])/o,_=-(a[0][1]-v[1])/o,b=(a[1][0]-v[0])/o,w=-(a[1][1]-v[1])/o,x=(a[2][0]-v[0])/o,S=-(a[2][1]-v[1])/o,C=l,T=u;l=0,u=0;var E=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>r&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var l=i+1;l<e;l++)for(var u=-t[l][i]/t[i][i],h=i;h<e+1;h++)i==h?t[l][h]=0:t[l][h]+=u*t[i][h]}for(var c=new Array(e),d=e-1;d>=0;d--){c[d]=t[d][e]/t[d][d];for(var p=d-1;p>=0;p--)t[p][e]-=t[p][d]*c[d]}return c}([[h-=C,p-=T,0,0,b-y],[f-=C,m-=T,0,0,x-y],[0,0,h,p,w-_],[0,0,f,m,S-_]]);if(E){c.save(),c.beginPath();var I=(y+b+x)/3,k=(_+w+S)/3,A=Ta(I,k,y,_),P=Ta(I,k,b,w),R=Ta(I,k,x,S);c.moveTo(P[0],P[1]),c.lineTo(A[0],A[1]),c.lineTo(R[0],R[1]),c.clip(),c.transform(E[0],E[2],E[1],E[3],y,_),c.translate(d[0]-C,d[3]-T),c.scale(n/i,-n/i),c.drawImage(g.canvas,0,0),c.restore()}})),h&&(c.save(),c.strokeStyle="black",c.lineWidth=1,a.getTriangles().forEach((function(t,e,i){var n=t.target,r=(n[0][0]-v[0])/o,s=-(n[0][1]-v[1])/o,a=(n[1][0]-v[0])/o,l=-(n[1][1]-v[1])/o,u=(n[2][0]-v[0])/o,h=-(n[2][1]-v[1])/o;c.beginPath(),c.moveTo(a,l),c.lineTo(r,s),c.lineTo(u,h),c.closePath(),c.stroke()})),c.restore()),c.canvas}var Ia=function(t,e,i,n,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=qo(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Tr(n)==Tr(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Tr(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Tr(this.targetProj_.getExtent()):null;var a=Sr(i),l=Cr(i),u=vr(i),h=mr(i),c=this.transformInv_(a),d=this.transformInv_(l),p=this.transformInv_(u),f=this.transformInv_(h);if(this.addQuad_(a,l,u,h,c,d,p,f,10),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};Ia.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},Ia.prototype.addQuad_=function(t,e,i,n,r,o,s,a,l){var u=Hn([r,o,s,a]),h=this.sourceWorldWidth_?Tr(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,p=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=Tr(Hn([t,e,i,n]))/this.targetWorldWidth_>.25||p;!d&&this.sourceProj_.isGlobal()&&h&&(p=h>.25||p)}if(p||!this.maxSourceExtent_||Er(u,this.maxSourceExtent_)){if(!(p||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(l>0))return;p=!0}if(l>0){if(!p){var f,g=[(t[0]+i[0])/2,(t[1]+i[1])/2],m=this.transformInv_(g);if(d)f=(ho(r[0],c)+ho(s[0],c))/2-ho(m[0],c);else f=(r[0]+s[0])/2-m[0];var v=(r[1]+s[1])/2-m[1];p=f*f+v*v>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],_=this.transformInv_(y),b=[(n[0]+t[0])/2,(n[1]+t[1])/2],w=this.transformInv_(b);this.addQuad_(t,e,y,b,r,o,_,w,l-1),this.addQuad_(b,y,i,n,w,_,s,a,l-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],S=this.transformInv_(x),C=[(i[0]+n[0])/2,(i[1]+n[1])/2],T=this.transformInv_(C);this.addQuad_(t,x,C,n,r,S,T,a,l-1),this.addQuad_(x,e,i,C,S,o,s,T,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,r,s,a),this.addTriangle_(t,e,i,r,o,s)}},Ia.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var r=e.source;hr(t,r[0]),hr(t,r[1]),hr(t,r[2])})),t},Ia.prototype.getTriangles=function(){return this.triangles_};var ka=Ia,Aa=function(t){function e(e,i,n,r,o,s){var a=e.getExtent(),l=i.getExtent(),u=l?xr(n,l):n,h=Ca(e,i,yr(u),r),c=new ka(e,i,u,a,.5*h),d=s(c.calculateSourceExtent(),h,o),p=wa;d&&(p=_a);var f=d?d.getPixelRatio():1;t.call(this,n,r,f,p),this.targetProj_=i,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=r,this.targetExtent_=n,this.sourceImage_=d,this.sourcePixelRatio_=f,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==ba&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==wa){var e=Tr(this.targetExtent_)/this.targetResolution_,i=wr(this.targetExtent_)/this.targetResolution_;this.canvas_=Ea(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==_a){this.state=ba,this.changed();var t=this.sourceImage_.getState();t==wa||t==xa?this.reproject_():(this.sourceListenerKey_=Ni(this.sourceImage_,Ji,(function(t){var e=this.sourceImage_.getState();e!=wa&&e!=xa||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){Gi(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(Sa),Pa="undefined",Ra="ready";function La(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Ma=function(t){function e(e){t.call(this),this.projection_=No(e.projection),this.attributions_=La(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:Ra,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return Ii()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=La(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(bn),Fa="imageloadstart",Oa="imageloadend",Da="imageloaderror",ja=function(t){function e(e,i){t.call(this,e),this.image=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);var $a=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Nr(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,n){var r=this.getProjection();if(r&&n&&!zo(r,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&zo(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&lr(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Aa(r,n,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(n=r),this.getImageInternal(t,e,i,n)},e.prototype.getImageInternal=function(t,e,i,n){return Ii()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case ba:this.loading=!0,this.dispatchEvent(new ja(Fa,e));break;case wa:this.loading=!1,this.dispatchEvent(new ja(Oa,e));break;case xa:this.loading=!1,this.dispatchEvent(new ja(Da,e))}},e}(Ma),Na=function(t){function e(e,i,n,r,o){var s=void 0!==o?_a:wa;void 0===i&&(i=wr(e)/r.height),t.call(this,e,i,n,s),this.loader_=void 0!==o?o:null,this.canvas_=r,this.error_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=xa):this.state=wa,this.changed()},e.prototype.load=function(){this.state==_a&&(this.state=ba,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(Sa),Ba=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvas_=new Na(e.canvasExtent,void 0,1,e.canvas),this.canvasSize_=e.canvasSize?e.canvasSize:null,Ni(this.canvas_,Ji,this.handleImageChange,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageInternal=function(t,e,i,n){return Er(t,this.canvas_.getExtent())?this.canvas_:null},e}($a),Ua="add",Ga="remove",za="length",Va=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),qa=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(za)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Va(Ua,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Va(Ga,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Va(Ga,n)),this.dispatchEvent(new Va(Ua,e))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(za,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new jn(58)},e}(bn),Wa=ft({props:{title:{type:String,default:""},icon:{type:String,required:!0},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},open:{type:Boolean,default:!1}},data:function(){return{mouseOver:!1,timeout:null,activeSubControls:0}},computed:{classObject:function(){return{active:this.active,"control-button--open":this.showSubControls}},iconClass:function(){return this.icon.startsWith("fa-")?"fa fa-fw "+this.icon:"icon icon-white "+this.icon},hasSubControls:function(){return this.$slots.hasOwnProperty("default")},showSubControls:function(){return this.mouseOver||this.hasActiveSubControl||this.open},hasActiveSubControl:function(){return this.activeSubControls>0}},methods:{handleClick:function(){this.disabled||this.$emit("click")},handleMouseEnter:function(){!this.disabled&&this.hover&&(this.mouseOver=!0),window.clearTimeout(this.timeout)},handleMouseLeave:function(){var t=this;window.clearTimeout(this.timeout),this.timeout=window.setTimeout((function(){t.mouseOver=!1}),200)},updateActiveSubControls:function(t){t?this.activeSubControls+=1:this.activeSubControls=Math.max(0,this.activeSubControls-1)}},watch:{active:function(t){this.$parent.$emit("control-button-active",t)}},created:function(){this.$on("control-button-active",this.updateActiveSubControls)},mounted:function(){this.active&&this.$parent.$emit("control-button-active",!0)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"control-button btn",class:t.classObject,attrs:{title:t.title,disabled:t.disabled},on:{click:t.handleClick,mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[i("i",{class:t.iconClass,attrs:{"aria-hidden":"true"}}),t._v(" "),t.hasSubControls?i("span",{staticClass:"control-button__sub-controls btn-group",on:{click:function(t){t.stopPropagation()}}},[t._t("default")],2):t._e()])}),[],!1,null,null,null).exports;var Ka=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,Ni(this,vn(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Gi(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Ni(t,Ji,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:($n("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){Ui(this,vn(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,Ni(this,vn(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(bn),Xa=function(t){function e(e,i,n){t.call(this,e),this.map=i,this.frameState=void 0!==n?n:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),Ha=function(t){function e(e,i,n,r,o){t.call(this,e,i,o),this.originalEvent=n,this.pixel=i.getEventPixel(n),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Xa),Ya=function(t){function e(e,i,n,r,o){t.call(this,e,i,n.originalEvent,r,o),this.pointerEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ha);function Za(t,e){return t[0]+=e[0],t[1]+=e[1],t}function Ja(t,e){var i,n,r=t[0],o=t[1],s=e[0],a=e[1],l=s[0],u=s[1],h=a[0],c=a[1],d=h-l,p=c-u,f=0===d&&0===p?0:(d*(r-l)+p*(o-u))/(d*d+p*p||0);return f<=0?(i=l,n=u):f>=1?(i=h,n=c):(i=l+f*d,n=u+f*p),[i,n]}function Qa(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function tl(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function el(t,e){return t[0]*=e,t[1]*=e,t}function il(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function nl(t,e){return Math.sqrt(il(t,e))}var rl="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",ol=-1!==rl.indexOf("firefox"),sl=-1!==rl.indexOf("safari")&&-1==rl.indexOf("chrom"),al=-1!==rl.indexOf("webkit")&&-1==rl.indexOf("edge"),ll=-1!==rl.indexOf("macintosh"),ul=window.devicePixelRatio||1,hl=function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}(),cl=(navigator,"ontouchstart"in window),dl="PointerEvent"in window,pl=!!navigator.msPointerEnabled,fl=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},gl=function(t){return t.target.getTargetElement()===document.activeElement},ml=qi,vl=function(t){return t.type==Zs.CLICK},yl=function(t){var e=t.originalEvent;return 0==e.button&&!(al&&ll&&e.ctrlKey)},_l=Wi,bl=function(t){return t.type==Zs.SINGLECLICK},wl=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},xl=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Sl=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Cl=function(t){var e=t.pointerEvent;return $n(void 0!==e,56),"mouse"==e.pointerType},Tl=function(t){var e=t.pointerEvent;return $n(void 0!==e,56),e.isPrimary&&0===e.button},El=function(t){function e(e,i,n){if(t.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,i);else if(void 0!==i&&n)this.setFlatCoordinates(i,e),this.ends_=n;else{for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout()),Ur(s,h.getFlatCoordinates()),a.push(s.length)}this.setFlatCoordinates(r,s),this.ends_=a}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLineString=function(t){this.flatCoordinates?Ur(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Jn(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(us(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cs(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=qr&&this.layout!=Wr||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,r=void 0!==i&&i;return function(t,e,i,n,r,o,s){if(s)return Ws(t,e,i[i.length-1],n,r,o);var a;if(r<t[n-1])return o?((a=t.slice(0,n))[n-1]=r,a):null;if(t[t.length-1]<r)return o?((a=t.slice(t.length-n))[n-1]=r,a):null;for(var l=0,u=i.length;l<u;++l){var h=i[l];if(e!=h){if(r<t[e+n-1])return null;if(r<=t[h-1])return Ws(t,e,h,n,r,!1);e=h}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,r)},e.prototype.getCoordinates=function(){return ms(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Xs(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],r=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new Xs(t.slice(r,a),i);n.push(l),r=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,o=0,s=n.length;o<s;++o){var a=n[o];Ur(t,qs(e,i,a,r,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=_s(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,zr,n)},e.prototype.getType=function(){return Jr},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){if(Rs(t,e,i[o],n,r))return!0;e=i[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=fs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(rs),Il=function(t){function e(e,i){t.call(this),i&&!Array.isArray(e[0])?this.setFlatCoordinates(i,e):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPoint=function(t){this.flatCoordinates?Ur(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<Jn(this.getExtent(),t,e))return n;for(var r=this.flatCoordinates,o=this.stride,s=0,a=r.length;s<a;s+=o){var l=lo(t,e,r[s],r[s+1]);if(l<n){n=l;for(var u=0;u<o;++u)i[u]=r[s+u];i.length=o}}return n},e.prototype.getCoordinates=function(){return gs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Ts(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],r=0,o=t.length;r<o;r+=i){var s=new Ts(t.slice(r,r+i),e);n.push(s)}return n},e.prototype.getType=function(){return Zr},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,r=e.length;n<r;n+=i){if(er(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ps(this.flatCoordinates,0,t,this.stride),this.changed()},e}(rs);var kl=function(t){function e(e,i,n){if(t.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout());for(var c=s.length,d=h.getEnds(),p=0,f=d.length;p<f;++p)d[p]+=c;Ur(s,h.getFlatCoordinates()),a.push(d)}i=r,e=s,n=a}void 0!==i&&n?(this.setFlatCoordinates(i,e),this.endss_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;Ur(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<Jn(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=us(t,e,a,n,r),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=cs(t,e,f,n,r,o,s,a,l,u,c),e=f[f.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,r,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var l=i[s];if(ks(t,e,l,n,r,o))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=ss(t,e,a,n),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?js(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,vs(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var r=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var l=i[s];o=ar(t,e,l[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,r){for(var o=[],s=0,a=i.length;s<a;++s){var l=i[s];o=As(t,e,l,n,r,2*s,o),e=l[l.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new Il(this.getFlatInteriorPoints().slice(),qr)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)if(!Os(t,e,i[o],n,r))return!1;return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=js(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l],c=[];s=xs(t,e,h,n,r,o,s,c),a.push(c),e=h[h.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,zr,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),r=n[n.length-1];if(0!==e)for(var o=0,s=n.length;o<s;++o)n[o]-=e;return new Ns(this.flatCoordinates.slice(e,r),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),l=a[a.length-1];if(0!==r)for(var u=0,h=a.length;u<h;++u)a[u]-=r;var c=new Ns(e.slice(r,l),t,a);n.push(c),r=l}return n},e.prototype.getType=function(){return Qr},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(Ls(t,e,a,n,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=fs(t,e,i[a],n,o[s]);o[s++]=u,e=u[u.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(rs),Al=function(t,e){this.dispatcher=t,this.mapping_=e};Al.prototype.getEvents=function(){return Object.keys(this.mapping_)},Al.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};var Pl=Al;function Rl(t){if(!this.isEventSimulatedFromTouch_(t)){1..toString()in this.pointerMap&&this.cancel(t);var e=Dl(t,this.dispatcher);this.pointerMap[1..toString()]=t,this.dispatcher.down(e,t)}}function Ll(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Dl(t,this.dispatcher);this.dispatcher.move(e,t)}}function Ml(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[1..toString()];if(e&&e.button===t.button){var i=Dl(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function Fl(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Dl(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function Ol(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Dl(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function Dl(t,e){var i=e.cloneEvent(t,t),n=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),n()},i.pointerId=1,i.isPrimary=!0,i.pointerType="mouse",i}var jl=function(t){function e(e){var i={mousedown:Rl,mousemove:Ll,mouseup:Ml,mouseover:Fl,mouseout:Ol};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,n=t.clientY,r=0,o=e.length,s=void 0;r<o&&(s=e[r]);r++){var a=Math.abs(i-s[0]),l=Math.abs(n-s[1]);if(a<=25&&l<=25)return!0}return!1},e.prototype.cancel=function(t){var e=Dl(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[1..toString()]},e}(Pl),$l="IMAGE",Nl="TILE",Bl="VECTOR_TILE",Ul="VECTOR",Gl="opacity",zl="visible",Vl="extent",ql="zIndex",Wl="maxResolution",Kl="minResolution",Xl="source",Hl=function(t){function e(e){t.call(this);var i=Ri({},e);i[Gl]=void 0!==e.opacity?e.opacity:1,i[zl]=void 0===e.visible||e.visible,i[ql]=e.zIndex,i[Wl]=void 0!==e.maxResolution?e.maxResolution:1/0,i[Kl]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=oo(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return Ii()},e.prototype.getLayerStatesArray=function(t){return Ii()},e.prototype.getExtent=function(){return this.get(Vl)},e.prototype.getMaxResolution=function(){return this.get(Wl)},e.prototype.getMinResolution=function(){return this.get(Kl)},e.prototype.getOpacity=function(){return this.get(Gl)},e.prototype.getSourceState=function(){return Ii()},e.prototype.getVisible=function(){return this.get(zl)},e.prototype.getZIndex=function(){return this.get(ql)},e.prototype.setExtent=function(t){this.set(Vl,t)},e.prototype.setMaxResolution=function(t){this.set(Wl,t)},e.prototype.setMinResolution=function(t){this.set(Kl,t)},e.prototype.setOpacity=function(t){this.set(Gl,t)},e.prototype.setVisible=function(t){this.set(zl,t)},e.prototype.setZIndex=function(t){this.set(ql,t)},e}(bn),Yl="postcompose",Zl="precompose",Jl="render",Ql="rendercomplete";function tu(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}var eu=function(t){function e(e){var i=Ri({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),Ni(this,vn(Xl),this.handleSourcePropertyChange_,this);var n=e.source?e.source:null;this.setSource(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Xl)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Pa},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Gi(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Ni(t,Ji,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Gi(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Gi(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Ni(t,Zl,(function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[Ai(this)]=i}),this),this.mapRenderKey_=Ni(this,Ji,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Xl,t)},e}(Hl),iu="image",nu="vector",ru=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,ou=/^([a-z]*)$/i;function su(t){return"string"==typeof t?t:lu(t)}!function(){var t={},e=0}();function au(t){return t[0]=oo(t[0]+.5|0,0,255),t[1]=oo(t[1]+.5|0,0,255),t[2]=oo(t[2]+.5|0,0,255),t[3]=oo(t[3],0,1),t}function lu(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function uu(t){return Array.isArray(t)?lu(t):t}var hu=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Qi)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return $n(void 0!==e,15),e===this.newest_||(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_},e.prototype.remove=function(t){var e=this.entries_[t];return $n(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){$n(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(Zi),cu=[0,0,0,1],du=[],pu=[0,0,0,1],fu=[0,0,0,0],gu=new hu,mu={},vu=null,yu={},_u=function(){var t,e,i=mu,n=["monospace","serif"],r=n.length,o="wmytzilWMYTZIL@#/&?$%10";function s(t){for(var i=bu(),s=100;s<=700;s+=300){for(var a=s+" ",l=!0,u=0;u<r;++u){var h=n[u];if(i.font=a+"32px "+h,e=i.measureText(o).width,t!=h){i.font=a+"32px "+t+","+h;var c=i.measureText(o).width;l=l&&c!=e}}if(l)return!0}return!1}function a(){var e=!0;for(var n in i)i[n]<60&&(s(n)?(i[n]=60,Li(yu),vu=null,gu.clear()):(++i[n],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var n=Pn(e);if(n)for(var r=0,o=n.length;r<o;++r){var l=n[r];l in i||(i[l]=60,s(l)||(i[l]=0,void 0===t&&(t=setInterval(a,32))))}}}();function bu(){return vu||(vu=Rn(1,1)),vu}var wu,xu,Su=(xu=yu,function(t){var e=xu[t];return null==e&&(wu||((wu=document.createElement("span")).textContent="M",wu.style.margin=wu.style.padding="0 !important",wu.style.position="absolute !important",wu.style.left="-99999px !important"),wu.style.font=t,document.body.appendChild(wu),e=xu[t]=wu.offsetHeight,document.body.removeChild(wu)),e});function Cu(t,e){var i=bu();return t!=i.font&&(i.font=t),i.measureText(e).width}function Tu(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}var Eu=[1,0,0,1,0,0];function Iu(t,e,i,n,r,o,s,a,l,u,h){var c;1!=i&&(c=t.globalAlpha,t.globalAlpha=c*i),e&&t.setTransform.apply(t,e),t.drawImage(n,r,o,s,a,l,u,s*h,a*h),c&&(t.globalAlpha=c),e&&t.setTransform.apply(t,Eu)}var ku=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};ku.prototype.clone=function(){return new ku({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},ku.prototype.getOpacity=function(){return this.opacity_},ku.prototype.getRotateWithView=function(){return this.rotateWithView_},ku.prototype.getRotation=function(){return this.rotation_},ku.prototype.getScale=function(){return this.scale_},ku.prototype.getSnapToPixel=function(){return!1},ku.prototype.getAnchor=function(){return Ii()},ku.prototype.getImage=function(t){return Ii()},ku.prototype.getHitDetectionImage=function(t){return Ii()},ku.prototype.getImageState=function(){return Ii()},ku.prototype.getImageSize=function(){return Ii()},ku.prototype.getHitDetectionImageSize=function(){return Ii()},ku.prototype.getOrigin=function(){return Ii()},ku.prototype.getSize=function(){return Ii()},ku.prototype.setOpacity=function(t){this.opacity_=t},ku.prototype.setRotateWithView=function(t){this.rotateWithView_=t},ku.prototype.setRotation=function(t){this.rotation_=t},ku.prototype.setScale=function(t){this.scale_=t},ku.prototype.setSnapToPixel=function(t){},ku.prototype.listenImageChange=function(t,e){return Ii()},ku.prototype.load=function(){Ii()},ku.prototype.unlistenImageChange=function(t,e){Ii()};var Au=function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return wa},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",o=0,s=null,a=0,l=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=pu),i=uu(i),void 0===(l=this.stroke_.getWidth())&&(l=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),hl||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r="round"),void 0===(n=this.stroke_.getLineCap())&&(n="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+l)+1,h={strokeStyle:i,strokeWidth:l,size:u,lineCap:n,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var c=Rn(u,u);this.canvas_=c.canvas,e=u=this.canvas_.width,this.draw_(h,c,0,0),this.createHitDetectionCanvas_(h)}else{u=Math.round(u);var d,p=!this.fill_;p&&(d=this.drawHitDetectionCanvas_.bind(this,h));var f=this.getChecksum(),g=t.add(f,u,u,this.draw_.bind(this,h),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,p?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=cu),e.fillStyle=uu(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Rn(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=su(cu),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(ku),Pu=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(Au),Ru=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};Ru.prototype.clone=function(){var t=this.getColor();return new Ru({color:Array.isArray(t)?t.slice():t||void 0})},Ru.prototype.getColor=function(){return this.color_},Ru.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Ru.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+su(t):this.checksum_=Ai(this.color_):this.checksum_="f-"}return this.checksum_};var Lu=Ru,Mu=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};Mu.prototype.clone=function(){var t=this.getColor();return new Mu({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},Mu.prototype.getColor=function(){return this.color_},Mu.prototype.getLineCap=function(){return this.lineCap_},Mu.prototype.getLineDash=function(){return this.lineDash_},Mu.prototype.getLineDashOffset=function(){return this.lineDashOffset_},Mu.prototype.getLineJoin=function(){return this.lineJoin_},Mu.prototype.getMiterLimit=function(){return this.miterLimit_},Mu.prototype.getWidth=function(){return this.width_},Mu.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Mu.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},Mu.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},Mu.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},Mu.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},Mu.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},Mu.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},Mu.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=Ai(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var Fu=Mu,Ou=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Nu,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};Ou.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Ou({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},Ou.prototype.getRenderer=function(){return this.renderer_},Ou.prototype.setRenderer=function(t){this.renderer_=t},Ou.prototype.getGeometry=function(){return this.geometry_},Ou.prototype.getGeometryFunction=function(){return this.geometryFunction_},Ou.prototype.getFill=function(){return this.fill_},Ou.prototype.setFill=function(t){this.fill_=t},Ou.prototype.getImage=function(){return this.image_},Ou.prototype.setImage=function(t){this.image_=t},Ou.prototype.getStroke=function(){return this.stroke_},Ou.prototype.setStroke=function(t){this.stroke_=t},Ou.prototype.getText=function(){return this.text_},Ou.prototype.setText=function(t){this.text_=t},Ou.prototype.getZIndex=function(){return this.zIndex_},Ou.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Nu,this.geometry_=t},Ou.prototype.setZIndex=function(t){this.zIndex_=t};var Du=null;function ju(t,e){if(!Du){var i=new Lu({color:"rgba(255,255,255,0.4)"}),n=new Fu({color:"#3399CC",width:1.25});Du=[new Ou({image:new Pu({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return Du}function $u(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[Yr]=[new Ou({fill:new Lu({color:[255,255,255,.5]})})],t[Qr]=t[Yr],t[Xr]=[new Ou({stroke:new Fu({color:e,width:5})}),new Ou({stroke:new Fu({color:i,width:3})})],t[Jr]=t[Xr],t[eo]=t[Yr].concat(t[Xr]),t[Kr]=[new Ou({image:new Pu({radius:6,fill:new Lu({color:i}),stroke:new Fu({color:e,width:1.5})}),zIndex:1/0})],t[Zr]=t[Kr],t[to]=t[Yr].concat(t[Xr],t[Kr]),t}function Nu(t){return t.getGeometry()}var Bu=Ou,Uu="renderOrder",Gu=function(t){function e(e){var i=e||{},n=Ri({},i);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,t.call(this,n),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||nu,this.type=Ul}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Uu)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Uu,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:ju,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else $n("function"==typeof t.getZIndex,41),i=[t];e=function(){return i}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(eu);Gu.prototype.getSource;var zu=Gu,Vu="arraybuffer",qu="json",Wu="text",Ku="xml";function Xu(t,e){return function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Vu&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==qu||o==Wu?r=a.responseText:o==Ku?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Vu&&(r=a.response),r?i.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),Ki)}function Hu(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Yu="addfeature",Zu="changefeature",Ju="clear",Qu="removefeature",th=i("A1R+"),eh=i.n(th),ih=function(t){this.rbush_=eh()(t,void 0),this.items_={}};ih.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Ai(e)]=i},ih.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[Ai(s)]=a}this.rbush_.load(i)},ih.prototype.remove=function(t){var e=Ai(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},ih.prototype.update=function(t,e){var i=this.items_[Ai(e)];lr([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},ih.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},ih.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},ih.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},ih.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},ih.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},ih.prototype.isEmpty=function(){return Fi(this.items_)},ih.prototype.clear=function(){this.rbush_.clear(),this.items_={}},ih.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return rr(e.minX,e.minY,e.maxX,e.maxY,t)},ih.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};var nh=ih,rh=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),oh=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:Ra,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=Ki,this.format_=i.format,this.overlaps_=null==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&($n(this.format_,7),this.loader_=Xu(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:Hu;var n,r,o=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=o?new nh:null,this.loadedExtentsRtree_=new nh,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(i.features)?r=i.features:i.features&&(r=(n=i.features).getArray()),o||void 0!==n||(n=new qa(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Ai(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new rh(Yu,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Ni(e,Ji,this.handleFeatureChange_,this),Ni(e,Pi,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:($n(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=t[r],a=Ai(s);this.addToIndex_(a,s)&&i.push(s)}for(var l=0,u=i.length;l<u;l++){var h=i[l],c=Ai(h);this.setupChangeEvents_(c,h);var d=h.getGeometry();if(d){var p=d.getExtent();e.push(p),n.push(h)}else this.nullGeometryFeatures_[c]=h}this.featuresRtree_&&this.featuresRtree_.load(e,n);for(var f=0,g=i.length;f<g;f++)this.dispatchEvent(new rh(Yu,i[f]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;Ni(this,Yu,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),Ni(this,Qu,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),Ni(t,Ua,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}),this),Ni(t,Ga,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}),this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(Gi)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new rh(Ju);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Fi(this.nullGeometryFeatures_)||Ur(t,Mi(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],l=e||qi;return this.featuresRtree_.forEachInExtent(a,(function(t){if(l(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(i,n,o,s))<u){r=t;var h=Math.sqrt(s);a[0]=i-h,a[1]=n-h,a[2]=i+h,a[3]=n+h}}})),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=Ai(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var s=o.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[s]=e):this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new rh(Zu,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Ai(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Fi(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,(function(t){return tr(t.extent,a)}))||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}),n.loading=n.loader_!==Ki)},a=0,l=o.length;a<l;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(lr(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=Ai(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=Ai(t);this.featureChangeKeys_[e].forEach(Gi),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new rh(Qu,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(Ma),sh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return io},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e}(Ns),ah=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return no},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e.prototype.getArea=function(){var t=this.flatCoordinates,e=Math.sqrt(Math.pow(t[0]-t[4],2)+Math.pow(t[1]-t[5],2)),i=Math.sqrt(Math.pow(t[2]-t[6],2)+Math.pow(t[3]-t[7],2));return Math.PI*e*i*.25},e}(Ns),lh="Point",uh="LineString",hh="Polygon",ch="Circle",dh="Ellipse",ph="drawstart",fh="drawend",gh=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);var mh,vh=function(t){function e(e){var i=e;i.stopDown||(i.stopDown=Wi),t.call(this,i),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(t){var e;t===Kr||t===Zr?e=lh:t===Xr||t===Jr||t===io?e=uh:t===Yr||t===Qr?e=hh:t===eo?e=ch:t===no&&(e=dh);return e}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_===hh?3:2,this.maxPoints_=e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:qi;var n,r=e.geometryFunction;if(!r)if(this.type_===eo)r=function(t,e){var i=e||new Vs([NaN,NaN]),n=il(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(n)),i};else if(this.type_===io)this.minPoints_=3,this.maxPoints_=3,r=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]];if(0===o[1])t=[[i,i,i,i]];else{var s=[-1*o[1],o[0]],a=o[0]/o[1],l=(r[0]+a*(n[1]-r[1])-n[0])/(s[0]-s[1]*a),u=[l*s[0],l*s[1]];t=[[[i[0]-u[0],i[1]-u[1]],[n[0]-u[0],n[1]-u[1]],[n[0]+u[0],n[1]+u[1]],[i[0]+u[0],i[1]+u[1]]]]}}else t=[t];var h=e;return h?h.setCoordinates(t):h=new sh(t),h};else if(this.type_===no)this.minPoints_=3,this.maxPoints_=3,r=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]],s=[i[0]+.5*o[0],i[1]+.5*o[1]];if(0===o[1])t=[[i,i,i,i]];else{var a=[-1*o[1],o[0]],l=o[0]/o[1],u=(r[0]+l*(n[1]-r[1])-n[0])/(a[0]-a[1]*l),h=[u*a[0],u*a[1]];t=[[[i[0],i[1]],[s[0]-h[0],s[1]-h[1]],[n[0],n[1]],[s[0]+h[0],s[1]+h[1]]]]}}else t=[t];var c=e;return c?c.setCoordinates(t):c=new ah(t),c};else{var o,s=this.mode_;s===lh?o=Ts:s===uh?o=Xs:s===hh&&(o=Ns),r=function(t,e){var i=e;return i?s===hh?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new o(t),i}}this.geometryFunction_=r,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new zu({source:new oh({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:(n=$u(),function(t,e){return n[t.getGeometry().getType()]}),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:wl,this.freehandCondition_,e.freehand?this.freehandCondition_=ml:this.freehandCondition_=e.freehandCondition?e.freehandCondition:xl,Ni(this,vn(ia),this.updateState_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===tn&&e.preventDefault(),this.freehand_=this.mode_!==lh&&this.freehandCondition_(e);var i=e.type===Zs.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===Zs.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===Zs.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e),n=!1):this.freehand_&&e.type===Zs.POINTERDOWN?n=!1:i?(n=e.type===Zs.POINTERMOVE)&&this.freehand_?n=this.handlePointerMove_(e):("mouse"==e.pointerEvent.pointerType||e.type===Zs.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Zs.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Ya(Zs.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===ch;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===lh&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_];if(this.mode_===uh)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===hh){var r=this.sketchCoords_;i=r[0].length>this.minPoints_,n=[r[0][0],r[0][r[0].length-2]]}if(i)for(var o=t.map,s=0,a=n.length;s<a;s++){var l=n[s],u=o.getPixelFromCoordinate(l),h=t.pixel,c=h[0]-u[0],d=h[1]-u[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+d*d)<=p){this.finishCoordinate_=l;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new Ka(new Ts(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===lh?this.sketchCoords_=e.slice():this.mode_===hh?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Ka(new Xs(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new Ka,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new gh(ph,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,n,r=t.coordinate,o=this.sketchFeature_.getGeometry();(this.mode_===lh?i=this.sketchCoords_:this.mode_===hh?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(r=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=r[0],i[1]=r[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(r);if(this.mode_===dh)if(this.sketchLine_||(this.sketchLine_=new Ka(new Xs([0,0]))),n=this.sketchLine_.getGeometry(),this.sketchCoords_.length<3)n.setCoordinates(this.sketchCoords_);else{var s=[((e=o.getCoordinates()[0])[0][0]+e[2][0])/2,(e[0][1]+e[2][1])/2];n.setCoordinates([e[0],s,e[3]])}else if(o.getType()==Yr&&this.mode_!==hh){this.sketchLine_||(this.sketchLine_=new Ka);var a=o.getLinearRing(0);(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),n.changed()):(n=new Xs(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(n))}else this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=t.coordinate,r=this.sketchFeature_.getGeometry();this.mode_===uh||this.mode_===dh?(this.finishCoordinate_=n.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),this.geometryFunction_(i,r)):this.mode_===hh&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry();this.mode_===uh?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===hh&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e)),0===t.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry();this.mode_===uh?(e.pop(),this.geometryFunction_(e,i)):this.mode_===hh&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===Zr?t.setGeometry(new Il([e])):this.type_===Jr?t.setGeometry(new El([e])):this.type_===Qr&&t.setGeometry(new kl([e])),this.dispatchEvent(new gh(fh,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new gh(ph,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},e}(ua),yh={white:[255,255,255,1],blue:[0,153,255,1],orange:"#ff5e00"},_h={},bh=new Fu({color:yh.white,width:5}),wh=new Fu({color:yh.white,width:6}),xh=new Fu({color:yh.blue,width:3}),Sh=new Fu({color:yh.orange,width:3}),Ch=new Lu({color:yh.blue}),Th=new Lu({color:yh.orange}),Eh=new Fu({color:yh.white,width:2}),Ih=new Fu({color:yh.white,width:3}),kh=new Fu({color:yh.white,width:2,lineDash:[3]}),Ah=new Fu({color:yh.blue,width:3,lineDash:[5]}),Ph={colors:yh,features:function(t){var e=t.get("color");return e=e?"#"+e:yh.blue,_h.hasOwnProperty(e)||(_h[e]=[new Bu({stroke:bh,image:new Pu({radius:6,fill:new Lu({color:e}),stroke:Eh}),fill:new Lu({color:"transparent"})}),new Bu({stroke:new Fu({color:e,width:3})})]),_h[e]},highlight:[new Bu({stroke:wh,image:new Pu({radius:6,fill:Th,stroke:Ih}),zIndex:200}),new Bu({stroke:Sh,zIndex:200})],editing:[new Bu({stroke:bh,image:new Pu({radius:6,fill:Ch,stroke:kh})}),new Bu({stroke:Ah})],viewport:[new Bu({stroke:xh}),new Bu({stroke:new Fu({color:yh.white,width:1})})],cross:[new Bu({image:new Au({stroke:wh,points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new Bu({image:new Au({stroke:Sh,points:4,radius1:6,radius2:0,angle:Math.PI/4})})]},Rh=function(t){var e=t.pointerEvent;return!(!e||"pen"!==e.pointerType)||xl(t)},Lh=ft({computed:{isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},isDrawingEllipse:function(){return"drawEllipse"===this.interactionMode}},methods:{draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="draw"+t):this.requireSelectedLabel()},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},drawEllipse:function(){this.draw("Ellipse")},maybeUpdateDrawInteractionMode:function(t){mh&&(this.map.removeInteraction(mh),mh=void 0),this.isDrawing&&((mh=new vh({source:this.annotationSource,type:t.slice(4),style:Ph.editing,freehandCondition:Rh})).on("drawend",this.handleNewFeature),this.map.addInteraction(mh))}},watch:{selectedLabel:function(t){this.isDrawing&&!t&&this.resetInteractionMode()}},created:function(){this.canAdd&&(oe.on("a",this.drawPoint,0,this.listenerSet),oe.on("s",this.drawRectangle,0,this.listenerSet),oe.on("d",this.drawCircle,0,this.listenerSet),oe.on("Shift+d",this.drawEllipse,0,this.listenerSet),oe.on("f",this.drawLineString,0,this.listenerSet),oe.on("g",this.drawPolygon,0,this.listenerSet),this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode))}},void 0,void 0,!1,null,null,null).exports,Mh=function(t){function e(e){var i=e||{};t.call(this,i),this.type=$l}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(eu);Mh.prototype.getSource;var Fh=Mh,Oh=ft({props:{label:{required:!0}}},void 0,void 0,!1,null,null,null).exports,Dh=ft({data:function(){return{imageSection:[0,0],imageSectionCenter:[0,0]}},computed:{imageSectionSteps:function(){return[Math.ceil(this.image.width/(this.viewExtent[2]-this.viewExtent[0])),Math.ceil(this.image.height/(this.viewExtent[3]-this.viewExtent[1]))]},imageSectionStepSize:function(){var t,e=[this.viewExtent[2]-this.viewExtent[0],this.viewExtent[3]-this.viewExtent[1]];return this.imageSectionSteps[0]>1?(t=e[0]*this.imageSectionSteps[0]-this.image.width,e[0]-=t/(this.imageSectionSteps[0]-1)):e[0]=this.viewExtent[2],this.imageSectionSteps[1]>1?(t=e[1]*this.imageSectionSteps[1]-this.image.height,e[1]-=t/(this.imageSectionSteps[1]-1)):e[1]=this.viewExtent[3],e},imageSectionStartCenter:function(){var t=[(this.viewExtent[2]-this.viewExtent[0])/2,(this.viewExtent[3]-this.viewExtent[1])/2];return this.imageSectionSteps[0]<=1&&(t[0]=this.extent[2]/2),this.imageSectionSteps[1]<=1&&(t[1]=this.extent[3]/2),t},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode}},methods:{getImageSectionCenter:function(t){return[t[0]*this.imageSectionStepSize[0]+this.imageSectionStartCenter[0],t[1]*this.imageSectionStepSize[1]+this.imageSectionStartCenter[1]]},showImageSection:function(t){return t[0]<this.imageSectionSteps[0]&&t[1]<this.imageSectionSteps[1]&&t[0]>=0&&t[1]>=0&&(this.imageSection=t,this.imageSectionCenter=this.getImageSectionCenter(t),this.map.getView().setCenter(this.imageSectionCenter),!0)},showLastImageSection:function(){this.showImageSection([this.imageSectionSteps[0]-1,this.imageSectionSteps[1]-1])},showFirstImageSection:function(){this.showImageSection([0,0])},showPreviousImageSection:function(){var t=this.imageSection[0]-1;return t>=0?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([this.imageSectionSteps[0]-1,this.imageSection[1]-1])},showNextImageSection:function(){var t=this.imageSection[0]+1;return t<this.imageSectionSteps[0]?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([0,this.imageSection[1]+1])}},watch:{viewExtent:function(){if(this.isLawnmowerAnnotationMode&&Number.isInteger(this.imageSectionSteps[0])&&Number.isInteger(this.imageSectionSteps[1])){for(var t,e,i=1/0,n=0,r=[0,0],o=0;o<this.imageSectionSteps[1];o++)for(var s=0;s<this.imageSectionSteps[0];s++)t=this.imageSectionCenter,e=this.getImageSectionCenter([s,o]),(n=Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)))<i&&(r[0]=s,r[1]=o,i=n);this.showImageSection(r)}}}},void 0,void 0,!1,null,null,null).exports,jh=i("cISd"),$h=i.n(jh);function Nh(t){return(Nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uh(t,e){return(Uh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Vh(t);if(e){var r=Vh(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return zh(this,i)}}function zh(t,e){return!e||"object"!==Nh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vh(t){return(Vh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qh,Wh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uh(t,e)}(o,t);var e,i,n,r=Gh(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.layer=t.layer,e.colorThreshold=void 0===t.colorThreshold?15:t.colorThreshold,e.currentThreshold=e.colorThreshold,e.blurRadius=void 0===t.blurRadius?5:t.blurRadius,e.simplifyTolerant=void 0===t.simplifyTolerant?0:t.simplifyTolerant,e.simplifyCount=void 0===t.simplifyCount?3:t.simplifyCount,e.downPoint=[0,0],e.map=t.map,e.snapshotCanvas=document.createElement("canvas"),e.snapshotContext=e.snapshotCanvas.getContext("2d"),e.snapshot=null,e.updatingSnapshot=!1,e.discardRadius=void 0===t.discardRadius?20:t.discardRadius,e.sketchFeature=null,e.sketchSource=t.source,void 0===e.sketchSource&&(e.sketchSource=new oh,e.map.addLayer(new zu({source:e.sketchSource,zIndex:200}))),e.sketchStyle=void 0===t.style?null:t.style,e.isShowingPoint=!1,e.indicatorPoint=new Ka(new Ts([20,20])),void 0!==t.indicatorPointStyle&&e.indicatorPoint.setStyle(t.indicatorPointStyle),e.isShowingCross=!1,e.indicatorCross=new Ka(new Ts([100,100])),void 0!==t.indicatorCrossStyle?e.indicatorCross.setStyle(t.indicatorCrossStyle):e.indicatorCross.setStyle([new Bu({image:new Au({stroke:new Fu({color:[0,153,255,1],width:3}),points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new Bu({image:new Au({stroke:new Fu({color:[255,255,255,.75],width:1.5}),points:4,radius1:6,radius2:0,angle:Math.PI/4})})]),e.indicatorSource=new oh,e.map.addLayer(new zu({source:e.indicatorSource,zIndex:200})),e.toggleActive(),e}return e=o,(i=[{key:"getHighDpiScaling",value:function(){return this.snapshot.height/this.map.getSize()[1]}},{key:"toSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.getHighDpiScaling()/this.map.getView().getResolution();return t.map((function(t){return[Math.round((t[0]-e[0])*n),i-Math.round((t[1]-e[1])*n)]}))}},{key:"fromSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.map.getView().getResolution()/this.getHighDpiScaling();return t.map((function(t){return[Math.round(t[0]*n+e[0]),Math.round((i-t[1])*n+e[1])]}))}},{key:"fromMagicWandCoordinates",value:function(t){return t.map((function(t){return[t.x,t.y]}))}},{key:"handleUpEvent",value:function(){return this.currentThreshold=this.colorThreshold,this.isShowingCross?this.sketchSource.removeFeature(this.sketchFeature):this.dispatchEvent({type:"drawend",feature:this.sketchFeature}),this.sketchFeature=null,this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,!1}},{key:"handleDownEvent",value:function(t){return this.downPoint[0]=Math.round(t.coordinate[0]),this.downPoint[1]=Math.round(t.coordinate[1]),this.drawSketch(),this.indicatorPoint.getGeometry().setCoordinates(this.downPoint),this.indicatorCross.getGeometry().setCoordinates(this.downPoint),this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1,!0}},{key:"handleDragEvent",value:function(t){var e=this.toSnapshotCoordinates([t.coordinate]).shift(),i=Math.round(e[0]),n=Math.round(e[1]),r=this.toSnapshotCoordinates([this.downPoint]).shift(),o=r[0],s=r[1];if(i!==o||n!==s){var a=i-o,l=n-s,u=Math.sqrt(a*a+l*l);u<=this.discardRadius&&!t.originalEvent.shiftKey?this.isShowingCross||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1):this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingCross=!1,this.isShowingPoint=!0);var h=Math.min(Math.max(this.colorThreshold+Math.round(u/2-this.colorThreshold),1),255);h!=this.currentThreshold&&(this.currentThreshold=h,this.drawSketch())}}},{key:"handleMoveEvent",value:function(t){this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingPoint=!0,this.isShowingCross=!1),this.indicatorPoint.getGeometry().setCoordinates(t.coordinate)}},{key:"toggleActive",value:function(){this.getActive()?(this.map.on(["moveend","change:size"],this.updateSnapshot.bind(this)),this.updateSnapshot()):(this.map.un(["moveend","change:size"],this.updateSnapshot.bind(this)),this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,this.sketchFeature&&(this.sketchSource.removeFeature(this.sketchFeature),this.sketchFeature=null))}},{key:"updateSnapshot",value:function(){!this.updatingSnapshot&&this.layer&&(this.layer.once("postcompose",this.updateSnapshotCanvas.bind(this)),this.updatingSnapshot=!0,this.map.renderSync(),this.updatingSnapshot=!1)}},{key:"updateSnapshotCanvas",value:function(t){this.snapshotCanvas.width=t.context.canvas.width,this.snapshotCanvas.height=t.context.canvas.height,this.snapshotContext.drawImage(t.context.canvas,0,0),this.snapshot=this.snapshotContext.getImageData(0,0,this.snapshotCanvas.width,this.snapshotCanvas.height),this.snapshot.bytes=4}},{key:"setLayer",value:function(t){this.layer=t}},{key:"drawSketch",value:function(){var t=this.toSnapshotCoordinates([this.downPoint]).shift(),e=$h.a.floodFill(this.snapshot,t[0],t[1],this.currentThreshold);this.blurRadius>0&&(e=$h.a.gaussBlurOnlyBorder(e,this.blurRadius));for(var i=e.data,n=this.snapshot.data,r=i.length-1;r>=0;r--)0===n[4*r]&&(i[r]=0);var o=$h.a.traceContours(e).filter((function(t){return!t.innner})).shift();if(o){this.simplifyTolerant>0&&(o=$h.a.simplifyContours([o],this.simplifyTolerant,this.simplifyCount).shift());var s=this.fromSnapshotCoordinates(this.fromMagicWandCoordinates(o.points));this.sketchFeature?this.sketchFeature.getGeometry().setCoordinates([s]):(this.sketchFeature=new Ka(new Ns([s])),this.sketchStyle&&this.sketchFeature.setStyle(this.sketchStyle),this.sketchSource.addFeature(this.sketchFeature))}}}])&&Bh(e.prototype,i),n&&Bh(e,n),o}(ua),Kh=ft({computed:{crossOrigin:function(){return this.image&&this.image.crossOrigin},isMagicWanding:function(){return"magicWand"===this.interactionMode&&!this.crossOrigin}},methods:{toggleMagicWand:function(){this.isMagicWanding?this.resetInteractionMode():qh&&(this.interactionMode="magicWand")},maybeUpdateMagicWandSnapshot:function(t){t&&!t.tiled&&this.isMagicWanding&&qh.updateSnapshot()},maybeSetMagicWandLayer:function(t,e){t&&!this.crossOrigin&&(!0===t.tiled?e&&!0===e.tiled||qh.setLayer(this.tiledImageLayer):e&&!0!==e.tiled||qh.setLayer(this.imageLayer))},toggleMagicWandInteraction:function(t){t?this.hasSelectedLabel?qh.setActive(!0):this.requireSelectedLabel():qh.setActive(!1)}},created:function(){this.canAdd&&(oe.on("Shift+g",this.toggleMagicWand,0,this.listenerSet),this.$watch("image",this.maybeUpdateMagicWandSnapshot),this.$watch("image",this.maybeSetMagicWandLayer),this.$watch("isMagicWanding",this.toggleMagicWandInteraction))},mounted:function(){this.canAdd&&((qh=new Wh({map:this.map,source:this.annotationSource,style:Ph.editing,indicatorPointStyle:Ph.editing,indicatorCrossStyle:Ph.cross,simplifyTolerant:.1})).on("drawend",this.handleNewFeature),qh.setActive(!1),this.map.addInteraction(qh))}},void 0,void 0,!1,null,null,null).exports,Xh="pointermove",Hh="pointerdown",Yh="pointerup",Zh="pointerover",Jh="pointerout",Qh="pointerenter",tc="pointerleave",ec="pointercancel",ic=["","unavailable","touch","pen","mouse"];function nc(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function rc(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function oc(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function sc(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function ac(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function lc(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function uc(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function hc(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}var cc=function(t){function e(e){var i={MSPointerDown:nc,MSPointerMove:rc,MSPointerUp:oc,MSPointerOut:sc,MSPointerOver:ac,MSPointerCancel:lc,MSGotPointerCapture:hc,MSLostPointerCapture:uc};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=ic[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(Pl);function dc(t){this.dispatcher.fireNativeEvent(t)}function pc(t){this.dispatcher.fireNativeEvent(t)}function fc(t){this.dispatcher.fireNativeEvent(t)}function gc(t){this.dispatcher.fireNativeEvent(t)}function mc(t){this.dispatcher.fireNativeEvent(t)}function vc(t){this.dispatcher.fireNativeEvent(t)}function yc(t){this.dispatcher.fireNativeEvent(t)}function _c(t){this.dispatcher.fireNativeEvent(t)}var bc=function(t){function e(e){var i={pointerdown:dc,pointermove:pc,pointerup:fc,pointerout:gc,pointerover:mc,pointercancel:vc,gotpointercapture:_c,lostpointercapture:yc};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Pl),wc=!1,xc=function(t){function e(e,i,n){t.call(this,e),this.originalEvent=i;var r=n||{};this.buttons=function(t){var e;if(t.buttons||wc)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e}(r),this.pressure=function(t,e){var i=0;i=t.pressure?t.pressure:e?.5:0;return i}(r,this.buttons),this.bubbles="bubbles"in r&&r.bubbles,this.cancelable="cancelable"in r&&r.cancelable,this.view="view"in r?r.view:null,this.detail="detail"in r?r.detail:null,this.screenX="screenX"in r?r.screenX:0,this.screenY="screenY"in r?r.screenY:0,this.clientX="clientX"in r?r.clientX:0,this.clientY="clientY"in r?r.clientY:0,this.ctrlKey="ctrlKey"in r&&r.ctrlKey,this.altKey="altKey"in r&&r.altKey,this.shiftKey="shiftKey"in r&&r.shiftKey,this.metaKey="metaKey"in r&&r.metaKey,this.button="button"in r?r.button:0,this.relatedTarget="relatedTarget"in r?r.relatedTarget:null,this.pointerId="pointerId"in r?r.pointerId:0,this.width="width"in r?r.width:0,this.height="height"in r?r.height:0,this.tiltX="tiltX"in r?r.tiltX:0,this.tiltY="tiltY"in r?r.tiltY:0,this.pointerType="pointerType"in r?r.pointerType:"",this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0,this.isPrimary="isPrimary"in r&&r.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);!function(){try{var t=new MouseEvent("click",{buttons:1});wc=1===t.buttons}catch(t){}}();var Sc=xc;function Cc(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function Tc(t){this.processTouches_(t,this.moveOverOut_)}function Ec(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function Ic(t){this.processTouches_(t,this.cancelOut_)}var kc=function(t){function e(e,i){var n={touchstart:Cc,touchmove:Tc,touchend:Ec,touchcancel:Ic};t.call(this,e,n),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&1..toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.radiusX||0,i.height=e.radiusY||0,i.pressure=e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),n=i.length;function r(){t.preventDefault()}for(var o=0;o<n;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=r,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,n=0;n<i;n++){if(t[n].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),n=i.length;if(n>=e.length){for(var r=[],o=0;o<n;++o){var s=Number(i[o]),a=this.pointerMap[s];1==s||this.findTouch_(e,s-2)||r.push(a.out)}for(var l=0;l<r.length;++l)this.cancelOut_(t,r[l])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,n=this.pointerMap[i.pointerId];if(n){var r=n.out,o=n.outTarget;this.dispatcher.move(i,t),r&&o!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=o,r.target=o,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),n.out=i,n.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var n=[i.clientX,i.clientY];e.push(n),setTimeout((function(){var t,i,r;i=n,r=(t=e).indexOf(i),r>-1&&t.splice(r,1)}),this.dedupTimeout_)}},e}(Pl),Ac=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],Pc=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(dl)this.registerSource("native",new bc(this));else if(pl)this.registerSource("ms",new cc(this));else{var t=new jl(this);this.registerSource("mouse",t),cl&&this.registerSource("touch",new kc(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,n=i.getEvents();n&&(n.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){Ni(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){Ui(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},n=0,r=Ac.length;n<r;n++){var o=Ac[n][0];i[o]=t[o]||e[o]||Ac[n][1]}return i},e.prototype.down=function(t,e){this.fireEvent(Hh,t,e)},e.prototype.move=function(t,e){this.fireEvent(Xh,t,e)},e.prototype.up=function(t,e){this.fireEvent(Yh,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(Qh,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(tc,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(Zh,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Jh,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(ec,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new Sc(t,i,e)},e.prototype.fireEvent=function(t,e,i){var n=this.makeEvent(t,e,i);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,Dl(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(Zi),Rc=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*ul:ul,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new Pc(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=Ni(this.pointerEventHandler_,Hh,this.handlePointerDown_,this),this.relayedListenerKey_=Ni(this.pointerEventHandler_,Xh,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new Ya(Zs.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Ya(Zs.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Ya(Zs.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Zs.POINTERUP||e.type==Zs.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Zs.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Ya(Zs.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(Gi),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Ya(Zs.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new Pc(document),this.dragListenerKeys_.push(Ni(this.documentPointerEventHandler_,Zs.POINTERMOVE,this.handlePointerMove_,this),Ni(this.documentPointerEventHandler_,Zs.POINTERUP,this.handlePointerUp_,this),Ni(this.pointerEventHandler_,Zs.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Ya(Zs.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Ya(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Gi(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(Gi(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Gi),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(Zi),Lc="layergroup",Mc="size",Fc="target",Oc="view",Dc=0,jc=1,$c=2,Nc=3,Bc=4,Uc=5,Gc=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};Gc.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Li(this.queuedElements_)},Gc.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},Gc.prototype.enqueue=function(t){$n(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},Gc.prototype.getCount=function(){return this.elements_.length},Gc.prototype.getLeftChildIndex_=function(t){return 2*t+1},Gc.prototype.getRightChildIndex_=function(t){return 2*t+2},Gc.prototype.getParentIndex_=function(t){return t-1>>1},Gc.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},Gc.prototype.isEmpty=function(){return 0===this.elements_.length},Gc.prototype.isKeyQueued=function(t){return t in this.queuedElements_},Gc.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},Gc.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&i[l]<i[a]?l:a;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(s,t)},Gc.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},Gc.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,o=this.priorities_,s=0,a=r.length;for(e=0;e<a;++e)(i=n(t=r[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,r[s++]=t);r.length=s,o.length=s,this.heapify_()};var zc=function(t){function e(e,i){t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()})),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&Ni(e[0],Ji,this.handleTileChange,this);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===$c||i===Nc||i===Bc||i===Uc){Ui(e,Ji,this.handleTileChange,this);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,r,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),(i=n.getState())===Uc?s=!0:i!==Dc||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load());0===o&&s&&this.tileChangeCallback_()},e}(Gc);function Vc(t){return t}function qc(t,e){return void 0!==t?0:void 0}function Wc(t,e){return void 0!==t?t+e:void 0}var Kc=0,Xc=1,Hc="center",Yc="resolution",Zc="rotation";function Jc(t,e){setTimeout((function(){t(e)}),0)}function Qc(t){return!(t.sourceCenter&&t.targetCenter&&!Qa(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var td=function(t){function e(e){t.call(this);var i=Ri({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=Go(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[Hc]=void 0!==t.center?t.center:null;var i=function(t){var e,i,n,r=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var a=t.resolutions;i=a[r],n=void 0!==a[o]?a[o]:a[a.length-1],e=function(t){return function(e,i,n){if(void 0!==e){var r=Nr(t,e,n);r=oo(r+i,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var s=t[o]/t[o+1];return t[o]/Math.pow(s,r-o)}return t[o]}}}(a)}else{var l=Go(t.projection,"EPSG:3857"),u=l.getExtent(),h=(u?Math.max(Tr(u),wr(u)):360*go[mo.DEGREES]/l.getMetersPerUnit())/256/Math.pow(2,0),c=h/Math.pow(2,28);void 0!==(i=t.maxResolution)?r=0:i=h/Math.pow(s,r),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(s,o):h/Math.pow(s,o):c),o=r+Math.floor(Math.log(i/n)/Math.log(s)),n=i/Math.pow(s,o-r),e=function(t,e,i){return function(n,r,o){if(void 0!==n){var s=-o/2+.5,a=Math.floor(Math.log(e/n)/Math.log(t)+s),l=Math.max(a+r,0);return void 0!==i&&(l=Math.min(l,i)),e/Math.pow(t,l)}}}(s,i,o-r)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:r,zoomFactor:s}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=function(t){return void 0!==t.extent?(e=t.extent,function(t){return t?[oo(t[0],e[0],e[2]),oo(t[1],e[1],e[3])]:void 0}):Vc;var e}(t),r=i.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=r||uo(5),function(t,e){return void 0!==t?Math.abs(t+e)<=o?0:t+e:void 0}):!1===e?Wc:"number"==typeof e?(i=e,n=2*Math.PI/i,function(t,e){return void 0!==t?t=Math.floor((t+e)/n+.5)*n:void 0}):Wc}return qc;var i,n;var r,o}(t);this.constraints_={center:n,resolution:r,rotation:o},void 0!==t.resolution?e[Yc]=t.resolution:void 0!==t.zoom&&(e[Yc]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[Yc]=oo(Number(this.getResolution()||e[Yc]),this.minResolution_,this.maxResolution_))),e[Zc]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=Ri({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),Ri({},e,t)},e.prototype.animate=function(t){var e,i=arguments,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&Jc(e,!0))}for(var o=Date.now(),s=this.getCenter().slice(),a=this.getResolution(),l=this.getRotation(),u=[],h=0;h<n;++h){var c=i[h],d={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||ta};if(c.center&&(d.sourceCenter=s,d.targetCenter=c.center,s=d.targetCenter),void 0!==c.zoom?(d.sourceResolution=a,d.targetResolution=this.constrainResolution(this.maxResolution_,c.zoom-this.minZoom_,0),a=d.targetResolution):c.resolution&&(d.sourceResolution=a,d.targetResolution=c.resolution,a=d.targetResolution),void 0!==c.rotation){d.sourceRotation=l;var p=ho(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+p,l=d.targetRotation}d.callback=e,Qc(d)?d.complete=!0:o+=d.duration,u.push(d)}this.animations_.push(u),this.setHint(Kc,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Kc]>0},e.prototype.getInteracting=function(){return this.hints_[Xc]>0},e.prototype.cancelAnimations=function(){this.setHint(Kc,-this.hints_[Kc]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&Jc(i[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],r=!0,o=0,s=n.length;o<s;++o){var a=n[o];if(!a.complete){var l=t-a.start,u=a.duration>0?l/a.duration:1;u>=1?(a.complete=!0,u=1):r=!1;var h=a.easing(u);if(a.sourceCenter){var c=a.sourceCenter[0],d=a.sourceCenter[1],p=c+h*(a.targetCenter[0]-c),f=d+h*(a.targetCenter[1]-d);this.set(Hc,[p,f])}if(a.sourceResolution&&a.targetResolution){var g=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(Hc,this.calculateCenterZoom(g,a.anchor)),this.set(Yc,g)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var m=1===h?ho(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(Hc,this.calculateCenterRotate(m,a.anchor)),this.set(Zc,m)}if(e=!0,!a.complete)break}}if(r){this.animations_[i]=null,this.setHint(Kc,-1);var v=n[0].callback;v&&Jc(v,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenter();return void 0!==n&&(tl(i=[n[0]-e[0],n[1]-e[1]],t-this.getRotation()),Za(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenter(),r=this.getResolution();void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]);return i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+Ai(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var n=e||0,r=i||0;return this.constraints_.resolution(t,n,r)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(Hc)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();$n(i,1);var n=this.getResolution();$n(void 0!==n,2);var r=this.getRotation();return $n(void 0!==r,3),br(i,n,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Yc)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),n=Tr(t)/i[0],r=wr(t)/i[1];return Math.max(n,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(Zc)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/r}},e.prototype.getState=function(t){var e=this.getCenter(),i=this.getProjection(),n=this.getResolution(),r=n/t,o=this.getRotation();return{center:[Math.round(e[0]/r)*r,Math.round(e[1]/r)*r],projection:void 0!==i?i:null,resolution:n,rotation:o,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var r=Nr(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),$n(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?($n(!Ir(t),25),i=Bs(t)):t.getType()===eo?(i=Bs(t=t.getExtent())).rotate(this.getRotation(),yr(t)):i=t;var o,s=void 0!==n.padding?n.padding:[0,0,0,0],a=void 0===n.constrainResolution||n.constrainResolution,l=void 0!==n.nearest&&n.nearest;o=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var u=i.getFlatCoordinates(),h=this.getRotation(),c=Math.cos(-h),d=Math.sin(-h),p=1/0,f=1/0,g=-1/0,m=-1/0,v=i.getStride(),y=0,_=u.length;y<_;y+=v){var b=u[y]*c-u[y+1]*d,w=u[y]*d+u[y+1]*c;p=Math.min(p,b),f=Math.min(f,w),g=Math.max(g,b),m=Math.max(m,w)}var x=this.getResolutionForExtent([p,f,g,m],[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);if(x=isNaN(x)?o:Math.max(x,o),a){var S=this.constrainResolution(x,0,0);!l&&S<x&&(S=this.constrainResolution(S,-1,0)),x=S}d=-d;var C=(p+g)/2,T=(f+m)/2,E=[(C+=(s[1]-s[3])/2*x)*c-(T+=(s[0]-s[2])/2*x)*d,T*c+C*d],I=n.callback?n.callback:Ki;void 0!==n.duration?this.animate({resolution:x,center:E,duration:n.duration,easing:n.easing},I):(this.setResolution(x),this.setCenter(E),Jc(I,!0))},e.prototype.centerOn=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,l=this.getResolution(),u=(s+=(e[0]/2-i[0])*l)*r-(a+=(i[1]-e[1]/2)*l)*(o=-o),h=a*r+s*o;this.setCenter([u,h])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(Hc,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(Yc,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(Zc,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(bn),ed="layers",id=function(t){function e(e){var i=e||{},n=Ri({},i);delete n.layers;var r=i.layers;t.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},Ni(this,vn(ed),this.handleLayersChanged_,this),r?Array.isArray(r)?r=new qa(r.slice(),{unique:!0}):$n("function"==typeof r.getArray,43):r=new qa(void 0,{unique:!0}),this.setLayers(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Gi),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Ni(t,Ua,this.handleLayersAdd_,this),Ni(t,Ga,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(Gi);Li(this.listenerKeys_);for(var i=t.getArray(),n=0,r=i.length;n<r;n++){var o=i[n];this.listenerKeys_[Ai(o)]=[Ni(o,Pi,this.handleLayerChange_,this),Ni(o,Ji,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[Ai(e)]=[Ni(e,Pi,this.handleLayerChange_,this),Ni(e,Ji,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=Ai(t.element);this.listenerKeys_[e].forEach(Gi),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(ed)},e.prototype.setLayers=function(t){this.set(ed,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=xr(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return Ra},e}(Hl);function nd(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}var rd=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,r,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new id({layers:t.layers});o[Lc]=s,o[Fc]=t.target,o[Oc]=void 0!==t.view?t.view:new td,void 0!==t.controls&&(Array.isArray(t.controls)?i=new qa(t.controls.slice()):($n("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new qa(t.interactions.slice()):($n("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?r=new qa(t.overlays.slice()):($n("function"==typeof t.overlays.getArray,49),r=t.overlays):r=new qa;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:r,values:o}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:ul,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(cl?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[en,nn,ln,dn,hn,Zs.POINTERDOWN,un,pn],r=0,o=n.length;r<o;++r)Ni(this.overlayContainerStopEvent_,n[r],Hi);for(var s in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new Rc(this,e.moveTolerance),Zs)Ni(this.mapBrowserEventHandler_,Zs[s],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,Ni(this.viewport_,tn,this.handleBrowserEvent,this),Ni(this.viewport_,pn,this.handleBrowserEvent,this),Ni(this.viewport_,un,this.handleBrowserEvent,this),this.controls=i.controls||new qa,this.interactions=i.interactions||new qa,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new zc(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},Ni(this,vn(Lc),this.handleLayerGroupChanged_,this),Ni(this,vn(Oc),this.handleViewChanged_,this),Ni(this,vn(Mc),this.handleSizeChanged_,this),Ni(this,vn(Fc),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),Ni(this.controls,Ua,(function(t){t.element.setMap(this)}),this),Ni(this.controls,Ga,(function(t){t.element.setMap(null)}),this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),Ni(this.interactions,Ua,(function(t){t.element.setMap(this)}),this),Ni(this.interactions,Ga,(function(t){t.element.setMap(null)}),this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),Ni(this.overlays_,Ua,(function(t){this.addOverlayInternal_(t.element)}),this),Ni(this.overlays_,Ga,(function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}),this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),Ui(this.viewport_,tn,this.handleBrowserEvent,this),Ui(this.viewport_,pn,this.handleBrowserEvent,this),Ui(this.viewport_,un,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(cn,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixel(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:qi;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,(function(t){i||(i=[]),i.push(t)}),e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||qi;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:qi,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(Fc)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?Jo(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Lc)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?Jo(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Mc)},e.prototype.getView=function(){return this.get(Oc)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var r=this.frameState_;if(!r||!(e in r.wantedTiles))return 1/0;if(!r.wantedTiles[e][t.getKey()])return 1/0;var o=i[0]-r.focus[0],s=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(o*o+s*s)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new Ha(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.getActive())if(!n.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var r=t.viewHints;r[Kc]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),r[Xc]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(Ql)||t.animate||this.tileQueue_.getTilesLoading()||function t(e){for(var i=0,n=e.length;i<n;++i){var r=e[i];if("function"==typeof r.getLayers)return t(r.getLayers().getArray());var o=r.getSource();if(o&&o.loading)return!0}return!1}(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(Ql,t);for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)Gi(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[Ni(n,on,this.handleBrowserEvent,this),Ni(n,sn,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(cn,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),On(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(cn,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Gi(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Gi(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",Ai(t)),this.viewPropertyListenerKey_=Ni(t,Pi,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ni(t,Ji,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Gi),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[Ni(t,Pi,this.render,this),Ni(t,Ji,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),n=this.getView(),r=[1/0,1/0,-1/0,-1/0],o=this.frameState_,s=null;if(void 0!==i&&function(t){return t[0]>0&&t[1]>0}(i)&&n&&n.isDef()){for(var a=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},h=0,c=l.length;h<c;++h)u[Ai(l[h].layer)]=l[h];e=n.getState(this.pixelRatio_),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:r,focus:this.focus_?this.focus_:e.center,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:a,wantedTiles:{}}}if(s&&(s.extent=br(e.center,e.resolution,e.rotation,s.size,r)),this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),o)(!this.previousExtent_||!Ir(this.previousExtent_)&&!lr(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Xa(Ti,this,o)),this.previousExtent_=or(this.previousExtent_));this.previousExtent_&&!s.viewHints[Kc]&&!s.viewHints[Xc]&&!lr(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Xa(Ei,this,s)),Zn(s.extent,this.previousExtent_))}this.dispatchEvent(new Xa(Ci,this,s)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(Lc,t)},e.prototype.setSize=function(t){this.set(Mc,t)},e.prototype.setTarget=function(t){this.set(Fc,t)},e.prototype.setView=function(t){this.set(Oc,t)},e.prototype.skipFeature=function(t){this.skippedFeatureUids_[Ai(t)]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){delete this.skippedFeatureUids_[Ai(t)],this.render()},e}(bn);var od=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:Ki,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){On(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&On(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Gi(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Ki&&this.listenerKeys.push(Ni(t,Ci,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(bn);function sd(t){this.updateElement_(t.frameState)}var ad=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||sd,target:i.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.overrideCollapsible_=void 0!==i.collapsible,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),Ni(l,en,this.handleClick_,this);var u=n+" ol-unselectable ol-control"+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.ulElement_),h.appendChild(l),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=t.viewState.resolution,o=0,s=n.length;o<s;++o){var a=n[o];if(tu(a,r)){var l=a.layer.getSource();if(l){var u=l.getAttributions();if(u){var h=u(t);if(h)if(this.overrideCollapsible_||!1!==l.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(h))for(var c=0,d=h.length;c<d;++c)h[c]in e||(i.push(h[c]),e[h[c]]=!0);else h in e||(i.push(h),e[h]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Gr(e,this.renderedAttributions_)){Dn(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Fn(this.collapseLabel_,this.label_):Fn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(od);function ld(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains("ol-hidden");r||0!==i?r&&0!==i&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.msTransform=n,this.label_.style.webkitTransform=n,this.label_.style.transform=n}this.rotation_=i}}var ud=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||ld,target:i.target});var n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),Ni(s,en,this.handleClick_,this);var a=n+" ol-unselectable ol-control",l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add("ol-hidden")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Qs}):t.setRotation(0))},e}(od),hd=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",l=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n+"-in",u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof o?document.createTextNode(o):o),Ni(u,en,this.handleClick_.bind(this,r));var h=document.createElement("button");h.className=n+"-out",h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),Ni(h,en,this.handleClick_.bind(this,-r));var c=n+" ol-unselectable ol-control",d=this.element;d.className=c,d.appendChild(u),d.appendChild(h),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var n=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:this.duration_,easing:Qs})):e.setResolution(n)}}},e}(od);var cd=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};cd.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},cd.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},cd.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},cd.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},cd.prototype.getAngle=function(){return this.angle_};var dd=cd;function pd(t){var e=!1;if(t.type==Zs.DBLCLICK){var i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;oa(n.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}var fd=function(t){function e(e){t.call(this,{handleEvent:pd});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(aa),gd=function(t){function e(e){t.call(this,{stopDown:Wi});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=i.condition?i.condition:wl,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(Xc,1));var e=this.targetPointers,i=la(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[n,r];el(s,o.getResolution()),tl(s,o.getRotation()),Za(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-n*Math.cos(r),s[1]-n*Math.sin(r)]);i.animate({center:i.constrainCenter(a),duration:500,easing:Qs})}return this.panning_&&(this.panning_=!1,i.setHint(Xc,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(ua),md=function(t){function e(e){var i=e||{};t.call(this,{stopDown:Wi}),this.condition_=i.condition?i.condition:fl,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){if(Cl(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==qc){var n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_,a=i.getRotation();ra(i,a-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!Cl(t))return!0;var e=t.map.getView();e.setHint(Xc,-1);var i=e.getRotation();return na(e,i,void 0,this.duration_),!1},e.prototype.handleDownEvent=function(t){return!!Cl(t)&&(!(!yl(t)||!this.condition_(t))&&(t.map.getView().setHint(Xc,1),this.lastAngle_=void 0,!0))},e}(ua),vd=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ns([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(Vi),yd="boxstart",_d="boxdrag",bd="boxend",wd=function(t){function e(e,i,n){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);function xd(){var t,e,i=this.getMap(),n=i.getView(),r=i.getSize(),o=this.getGeometry().getExtent();if(this.out_){var s=n.calculateExtent(r),a=(t=[i.getPixelFromCoordinate(mr(o)),i.getPixelFromCoordinate(Cr(o))],cr(or(e),t));!function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(s,1/n.getResolutionForExtent(a,r)),o=s}var l=n.constrainResolution(n.getResolutionForExtent(o,r)),u=yr(o);u=n.constrainCenter(u),n.animate({resolution:l,center:u,duration:this.duration_,easing:Qs})}var Sd=function(t){function e(e){var i=e||{},n=i.condition?i.condition:xl;t.call(this,{condition:n,className:i.className||"ol-dragzoom",onBoxEnd:xd}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this);var i=e||{};this.box_=new vd(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:Ki,this.startPixel_=null,this.condition_=i.condition?i.condition:ml,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:this.defaultBoxEndCondition}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){Cl(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new wd(_d,t.coordinate,t)))},e.prototype.handleUpEvent=function(t){return!Cl(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new wd(bd,t.coordinate,t))),!1)},e.prototype.handleDownEvent=function(t){return!!Cl(t)&&(!(!yl(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new wd(yd,t.coordinate,t)),!0))},e}(ua)),Cd=37,Td=38,Ed=39,Id=40;function kd(t){var e=!1;if(t.type==on){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==Id||i==Cd||i==Ed||i==Td)){var n=t.map.getView(),r=n.getResolution()*this.pixelDelta_,o=0,s=0;i==Id?s=-r:i==Cd?o=-r:i==Ed?o=r:s=r;var a=[o,s];tl(a,n.getRotation()),function(t,e,i){var n=t.getCenter();if(n){var r=t.constrainCenter([n[0]+e[0],n[1]+e[1]]);i?t.animate({duration:i,easing:ea,center:r}):t.setCenter(r)}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}var Ad=function(t){function e(e){t.call(this,{handleEvent:kd});var i=e||{};this.defaultCondition_=function(t){return wl(t)&&Sl(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(aa);function Pd(t){var e=!1;if(t.type==on||t.type==sn){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_;oa(n.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var Rd=function(t){function e(e){t.call(this,{handleEvent:Pd});var i=e||{};this.condition_=i.condition?i.condition:Sl,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(aa),Ld="trackpad",Md="wheel",Fd=function(t){function e(e){var i=e||{};t.call(this,i),this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:ml,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(Xc,-1)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==pn&&e!==un)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==pn?(i=r.deltaY,ol&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=ul),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==un&&(i=-r.wheelDeltaY,sl&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?Ld:Md),this.mode_===Ld){var s=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(Xc,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),l=s.getMinResolution(),u=s.getMaxResolution(),h=0;if(a<l?(a=Math.max(a,l/this.trackpadZoomBuffer_),h=1):a>u&&(a=Math.min(a,u*this.trackpadZoomBuffer_),h=-1),this.lastAnchor_){var c=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(c))}return s.setResolution(a),0===h&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:Qs,anchor:this.lastAnchor_,duration:this.duration_}),h>0?s.animate({resolution:l,easing:Qs,anchor:this.lastAnchor_,duration:500}):h<0&&s.animate({resolution:u,easing:Qs,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var d=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),d),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();oa(e,-oo(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(aa),Od=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Wi),t.call(this,n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==qc){var l=s.getViewport().getBoundingClientRect(),u=la(this.targetPointers);if(u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixel(u),this.rotating_){var h=a.getRotation();s.render(),ra(a,h+e,this.anchor_)}}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(Xc,-1),this.rotating_){var i=e.getRotation();na(e,i,this.anchor_,this.duration_)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(Xc,1),!0}return!1},e}(ua),Dd=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Wi),t.call(this,n),this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView(),u=l.getResolution(),h=l.getMaxResolution(),c=l.getMinResolution(),d=u*e;d>h?(e=h/u,d=h):d<c&&(e=c/u,d=c),1!=e&&(this.lastScaleDelta_=e);var p=a.getViewport().getBoundingClientRect(),f=la(this.targetPointers);f[0]-=p.left,f[1]-=p.top,this.anchor_=a.getCoordinateFromPixel(f),a.render(),sa(l,d,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(Xc,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var n=this.lastScaleDelta_-1;!function(t,e,i,n,r){e=t.constrainResolution(e,0,r),sa(t,e,i,n)}(e,i,this.anchor_,this.duration_,n)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(Xc,1),!0}return!1},e}(ua);function jd(t){var e=t||{},i=new qa,n=new dd(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new md),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new fd({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new gd({condition:e.onFocusOnly?gl:void 0,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new Od),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new Dd({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Ad),i.push(new Rd({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Fd({condition:e.onFocusOnly?gl:void 0,constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new Sd({duration:e.zoomDuration})),i}var $d=function(t){function e(e,i,n,r,o){t.call(this,e),this.vectorContext=i,this.frameState=n,this.context=r,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),Nd=function(){};Nd.prototype.drawCustom=function(t,e,i){},Nd.prototype.drawGeometry=function(t){},Nd.prototype.setStyle=function(t){},Nd.prototype.drawCircle=function(t,e){},Nd.prototype.drawEllipse=function(t,e){},Nd.prototype.drawFeature=function(t,e){},Nd.prototype.drawGeometryCollection=function(t,e){},Nd.prototype.drawLineString=function(t,e){},Nd.prototype.drawMultiLineString=function(t,e){},Nd.prototype.drawMultiPoint=function(t,e){},Nd.prototype.drawMultiPolygon=function(t,e){},Nd.prototype.drawPoint=function(t,e){},Nd.prototype.drawPolygon=function(t,e){},Nd.prototype.drawText=function(t,e){},Nd.prototype.setFillStrokeStyle=function(t,e){},Nd.prototype.setImageStyle=function(t,e){},Nd.prototype.setTextStyle=function(t,e){};var Bd=Nd,Ud=function(t){function e(e,i,n,r,o){t.call(this),this.context_=e,this.pixelRatio_=i,this.extent_=n,this.transform_=r,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var r=ro(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,h=r.length;u<h;u+=2){var c=r[u]-this.imageAnchorX_,d=r[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var p=c+this.imageAnchorX_,f=d+this.imageAnchorY_;es(s,p,f,this.imageScale_,this.imageScale_,l,-p,-f),o.setTransform.apply(o,s)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,d,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=ro(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var u=es(this.tmpLocalTransform_,a,l,this.textScale_,this.textScale_,s,-a,-l);o.setTransform.apply(o,u)}this.textStrokeState_&&o.strokeText(this.text_,a,l),this.textFillState_&&o.fillText(this.text_,a,l)}0===s&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_,s=ro(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;r&&(a-=2);for(var l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return r&&o.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e},e.prototype.drawCircle=function(t){if(Er(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var r=t.getStride();return ro(n,0,n.length,r,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Kr:this.drawPoint(t);break;case Xr:this.drawLineString(t);break;case Yr:case io:case no:this.drawPolygon(t);break;case Zr:this.drawMultiPoint(t);break;case Jr:this.drawMultiLineString(t);break;case Qr:this.drawMultiPolygon(t);break;case to:this.drawGeometryCollection(t);break;case eo:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Er(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(Er(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(Er(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),r=0,o=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,l=o.length;a<l;++a)r=this.moveToLineTo_(n,r,o[a],s,!1);i.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},e.prototype.drawPolygon=function(t){if(Er(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(Er(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=r.length;s<a;++s){var l=r[s];n=this.drawRings_(i,n,l,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),hl&&(Gr(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,hl&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=n&&(i.textAlign=e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:uu(i||cu)}}else this.fillState_=null;if(e){var n=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:"round",lineDash:o||du,lineDashOffset:s||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==l?l:1),miterLimit:void 0!==u?u:10,strokeStyle:uu(n||pu)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:uu(i||cu)}}else this.textFillState_=null;var n=t.getStroke();if(n){var r=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),h=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:"round",lineDash:s||du,lineDashOffset:a||0,lineJoin:void 0!==l?l:"round",lineWidth:void 0!==u?u:1,miterLimit:void 0!==h?h:10,strokeStyle:uu(r||pu)}}else this.textStrokeState_=null;var c=t.getFont(),d=t.getOffsetX(),p=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation(),m=t.getScale(),v=t.getText(),y=t.getTextAlign(),_=t.getTextBaseline();this.textState_={font:void 0!==c?c:"10px sans-serif",textAlign:void 0!==y?y:"center",textBaseline:void 0!==_?_:"middle"},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==m?m:1)}else this.text_=""},e}(Bd),Gd=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function zd(t,e,i){return e+":"+t+":"+(i?su(i):"null")}Gd.prototype.clear=function(){this.cache_={},this.cacheSize_=0},Gd.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},Gd.prototype.get=function(t,e,i){var n=zd(t,e,i);return n in this.cache_?this.cache_[n]:null},Gd.prototype.set=function(t,e,i,n){var r=zd(t,e,i);this.cache_[r]=n,++this.cacheSize_},Gd.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var Vd=new Gd;function qd(t,e){Vd.expire()}function Wd(t,e){return t.zIndex-e.zIndex}var Kd=[],Xd=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.context_=Rn(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className="ol-unselectable",i.insertBefore(this.canvas_,i.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap(),n=this.context_;if(i.hasListener(t)){var r=e.extent,o=e.pixelRatio,s=e.viewState.rotation,a=this.getTransform(e),l=new Ud(n,o,r,a,s),u=new $d(t,l,e,n,null);i.dispatchEvent(u)}},e.prototype.getTransform=function(t){var e=t.viewState,i=this.canvas_.width/2,n=this.canvas_.height/2,r=t.pixelRatio/e.resolution,o=-r,s=-e.rotation,a=-e.center[0],l=-e.center[1];return es(this.transform_,i,n,r,o,s,a,l)},e.prototype.renderFrame=function(t){if(t){var e=this.context_,i=t.pixelRatio,n=Math.round(t.size[0]*i),r=Math.round(t.size[1]*i);this.canvas_.width!=n||this.canvas_.height!=r?(this.canvas_.width=n,this.canvas_.height=r):e.clearRect(0,0,n,r);var o=t.viewState.rotation;this.calculateMatrices2D(t),this.dispatchRenderEvent(Zl,t);var s=t.layerStatesArray;!function(t,e){var i,n=t.length,r=Array(t.length);for(i=0;i<n;i++)r[i]={index:i,value:t[i]};for(r.sort((function(t,i){return e(t.value,i.value)||t.index-i.index})),i=0;i<t.length;i++)t[i]=r[i].value}(s,Wd),o&&(e.save(),Tu(e,o,n/2,r/2));var a,l,u=t.viewState.resolution;for(a=0,l=s.length;a<l;++a){var h=s[a],c=h.layer,d=this.getLayerRenderer(c);tu(h,u)&&h.sourceState==Ra&&(d.prepareFrame(t,h)&&d.composeFrame(t,h,e))}o&&e.restore(),this.dispatchRenderEvent(Yl,t),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){var a,l,u=e.viewState.resolution,h=e.layerStatesArray,c=h.length,d=Jo(e.pixelToCoordinateTransform,t.slice());for(l=c-1;l>=0;--l){var p=h[l],f=p.layer;if(tu(p,u)&&o.call(s,f))if(a=this.getLayerRenderer(f).forEachLayerAtCoordinate(d,e,i,n,r))return a}},e.prototype.registerLayerRenderers=function(e){t.prototype.registerLayerRenderers.call(this,e);for(var i=0,n=e.length;i<n;++i){var r=e[i];$r(Kd,r)||Kd.push(r)}},e}(function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){Ii()},e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;es(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),function(t){var e,i=(e=t)[0]*e[3]-e[1]*e[2];$n(0!==i,32);var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];t[0]=s/i,t[1]=-r/i,t[2]=-o/i,t[3]=n/i,t[4]=(o*l-s*a)/i,t[5]=-(n*l-r*a)/i}(Zo(n,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=e.viewState,u=l.resolution;function h(t,i){var o=e.layerStates[Ai(i)].managed;if(!(Ai(t)in e.skippedFeatureUids)||o)return n.call(r,t,o?i:null)}var c=l.projection,d=t;if(c.canWrapX()){var p=c.getExtent(),f=Tr(p),g=t[0];if(g<p[0]||g>p[2])d=[g+f*Math.ceil((p[0]-g)/f),t[1]]}var m,v=e.layerStatesArray;for(m=v.length-1;m>=0;--m){var y=v[m],_=y.layer;if(tu(y,u)&&o.call(s,_)){var b=this.getLayerRenderer(_),w=_.getSource();if(w&&(a=b.forEachFeatureAtCoordinate(w.getWrapX()?d:t,e,i,h)),a)return a}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){return Ii()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,qi,this,n,r)},e.prototype.getLayerRenderer=function(t){var e=Ai(t);if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,n=0,r=this.layerRendererConstructors_.length;n<r;++n){var o=this.layerRendererConstructors_[n];if(o.handles(t)){i=o.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=Ni(i,Ji,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],Gi(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.renderFrame=function(t){Ii()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(qd)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(Vi)),Hd=function(t){function e(e){t.call(this,e),this.renderedResolution,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clip=function(t,e,i){var n=e.pixelRatio,r=e.size[0]*n,o=e.size[1]*n,s=e.viewState.rotation,a=Sr(i),l=Cr(i),u=vr(i),h=mr(i);Jo(e.coordinateToPixelTransform,a),Jo(e.coordinateToPixelTransform,l),Jo(e.coordinateToPixelTransform,u),Jo(e.coordinateToPixelTransform,h),t.save(),Tu(t,-s,r/2,o/2),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(h[0]*n,h[1]*n),t.clip(),Tu(t,s,r/2,o/2)},e.prototype.dispatchComposeEvent_=function(t,e,i,n){var r=this.getLayer();if(r.hasListener(t)){var o=i.size[0]*i.pixelRatio,s=i.size[1]*i.pixelRatio,a=i.viewState.rotation;Tu(e,-a,o/2,s/2);var l=void 0!==n?n:this.getTransform(i,0),u=new Ud(e,i.pixelRatio,i.extent,l,i.viewState.rotation),h=new $d(t,u,i,e,null);r.dispatchEvent(h),Tu(e,a,o/2,s/2)}},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){return this.forEachFeatureAtCoordinate(t,e,i,qi)?n.call(r,this.getLayer(),null):void 0},e.prototype.postCompose=function(t,e,i,n){this.dispatchComposeEvent_(Yl,t,e,n)},e.prototype.preCompose=function(t,e,i){this.dispatchComposeEvent_(Zl,t,e,i)},e.prototype.dispatchRenderEvent=function(t,e,i){this.dispatchComposeEvent_(Jl,t,e,i)},e.prototype.getTransform=function(t,e){var i=t.viewState,n=t.pixelRatio,r=n*t.size[0]/2,o=n*t.size[1]/2,s=n/i.resolution,a=-s,l=-i.rotation,u=-i.center[0]+e,h=-i.center[1];return es(this.transform_,r,o,s,a,l,u,h)},e.prototype.composeFrame=function(t,e,i){Ii()},e.prototype.prepareFrame=function(t,e){return Ii()},e}(function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){return t.forEachLoadedTile(e,n,r,(function(t){i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t}))}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n){},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===wa&&this.renderIfReadyAndVisible()},e.prototype.hasFeatureAtCoordinate=function(t,e){return!1},e.prototype.loadImage=function(t){var e=t.getState();return e!=wa&&e!=xa&&Ni(t,Ji,this.handleImageChange_,this),e==_a&&(t.load(),e=t.getState()),e==wa},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Ra&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=Ai(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,n){var r=Ai(e),o=i.toString();r in t?o in t[r]?t[r][o].extend(n):t[r][o]=n:(t[r]={},t[r][o]=n)},e.prototype.manageTilePyramid=function(t,e,i,n,r,o,s,a,l,u){var h=Ai(e);h in t.wantedTiles||(t.wantedTiles[h]={});var c,d,p,f,g,m,v=t.wantedTiles[h],y=t.tileQueue;for(m=i.getMinZoom();m<=s;++m)for(d=i.getTileRangeForExtentAndZ(o,m,d),p=i.getResolution(m),f=d.minX;f<=d.maxX;++f)for(g=d.minY;g<=d.maxY;++g)s-m<=a?((c=e.getTile(m,f,g,n,r)).getState()==Dc&&(v[c.getKey()]=!0,y.isKeyQueued(c.getKey())||y.enqueue([c,h,i.getTileCoordCenter(c.tileCoord),p])),void 0!==l&&l.call(u,c)):e.useTile(m,f,g,r)},e}(fn)),Yd=function(t){function e(e){t.call(this,e),this.coordinateToCanvasPixelTransform=[1,0,0,1,0,0],this.hitCanvasContext_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.preCompose(i,t);var n=this.getImage();if(n){var r=e.extent,o=void 0!==r&&!tr(r,t.extent)&&Er(r,t.extent);o&&this.clip(i,t,r);var s=this.getImageTransform(),a=i.globalAlpha;i.globalAlpha=e.opacity;var l=s[4],u=s[5],h=n.width*s[0],c=n.height*s[3];h>=.5&&c>=.5&&i.drawImage(n,0,0,+n.width,+n.height,Math.round(l),Math.round(u),Math.round(h),Math.round(c)),i.globalAlpha=a,o&&i.restore()}this.postCompose(i,t,e)},e.prototype.getImage=function(){return Ii()},e.prototype.getImageTransform=function(){return Ii()},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){if(this.getImage()){var o=Jo(this.coordinateToCanvasPixelTransform,t.slice());el(o,e.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=Rn(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),o[0],o[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?n.call(r,this.getLayer(),s):void 0}},e}(Hd),Zd=function(t){function e(i){if(t.call(this,i),this.image_=null,this.imageTransform_=[1,0,0,1,0,0],this.skippedFeatures_=[],this.vectorRenderer_=null,i.getType()===Ul)for(var n=0,r=Kd.length;n<r;++n){var o=Kd[n];if(o!==e&&o.handles(i)){this.vectorRenderer_=new o(i);break}}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.prepareFrame=function(t,e){var i,n=t.pixelRatio,r=t.size,o=t.viewState,s=o.center,a=o.resolution,l=this.getLayer().getSource(),u=t.viewHints,h=this.vectorRenderer_,c=t.extent;if(h||void 0===e.extent||(c=xr(c,e.extent)),!u[Kc]&&!u[Xc]&&!Ir(c)){var d=o.projection,p=this.skippedFeatures_;if(h){var f=h.context,g=Ri({},t,{size:[Tr(c)/a,wr(c)/a],viewState:Ri({},t.viewState,{rotation:0})}),m=Object.keys(g.skippedFeatureUids).sort();i=new Na(c,a,n,f.canvas,(function(t){!h.prepareFrame(g,e)||!h.replayGroupChanged&&Gr(p,m)||(f.canvas.width=g.size[0]*n,f.canvas.height=g.size[1]*n,h.compose(f,g,e),p=m,t())}))}else i=l.getImage(c,a,n,d);i&&this.loadImage(i)&&(this.image_=i,this.skippedFeatures_=p)}if(this.image_){var v=(i=this.image_).getExtent(),y=i.getResolution(),_=i.getPixelRatio(),b=n*y/(a*_),w=es(this.imageTransform_,n*r[0]/2,n*r[1]/2,b,b,0,_*(v[0]-s[0])/y,_*(s[1]-v[3])/y);es(this.coordinateToCanvasPixelTransform,n*r[0]/2-w[4],n*r[1]/2-w[5],n/a,-n/a,0,-s[0],-s[1]),this.renderedResolution=y*n/_}return!!this.image_},e.prototype.forEachFeatureAtCoordinate=function(e,i,n,r){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,i,n,r):t.prototype.forEachFeatureAtCoordinate.call(this,e,i,n,r)},e}(Yd);Zd.handles=function(t){return t.getType()===$l||t.getType()===Ul&&t.getRenderMode()===iu},Zd.create=function(t,e){return new Zd(e)};var Jd=Zd,Qd=function(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n};function tp(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new Qd(t,e,i,n)}Qd.prototype.contains=function(t){return this.containsXY(t[1],t[2])},Qd.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},Qd.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},Qd.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},Qd.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},Qd.prototype.getHeight=function(){return this.maxY-this.minY+1},Qd.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},Qd.prototype.getWidth=function(){return this.maxX-this.minX+1},Qd.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};var ep=Qd,ip=function(t){function e(e,i){t.call(this,e),this.context=i?null:Rn(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new ep(0,0,0,0),this.imageTransform_=[1,0,0,1,0,0],this.zDirection=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isDrawableTile_=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==$c||i==Bc||i==Nc&&!n},e.prototype.getTile=function(t,e,i,n,r){var o=this.getLayer(),s=o.getSource().getTile(t,e,i,n,r);return s.getState()==Nc&&(o.getUseInterimTilesOnError()?o.getPreload()>0&&(this.newTiles_=!0):s.setState($c)),this.isDrawableTile_(s)||(s=s.getInterimTile()),s},e.prototype.prepareFrame=function(t,e){var i=t.pixelRatio,n=t.size,r=t.viewState,o=r.projection,s=r.resolution,a=r.center,l=this.getLayer(),u=l.getSource(),h=u.getRevision(),c=u.getTileGridForProjection(o),d=c.getZForResolution(s,this.zDirection),p=c.getResolution(d),f=Math.round(s/p)||1,g=t.extent;if(void 0!==e.extent&&(g=xr(g,e.extent)),Ir(g))return!1;var m=c.getTileRangeForExtentAndZ(g,d),v=c.getTileRangeExtent(d,m),y=u.getTilePixelRatio(i),_={};_[d]={};var b,w,x,S=this.createLoadedTileFinder(u,o,_),C=t.viewHints,T=C[Kc]||C[Xc],E=this.tmpExtent,I=this.tmpTileRange_;for(this.newTiles_=!1,w=m.minX;w<=m.maxX;++w)for(x=m.minY;x<=m.maxY;++x)if(!(Date.now()-t.time>16&&T)){if(b=this.getTile(d,w,x,i,o),this.isDrawableTile_(b)){var k=Ai(this);if(b.getState()==$c){_[d][b.tileCoord.toString()]=b;var A=b.inTransition(k);this.newTiles_||!A&&-1!==this.renderedTiles.indexOf(b)||(this.newTiles_=!0)}if(1===b.getAlpha(k,t.time))continue}var P=c.getTileCoordChildTileRange(b.tileCoord,I,E),R=!1;P&&(R=S(d+1,P)),R||c.forEachTileCoordParentTileRange(b.tileCoord,S,null,I,E)}var L=p*i/y*f;if(!(this.renderedResolution&&Date.now()-t.time>16&&T)&&(this.newTiles_||!this.renderedExtent_||!tr(this.renderedExtent_,g)||this.renderedRevision!=h||f!=this.oversampling_||!T&&L!=this.renderedResolution)){var M=this.context;if(M){var F=u.getTilePixelSize(d,i,o),O=Math.round(m.getWidth()*F[0]/f),D=Math.round(m.getHeight()*F[1]/f),j=M.canvas;j.width!=O||j.height!=D?(this.oversampling_=f,j.width=O,j.height=D):(this.renderedExtent_&&!lr(v,this.renderedExtent_)&&M.clearRect(0,0,O,D),f=this.oversampling_)}this.renderedTiles.length=0;var $,N,B,U,G,z,V,q,W,K,X=Object.keys(_).map(Number);for(X.sort((function(t,e){return t===d?1:e===d?-1:t>e?1:t<e?-1:0})),U=0,G=X.length;U<G;++U)for(var H in B=X[U],N=u.getTilePixelSize(B,i,o),$=c.getResolution(B)/p,V=y*u.getGutterForProjection(o),q=_[B])b=q[H],w=((z=c.getTileCoordExtent(b.getTileCoord(),E))[0]-v[0])/p*y/f,x=(v[3]-z[3])/p*y/f,W=N[0]*$/f,K=N[1]*$/f,this.drawTileImage(b,t,e,w,x,W,K,V,d===B),this.renderedTiles.push(b);this.renderedRevision=h,this.renderedResolution=p*i/y*f,this.renderedExtent_=v}var Y=this.renderedResolution/s,Z=es(this.imageTransform_,i*n[0]/2,i*n[1]/2,Y,Y,0,(this.renderedExtent_[0]-a[0])/this.renderedResolution*i,(a[1]-this.renderedExtent_[3])/this.renderedResolution*i);return es(this.coordinateToCanvasPixelTransform,i*n[0]/2-Z[4],i*n[1]/2-Z[5],i/s,-i/s,0,-a[0],-a[1]),this.updateUsedTiles(t.usedTiles,u,d,m),this.manageTilePyramid(t,u,c,i,o,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.renderedTiles.length>0},e.prototype.drawTileImage=function(t,e,i,n,r,o,s,a,l){var u=this.getTileImage(t);if(u){var h=Ai(this),c=l?t.getAlpha(h,e.time):1,d=this.getLayer().getSource();1!==c||d.getOpaque(e.viewState.projection)||this.context.clearRect(n,r,o,s);var p=c!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,o,s),p&&this.context.restore(),1!==c?e.animate=!0:l&&t.endTransition(h)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.getTileImage=function(t){return t.getImage()},e}(Yd);ip.handles=function(t){return t.getType()===Nl},ip.create=function(t,e){return new ip(e)},ip.prototype.getLayer;var np=ip,rp=function(){};rp.prototype.getReplay=function(t,e){return Ii()},rp.prototype.isEmpty=function(){return Ii()},rp.prototype.addDeclutter=function(t){return Ii()};var op=rp,sp="Circle",ap="Default",lp="Image",up="LineString",hp="Polygon",cp="Text",dp="Ellipse";function pp(t,e,i,n,r,o,s,a){for(var l,u,h,c=[],d=t[e]>t[i-n],p=r.length,f=t[e],g=t[e+1],m=t[e+=n],v=t[e+1],y=0,_=Math.sqrt(Math.pow(m-f,2)+Math.pow(v-g,2)),b="",w=0,x=0;x<p;++x){u=d?p-x-1:x;var S=r.charAt(u),C=o(b=d?S+b:b+S)-w;w+=C;for(var T=s+C/2;e<i-n&&y+_<T;)f=m,g=v,m=t[e+=n],v=t[e+1],y+=_,_=Math.sqrt(Math.pow(m-f,2)+Math.pow(v-g,2));var E=T-y,I=Math.atan2(v-g,m-f);if(d&&(I+=I>0?-Math.PI:Math.PI),void 0!==h){var k=I-h;if(k+=k>Math.PI?-2*Math.PI:k<-Math.PI?2*Math.PI:0,Math.abs(k)>a)return null}var A=E/_,P=co(f,m,A),R=co(g,v,A);h==I?(d&&(l[0]=P,l[1]=R,l[2]=C/2),l[4]=b):(w=C,l=[P,R,C/2,I,b=S],d?c.unshift(l):c.push(l),h=I),s+=C}return c}var fp={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12,ELLIPSE:13},gp=[fp.FILL],mp=[fp.STROKE],vp=[fp.BEGIN_PATH],yp=[fp.CLOSE_PATH],_p=fp,bp=[hp,sp,dp,up,lp,cp,ap],wp={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},xp=[1/0,1/0,-1/0,-1/0],Sp=[1,0,0,1,0,0],Cp=function(t){function e(e,i,n,r,o,s){t.call(this),this.declutterTree=s,this.tolerance=e,this.maxExtent=i,this.overlaps=o,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replayTextBackground_=function(t,e,i,n,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,v){var y=m||v;e-=r*=d,i-=o*=d;var _,b,w,x,S=f+u>n.width?n.width-u:f,C=a+h>n.height?n.height-h:a,T=g[3]+S*d+g[1],E=g[0]+C*d+g[2],I=e-g[3],k=i-g[0];(y||0!==c)&&(_=[I,k],b=[I+T,k],w=[I+T,k+E],x=[I,k+E]);var A=null;if(0!==c){var P=e+r,R=i+o;A=es(Sp,P,R,1,1,c,-P,-R),or(xp),hr(xp,Jo(Sp,_)),hr(xp,Jo(Sp,b)),hr(xp,Jo(Sp,w)),hr(xp,Jo(Sp,x))}else rr(I,k,I+T,k+E,xp);var L=t.canvas,M=v?v[2]*d/2:0,F=xp[0]-M<=L.width&&xp[2]+M>=0&&xp[1]-M<=L.height&&xp[3]+M>=0;if(p&&(e=Math.round(e),i=Math.round(i)),s){if(!F&&1==s[4])return;ur(s,xp);var O=F?[t,A?A.slice(0):null,l,n,u,h,S,C,e,i,d]:null;O&&y&&O.push(m,v,_,b,w,x),s.push(O)}else F&&(y&&this.replayTextBackground_(t,_,b,w,x,m,v),Iu(t,A,l,n,u,h,S,C,e,i,d))},e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var l,u,h,c=[t[e],t[e+1]],d=[NaN,NaN],p=!0;for(l=e+n;l<i;l+=n)d[0]=t[l],d[1]=t[l+1],(h=ir(a,d))!==u?(p&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],p=!1):h===Vn?(this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],p=!1):p=!0,c[0]=d[0],c[1]=d[1],u=h;return(r&&p||l===e+n)&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],l=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(l),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a,l=t.getType(),u=t.getStride(),h=this.coordinates.length;if(l==Qr){n=(t=t).getOrientedFlatCoordinates(),s=[];var c=t.getEndss();a=0;for(var d=0,p=c.length;d<p;++d){var f=[];a=this.drawCustomCoordinates_(n,a,c[d],u,f),s.push(f)}this.instructions.push([_p.CUSTOM,h,s,t,i,vs])}else l==Yr||l==Jr?(o=[],n=l==Yr?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),u,o),this.instructions.push([_p.CUSTOM,h,o,t,i,ms])):l==Xr||l==Zr?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,u,!1,!1),this.instructions.push([_p.CUSTOM,h,r,t,i,gs])):l==Kr&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([_p.CUSTOM,h,r,t,i]));this.endGeometry(t,e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[_p.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[_p.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){},e.prototype.fill_=function(t){if(this.alignFill_){var e=Jo(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.setTransform.apply(t,Eu)},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],hl&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){var i=t[4];if(1==i||i==t.length-5){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(n)){this.declutterTree.insert(n);for(var r=5,o=t.length;r<o;++r){var s=t[r];s&&(s.length>11&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),Iu.apply(void 0,s))}}t.length=5,or(t)}}},e.prototype.replay_=function(t,e,i,n,r,o,s){var a;this.pixelCoordinates_&&Gr(e,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=ro(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),Zo(this.renderedTransform_,e));for(var l,u,h,c,d,p,f,g,m,v,y,_,b=!Fi(i),w=0,x=n.length,S=0,C=0,T=0,E=null,I=null,k=this.coordinateCache_,A=this.viewRotation_,P={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},R=this.instructions!=n||this.overlaps?0:200;w<x;){var L=n[w];switch(L[0]){case _p.BEGIN_GEOMETRY:v=L[1],b&&i[Ai(v)]||!v.getGeometry()?w=L[2]:void 0===s||Er(s,v.getGeometry().getExtent())?++w:w=L[2]+1;break;case _p.BEGIN_PATH:C>R&&(this.fill_(t),C=0),T>R&&(t.stroke(),T=0),C||T||(t.beginPath(),c=d=NaN),++w;break;case _p.CIRCLE:var M=a[S=L[1]],F=a[S+1],O=a[S+2]-M,D=a[S+3]-F,j=Math.sqrt(O*O+D*D);t.moveTo(M+j,F),t.arc(M,F,j,0,2*Math.PI,!0),++w;break;case _p.ELLIPSE:S=L[1],l=L[2];var $=a[S],N=a[S+1],B=a[S+2],U=a[S+3],G=a[S+4],z=a[S+5],V=a[S+6],q=a[S+7];if(l-S==8){var W=.2761424*(G-$),K=.2761424*(z-N),X=.2761424*(V-B),H=.2761424*(q-U);t.moveTo($,N),t.bezierCurveTo($-X,N-H,B-W,U-K,B,U),t.bezierCurveTo(B+W,U+K,G-X,z-H,G,z),t.bezierCurveTo(G+X,z+H,V+W,q+K,V,q),t.bezierCurveTo(V-W,q-K,$+X,N+H,$,N)}++w;break;case _p.CLOSE_PATH:t.closePath(),++w;break;case _p.CUSTOM:S=L[1],l=L[2];var Y=L[3],Z=L[4],J=6==L.length?L[5]:void 0;P.geometry=Y,P.feature=v,w in k||(k[w]=[]);var Q=k[w];J?J(a,S,l,2,Q):(Q[0]=a[S],Q[1]=a[S+1],Q.length=2),Z(Q,P),++w;break;case _p.DRAW_IMAGE:S=L[1],l=L[2],m=L[3],u=L[4],h=L[5],g=o?null:L[6];var tt=L[7],et=L[8],it=L[9],nt=L[10],rt=L[11],ot=L[12],st=L[13],at=L[14],lt=void 0,ut=void 0,ht=void 0;for(L.length>16?(lt=L[15],ut=L[16],ht=L[17]):(lt=fu,ut=ht=!1),rt&&(ot+=A);S<l;S+=2)this.replayImage_(t,a[S],a[S+1],m,u,h,g,tt,et,it,nt,ot,st,r,at,lt,ut?E:null,ht?I:null);this.renderDeclutter_(g,v),++w;break;case _p.DRAW_CHARS:var ct=L[1],dt=L[2],pt=L[3];g=o?null:L[4];var ft=L[5],gt=L[6],mt=L[7],vt=L[8],yt=L[9],_t=L[10],bt=L[11],wt=L[12],xt=L[13],St=L[14],Ct=Ks(a,ct,dt,2),Tt=vt(wt);if(ft||Tt<=Ct){var Et=this.textStates[xt].textAlign,It=pp(a,ct,dt,2,wt,vt,(Ct-Tt)*wp[Et],mt);if(It){var kt=void 0,At=void 0,Pt=void 0,Rt=void 0,Lt=void 0;if(_t)for(kt=0,At=It.length;kt<At;++kt)Pt=(Lt=It[kt])[4],Rt=this.getImage(Pt,xt,"",_t),u=Lt[2]+bt,h=pt*Rt.height+2*(.5-pt)*bt-yt,this.replayImage_(t,Lt[0],Lt[1],Rt,u,h,g,Rt.height,1,0,0,Lt[3],St,!1,Rt.width,fu,null,null);if(gt)for(kt=0,At=It.length;kt<At;++kt)Pt=(Lt=It[kt])[4],Rt=this.getImage(Pt,xt,gt,""),u=Lt[2],h=pt*Rt.height-yt,this.replayImage_(t,Lt[0],Lt[1],Rt,u,h,g,Rt.height,1,0,0,Lt[3],St,!1,Rt.width,fu,null,null)}}this.renderDeclutter_(g,v),++w;break;case _p.END_GEOMETRY:if(void 0!==o){var Mt=o(v=L[1]);if(Mt)return Mt}++w;break;case _p.FILL:R?C++:this.fill_(t),++w;break;case _p.MOVE_TO_LINE_TO:for(S=L[1],l=L[2],y=a[S],f=(_=a[S+1])+.5|0,(p=y+.5|0)===c&&f===d||(t.moveTo(y,_),c=p,d=f),S+=2;S<l;S+=2)p=(y=a[S])+.5|0,f=(_=a[S+1])+.5|0,S!=l-2&&p===c&&f===d||(t.lineTo(y,_),c=p,d=f);++w;break;case _p.SET_FILL_STYLE:E=L,this.alignFill_=L[2],C&&(this.fill_(t),C=0,T&&(t.stroke(),T=0)),t.fillStyle=L[1],++w;break;case _p.SET_STROKE_STYLE:I=L,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,L),++w;break;case _p.STROKE:R?T++:t.stroke(),++w;break;default:++w}}C&&this.fill_(t),T&&t.stroke()},e.prototype.replay=function(t,e,i,n,r){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,r,void 0,void 0)},e.prototype.replayHitDetection=function(t,e,i,n,r,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,!0,r,o)},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==_p.END_GEOMETRY?o=t:n==_p.BEGIN_GEOMETRY&&(i[2]=t,Br(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=uu(n||cu)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=uu(r||pu);var o=e.getLineCap();i.lineCap=void 0!==o?o:"round";var s=e.getLineDash();i.lineDash=s?s.slice():du;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var l=e.getLineJoin();i.lineJoin=void 0!==l?l:"round";var u=e.getWidth();i.lineWidth=void 0!==u?u:1;var h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t,e){var i=t.fillStyle,n=[_p.SET_FILL_STYLE,i];return"string"!=typeof i&&n.push(!0),n},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[_p.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e,i){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!Gr(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[_p.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Zn(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Yn(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Bd),Tp=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([_p.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([_p.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([_p.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([_p.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),r=t.getHitDetectionImage(1),o=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroup_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(Cp),Ep=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[_p.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],vp);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(mp),this.endGeometry(t,e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],vp);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(mp),this.endGeometry(t,e)}},e.prototype.finish=function(){var t=this.state;null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(mp),this.reverseHitDetectionInstructions(),this.state=null},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(mp),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(vp)},e}(Cp),Ip=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=null!=r.strokeStyle,a=i.length;this.instructions.push(vp),this.hitDetectionInstructions.push(vp);for(var l=0;l<a;++l){var u=i[l],h=this.coordinates.length,c=this.appendFlatCoordinates(t,e,u,n,!0,!s),d=[_p.MOVE_TO_LINE_TO,h,c];this.instructions.push(d),this.hitDetectionInstructions.push(d),s&&(this.instructions.push(yp),this.hitDetectionInstructions.push(yp)),e=u}return o&&(this.instructions.push(gp),this.hitDetectionInstructions.push(gp)),s&&(this.instructions.push(mp),this.hitDetectionInstructions.push(mp)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([_p.SET_FILL_STYLE,su(cu)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,s,!1,!1);var l=[_p.CIRCLE,a];this.instructions.push(vp,l),this.hitDetectionInstructions.push(vp,l),this.hitDetectionInstructions.push(gp),void 0!==i.fillStyle&&this.instructions.push(gp),void 0!==i.strokeStyle&&(this.instructions.push(mp),this.hitDetectionInstructions.push(mp)),this.endGeometry(t,e)}},e.prototype.drawEllipse=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([_p.SET_FILL_STYLE,su(cu)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=this.coordinates.length;Array.prototype.push.apply(this.coordinates,o);var a=this.coordinates.length,l=[_p.BEGIN_PATH],u=[_p.ELLIPSE,s,a];this.instructions.push(l,u),this.hitDetectionInstructions.push(l,u);var h=[_p.FILL];if(this.hitDetectionInstructions.push(h),void 0!==i.fillStyle&&this.instructions.push(h),void 0!==i.strokeStyle){var c=[_p.STROKE];this.instructions.push(c),this.hitDetectionInstructions.push(c)}this.endGeometry(t,e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([_p.SET_FILL_STYLE,su(cu)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(t,e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([_p.SET_FILL_STYLE,su(cu)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([_p.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,i=0,n=e.length;i<n;++i)e[i]=bs(e[i],t)},e.prototype.setFillStrokeStyles_=function(t){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill,t),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},e}(Cp);function kp(t,e,i,n,r){var o,s,a,l,u,h,c,d,p,f=i,g=i,m=0,v=0,y=i;for(o=i;o<n;o+=r){var _=e[o],b=e[o+1];void 0!==l&&(d=_-l,p=b-u,a=Math.sqrt(d*d+p*p),void 0!==h&&(v+=s,Math.acos((h*d+c*p)/(s*a))>t&&(v>m&&(m=v,f=y,g=o),v=0,y=o-r)),s=a,h=d,c=p),l=_,u=b}return(v+=a)>m?[y,o]:[f,g]}var Ap="line";var Pp={Circle:Ip,Default:Cp,Image:Tp,LineString:Ep,Polygon:Ip,Text:function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},gu.prune()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(i||n)){var o,s,a=this.coordinates.length,l=t.getType(),u=null,h=2,c=2;if(r.placement===Ap){if(!Er(this.getBufferedMaxExtent(),t.getExtent()))return;var d;if(u=t.getFlatCoordinates(),c=t.getStride(),l==Xr)d=[u.length];else if(l==Jr)d=t.getEnds();else if(l==Yr)d=t.getEnds().slice(0,1);else if(l==Qr){var p=t.getEndss();for(d=[],o=0,s=p.length;o<s;++o)d.push(p[o][0])}this.beginGeometry(t,e);for(var f,g=r.textAlign,m=0,v=0,y=d.length;v<y;++v){if(null==g){var _=kp(r.maxAngle,u,m,d[v],c);m=_[0],f=_[1]}else f=d[v];for(o=m;o<f;o+=c)this.coordinates.push(u[o],u[o+1]);h=this.coordinates.length,m=d[v],this.drawChars_(a,h,this.declutterGroup_),a=h}this.endGeometry(t,e)}else{var b=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),w=b.width/this.pixelRatio;switch(l){case Kr:case Zr:h=(u=t.getFlatCoordinates()).length;break;case Xr:u=t.getFlatMidpoint();break;case eo:u=t.getCenter();break;case Jr:h=(u=t.getFlatMidpoints()).length;break;case Yr:if(u=t.getFlatInteriorPoint(),!r.overflow&&u[2]/this.resolution<w)return;c=3;break;case Qr:var x=t.getFlatInteriorPoints();for(u=[],o=0,s=x.length;o<s;o+=3)(r.overflow||x[o+2]/this.resolution>=w)&&u.push(x[o],x[o+1]);if(0==(h=u.length))return}h=this.appendFlatCoordinates(u,0,h,c,!1,!1),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(b,a,h),this.endGeometry(t,e)}}},e.prototype.getImage=function(t,e,i,n){var r,o=n+e+t+i+this.pixelRatio;if(!gu.containsKey(o)){var s=n?this.strokeStates[n]||this.textStrokeState_:null,a=i?this.fillStates[i]||this.textFillState_:null,l=this.textStates[e]||this.textState_,u=this.pixelRatio,h=l.scale*u,c=wp[l.textAlign||"center"],d=n&&s.lineWidth?s.lineWidth:0,p=t.split("\n"),f=p.length,g=[],m=function(t,e,i){for(var n=e.length,r=0,o=0;o<n;++o){var s=Cu(t,e[o]);r=Math.max(r,s),i.push(s)}return r}(l.font,p,g),v=Su(l.font),y=v*f,_=m+d,b=Rn(Math.ceil(_*h),Math.ceil((y+d)*h));r=b.canvas,gu.set(o,r),1!=h&&b.scale(h,h),b.font=l.font,n&&(b.strokeStyle=s.strokeStyle,b.lineWidth=d,b.lineCap=s.lineCap,b.lineJoin=s.lineJoin,b.miterLimit=s.miterLimit,hl&&s.lineDash.length&&(b.setLineDash(s.lineDash),b.lineDashOffset=s.lineDashOffset)),i&&(b.fillStyle=a.fillStyle),b.textBaseline="middle",b.textAlign="center";var w,x=.5-c,S=c*r.width/h+x*d;if(n)for(w=0;w<f;++w)b.strokeText(p[w],S+x*g[w],.5*(d+v)+w*v);if(i)for(w=0;w<f;++w)b.fillText(p[w],S+x*g[w],.5*(d+v)+w*v)}return gu.get(o)},e.prototype.drawTextImage_=function(t,e,i){var n=this.textState_,r=this.textStrokeState_,o=this.pixelRatio,s=wp[n.textAlign||"center"],a=wp[n.textBaseline],l=r&&r.lineWidth?r.lineWidth:0,u=s*t.width/o+2*(.5-s)*l,h=a*t.height/o+2*(.5-a)*l;this.instructions.push([_p.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,t.width,n.padding==fu?fu:n.padding.map((function(t){return t*o})),!!n.backgroundFill,!!n.backgroundStroke]),this.hitDetectionInstructions.push([_p.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/o,t.width,n.padding,!!n.backgroundFill,!!n.backgroundStroke])},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,r=this.textState_,o=this.textFillState_,s=this.strokeKey_;n&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:n.strokeStyle,lineCap:n.lineCap,lineDashOffset:n.lineDashOffset,lineWidth:n.lineWidth,lineJoin:n.lineJoin,miterLimit:n.miterLimit,lineDash:n.lineDash}));var a=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:r.font,textAlign:r.textAlign||"center",scale:r.scale});var l=this.fillKey_;o&&(l in this.fillStates||(this.fillStates[l]={fillStyle:o.fillStyle}));var u=this.pixelRatio,h=wp[r.textBaseline],c=this.textOffsetY_*u,d=this.text_,p=r.font,f=r.scale,g=n?n.lineWidth*f/2:0,m=this.widths_[p];m||(this.widths_[p]=m={}),this.instructions.push([_p.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=Cu(p,t)),e*f*u},c,s,g*u,d,a,1]),this.hitDetectionInstructions.push([_p.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=Cu(p,t)),e*f},c,s,g,d,a,1/u])},e.prototype.setTextStyle=function(t,e){var i,n,r;if(t){this.declutterGroup_=e;var o=t.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=uu(o.getColor()||cu)):n=this.textFillState_=null;var s=t.getStroke();if(s){(r=this.textStrokeState_)||(r=this.textStrokeState_={});var a=s.getLineDash(),l=s.getLineDashOffset(),u=s.getWidth(),h=s.getMiterLimit();r.lineCap=s.getLineCap()||"round",r.lineDash=a?a.slice():du,r.lineDashOffset=void 0===l?0:l,r.lineJoin=s.getLineJoin()||"round",r.lineWidth=void 0===u?1:u,r.miterLimit=void 0===h?10:h,r.strokeStyle=uu(s.getColor()||pu)}else r=this.textStrokeState_=null;i=this.textState_;var c=t.getFont()||"10px sans-serif";_u(c);var d=t.getScale();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||fu,i.scale=void 0===d?1:d;var p=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===f?0:f,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===m?0:m,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:Ai(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Ai(n.fillStyle):""}else this.text_=""},e}(Cp),Ellipse:Ip},Rp=function(t){function e(e,i,n,r,o,s,a){t.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=i,this.overlaps_=o,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=a,this.replaysByZIndex_={},this.hitDetectionContext_=Rn(1,1),this.hitDetectionTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t){var e=null;return this.declutterTree_&&(t?(e=this.declutterGroup_)[4]++:(e=this.declutterGroup_=[1/0,1/0,-1/0,-1/0]).push(1)),e},e.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},e.prototype.hasReplays=function(t){for(var e in this.replaysByZIndex_)for(var i=this.replaysByZIndex_[e],n=0,r=t.length;n<r;++n)if(t[n]in i)return!0;return!1},e.prototype.finish=function(){for(var t in this.replaysByZIndex_){var e=this.replaysByZIndex_[t];for(var i in e)e[i].finish()}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=2*(n=Math.round(n))+1,u=es(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=this.hitDetectionContext_;h.canvas.width!==l||h.canvas.height!==l?(h.canvas.width=l,h.canvas.height=l):h.clearRect(0,0,l,l),void 0!==this.renderBuffer_&&(hr(a=[1/0,1/0,-1/0,-1/0],t),Yn(a,e*(this.renderBuffer_+n),a));var c,d,p=function(t){if(void 0!==Lp[t])return Lp[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var r=t,o=0,s=0;for(;r>=o;)Mp(i,t+r,t+o),Mp(i,t+o,t+r),Mp(i,t-o,t+r),Mp(i,t-r,t+o),Mp(i,t-r,t-o),Mp(i,t-o,t-r),Mp(i,t+o,t-r),Mp(i,t+r,t-o),o++,2*((s+=1+2*o)-r)+1>0&&(s+=1-2*(r-=1));return Lp[t]=i,i}(n);function f(t){for(var e=h.getImageData(0,0,l,l).data,i=0;i<l;i++)for(var n=0;n<l;n++)if(p[i][n]&&e[4*(n*l+i)+3]>0){var r=void 0;return(!c||d!=lp&&d!=cp||-1!==c.indexOf(t))&&(r=o(t)),r||void h.clearRect(0,0,l,l)}}this.declutterTree_&&(c=this.declutterTree_.all().map((function(t){return t.value})));var g,m,v,y,_,b=Object.keys(this.replaysByZIndex_).map(Number);for(b.sort(jr),g=b.length-1;g>=0;--g){var w=b[g].toString();for(v=this.replaysByZIndex_[w],m=bp.length-1;m>=0;--m)if(void 0!==(y=v[d=bp[m]]))if(!s||d!=lp&&d!=cp){if(_=y.replayHitDetection(h,u,i,r,f,a))return _}else{var x=s[w];x?x.push(y,u.slice(0)):s[w]=[y,u.slice(0)]}}},e.prototype.getClipCoords=function(t){var e=this.maxExtent_,i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return ro(s,0,8,2,t,s),s},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",n=this.replaysByZIndex_[i];void 0===n&&(n={},this.replaysByZIndex_[i]=n);var r=n[e];void 0===r&&(r=new(0,Pp[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[e]=r);return r},e.prototype.getReplays=function(){return this.replaysByZIndex_},e.prototype.isEmpty=function(){return Fi(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,n,r,o,s){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(jr),t.save(),this.clip(t,e);var l,u,h,c,d,p,f=o||bp;for(l=0,u=a.length;l<u;++l){var g=a[l].toString();for(d=this.replaysByZIndex_[g],h=0,c=f.length;h<c;++h){var m=f[h];if(p=d[m],void 0!==p)if(!s||m!=lp&&m!=cp)p.replay(t,e,i,n,r);else{var v=s[g];v?v.push(p,e.slice(0)):s[g]=[p,e.slice(0)]}}}t.restore()},e}(op),Lp={0:[[!0]]};function Mp(t,e,i){var n,r=Math.floor(t.length/2);if(e>=r)for(n=r;n<e;n++)t[n][i]=!0;else if(e<r)for(n=e+1;n<r;n++)t[n][i]=!0}var Fp=Rp,Op={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=wa)return;var o=t.getReplay(i.getZIndex(),lp);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),cp);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),up);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),cp);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:Bp,MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=wa)return;var o=t.getReplay(i.getZIndex(),lp);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),cp);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),up);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),cp);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getReplay(i.getZIndex(),hp);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),cp);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){(0,Op[s[r].getType()])(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),sp);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),cp);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},Rectangle:Bp,Ellipse:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),dp);s.setFillStrokeStyle(r,o),s.drawEllipse(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),cp);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}};function Dp(t,e){return parseInt(Ai(t),10)-parseInt(Ai(e),10)}function jp(t,e){var i=$p(t,e);return i*i}function $p(t,e){return.5*t/e}function Np(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var l=a.getImageState();l==wa||l==xa?a.unlistenImageChange(r,o):(l==_a&&a.load(),l=a.getImageState(),a.listenImageChange(r,o),s=!0)}return function(t,e,i,n){var r=i.getGeometryFunction()(e);if(!r)return;var o=r.getSimplifiedGeometry(n);if(i.getRenderer())!function t(e,i,n,r){if(i.getType()==to){for(var o=i.getGeometries(),s=0,a=o.length;s<a;++s)t(e,o[s],n,r);return}e.getReplay(n.getZIndex(),ap).drawCustom(i,r,n.getRenderer())}(t,o,i,e);else{(0,Op[o.getType()])(t,o,i,e)}}(t,e,i,n),s}function Bp(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),hp);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),cp);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}var Up=function(t){function e(e){t.call(this,e),this.declutterTree_=e.getDeclutter()?eh()(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=Rn(),Ni(gu,Qi,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Ui(gu,Qi,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.compose=function(t,e,i){var n=e.extent,r=e.pixelRatio,o=i.managed?e.skippedFeatureUids:{},s=e.viewState,a=s.projection,l=s.rotation,u=a.getExtent(),h=this.getLayer().getSource(),c=this.getTransform(e,0),d=i.extent,p=void 0!==d;p&&this.clip(t,e,d);var f=this.replayGroup_;if(f&&!f.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var g,m=this.getLayer(),v=0,y=0,_=1!==i.opacity,b=m.hasListener(Jl);if(_||b){var w=t.canvas.width,x=t.canvas.height;if(l){var S=Math.round(Math.sqrt(w*w+x*x));v=(S-w)/2,y=(S-x)/2,w=x=S}this.context.canvas.width=w,this.context.canvas.height=x,g=this.context}else g=t;var C=g.globalAlpha;_||(g.globalAlpha=i.opacity),g!=t&&g.translate(v,y);var T=e.viewHints,E=!(T[Kc]||T[Xc]),I=e.size[0]*r,k=e.size[1]*r;if(Tu(g,-l,I/2,k/2),f.replay(g,c,l,o,E),h.getWrapX()&&a.canWrapX()&&!tr(u,n)){for(var A,P=n[0],R=Tr(u),L=0;P<u[0];)A=R*--L,c=this.getTransform(e,A),f.replay(g,c,l,o,E),P+=R;for(L=0,P=n[2];P>u[2];)A=R*++L,c=this.getTransform(e,A),f.replay(g,c,l,o,E),P-=R}if(Tu(g,l,I/2,k/2),b&&this.dispatchRenderEvent(g,e,c),g!=t){if(_){var M=t.globalAlpha;t.globalAlpha=i.opacity,t.drawImage(g.canvas,-v,-y),t.globalAlpha=M}else t.drawImage(g.canvas,-v,-y);g.translate(-v,-y)}_||(g.globalAlpha=C)}p&&t.restore()},e.prototype.composeFrame=function(t,e,i){var n=this.getTransform(t,0);this.preCompose(i,t,n),this.compose(i,t,e),this.postCompose(i,t,e,n)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(this.replayGroup_){var o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=Ai(t);if(!(e in l))return l[e]=!0,n.call(r,t,a)}),null)}},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e){var i=this.getLayer(),n=i.getSource(),r=t.viewHints[Kc],o=t.viewHints[Xc],s=i.getUpdateWhileAnimating(),a=i.getUpdateWhileInteracting();if(!this.dirty_&&!s&&r||!a&&o)return!0;var l=t.extent,u=t.viewState,h=u.projection,c=u.resolution,d=t.pixelRatio,p=i.getRevision(),f=i.getRenderBuffer(),g=i.getRenderOrder();void 0===g&&(g=Dp);var m=Yn(l,f*c),v=u.projection.getExtent();if(n.getWrapX()&&u.projection.canWrapX()&&!tr(v,t.extent)){var y=Tr(v),_=Math.max(Tr(m)/2,y);m[0]=v[0]-_,m[2]=v[2]+_}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==p&&this.renderedRenderOrder_==g&&tr(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var b=new Fp($p(c,d),m,c,d,n.getOverlaps(),this.declutterTree_,i.getRenderBuffer());n.loadFeatures(m,c,h);var w=function(t){var e,n=t.getStyleFunction()||i.getStyleFunction();if(n&&(e=n(t,c)),e){var r=this.renderFeature(t,c,d,e,b);this.dirty_=this.dirty_||r}}.bind(this);if(g){var x=[];n.forEachFeatureInExtent(m,(function(t){x.push(t)})),x.sort(g);for(var S=0,C=x.length;S<C;++S)w(x[S])}else n.forEachFeatureInExtent(m,w);return b.finish(),this.renderedResolution_=c,this.renderedRevision_=p,this.renderedRenderOrder_=g,this.renderedExtent_=m,this.replayGroup_=b,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!n)return!1;var o=!1;if(Array.isArray(n))for(var s=0,a=n.length;s<a;++s)o=Np(r,t,n[s],jp(e,i),this.handleStyleImageChange_,this)||o;else o=Np(r,t,n,jp(e,i),this.handleStyleImageChange_,this);return o},e}(Hd);Up.handles=function(t){return t.getType()===Ul},Up.create=function(t,e){return new Up(e)};var Gp=Up,zp="image",Vp="vector",qp={image:[hp,sp,up,lp,cp],hybrid:[hp,up]},Wp={image:[ap],hybrid:[lp,cp,ap],vector:bp},Kp=function(t){function e(e){t.call(this,e,!0),this.declutterTree_=e.getDeclutter()?eh()(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=[1,0,0,1,0,0];var i=e.getRenderMode();this.zDirection=i===Vp?1:0,i!==Vp&&(this.context=Rn()),Ni(gu,Qi,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Ui(gu,Qi,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.getTile=function(e,i,n,r,o){var s=t.prototype.getTile.call(this,e,i,n,r,o);return s.getState()===$c&&(this.createReplayGroup_(s,r,o),this.context&&this.renderTileImage_(s,r,o)),s},e.prototype.getTileImage=function(t){var e=this.getLayer();return t.getImage(e)},e.prototype.prepareFrame=function(e,i){var n=this.getLayer().getRevision();return this.renderedLayerRevision_!=n&&(this.renderedTiles.length=0),this.renderedLayerRevision_=n,t.prototype.prepareFrame.call(this,e,i)},e.prototype.createReplayGroup_=function(t,e,i){var n=this,r=this.getLayer(),o=r.getRevision(),s=r.getRenderOrder()||null,a=t.getReplayState(r);if(a.dirty||a.renderedRevision!=o||a.renderedRenderOrder!=s){for(var l=r.getSource(),u=l.getTileGrid(),h=l.getTileGridForProjection(i).getResolution(t.tileCoord[0]),c=t.extent,d=function(o,d){var p=t.getTile(t.tileKeys[o]);if(p.getState()==$c){var f=p.tileCoord,g=u.getTileCoordExtent(f),m=xr(c,g),v=lr(g,m)?null:Yn(m,r.getRenderBuffer()*h,n.tmpExtent),y=p.getProjection(),_=!1;zo(i,y)||(_=!0,p.setProjection(i)),a.dirty=!1;var b=new Fp(0,m,h,e,l.getOverlaps(),n.declutterTree_,r.getRenderBuffer()),w=jp(h,e),x=function(t){var e,i=t.getStyleFunction()||r.getStyleFunction();if(i&&(e=i(t,h)),e){var n=this.renderFeature(t,w,e,b);this.dirty_=this.dirty_||n,a.dirty=a.dirty||n}},S=p.getFeatures();s&&s!==a.renderedRenderOrder&&S.sort(s);for(var C=0,T=S.length;C<T;++C){var E=S[C];_&&(y.getUnits()==mo.TILE_PIXELS&&(y.setWorldExtent(g),y.setExtent(p.getExtent())),E.getGeometry().transform(y,i)),v&&!Er(v,E.getGeometry().getExtent())||x.call(n,E)}b.finish(),p.setReplayGroup(r,t.tileCoord.toString(),b)}},p=0,f=t.tileKeys.length;p<f;++p)d(p);a.renderedRevision=o,a.renderedRenderOrder=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){var o=e.viewState.resolution,s=e.viewState.rotation;i=null==i?0:i;var a,l,u,h,c=this.getLayer(),d={},p=this.renderedTiles;for(u=0,h=p.length;u<h;++u){var f=p[u];if(Qn(a=Yn(f.extent,i*o,a),t))for(var g=0,m=f.tileKeys.length;g<m;++g){var v=f.getTile(f.tileKeys[g]);if(v.getState()==$c){var y=v.getReplayGroup(c,f.tileCoord.toString());l=l||y.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=Ai(t);if(!(e in d))return d[e]=!0,n.call(r,t,c)}),null)}}}return l},e.prototype.getReplayTransform_=function(t,e){var i=this.getLayer().getSource().getTileGrid(),n=t.tileCoord,r=i.getResolution(n[0]),o=e.viewState,s=e.pixelRatio,a=o.resolution/s,l=i.getTileCoordExtent(n,this.tmpExtent),u=o.center,h=Sr(l),c=e.size,d=Math.round(s*c[0]/2),p=Math.round(s*c[1]/2);return es(this.tmpTransform_,d,p,r/a,r/a,o.rotation,(h[0]-u[0])/r,(u[1]-h[1])/r)},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.postCompose=function(e,i,n){var r=this.getLayer(),o=r.getRenderMode();if(o!=zp){var s,a,l=r.getDeclutter()?{}:null,u=r.getSource(),h=Wp[o],c=i.pixelRatio,d=i.viewState.rotation,p=i.size;d&&Tu(e,-d,s=Math.round(c*p[0]/2),a=Math.round(c*p[1]/2)),l&&this.declutterTree_.clear();for(var f=i.viewHints,g=!(f[Kc]||f[Xc]),m=this.renderedTiles,v=u.getTileGridForProjection(i.viewState.projection),y=[],_=[],b=m.length-1;b>=0;--b){var w=m[b];if(w.getState()!=Uc)for(var x=w.tileCoord,S=v.getTileCoordExtent(x,this.tmpExtent)[0]-w.extent[0],C=void 0,T=0,E=w.tileKeys.length;T<E;++T){var I=w.getTile(w.tileKeys[T]);if(I.getState()==$c){var k=I.getReplayGroup(r,x.toString());if(k&&k.hasReplays(h)){C||(C=this.getTransform(i,S));var A=I.tileCoord[0],P=k.getClipCoords(C);e.save(),e.globalAlpha=n.opacity;for(var R=0,L=y.length;R<L;++R){var M=y[R];A<_[R]&&(e.beginPath(),e.moveTo(P[0],P[1]),e.lineTo(P[2],P[3]),e.lineTo(P[4],P[5]),e.lineTo(P[6],P[7]),e.moveTo(M[6],M[7]),e.lineTo(M[4],M[5]),e.lineTo(M[2],M[3]),e.lineTo(M[0],M[1]),e.clip())}k.replay(e,C,d,{},g,h,l),e.restore(),y.push(P),_.push(A)}}}}l&&function(t,e,i,n){for(var r=Object.keys(t).map(Number).sort(jr),o={},s=0,a=r.length;s<a;++s)for(var l=t[r[s].toString()],u=0,h=l.length;u<h;){var c=l[u++],d=l[u++];c.replay(e,d,i,o,n)}}(l,e,d,g),d&&Tu(e,d,s,a)}t.prototype.postCompose.call(this,e,i,n)},e.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var o=0,s=i.length;o<s;++o)r=Np(n,t,i[o],e,this.handleStyleImageChange_,this)||r;else r=Np(n,t,i,e,this.handleStyleImageChange_,this);return r},e.prototype.renderTileImage_=function(t,e,i){var n=this.getLayer(),r=t.getReplayState(n),o=n.getRevision(),s=qp[n.getRenderMode()];if(s&&r.renderedTileRevision!==o){r.renderedTileRevision=o;var a=t.wrappedTileCoord,l=a[0],u=n.getSource(),h=u.getTileGridForProjection(i),c=h.getResolution(l),d=t.getContext(n),p=u.getTilePixelSize(l,e,i);d.canvas.width=p[0],d.canvas.height=p[1];for(var f=h.getTileCoordExtent(a,this.tmpExtent),g=0,m=t.tileKeys.length;g<m;++g){var v=t.getTile(t.tileKeys[g]);if(v.getState()==$c){var y=e/c,_=Xo(this.tmpTransform_);Qo(_,y,-y),ts(_,-f[0],-f[3]),v.getReplayGroup(n,t.tileCoord.toString()).replay(d,_,0,{},!0,s)}}}},e}(np);Kp.handles=function(t){return t.getType()===Bl},Kp.create=function(t,e){return new Kp(e)};var Xp,Hp,Yp=Kp,Zp=function(t){function e(e){(e=Ri({},e)).controls||(e.controls=function(t){var e=t||{},i=new qa;return(void 0===e.zoom||e.zoom)&&i.push(new hd(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new ud(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new ad(e.attributionOptions)),i}()),e.interactions||(e.interactions=jd()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new Xd(this);return t.registerLayerRenderers([Jd,np,Gp,Yp]),t},e}(rd),Jp=ft({data:function(){return{hasMeasureFeature:!1,measureFeaturePosition:[0,0]}},computed:{isMeasuring:function(){return"measure"===this.interactionMode}},methods:{toggleMeasuring:function(){this.isMeasuring?this.resetInteractionMode():this.interactionMode="measure"},handleMeasureDrawStart:function(t){Xp.getSource().clear(),this.setMeasureFeature(t.feature)},updateMeasureFeature:function(t){this.measureFeaturePosition=t.target.getGeometry().getLastCoordinate(),this.$emit("changeMeasureFeature",[t.target])},setMeasureFeature:function(t){this.measureFeature=t,this.hasMeasureFeature=!!t,t&&(this.updateMeasureFeature({target:t}),t.on("change",this.updateMeasureFeature))}},watch:{isMeasuring:function(t){t?(this.map.addLayer(Xp),this.map.addInteraction(Hp),this.$emit("measuring")):(Xp.getSource().clear(),this.setMeasureFeature(void 0),this.map.removeLayer(Xp),this.map.removeInteraction(Hp))},image:function(){this.isMeasuring&&this.$nextTick((function(){this.updateMeasureFeature({target:this.measureFeature})}))}},created:function(){Xp=new zu({source:new oh,style:Ph.editing,zIndex:200,updateWhileAnimating:!0,updateWhileInteracting:!0}),(Hp=new vh({source:Xp.getSource(),type:"LineString",style:Xp.getStyle()})).on("drawstart",this.handleMeasureDrawStart),oe.on("Shift+f",this.toggleMeasuring,0,this.listenerSet),this.measureFeature=void 0}},void 0,void 0,!1,null,null,null).exports,Qp=ft({props:{extent:{type:Array,required:!0},intendedWidth:{type:Number,default:250},intendedHeight:{type:Number,default:200}},data:function(){return{}},computed:{minimap:function(){return new Zp({controls:[],interactions:[]})},viewport:function(){return new Ka}},methods:{updateViewport:function(){this.mapSize&&this.mapView.getCenter()&&this.viewport.setGeometry(Bs(this.mapView.calculateExtent(this.mapSize)))},dragViewport:function(t){this.mapView.setCenter(t.coordinate)},updateMapSize:function(t){this.mapSize=t.target.getSize()},updateMapView:function(t){this.mapView&&(this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport)),this.mapView=t.target.getView(),this.mapView.on("change:center",this.updateViewport),this.mapView.on("change:resolution",this.updateViewport)},updateElementSize:function(){var t=this.extent[2],e=this.extent[3],i=Math.max(t/this.intendedWidth,e/this.intendedHeight);this.minimap.setView(new td({projection:this.mapView.getProjection(),center:yr(this.extent),resolution:i})),this.$el.style.width=Math.round(t/i)+"px",this.$el.style.height=Math.round(e/i)+"px",this.minimap.updateSize()},refreshImageLayer:function(t){var e=t.element.get("name");if(e&&e.startsWith("image")){var i=this.minimap.getLayers();i.getLength()>1?i.setAt(0,t.element):i.insertAt(0,t.element)}},initImageLayer:function(t){var e=this;t.getArray().forEach((function(t){e.refreshImageLayer({element:t})}))}},watch:{extent:function(){this.updateElementSize()}},created:function(){var t=new oh;t.addFeature(this.viewport);var e=this.$parent.map;this.mapSize=e.getSize(),this.updateMapView({target:e}),e.on("change:size",this.updateMapSize),e.on("change:view",this.updateMapView),e.once("postcompose",this.updateViewport),this.minimap.addLayer(new zu({source:t,style:Ph.viewport})),e.getLayers().on("add",this.refreshImageLayer),this.minimap.on("pointerdrag",this.dragViewport),this.minimap.on("click",this.dragViewport),this.initImageLayer(e.getLayers())},mounted:function(){this.updateElementSize(),this.minimap.setTarget(this.$el),this.updateViewport()},beforeDestroy:function(){var t=this.$parent.map;this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport),t.un("change:size",this.updateMapSize),t.un("change:view",this.updateMapView),t.getLayers().un("add",this.refreshImageLayer)}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"minimap"})}),[],!1,null,null,null).exports,tf="modifystart",ef="modifyend",nf=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);function rf(t,e){return t.index-e.index}function of(t,e){var i,n,r=e.geometry;if(r.getType()===eo){var o=r;if(1===e.index){var s=il(o.getCenter(),t),a=Math.sqrt(s)-o.getRadius();return a*a}}return i=t,n=e.segment,il(i,Ja(i,n))}function sf(t,e){var i=e.geometry;return i.getType()===eo&&1===e.index||i.getType()===no||i.getType()===io?i.getClosestPoint(t):Ja(t,e.segment)}function af(){var t=$u();return function(e,i){return t[Kr]}}var lf=function(t){function e(e){var i;if(t.call(this,e),this.condition_=e.condition?e.condition:Tl,this.defaultDeleteCondition_=function(t){return function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&bl(t)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:ml,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new nh,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new zu({source:new oh({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:af(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Rectangle:this.writePolygonGeometry_,Ellipse:this.writePolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,i=new qa(this.source_.getFeatures()),Ni(this.source_,Yu,this.handleSourceAdd_,this),Ni(this.source_,Qu,this.handleSourceRemove_,this)):i=e.features,!i)throw new Error("The modify interaction requires features or a source");this.features_=i,this.features_.forEach(this.addFeature_.bind(this)),Ni(this.features_,Ua,this.handleFeatureAdd_,this),Ni(this.features_,Ga,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature_=function(t){var e=t.getGeometry();e&&e.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[e.getType()].call(this,t,e);var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),Ni(t,Ji,this.handleFeatureChange_,this)},e.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new nf(tf,this.features_,t)))},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),Ui(t,Ji,this.handleFeatureChange_,this)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach((function(e){t===e.feature&&i.push(e)}));for(var n=i.length-1;n>=0;--n)e.remove(i[n])},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n){var o=i[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length-1;n<r;++n){var o=i.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert(Hn(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Hn(l),u)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Hn(l),u)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,h=l.length-1;u<h;++u){var c=l.slice(u,u+2),d={feature:t,geometry:e,depth:[s,n],index:u,segment:c};this.rBush_.insert(Hn(c),d)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},r={feature:t,geometry:e,index:1,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(sr(i),n),this.rBush_.insert(e.getExtent(),r)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n)this.SEGMENT_WRITERS_[i[n].getType()].call(this,t,i[n])},e.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new Ka(new Ts(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Zs.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=Zs.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Zs.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,n=this.dragSegments_.length;i<n;++i){for(var r=this.dragSegments_[i],o=r[0],s=o.depth,a=o.geometry,l=void 0,u=o.segment,h=r[1];e.length<a.getStride();)e.push(u[h][e.length]);switch(a.getType()){case Kr:l=e,u[0]=u[1]=e;break;case Zr:(l=a.getCoordinates())[o.index]=e,u[0]=u[1]=e;break;case Xr:(l=a.getCoordinates())[o.index+h]=e,u[h]=e;break;case Jr:case Yr:(l=a.getCoordinates())[s[0]][o.index+h]=e,u[h]=e;break;case Qr:(l=a.getCoordinates())[s[1]][s[0]][o.index+h]=e,u[h]=e;break;case io:var c=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+2)%4],d=[e[0]-c[0],e[1]-c[1]],p=[(y=v[(o.index+h+1)%4])[0]-c[0],y[1]-c[1]],f=Math.sqrt(p[0]*p[0]+p[1]*p[1]);p[0]=p[0]/f,p[1]=p[1]/f;var g=d[0]*p[0]+d[1]*p[1];v[(o.index+h+1)%4]=[c[0]+g*p[0],c[1]+g*p[1]];var m=[(_=v[(o.index+h+3)%4])[0]-c[0],_[1]-c[1]];f=Math.sqrt(m[0]*m[0]+m[1]*m[1]),m[0]=m[0]/f,m[1]=m[1]/f,g=d[0]*m[0]+d[1]*m[1],v[(o.index+h+3)%4]=[c[0]+g*m[0],c[1]+g*m[1]],v[o.index+h]=e;break;case no:var v,y=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+1)%4],_=(c=v[(o.index+h+2)%4],v[(o.index+h+3)%4]),b=Math.sqrt(Math.pow(y[0]-_[0],2)+Math.pow(y[1]-_[1],2))/2,w=[e[0]-c[0],e[1]-c[1]],x=[-1*w[1],w[0]];f=Math.sqrt(x[0]*x[0]+x[1]*x[1]);x[0]=x[0]/f,x[1]=x[1]/f;var S=[c[0]+w[0]/2,c[1]+w[1]/2];v[(o.index+h+1)%4]=[S[0]+x[0]*b,S[1]+x[1]*b],v[(o.index+h+3)%4]=[S[0]-x[0]*b,S[1]-x[1]*b],v[o.index+h]=e;break;case eo:u[0]=u[1]=e,0===o.index?(this.changingFeature_=!0,a.setCenter(e),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius(nl(a.getCenter(),e)),this.changingFeature_=!1)}l&&this.setGeometryCoordinates_(a,l)}this.createOrUpdateVertexFeature_(e)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);var e=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var n=[],r=i.getGeometry().getCoordinates(),o=Hn([r]),s=this.rBush_.getInExtent(o),a={};s.sort(rf);for(var l=0,u=s.length;l<u;++l){var h=s[l],c=h.segment,d=Ai(h.feature),p=h.depth;if(p&&(d+="-"+p.join("-")),a[d]||(a[d]=new Array(2)),h.geometry.getType()===eo&&1===h.index)Qa(sf(e,h),r)&&!a[d][0]&&(this.dragSegments_.push([h,0]),a[d][0]=h);else if(Qa(c[0],r)&&!a[d][0])this.dragSegments_.push([h,0]),a[d][0]=h;else if(Qa(c[1],r)&&!a[d][1]){if((h.geometry.getType()===Xr||h.geometry.getType()===Jr)&&a[d][0]&&0===a[d][0].index)continue;this.dragSegments_.push([h,1]),a[d][1]=h}else this.insertVertexCondition_(t)&&Ai(c)in this.vertexSegments_&&!a[d][0]&&!a[d][1]&&n.push([h,r])}n.length&&this.willModifyFeatures_(t);for(var f=n.length-1;f>=0;--f)this.insertVertex_.apply(this,n[f])}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],n=i.geometry;if(n.getType()===io||n.getType()===no)this.features_.remove(i.feature),this.features_.push(i.feature);else if(n.getType()===eo){var r=n.getCenter(),o=i.featureSegments[0],s=i.featureSegments[1];o.segment[0]=o.segment[1]=r,s.segment[0]=s.segment[1]=r,this.rBush_.update(sr(r),o),this.rBush_.update(n.getExtent(),s)}else this.rBush_.update(Hn(i.segment),i)}return this.modified_&&(this.dispatchEvent(new nf(ef,this.features_,t)),this.modified_=!1),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map)},e.prototype.handlePointerAtPixel_=function(t,e){var i=e.getCoordinateFromPixel(t),n=Yn(sr(i),e.getView().getResolution()*this.pixelTolerance_),r=this.rBush_.getInExtent(n);if(r.length>0){r.sort((function(t,e){return of(i,t)-of(i,e)}));var o=r[0],s=o.segment,a=sf(i,o),l=e.getPixelFromCoordinate(a),u=nl(t,l);if(u<=this.pixelTolerance_){var h={};if(o.geometry.getType()===eo&&1===o.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a);else{var c=e.getPixelFromCoordinate(s[0]),d=e.getPixelFromCoordinate(s[1]),p=il(l,c),f=il(l,d);u=Math.sqrt(Math.min(p,f)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(a=p>f?s[1]:s[0]),this.createOrUpdateVertexFeature_(a);for(var g=1,m=r.length;g<m;++g){var v=r[g].segment;if(!(Qa(s[0],v[0])&&Qa(s[1],v[1])||Qa(s[0],v[1])&&Qa(s[1],v[0])))break;h[Ai(v)]=!0}}return h[Ai(s)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,r=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case Jr:case Yr:(i=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case Qr:(i=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case Xr:(i=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,i);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,a,s,1);var u={segment:[n[0],e],feature:r,geometry:o,depth:s,index:a};l.insert(Hn(u.segment),u),this.dragSegments_.push([u,1]);var h={segment:[e,n[1]],feature:r,geometry:o,depth:s,index:a+1};l.insert(Hn(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Zs.POINTERDRAG){var t=this.lastPointerEvent_;return this.willModifyFeatures_(t),this.removeVertex_(),this.dispatchEvent(new nf(ef,this.features_,t)),this.modified_=!1,!0}return!1},e.prototype.removeVertex_=function(){var t,e,i,n,r,o,s,a,l,u,h,c=this.dragSegments_,d={},p=!1;for(r=c.length-1;r>=0;--r)h=Ai((u=(i=c[r])[0]).feature),u.depth&&(h+="-"+u.depth.join("-")),h in d||(d[h]={}),0===i[1]?(d[h].right=u,d[h].index=u.index):1==i[1]&&(d[h].left=u,d[h].index=u.index+1);for(h in d){switch(l=d[h].right,s=d[h].left,(a=(o=d[h].index)-1)<0&&(a=0),t=e=(n=(u=void 0!==s?s:l).geometry).getCoordinates(),p=!1,n.getType()){case Jr:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(o,1),p=!0);break;case Xr:e.length>2&&(e.splice(o,1),p=!0);break;case Qr:t=t[u.depth[1]];case Yr:(t=t[u.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),p=!0,0===o&&(t.pop(),t.push(t[0]),a=t.length-1))}if(p){this.setGeometryCoordinates_(n,e);var f=[];if(void 0!==s&&(this.rBush_.remove(s),f.push(s.segment[0])),void 0!==l&&(this.rBush_.remove(l),f.push(l.segment[1])),void 0!==s&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:a,segment:f};this.rBush_.insert(Hn(g.segment),g)}this.updateSegmentIndices_(n,o,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return p},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),(function(r){r.geometry===t&&(void 0===i||void 0===r.depth||Gr(r.depth,i))&&r.index>e&&(r.index+=n)}))},e}(ua),uf=ft({props:{position:{type:Array,required:!0}},computed:{positionText:function(){return this.position.join("  ")}}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"mouse-position-indicator",attrs:{title:"Mouse position in the image"},domProps:{textContent:this._s(this.positionText)}})}),[],!1,null,null,null).exports,hf=ft({components:{mousePositionIndicator:uf},props:{showMousePosition:{type:Boolean,default:!1}},data:function(){return{mousePositionIC:[0,0]}},watch:{mousePosition:function(t){var e=this;Zt((function(){e.mousePositionIC=e.invertPointsYAxis(t.slice()).map(Math.round)}),100,"annotations.canvas.mouse-position-ic")}}},void 0,void 0,!1,null,null,null).exports,cf=i("/rf6"),df=i("XPUu"),pf=i.n(df),ff=i("OpTr"),gf=i.n(ff),mf=i("Qnnh"),vf=i.n(mf);function yf(t,e){t.geometry.coordinates=Ss(t.geometry.coordinates),e.geometry.coordinates=Ss(e.geometry.coordinates);var i=vf()(t,e);return"MultiPolygon"===i.geometry.type?i.geometry.coordinates[0]:i.geometry.coordinates}var _f=i("qNH4"),bf=i.n(_f);var wf=function(t){var e=t.pointerEvent;return e&&"pen"===e.pointerType};function xf(t,e){var i=t.originalEvent.deltaY;t.type==un?0===(i=-t.originalEvent.wheelDeltaY)&&(i=-t.originalEvent.wheelDeltaX):0===i&&(i=t.originalEvent.deltaX);var n=5;return e<=25&&(n=1),i>0?e+n:i<0?Math.max(e-n,5):e}function Sf(t,e){return 0!=t.pointerEvent.pressure?(e=xf(t,e),Math.max(e*t.pointerEvent.pressure,5)*t.map.getView().getResolution()):e}function Cf(){var t=$u();return t[Yr]=t[Yr].concat(t[Xr]),function(e,i){return t[e.getGeometry().getType()]}}var Tf=function(t){function e(e){e.freehandCondition=e.freehandCondition?e.freehandCondition:wf,t.call(this,e),this.overlay_=new zu({source:this.overlay_.getSource(),style:e.style?e.style:Cf(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.condition_=void 0!==e.condition?e.condition:ml,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:xl,this.isDrawing_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===pn||un)&&(this.updateAbsoluteSketchPointRadius_(e),n=!1),e.type===Zs.POINTERDRAG&&this.handlingDownUpSequence&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return!(this.handlingDownUpSequence||!this.condition_(t))&&(this.startDrawing_(t),!0)},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isDrawing_)&&(this.finishDrawing(),!0)},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Ka(new Vs(e,i)),this.updateSketchFeatures_()}},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=xf(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Vs(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(Sf(t,this.sketchPointRadius_))},e.prototype.startDrawing_=function(t){this.isDrawing_=!0,this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t);var e=t.coordinate;this.finishCoordinate_=e,this.sketchFeature_=new Ka(Us(this.sketchCircle_)),this.updateSketchFeatures_(),this.dispatchEvent(new gh(ph,this.sketchFeature_))},e.prototype.handlePointerMove_=function(t){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isDrawing_&&this.sketchFeature_){var e=Us(this.sketchCircle_),i=Object(cf.polygon)(e.getCoordinates()),n=this.sketchFeature_.getGeometry(),r=Object(cf.polygon)(n.getCoordinates());(gf()(i,r)||pf()(i,r))&&n.setCoordinates(yf(i,r))}},e.prototype.finishDrawing=function(){this.isDrawing_=!1;var t=this.abortDrawing_();t&&(this.dispatchEvent(new gh(fh,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e.prototype.abortDrawing_=function(){return this.sketchCircle_=null,t.prototype.abortDrawing_.call(this)},e}(vh),Ef="modifyremove";var If=function(t){function e(e){t.call(this,e),this.overlay_.setStyle(e.style?e.style:function(){var t=$u();return function(e,i){return t[eo]}}()),this.sketchPoint_=null,this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.addCondition_=void 0!==e.addCondition?e.addCondition:ml,this.subtractCondition_=void 0!==e.subtractCondition?e.subtractCondition:ml,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:xl,this.allowRemove_=void 0===e.allowRemove||e.allowRemove,this.isAdding_=!1,this.isSubtracting_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Ka(new Vs(e,i)),this.overlay_.getSource().addFeature(this.sketchPoint_)}},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Vs(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(Sf(t,this.sketchPointRadius_))},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=xf(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===pn||un)&&(this.updateAbsoluteSketchPointRadius_(e),n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handlePointerMove_=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t)},e.prototype.handleDownEvent=function(t){if(!this.handlingDownUpSequence){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.subtractCondition_(t))return this.startSubtracting_(t),!0;if(this.addCondition_(t))return this.startAdding_(t),!0}return!1},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isSubtracting_&&!this.isAdding_)&&(this.finishModifying_(t),!0)},e.prototype.startSubtracting_=function(t){this.isSubtracting_=!0,this.willModifyFeatures_(t),this.subtractCurrentFeatures_(t)},e.prototype.startAdding_=function(t){this.isAdding_=!0,this.willModifyFeatures_(t),this.addCurrentFeatures_(t)},e.prototype.handleDragEvent=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isSubtracting_?this.subtractCurrentFeatures_(t):this.isAdding_&&this.addCurrentFeatures_(t)},e.prototype.subtractCurrentFeatures_=function(t){var e=Us(this.sketchCircle_),i=Object(cf.polygon)(e.getCoordinates()),n=e.getArea();this.features_.getArray().forEach((function(e){var r=e.getGeometry();try{var o=Object(cf.polygon)(r.getCoordinates())}catch(t){return}if(gf()(i,o)){var s=function(t,e){t.geometry.coordinates=Ss(t.geometry.coordinates),e.geometry.coordinates=Ss(e.geometry.coordinates);var i=bf()(t,e);if("MultiPolygon"===i.geometry.type){for(var n,r=0,o=0;o<i.geometry.coordinates.length;o++){var s=new Ns(i.geometry.coordinates[o]).getArea();s>r&&(r=s,n=i.geometry.coordinates[o])}return n}return i.geometry.coordinates}(o,i);if(!this.allowRemove_&&n>new Ns(s).getArea())return;r.setCoordinates(s)}else pf()(i,o)&&this.allowRemove_&&(this.features_.remove(e),this.source_&&this.source_.removeFeature(e),this.dispatchEvent(new nf(Ef,new qa([e]),t)))}),this)},e.prototype.addCurrentFeatures_=function(t){var e=Us(this.sketchCircle_),i=Object(cf.polygon)(e.getCoordinates());this.features_.getArray().forEach((function(t){var n=t.getGeometry();try{var r=Object(cf.polygon)(n.getCoordinates())}catch(t){return}gf()(i,r)?n.setCoordinates(yf(i,r)):pf()(i,r)&&n.setCoordinates(e.getCoordinates())}),this)},e.prototype.finishModifying_=function(t){this.isSubtracting_=!1,this.isAdding_=!1,this.dispatchEvent(new nf(ef,this.features_,t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e}(lf),kf="select",Af=function(t){function e(e,i,n,r){t.call(this,e),this.selected=i,this.deselected=n,this.mapBrowserEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);function Pf(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,s=this.getFeatures(),a=[],l=[];if(r){Li(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return l.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;u>=0;--u){var h=s.item(u),c=l.indexOf(h);c>-1?l.splice(c,1):(s.remove(h),a.push(h))}0!==l.length&&s.extend(l)}else{o.forEachFeatureAtPixel(t.pixel,function(t,r){if(this.filter_(t,r))return!e&&!n||$r(s.getArray(),t)?(i||n)&&$r(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(l.push(t),this.addFeatureLayerAssociation_(t,r)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;d>=0;--d)s.remove(a[d]);s.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new Af(kf,l,a,t)),function(t){return"pointermove"==t.type}(t)}function Rf(){var t=$u();return Ur(t[Yr],t[Xr]),Ur(t[to],t[Xr]),function(e,i){return e.getGeometry()?t[e.getGeometry().getType()]:null}}var Lf,Mf,Ff,Of,Df=function(t){function e(e){t.call(this,{handleEvent:Pf});var i=e||{};this.condition_=i.condition?i.condition:bl,this.addCondition_=i.addCondition?i.addCondition:_l,this.removeCondition_=i.removeCondition?i.removeCondition:_l,this.toggleCondition_=i.toggleCondition?i.toggleCondition:xl,this.multi_=!!i.multi&&i.multi,this.filter_=i.filter?i.filter:qi,this.hitTolerance_=i.hitTolerance?i.hitTolerance:0;var n,r=new zu({source:new oh({useSpatialIndex:!1,features:i.features,wrapX:i.wrapX}),style:i.style?i.style:Rf(),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=r,i.layers)if("function"==typeof i.layers)n=i.layers;else{var o=i.layers;n=function(t){return $r(o,t)}}else n=qi;this.layerFilter_=n,this.featureLayerAssociation_={};var s=this.getFeatures();Ni(s,Ua,this.addFeature_,this),Ni(s,Ga,this.removeFeature_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[Ai(t)]=e},e.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[Ai(t)]},e.prototype.getOverlay=function(){return this.featureOverlay_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap(),n=this.getFeatures();i&&n.forEach(i.unskipFeature.bind(i)),t.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&n.forEach(e.skipFeature.bind(e))},e.prototype.addFeature_=function(t){var e=this.getMap();e&&e.skipFeature(t.element)},e.prototype.removeFeature_=function(t){var e=this.getMap();e&&e.unskipFeature(t.element)},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[Ai(t)]},e}(aa),jf=50,$f=ft({computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},toggleCurrentInteraction:function(t){Mf&&(jf=Mf.getBrushRadius(),this.map.removeInteraction(Mf),Mf=null),this.canAdd&&"polygonBrush"===t?((Mf=new Tf({map:this.map,source:this.annotationSource,style:Ph.editing,brushRadius:jf})).on("drawend",this.handleNewFeature),this.map.addInteraction(Mf)):this.canModify&&"polygonEraser"===t?((Mf=new If({map:this.map,features:this.selectInteraction.getFeatures(),style:Ph.editing,brushRadius:jf,allowRemove:!1,addCondition:_l,subtractCondition:wl})).on("modifystart",this.handleFeatureModifyStart),Mf.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(Mf),this.map.addInteraction(Lf)):this.canModify&&"polygonFill"===t&&((Mf=new If({map:this.map,features:this.selectInteraction.getFeatures(),style:Ph.editing,brushRadius:jf,addCondition:wl,subtractCondition:_l})).on("modifystart",this.handleFeatureModifyStart),Mf.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(Mf),this.map.addInteraction(Lf))}},created:function(){this.canAdd&&oe.on("e",this.togglePolygonBrush,0,this.listenerSet),this.canModify&&(oe.on("r",this.togglePolygonEraser,0,this.listenerSet),oe.on("t",this.togglePolygonFill,0,this.listenerSet)),(this.canAdd||this.canModify)&&this.$watch("interactionMode",this.toggleCurrentInteraction)},mounted:function(){this.canModify&&(Lf=new Df({condition:function(t){return vl(t)&&xl(t)},style:Ph.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0})).on("select",this.handleFeatureSelect)}},void 0,void 0,!1,null,null,null).exports,Nf=ft({data:function(){return{regularSamplingRows:null,regularSamplingColumns:null,currentSamplingIndex:null,randomSamplingCount:null,randomLocationMemory:{}}},computed:{regularSamplingLocations:function(){for(var t=[this.image.width/this.regularSamplingColumns,this.image.height/this.regularSamplingRows],e=[t[0]/2,t[1]/2],i=[],n=this.regularSamplingRows-1;n>=0;n--)for(var r=this.regularSamplingColumns-1;r>=0;r--)i.unshift([e[0]+r*t[0],e[1]+n*t[1]]);return i},randomSamplingLocations:function(){if(!this.randomLocationMemory.hasOwnProperty(this.image.id)){for(var t=[],e=this.image.width,i=this.image.height,n=this.randomSamplingCount;n>0;n--)t.push([Math.round(Math.random()*e),Math.round(Math.random()*i)]);this.randomLocationMemory[this.image.id]=t}return this.randomLocationMemory[this.image.id]},samplingLocations:function(){return this[this.annotationMode+"Locations"]},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")}},methods:{setSamplingData:function(t,e){"regularSampling"===t?Array.isArray(e)&&e[0]>0&&e[1]>0&&(this.regularSamplingRows=e[0],this.regularSamplingColumns=e[1]):"randomSampling"===t&&e>0&&(this.randomSamplingCount=e)},updateShownSamplingLocation:function(){var t=this.currentSamplingIndex;null!==t&&t>=0&&t<this.samplingLocations.length&&(this.map.getView().setCenter(this.samplingLocations[t]),Of.getGeometry().setCoordinates(this.samplingLocations[t]))},showFirstSamplingLocation:function(){this.currentSamplingIndex=0,this.updateShownSamplingLocation()},showLastSamplingLocation:function(){this.currentSamplingIndex=this.samplingLocations.length-1,this.updateShownSamplingLocation()},showPreviousSamplingLocation:function(){var t=this.currentSamplingIndex-1;return!(t<0)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},showNextSamplingLocation:function(){var t=this.currentSamplingIndex+1;return!(t>=this.samplingLocations.length)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},createSampledAnnotation:function(){var t=this.samplingLocations[this.currentSamplingIndex];this.createPointAnnotationAt(t[0],t[1])}},watch:{isSamplingAnnotationMode:function(t){t?this.map.addLayer(Ff):this.map.removeLayer(Ff)},randomSamplingCount:function(){this.randomLocationMemory={}}},created:function(){Ff=new zu({source:new oh,style:[new Bu({image:new Pu({radius:6,stroke:new Fu({color:"white",width:4})})}),new Bu({image:new Pu({radius:6,stroke:new Fu({color:[0,153,255,1],width:2,lineDash:[3]})})})],zIndex:90,updateWhileAnimating:!0,updateWhileInteracting:!0}),Of=new Ka(new Ts([0,0])),Ff.getSource().addFeature(Of)}},void 0,void 0,!1,null,null,null).exports,Bf=ft({mixins:[Dr],props:{resolution:{required:!0}},data:function(){return{targetWidth:100,leadingDigits:[1,2,5]}},computed:{scale:function(){return this.targetWidth*this.scaleMultiplier},scalePowerOfTen:function(){return this.powerOfTen(this.scale)},scaleMultiplier:function(){return this.hasArea?this.resolution*this.pxWidthInMeter:this.resolution||0},scaleNearest:function(){for(var t=0,e=1/0,i=this.leadingDigits.length-1;i>=0;i--){var n=this.leadingDigits[i]*this.scalePowerOfTen;Math.abs(this.scale-n)<e&&(t=i,e=Math.abs(this.scale-n))}return this.leadingDigits[t]*this.scalePowerOfTen},unitNearest:function(){for(var t=0,e=1/0,i=this.unitMultipliers.length-1;i>=0;i--)Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen)<e&&(t=i,e=Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen));return t},width:function(){return Math.round(this.scaleNearest/this.scaleMultiplier)},styleObject:function(){return{width:this.width+"px"}},text:function(){return this.hasArea?Math.round(this.scaleNearest/this.unitMultipliers[this.unitNearest])+" "+this.unitNames[this.unitNearest]:Math.round(this.scaleNearest)+" px"}}},void 0,void 0,!1,null,null,null),Uf=ft({components:{scaleLineIndicator:Bf.exports},props:{showScaleLine:{type:Boolean,default:!1},imagesArea:{type:Object,default:null}}},void 0,void 0,!1,null,null,null).exports,Gf="preload",zf="useInterimTilesOnError",Vf=function(t){function e(e){var i=e||{},n=Ri({},i);delete n.preload,delete n.useInterimTilesOnError,t.call(this,n),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=Nl}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(Gf)},e.prototype.setPreload=function(t){this.set(Gf,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(zf)},e.prototype.setUseInterimTilesOnError=function(t){this.set(zf,t)},e}(eu);Vf.prototype.getSource;var qf=Vf,Wf="translatestart",Kf="translating",Xf="translateend",Hf=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.coordinate=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi);function Yf(t){return(Yf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jf(t,e){return(Jf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=eg(t);if(e){var r=eg(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return tg(this,i)}}function tg(t,e){return!e||"object"!==Yf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eg(t){return(eg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ig,ng=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jf(t,e)}(o,t);var e,i,n,r=Qf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).features=void 0!==t.features?t.features:null,e.on("change:active",e.toggleListeners),e.translateUp=function(){return e.translate(0,1)},e.translateDown=function(){return e.translate(0,-1)},e.translateLeft=function(){return e.translate(-1,0)},e.translateRight=function(){return e.translate(1,0)},e.setMap(t.map),e.translating=!1,e}return e=o,(i=[{key:"toggleListeners",value:function(t){if(t.oldValue){oe.off("ArrowLeft",this.translateLeft),oe.off("ArrowUp",this.translateUp),oe.off("ArrowRight",this.translateRight),oe.off("ArrowDown",this.translateDown);var e=this.getMap().getTargetElement();e&&(e.style.cursor="")}else oe.on("ArrowLeft",this.translateLeft,10),oe.on("ArrowUp",this.translateUp,10),oe.on("ArrowRight",this.translateRight,10),oe.on("ArrowDown",this.translateDown,10)}},{key:"translate",value:function(t,e){var i=this;return!(this.features&&this.features.getLength()>0)||(this.translating||(this.dispatchEvent({type:"translatestart",features:this.features}),this.translating=!0),this.features.forEach((function(i){var n=i.getGeometry();n.translate(t,e),i.setGeometry(n)})),Kt((function(){i.translating=!1,i.dispatchEvent({type:"translateend",features:i.features})}),500,"ol.interactions.Translate.translateend"),!1)}}])&&Zf(e.prototype,i),n&&Zf(e,n),o}(function(t){function e(e){var i,n=e||{};if(t.call(this,n),this.lastCoordinate_=null,this.features_=void 0!==n.features?n.features:null,n.layers)if("function"==typeof n.layers)i=n.layers;else{var r=n.layers;i=function(t){return $r(r,t)}}else i=qi;this.layerFilter_=i,this.hitTolerance_=n.hitTolerance?n.hitTolerance:0,this.lastFeature_=null,Ni(this,vn(ia),this.handleActiveChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new qa([this.lastFeature_]);return this.dispatchEvent(new Hf(Wf,e,t.coordinate)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new qa([this.lastFeature_]);return this.dispatchEvent(new Hf(Xf,e,t.coordinate)),!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],r=this.features_||new qa([this.lastFeature_]);r.forEach((function(t){var e=t.getGeometry();e.translate(i,n),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new Hf(Kf,r,e))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||$r(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(i)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();e&&i||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(ua)),rg=ft({computed:{isTranslating:function(){return"translate"===this.interactionMode}},methods:{toggleTranslating:function(){this.isTranslating?this.resetInteractionMode():this.interactionMode="translate"}},watch:{isTranslating:function(t){this.canModify&&ig.setActive(t)}},mounted:function(){this.canModify&&((ig=new ng({features:this.selectInteraction.getFeatures(),map:this.map})).setActive(!1),ig.on("translatestart",this.handleFeatureModifyStart),ig.on("translateend",this.handleFeatureModifyEnd),this.map.addInteraction(ig),oe.on("m",this.toggleTranslating,0,this.listenerSet))}},void 0,void 0,!1,null,null,null).exports,og=function(t){function e(e,i,n){t.call(this);var r=n||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(Ji)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==$c)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==$c){t.interimTile=null;break}t.getState()==jc?e=t:t.getState()==Dc?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Js(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Zi);function sg(){var t=Rn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var ag=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,s),this.crossOrigin_=r,this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==jc&&(this.unlistenImage_(),this.image_=sg()),this.interimTile&&this.interimTile.dispose(),this.state=Uc,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=Nc,this.unlistenImage_(),this.image_=sg(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=$c:this.state=Bc,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==Nc&&(this.state=Dc,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Dc&&(this.state=jc,this.changed(),this.imageListenerKeys_=[Bi(this.image_,rn,this.handleImageError_,this),Bi(this.image_,an,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(Gi),this.imageListenerKeys_=null},e}(og);function lg(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function ug(t,e,i){return t+"/"+e+"/"+i}function hg(t){return ug(t[0],t[1],t[2])}function cg(t,e){var i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,(function(){return(-s[2]-1).toString()})).replace(o,(function(){var t=s[0],i=e.getFullTileRange(t);return $n(i,55),(i.getHeight()+s[2]).toString()})):void 0}}function dg(t){return 1===t.length?t[0]:function(e,i,n){if(e){var r=ho(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[r](e,i,n)}}}function pg(t,e,i){}function fg(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n,r=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(n=r;n<=o;++n)e.push(t.replace(i[0],String.fromCharCode(n)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}var gg=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach((function(e){e.tileCoord[0]!==t&&(this.remove(hg(e.tileCoord)),e.dispose())}),this)}},e}(hu),mg=function(t){function e(e,i,n,r,o,s,a,l,u,h,c){t.call(this,o,Dc),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var d=r.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent(),f=this.sourceTileGrid_.getExtent(),g=p?xr(d,p):d;if(0!==gr(g)){var m=e.getExtent();m&&(f=f?xr(f,m):m);var v=r.getResolution(this.wrappedTileCoord_[0]),y=Ca(e,n,yr(g),v);if(!isFinite(y)||y<=0)this.state=Bc;else{var _=void 0!==h?h:.5;if(this.triangulation_=new ka(e,n,g,f,y*_),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(y);var b=this.triangulation_.calculateSourceExtent();if(f&&(e.canWrapX()?(b[1]=oo(b[1],f[1],f[3]),b[3]=oo(b[3],f[1],f[3])):b=xr(b,f)),gr(b)){for(var w=i.getTileRangeForExtentAndZ(b,this.sourceZ_),x=w.minX;x<=w.maxX;x++)for(var S=w.minY;S<=w.maxY;S++){var C=u(this.sourceZ_,x,S,a);C&&this.sourceTiles_.push(C)}0===this.sourceTiles_.length&&(this.state=Bc)}else this.state=Bc}else this.state=Bc}}else this.state=Bc}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==jc&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==$c&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Nc;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Ea(n,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=$c}this.changed()},e.prototype.load=function(){if(this.state==Dc){this.state=jc,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==Dc||r==jc){t++;var o=Ni(e,Ji,(function(i){var n=e.getState();n!=$c&&n!=Nc&&n!=Bc||(Gi(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==Dc&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Gi),this.sourcesListenerKeys_=null},e}(og),vg=[0,0,0],yg=function(t){var e,i,n,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,$n((e=this.resolutions_,i=!0,n=function(t,e){return e-t}||jr,e.every((function(t,r){if(0===r)return!0;var o=n(e[r-1],t);return!(o>0||i&&0===o)}))),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(r){if(this.resolutions_[o]/this.resolutions_[o+1]!==r){r=void 0;break}}else r=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,$n(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=Sr(a)),$n(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,$n(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,$n(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new ep(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):a&&this.calculateTileRanges_(a)};yg.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},yg.prototype.forEachTileCoordParentTileRange=function(t,e,i,n,r){var o,s,a,l=null,u=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(o=2===this.zoomFactor_?tp(s=Math.floor(s/2),s,a=Math.floor(a/2),a,n):this.getTileRangeForExtentAndZ(l,u,n),e.call(i,u,o))return!0;--u}return!1},yg.prototype.getExtent=function(){return this.extent_},yg.prototype.getMaxZoom=function(){return this.maxZoom},yg.prototype.getMinZoom=function(){return this.minZoom},yg.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},yg.prototype.getResolution=function(t){return this.resolutions_[t]},yg.prototype.getResolutions=function(){return this.resolutions_},yg.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return tp(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},yg.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=nd(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r;return rr(s,n[1]+e.minY*o[1]*r,a,n[1]+(e.maxY+1)*o[1]*r,i)},yg.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=vg;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),tp(r,n[1],o,n[2],i)},yg.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=nd(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]+(t[2]+.5)*n[1]*i]},yg.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=nd(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]+t[2]*r[1]*n;return rr(o,s,o+r[0]*n,s+r[1]*n,e)},yg.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},yg.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),l=nd(this.getTileSize(o),this.tmpSize_),u=n?.5:0,h=n?0:.5,c=Math.floor((t-a[0])/i+u),d=Math.floor((e-a[1])/i+h),p=s*c/l[0],f=s*d/l[1];return n?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),lg(o,p,f,r)},yg.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=nd(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?0:.5,h=Math.floor((t-o[0])/s+l),c=Math.floor((e-o[1])/s+u),d=h/a[0],p=c/a[1];return n?(d=Math.ceil(d)-1,p=Math.ceil(p)-1):(d=Math.floor(d),p=Math.floor(p)),lg(i,d,p,r)},yg.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},yg.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},yg.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},yg.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},yg.prototype.getZForResolution=function(t,e){return oo(Nr(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},yg.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i};var _g=yg;function bg(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var r=void 0!==n?n:Un,o=wg(t,e,i);return new _g({extent:t,origin:_r(t,r),resolutions:o,tileSize:i})}(xg(t),e,i,n)}(t),t.setDefaultTileGrid(e)),e}function wg(t,e,i){for(var n=void 0!==e?e:42,r=wr(t),o=Tr(t),s=nd(void 0!==i?i:256),a=Math.max(o/s[0],r/s[1]),l=n+1,u=new Array(l),h=0;h<l;++h)u[h]=a/Math.pow(2,h);return u}function xg(t){var e=(t=No(t)).getExtent();if(!e){var i=180*go[mo.DEGREES]/t.getMetersPerUnit();e=rr(-i,-i,i,i)}return e}var Sg=function(t){function e(e){t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new gg(e.cacheSize),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a,l=!0,u=i.minX;u<=i.maxX;++u)for(var h=i.minY;h<=i.maxY;++h)s=ug(e,u,h),a=!1,r.containsKey(s)&&(a=(o=r.get(s)).getState()===$c)&&(a=!1!==n(o)),a||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,r){return Ii()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:bg(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!zo(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,r,o,s=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),l=nd(s.getTileSize(t),this.tmpSize);return 1==a?l:(n=l,r=a,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=n[0]*r+.5|0,o[1]=n[1]*r+.5|0,o)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=xg(i);if(Qn(o,r))return e;var s=Tr(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}(t,n)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e.prototype.useTile=function(t,e,i,n){},e}(Ma),Cg=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yi),Tg="tileloadstart",Eg="tileloadend",Ig="tileloaderror";function kg(t,e){t.getImage().src=e}var Ag=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:kg,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:ag,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!zo(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!zo(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!zo(e,t)){var i=Ai(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=bg(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||zo(e,t))return this.tileCache;var i=Ai(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new gg(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,r,o){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),l=a?this.tileUrlFunction(a,n,r):void 0,u=new this.tileClass(s,void 0!==l?Dc:Bc,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,Ni(u,Ji,this.handleTileChange,this),u},e.prototype.getTile=function(t,e,i,n,r){var o=this.getProjection();if(o&&r&&!zo(o,r)){var s,a=this.getTileCacheForProjection(r),l=[t,e,i],u=hg(l);a.containsKey(u)&&(s=a.get(u));var h=this.getKey();if(s&&s.key==h)return s;var c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),p=this.getTileCoordForTileUrlFunction(l,r),f=new mg(o,c,r,d,l,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return f.key=h,s?(f.interimTile=s,f.refreshInterimChain(),a.replace(u,f)):a.set(u,f),f}return this.getTileInternal(t,e,i,n,o||r)},e.prototype.getTileInternal=function(t,e,i,n,r){var o=null,s=ug(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var l=o;o=this.createTile_(t,e,i,n,r,a),l.getState()==Dc?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,i,n,r,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=No(t);if(i){var n=Ai(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.generateTileUrlFunction_=!e.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(this):pg,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction,this.key_),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=Ai(i),r=i.getState();r==jc?(this.tileLoadingKeys_[n]=!0,e=Tg):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=r==Nc?Ig:r==$c||r==Uc?Eg:void 0),null!=e&&this.dispatchEvent(new Cg(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=fg(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=cg(t[r],e);return dg(n)}(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=ug(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Sg)),Pg="default",Rg="truncated",Lg=function(t){function e(e,i,n,r,o,s,a){t.call(this,i,n,r,o,s,a),this.zoomifyImage_=null,this.tileSize_=nd(e.getTileSize(i[0]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=t.prototype.getImage.call(this);if(this.state==$c){var i=this.tileSize_;if(e.width==i[0]&&e.height==i[1])return this.zoomifyImage_=e,e;var n=Rn(i[0],i[1]);return n.drawImage(e,0,0),this.zoomifyImage_=n.canvas,n.canvas}return e},e}(ag),Mg=function(t){function e(e){var i=e||{},n=i.size,r=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:Pg,o=n[0],s=n[1],a=i.extent||[0,-n[1],n[0],0],l=[],u=i.tileSize||256,h=u;switch(r){case Pg:for(;o>h||s>h;)l.push([Math.ceil(o/h),Math.ceil(s/h)]),h+=h;break;case Rg:for(var c=o,d=s;c>h||d>h;)l.push([Math.ceil(c/h),Math.ceil(d/h)]),c>>=1,d>>=1;break;default:$n(!1,53)}l.push([1,1]),l.reverse();for(var p=[1],f=[0],g=1,m=l.length;g<m;g++)p.push(1<<g),f.push(l[g-1][0]*l[g-1][1]+f[g-1]);p.reverse();var v=new _g({tileSize:u,extent:a,origin:Sr(a),resolutions:p}),y=i.url;y&&-1==y.indexOf("{TileGroup}")&&-1==y.indexOf("{tileIndex}")&&(y+="{TileGroup}/{z}-{x}-{y}.jpg");var _=dg(fg(y).map((function(t){return function(e,i,n){if(e){var r=e[0],o=e[1],s=-e[2]-1,a=o+s*l[r][0],u=v.getTileSize(r),h=Array.isArray(u)?u[0]:u,c={z:r,x:o,y:s,tileIndex:a,TileGroup:"TileGroup"+((a+f[r])/h|0)};return t.replace(/\{(\w+?)\}/g,(function(t,e){return c[e]}))}}}))),b=Lg.bind(null,v);t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:b,tileGrid:v,tileUrlFunction:_,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ag),Fg=ft({props:{resolution:{required:!0}},computed:{zoomLevelText:function(){return(Math.round(100/this.resolution)/100||0)+"x"}}},void 0,void 0,!1,null,null,null),Og=ft({components:{zoomLevelIndicator:Fg.exports},props:{showZoomLevel:{type:Boolean,default:!1}}},void 0,void 0,!1,null,null,null).exports,Dg=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target}),this.extent=i.extent?i.extent:null;var n=void 0!==i.className?i.className:"ol-zoom-extent",r=void 0!==i.label?i.label:"E",o=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=o,s.appendChild("string"==typeof r?document.createTextNode(r):r),Ni(s,en,this.handleClick_,this);var a=n+" ol-unselectable ol-control",l=this.element;l.className=a,l.appendChild(s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fit(e)},e}(od);function jg(t){return(jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $g(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ng(t,e){return(Ng=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=zg(t);if(e){var r=zg(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Ug(this,i)}}function Ug(t,e){return!e||"object"!==jg(e)&&"function"!=typeof e?Gg(t):e}function Gg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zg(t){return(zg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vg,qg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ng(t,e)}(o,t);var e,i,n,r=Bg(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=t||{},n=i.label?i.label:"1",s=document.createElement("button");s.innerHTML=n,s.title="Zoom to original resolution",s.addEventListener("click",(function(){e.zoomToNative.call(Gg(e))}));var a=document.createElement("div");return a.className="zoom-to-native ol-unselectable ol-control",a.appendChild(s),(e=r.call(this,{element:a,target:i.target})).duration_=void 0!==i.duration?i.duration:250,e}return e=o,(i=[{key:"zoomToNative",value:function(){var t=this.getMap().getView();t&&t.getResolution()&&(this.duration_>0?t.animate({resolution:1,duration:this.duration_}):t.setResolution(1))}}])&&$g(e.prototype,i),n&&$g(e,n),o}(od),Wg=ft({mixins:[Ys,ya,Lh,Dh,Kh,Jp,hf,$f,Nf,Uf,rg,Og],components:{minimap:Qp,labelIndicator:Oh,controlButton:Wa},props:{canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},image:{type:Object,default:null},annotations:{type:Array,default:function(){return[]}},selectedAnnotations:{type:Array,default:function(){return[]}},center:{type:Array,default:void 0},resolution:{type:Number,default:void 0},selectedLabel:{default:null},lastCreatedAnnotation:{default:null},annotationOpacity:{type:Number,default:1},annotationMode:{type:String,default:"default"},showMinimap:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},data:function(){return{initialized:!1,viewFitOptions:{padding:[50,50,50,50],minResolution:1},interactionMode:"default",mapSize:[0,0],mousePosition:[0,0]}},computed:{extent:function(){return this.image?[0,0,this.image.width,this.image.height]:[0,0,0,0]},viewExtent:function(){return this.initialized&&this.resolution&&this.map?this.map.getView().calculateExtent(this.mapSize):[0,0,0,0]},projection:function(){return new yo({code:"biigle-image",units:"pixels",extent:this.extent})},selectedFeatures:function(){return this.selectInteraction?this.selectInteraction.getFeatures():[]},isDefaultInteractionMode:function(){return"default"===this.interactionMode},hasSelectedLabel:function(){return Boolean(this.selectedLabel)},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasLastCreatedAnnotation:function(){return null!==this.lastCreatedAnnotation},previousButtonTitle:function(){switch(this.annotationMode){case"volare":return"Previous annotation";case"lawnmower":return"Previous image section";case"randomSampling":case"regularSampling":return"Previous sample location";default:return"Previous image"}},nextButtonTitle:function(){switch(this.annotationMode){case"volare":return"Next annotation";case"lawnmower":return"Next image section";case"randomSampling":case"regularSampling":return"Next sample location";default:return"Next image"}}},methods:{createMap:function(){var t=new Zp({controls:[new hd,new Dg({tipLabel:"Zoom to show whole image",label:""})],interactions:jd({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1})});return t.addControl(new qg({label:""})),t},declareNonReactiveProperties:function(){this.map=this.createMap(),this.imageLayer=new Fh,this.tiledImageLayer=new qf,this.annotationFeatures=new qa,this.annotationSource=new oh({features:this.annotationFeatures}),this.annotationLayer=new zu({source:this.annotationSource,zIndex:100,updateWhileAnimating:!0,updateWhileInteracting:!0,style:Ph.features}),this.selectInteraction=new Df({condition:vl,style:Ph.highlight,layers:[this.annotationLayer],multi:!0}),this.canModify&&(this.featureRevisionMap={},this.modifyInteraction=new lf({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return xl(t)&&bl(t)}}))},updateMapSize:function(){this.mapSize=this.map.getSize()},updateMapView:function(t){var e=t.target.getView();this.$emit("moveend",{center:e.getCenter(),resolution:e.getResolution()})},invertPointsYAxis:function(t){for(var e=this.extent[3],i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e},getGeometry:function(t){var e=this.convertPointsFromDbToOl(t.points);switch(t.shape){case"Point":return new Ts(e[0]);case"Rectangle":return new sh([e]);case"Polygon":return new Ns([e]);case"LineString":return new Xs(e);case"Circle":return new Vs(e[0],e[1][0]);case"Ellipse":return new ah([e]);default:return void console.error("Unknown annotation shape: "+t.shape)}},createFeature:function(t){var e=new Ka(this.getGeometry(t));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},handleFeatureModifyStart:function(t){var e=this;t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleFeatureModifyEnd:function(t){var e=this,i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{id:t.getId(),image_id:t.get("annotation").image_id,points:e.getPoints(t.getGeometry())}}));i.length>0&&this.$emit("update",i)},focusAnnotation:function(t,e,i){var n=this.annotationSource.getFeatureById(t.id);n&&(e?delete this.viewFitOptions.duration:this.viewFitOptions.duration=250,this.viewFitOptions.minResolution=i?this.resolution:1,this.map.getView().fit(n.getGeometry(),this.viewFitOptions))},fitImage:function(){this.map.getView().fit(this.extent,this.map.getSize())},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature))},handlePrevious:function(){this.$emit("previous")},handleNext:function(){this.$emit("next")},resetInteractionMode:function(){this.interactionMode="default"},getPoints:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},handleNewFeature:function(t){var e=this;if(this.hasSelectedLabel){var i=t.feature.getGeometry();t.feature.set("color",this.selectedLabel.color);this.$emit("new",{shape:i.getType(),points:this.getPoints(i)},(function(){try{e.annotationSource.removeFeature(t.feature)}catch(t){}}))}else this.annotationSource.removeFeature(t.feature)},deleteSelectedAnnotations:function(){this.hasSelectedAnnotations&&confirm("Are you sure you want to delete all selected annotations?")&&this.$emit("delete",this.selectedAnnotations)},deleteLastCreatedAnnotation:function(){this.hasLastCreatedAnnotation&&this.$emit("delete",[this.lastCreatedAnnotation])},createPointAnnotationAt:function(t,e){if(this.hasSelectedLabel){var i=new Ka(new Ts([t,e]));this.annotationSource.addFeature(i),this.handleNewFeature({feature:i})}else this.requireSelectedLabel()},requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},render:function(){this.map&&this.map.render()},handleRegularImage:function(t){t?this.imageLayer.setSource(new Ba({canvas:t.canvas,projection:this.projection,canvasExtent:this.extent,canvasSize:[t.width,t.height]})):this.imageLayer.setSource(null)},handleTiledImage:function(t){t?this.tiledImageLayer.setSource(new Mg({url:t.url,size:[t.width,t.height],extent:[0,0,t.width,t.height],transition:100})):this.tiledImageLayer.setSource(null)},updateMousePosition:function(t){this.mousePosition=t.coordinate},refreshAnnotationSource:function(t,e){var i={};t.forEach((function(t){i[t.id]=null}));var n={},r=e.getFeatures(),o=r.filter((function(t){return n[t.getId()]=null,!i.hasOwnProperty(t.getId())}));o.length===r.length?e.clear(!0):(o.filter((function(t){return void 0!==t.getId()})).forEach((function(t){e.removeFeature(t)})),t=t.filter((function(t){return!n.hasOwnProperty(t.id)}))),e.addFeatures(t.map(this.createFeature))}},watch:{image:function(t,e){t?!0===t.tiled?(e&&!0===e.tiled||(this.map.removeLayer(this.imageLayer),this.map.addLayer(this.tiledImageLayer)),this.handleTiledImage(t,e)):(e&&!0!==e.tiled||(this.map.removeLayer(this.tiledImageLayer),this.map.addLayer(this.imageLayer)),this.handleRegularImage(t,e)):(this.map.removeLayer(this.tiledImageLayer),this.map.removeLayer(this.imageLayer))},annotations:function(t){this.refreshAnnotationSource(t,this.annotationSource),this.resetHoveredAnnotations()},selectedAnnotations:function(t){var e=this.annotationSource,i=this.selectedFeatures;i.clear(),t.forEach((function(t){i.push(e.getFeatureById(t.id))}))},extent:function(t,e){if(t[2]!==e[2]||t[3]!==e[3]){var i=yr(t);this.initialized||(i=this.center||i),this.map.setView(new td({projection:this.projection,center:i,resolution:this.resolution,zoomFactor:2,minResolution:.01,extent:t})),void 0===this.resolution&&this.map.getView().fit(t),this.initialized||(this.updateMapView({target:this.map}),this.initialized=!0)}},annotationOpacity:function(t){this.annotationLayer.setOpacity(t)},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t||this.isTranslating),this.canModify&&this.modifyInteraction.setActive(t)}},created:function(){var t=this;this.declareNonReactiveProperties(),this.annotationLayer.set("name","annotations"),this.map.addLayer(this.annotationLayer),this.imageLayer.set("name","imageRegular"),this.tiledImageLayer.set("name","imageTile"),re.$on("sidebar.toggle",(function(){t.$nextTick((function(){t.map.updateSize()}))})),this.map.on("change:size",this.updateMapSize),this.map.on("moveend",this.updateMapView),this.map.on("pointermove",this.updateMousePosition),this.selectInteraction.on("select",this.handleFeatureSelect),this.map.addInteraction(this.selectInteraction),oe.on(" ",this.handleNext,0,this.listenerSet),oe.on("ArrowRight",this.handleNext,0,this.listenerSet),oe.on("ArrowLeft",this.handlePrevious,0,this.listenerSet),oe.on("Escape",this.resetInteractionMode,0,this.listenerSet),this.canModify&&(this.modifyInteraction.on("modifystart",this.handleFeatureModifyStart),this.modifyInteraction.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(this.modifyInteraction)),this.canDelete&&(oe.on("Delete",this.deleteSelectedAnnotations,0,this.listenerSet),oe.on("Backspace",this.deleteLastCreatedAnnotation,0,this.listenerSet))},mounted:function(){this.map.setTarget(this.$el)}},void 0,void 0,!1,null,null,null).exports,Kg=ft(new Vue({data:{cache:{}},computed:{imageFileUri:function(){return biigle.$require("annotations.imageFileUri")},shapeMap:function(){return biigle.$require("annotations.shapes")},inverseShapeMap:function(){var t={};for(var e in this.shapeMap)t[this.shapeMap[e]]=parseInt(e,10);return t}},methods:{parseResponse:function(t){return t.data},resolveShape:function(t){return t.shape=this.shapeMap[t.shape_id],t},resolveAllShapes:function(t){return t.forEach(this.resolveShape,this),t},setDeselected:function(t){return t.selected=!1,t},setAllDeselected:function(t){return t.forEach(this.setDeselected),t},fetchAnnotations:function(t){return this.cache.hasOwnProperty(t)||(this.cache[t]=Lt.getAnnotations({id:t}).catch((function(){return Vue.Promise.reject("Failed to load annotations for image ".concat(t,"!"))})).then(this.parseResponse).then(this.resolveAllShapes)),this.cache[t].then(this.setAllDeselected)},create:function(t,e){var i=this;return e.shape_id=this.inverseShapeMap[e.shape],delete e.shape,Lt.saveAnnotations({id:t},e).then(this.parseResponse).then(this.resolveShape).then(this.setDeselected).then((function(e){return i.cache[t].then((function(t){t.unshift(e)})),e}))},update:function(t){var e=this,i=Rt.update({id:t.id},{points:t.points});return i.then((function(){e.cache[t.image_id].then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void(e[i].points=t.points)}))})),i},attachLabel:function(t,e){var i=Rt.attachLabel({id:t.id},e);return i.then((function(e){t.labels.unshift(e.data)}),(function(){})),i},detachLabel:function(t,e){var i=Rt.detachLabel({annotation_label_id:e.id});return i.then((function(){for(var i=t.labels.length-1;i>=0;i--)if(t.labels[i].id===e.id)return void t.labels.splice(i,1)})),i},delete:function(t){var e=Rt.delete({id:t.id}),i=this.cache[t.image_id];return e.then((function(){i.then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void e.splice(i,1)}))})),e}}}),void 0,void 0,!1,null,null,null).exports,Xg=ft({props:{annotationFilters:{type:Array,default:function(){return[]}},hasActiveFilter:{type:Boolean,default:!1}},data:function(){return{chosenFilterIndex:null}},computed:{hasFilters:function(){return this.annotationFilters.length>0},chosenFilter:function(){return this.annotationFilters[this.chosenFilterIndex]},clearButtonClass:function(){return{"btn-info":this.hasActiveFilter}}},methods:{emitSelectFilter:function(t){this.$emit("select",t)},emitUnselectFilter:function(){this.$emit("unselect")}},watch:{chosenFilter:function(t,e){e&&(this.$refs.filterElement.removeChild(e.$el),e.$off("select",this.emitSelectFilter),e.$off("unselect",this.emitUnselectFilter)),this.$refs.filterElement.appendChild(t.$el),t.$on("select",this.emitSelectFilter),t.$on("unselect",this.emitUnselectFilter)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"annotations-tab__filter form-inline",on:{submit:function(t){t.preventDefault()}}},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.chosenFilterIndex,expression:"chosenFilterIndex"}],staticClass:"form-control",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.chosenFilterIndex=e.target.multiple?i:i[0]}}},t._l(t.annotationFilters,(function(e,n){return i("option",{domProps:{value:n,textContent:t._s(e.name)}})})),0),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.chosenFilter,expression:"chosenFilter"}],ref:"filterElement"}),t._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!t.chosenFilter,expression:"!chosenFilter"}],staticClass:"form-control",attrs:{placeholder:"Filter annotations",type:"text",disabled:"true"}}),t._v(" "),i("button",{staticClass:"btn btn-default",class:t.clearButtonClass,attrs:{title:"Clear annotation filter",disabled:!t.hasActiveFilter},on:{click:function(e){return e.preventDefault(),t.emitUnselectFilter(e)}}},[i("i",{staticClass:"fa fa-times"})])])}),[],!1,null,null,null).exports,Hg=ft({props:{annotation:{type:Object,required:!0},annotationLabel:{type:Object,required:!0},canDetach:{type:Boolean,default:!1}},computed:{classObject:function(){return{selected:!1!==this.annotation.selected}},shapeClass:function(){return"icon-"+this.annotation.shape.toLowerCase()},username:function(){return this.annotationLabel.user?this.annotationLabel.user.firstname+" "+this.annotationLabel.user.lastname:"(user deleted)"}},methods:{emitSelect:function(t){this.$emit("select",this.annotation,t.shiftKey)},emitDetach:function(){this.$emit("detach",this.annotation,this.annotationLabel)},emitFocus:function(){this.$emit("focus",this.annotation)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item__sub-item",class:t.classObject,attrs:{"data-annotation-id":t.annotation.id},on:{click:t.emitSelect,dblclick:t.emitFocus}},[t.canDetach?i("button",{staticClass:"close",attrs:{type:"button",title:"Detach this label from the annotation"},on:{click:function(e){return e.stopPropagation(),t.emitDetach(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("")])]):t._e(),t._v(" "),i("span",{staticClass:"icon",class:t.shapeClass}),t._v(" "),i("span",{domProps:{textContent:t._s(t.username)}})])}),[],!1,null,null,null),Yg=ft({components:{annotationItem:Hg.exports},props:{label:{type:Object,default:function(){return{}}},annotations:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null}},data:function(){return{open:!1}},computed:{title:function(){return"Annotations with label ".concat(this.label.name)},classObject:function(){return{selected:this.isSelected}},count:function(){return this.annotationItems.length},countTitle:function(){return"There are ".concat(this.count," annotations with label ").concat(this.label.name)},colorStyle:function(){return"background-color: #"+this.label.color},isSelected:function(){return this.open||this.annotations.reduce((function(t,e){return t||!1!==e.selected}),!1)},annotationItems:function(){var t=this,e=[];return this.annotations.forEach((function(i){i.labels.forEach((function(n){n.label_id===t.label.id&&e.push({annotation:i,annotationLabel:n,canDetach:t.canDetachAnnotationLabel(n)})}))})),e}},methods:{toggleOpen:function(){this.open=!this.open},emitSelect:function(t,e){this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitFocus:function(t){this.$emit("focus",t)},canDetachAnnotationLabel:function(t){return this.canDetachOthers||this.ownUserId===t.user_id}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item",class:t.classObject,attrs:{title:t.title}},[i("div",{staticClass:"annotations-tab-item__title",on:{click:t.toggleOpen}},[i("span",{staticClass:"pull-right badge",attrs:{title:t.countTitle},domProps:{textContent:t._s(t.count)}}),t._v(" "),i("span",{staticClass:"annotations-tab-item__color",style:t.colorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)}})]),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.isSelected,expression:"isSelected"}],staticClass:"annotations-tab-item__list list-unstyled"},t._l(t.annotationItems,(function(e){return i("annotation-item",{key:e.annotationLabel.id,attrs:{annotation:e.annotation,"annotation-label":e.annotationLabel,"can-detach":e.canDetach},on:{select:t.emitSelect,detach:t.emitDetach,focus:t.emitFocus}})})),1)])}),[],!1,null,null,null),Zg=ft({components:{filters:Xg,labelItem:Yg.exports},props:{hasActiveFilter:{type:Boolean,default:!1},annotations:{type:Array,default:function(){return[]}},annotationFilters:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null},selectedAnnotations:{type:Array,default:function(){return[]}}},computed:{labelItems:function(){var t={},e={},i={};return this.annotations.forEach((function(n){n.labels.forEach((function(r){t.hasOwnProperty(r.label.id)||(t[r.label_id]=r.label,e[r.label_id]=[]);var o=n.id+"-"+r.label_id;i.hasOwnProperty(o)||(i[o]=null,e[r.label_id].push(n))}))})),Object.values(t).sort((function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:-1})).map((function(t){return{id:t.id,label:t,annotations:e[t.id]}}))}},methods:{handleSelect:function(t,e){!1!==t.selected&&e?this.$emit("deselect",t):this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitSelectFilter:function(t){this.$emit("select-filter",t)},emitUnselectFilter:function(){this.$emit("unselect-filter")},emitFocus:function(t){this.$emit("focus",t)},scrollIntoView:function(t){var e,i=this.$refs.scrollList,n=i.scrollTop,r=i.offsetHeight,o=1/0,s=0;t.forEach((function(t){for(var n=i.querySelectorAll('[data-annotation-id="'.concat(t.id,'"]')),r=n.length-1;r>=0;r--)e=n[r],o=Math.min(e.offsetTop,o),s=Math.max(e.offsetTop+e.offsetHeight,s)})),n>o?i.scrollTop=o:n+r<s&&(i.scrollTop=r>=s-o?s-i.offsetHeight:o)}},watch:{selectedAnnotations:function(t){t.length>0&&this.$nextTick((function(){this.scrollIntoView(t)}))}}},void 0,void 0,!1,null,null,null).exports,Jg=i("1r6t"),Qg=i.n(Jg),tm=document.createElement("canvas");tm.style.imageOrientation="none",tm.style.visibility="hidden",tm.style.position="fixed",document.body.appendChild(tm);try{Vg=Qg.a.canvas();var em=null,im=null}catch(t){console.warn("WebGL not supported. Color adjustment disabled.")}window.addEventListener("beforeunload",(function(){em&&(em.destroy(),Vg.width=1,Vg.height=1)}));var nm=ft(new Vue({data:{cache:{},cachedIds:[],maxCacheSize:10,supportsColorAdjustment:!1,currentlyDrawnImage:null,colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0]}},computed:{imageFileUri:function(){return biigle.$require("annotations.imageFileUri")},tilesUri:function(){return biigle.$require("annotations.tilesUri")},supportedTextureSize:function(){return Vg?Vg._.gl.getParameter(Vg._.gl.MAX_TEXTURE_SIZE):0},hasColorAdjustment:function(){for(var t in this.colorAdjustment)if(this.colorAdjustment.hasOwnProperty(t)&&this.isAdjustmentActive(t))return!0;return!1}},methods:{isTiledImage:function(t){return!0===t.tiled},isAdjustmentActive:function(t){return 0!==this.colorAdjustment[t].reduce((function(t,e){return t+e}))},checkSupportsColorAdjustment:function(t){if(!Vg||t.crossOrigin)return!1;if(this.isTiledImage(t))this.supportsColorAdjustment=!1;else{if(this.currentlyDrawnImage&&this.currentlyDrawnImage.width===t.width&&this.currentlyDrawnImage.height===t.height)return this.supportsColorAdjustment;var e=this.supportedTextureSize;if(e<t.width||e<t.height)return console.warn("Insufficient WebGL texture size. Required: ".concat(t.width,"x").concat(t.height,", available: ").concat(e,"x").concat(e,". Color adjustment disabled.")),void(this.supportsColorAdjustment=!1);var i=Qg.a.canvas();if(i.width=t.width,i.height=t.height,t.width!==i._.gl.drawingBufferWidth||t.height!==i._.gl.drawingBufferHeight)return console.warn("Your browser does not allow a WebGL drawing buffer with the size of the original image. Color adjustment disabled."),void(this.supportsColorAdjustment=!1);this.supportsColorAdjustment=!0}},createImage:function(t){var e=this,i=document.createElement("img"),n={id:t,source:i,width:0,height:0,canvas:document.createElement("canvas"),crossOrigin:!1};i.style.imageOrientation="none",i.style.visibility="hidden",i.style.position="fixed",document.body.appendChild(i);var r=new Vue.Promise((function(e,r){i.onload=function(){n.width=i.width,n.height=i.height,e(n)},i.onerror=function(){r("Failed to load image ".concat(t,"!"))}}));return r.finally((function(){document.body.removeChild(i)})),Vue.http.get(this.imageFileUri.replace(":id",t),{responseType:"blob"}).then((function(t){if("application/json"===t.headers.get("content-type")){var n=t.body.uuid;return t.body.url=e.tilesUri.replace(":uuid",n[0]+n[1]+"/"+n[2]+n[3]+"/"+n),t.body}return t.blob().then((function(t){var e=window.URL||window.webkitURL;i.src=e.createObjectURL(t)})),r})).catch((function(e){return 0===e.status?(n.crossOrigin=!0,i.src=e.url,r):Vue.Promise.reject("Failed to load image ".concat(t,"!"))}))},drawSimpleImage:function(t){return document.body.appendChild(t.source),tm.width=t.width,tm.height=t.height,tm.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(tm,0,0),t},drawColorAdjustedImage:function(t){for(var e in im!==t.source.src&&(document.body.appendChild(t.source),tm.width=t.width,tm.height=t.height,tm.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),em?em.loadContentsOf(tm):em=Vg.texture(tm),im=t.source.src),Vg.draw(em),this.colorAdjustment)this.colorAdjustment.hasOwnProperty(e)&&this.isAdjustmentActive(e)&&Vg[e].apply(Vg,this.colorAdjustment[e]);return Vg.update(),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(Vg,0,0),t},drawImage:function(t){return this.checkSupportsColorAdjustment(t),this.currentlyDrawnImage=t,this.supportsColorAdjustment&&this.hasColorAdjustment?this.drawColorAdjustedImage(t):this.isTiledImage(t)?t:this.drawSimpleImage(t)},fetchImage:function(t){return this.cache.hasOwnProperty(t)||(re.$emit("images.fetching",t),this.cache[t]=this.createImage(t),this.cachedIds.push(t)),this.cache[t]},fetchAndDrawImage:function(t){return this.fetchImage(t).then(this.drawImage)},updateColorAdjustment:function(t){if(this.supportsColorAdjustment){var e,i,n=this.colorAdjustment,r=this.hasColorAdjustment;for(e in t)if(t.hasOwnProperty(e))for(i=t[e].length-1;i>=0;i--)n[e].splice(i,1,t[e][i]);this.hasColorAdjustment?this.drawColorAdjustedImage(this.currentlyDrawnImage):r&&this.drawSimpleImage(this.currentlyDrawnImage)}}},watch:{cachedIds:function(t){if(t.length>this.maxCacheSize){var e=t.shift();delete this.cache[e]}}}}),void 0,void 0,!1,null,null,null).exports,rm=ft({components:{typeahead:Vt},data:function(){return{name:"",placeholder:"",selectedItem:null}},computed:{items:function(){return[]},selectedItemName:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},filter:function(t){return t},reset:function(){this.selectedItem=null}},watch:{selectedItem:function(t){t?this.$emit("select",this):this.$emit("unselect")}},created:function(){this.$mount()}},(function(){var t=this.$createElement;return(this._self._c||t)("typeahead",{attrs:{items:this.items,placeholder:this.placeholder,value:this.selectedItemName},on:{select:this.select}})}),[],!1,null,null,null).exports,om=ft(Vue.extend({mixins:[rm],components:{typeahead:ye},data:function(){return{name:"label",annotations:[],placeholder:"label name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.label.id]=e.label}))})),Object.values(t)}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.label.id===e}),!1)}))}}}),void 0,void 0,!1,null,null,null).exports,sm=ft(Vue.extend({mixins:[rm],data:function(){return{name:"shape",shapes:[],placeholder:"shape name"}},computed:{items:function(){var t=this;return Object.keys(this.shapes).map((function(e){return{id:parseInt(e),name:t.shapes[e]}}))}},methods:{filter:function(t){var e=this;return this.selectedItem?t.filter((function(t){return t.shape_id===e.selectedItem.id})):t}}}),void 0,void 0,!1,null,null,null).exports,am=ft(Vue.extend({mixins:[rm],data:function(){return{name:"user",annotations:[],placeholder:"user name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.user_id]=e.user}))})),Object.values(t).map((function(t){return t.name=t.firstname+" "+t.lastname,t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.user_id===e}),!1)}))}}}),void 0,void 0,!1,null,null,null).exports,lm={},um=ft({mixins:[Zg],computed:{plugins:function(){return lm}}},void 0,void 0,!1,null,null,null).exports,hm={},cm=ft({components:{labelTrees:_e},data:function(){return{labelTrees:[],selectedLabel:null}},computed:{plugins:function(){return hm}},methods:{handleSelectedLabel:function(t){this.selectedLabel=t,this.$emit("select",t)},handleDeselectedLabel:function(){this.selectedLabel=null,this.$emit("select",null)}},created:function(){this.labelTrees=biigle.$require("annotations.labelTrees")}},void 0,void 0,!1,null,null,null).exports,dm=ft({data:function(){return{filenameMap:{},currentImageId:null,defaultFilename:""}},computed:{currentImageFilename:function(){return this.filenameMap[this.currentImageId]||this.defaultFilename}},methods:{updateImageId:function(t){this.currentImageId=t}},created:function(){var t=biigle.$require("annotations.imagesIds"),e=biigle.$require("annotations.imagesFilenames"),i=this.filenameMap;t.forEach((function(t,n){i[t]=e[n]})),re.$on("images.change",this.updateImageId)}},void 0,void 0,!1,null,null,null).exports,pm=ft({mixins:[dm],computed:{filename:function(){if(this.currentImageFilename){var t=this.currentImageFilename.split(".");return t.length>1&&(t[t.length-1]="png"),"biigle_screenshot_"+(t=t.join(".").toLowerCase())}return"biigle_screenshot.png"}},methods:{trimCanvas:function(t){var e,i,n,r=t.getContext("2d"),o=document.createElement("canvas").getContext("2d"),s=r.getImageData(0,0,t.width,t.height),a=s.data.length,l={top:null,left:null,right:null,bottom:null};for(e=0;e<a;e+=4)0!==s.data[e+3]&&(i=e/4%t.width,n=~~(e/4/t.width),null===l.top&&(l.top=n),(null===l.left||i<l.left)&&(l.left=i),(null===l.right||l.right<i)&&(l.right=i),(null===l.bottom||l.bottom<n)&&(l.bottom=n));var u=l.bottom-l.top,h=l.right-l.left,c=r.getImageData(l.left,l.top,h,u);return o.canvas.width=h,o.canvas.height=u,o.putImageData(c,0,0),o.canvas},makeBlob:function(t){try{t=this.trimCanvas(t)}catch(t){return Vue.Promise.reject("Could not create screenshot. Maybe the image is not loaded yet?")}var e="image/png";if(HTMLCanvasElement.prototype.toBlob)return new Vue.Promise((function(i){t.toBlob(i,e)}));for(var i=atob(t.toDataURL(e).split(",")[1]),n=i.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=i.charCodeAt(o);return new Vue.Promise((function(t){t(new Blob([r],{type:e}))}))},download:function(t){var e=document.createElement("a");e.style="display: none",e.download=this.filename,e.href=URL.createObjectURL(t),document.body.appendChild(e),e.click(),window.setTimeout((function(){document.body.removeChild(e),URL.revokeObjectURL(e.href)}),100)},capture:function(){var t=this;this.map&&(this.map.once("postcompose",(function(e){t.makeBlob(e.context.canvas).then(t.download).catch(t.handleError)})),this.map.renderSync())},handleError:function(t){te.danger(t)},setMap:function(t){this.map=t}},created:function(){re.$on("annotations.map.init",this.setMap)}},void 0,void 0,!1,null,null,null).exports,fm={annotationOpacity:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0,randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3},gm=new ue({data:{urlParams:Object.keys(fm),storageKey:"biigle.annotations.settings",defaults:fm}}),mm={},vm=ft({components:{screenshotButton:pm,powerToggle:ie},props:{image:{type:Object,default:null}},data:function(){return{restoreKeys:["annotationOpacity","mousePosition","zoomLevel","scaleLine","labelTooltip","measureTooltip","minimap","progressIndicator"],annotationOpacity:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0}},computed:{plugins:function(){return mm},crossOrigin:function(){return this.image&&this.image.crossOrigin},settings:function(){return gm}},methods:{showMousePosition:function(){this.mousePosition=!0},hideMousePosition:function(){this.mousePosition=!1},showZoomLevel:function(){this.zoomLevel=!0},hideZoomLevel:function(){this.zoomLevel=!1},showScaleLine:function(){this.scaleLine=!0},hideScaleLine:function(){this.scaleLine=!1},showLabelTooltip:function(){this.labelTooltip=!0,this.measureTooltip=!1},hideLabelTooltip:function(){this.labelTooltip=!1},showMeasureTooltip:function(){this.measureTooltip=!0,this.labelTooltip=!1},hideMeasureTooltip:function(){this.measureTooltip=!1},showMinimap:function(){this.minimap=!0},hideMinimap:function(){this.minimap=!1},showProgressIndicator:function(){this.progressIndicator=!0},hideProgressIndicator:function(){this.progressIndicator=!1},toggleAnnotationOpacity:function(){this.annotationOpacity>0?this.annotationOpacity=0:this.annotationOpacity=1}},watch:{annotationOpacity:function(t){t=parseFloat(t),this.$emit("change","annotationOpacity",t),this.settings.set("annotationOpacity",t)},mousePosition:function(t){this.$emit("change","mousePosition",t),this.settings.set("mousePosition",t)},zoomLevel:function(t){this.$emit("change","zoomLevel",t),this.settings.set("zoomLevel",t)},scaleLine:function(t){this.$emit("change","scaleLine",t),this.settings.set("scaleLine",t)},labelTooltip:function(t){this.$emit("change","labelTooltip",t),this.settings.set("labelTooltip",t)},measureTooltip:function(t){this.$emit("change","measureTooltip",t),this.settings.set("measureTooltip",t)},minimap:function(t){this.$emit("change","minimap",t),this.settings.set("minimap",t)},progressIndicator:function(t){this.$emit("change","progressIndicator",t),this.settings.set("progressIndicator",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=t.settings.get(e)})),oe.on("o",this.toggleAnnotationOpacity)}},void 0,void 0,!1,null,null,null).exports;biigle.$declare("annotations.components.annotationCanvas",Wg),biigle.$declare("annotations.components.annotationsTab",Zg),biigle.$declare("annotations.components.annotationsTabPlugins",lm),biigle.$declare("annotations.components.controlButton",Wa),biigle.$declare("annotations.components.labelsTabPlugins",hm),biigle.$declare("annotations.components.labelTooltip",Or),biigle.$declare("annotations.components.minimap",Qp),biigle.$declare("annotations.components.mousePositionIndicator",uf),biigle.$declare("annotations.components.settingsTabPlugins",mm),biigle.$declare("annotations.models.LabelAnnotationFilter",om),biigle.$declare("annotations.models.ShapeAnnotationFilter",sm),biigle.$declare("annotations.models.UserAnnotationFilter",am),biigle.$declare("annotations.ol.AttachLabelInteraction",va),biigle.$declare("annotations.ol.TranslateInteraction",ng),biigle.$declare("annotations.ol.ZoomToNativeControl",qg),biigle.$declare("annotations.stores.annotations",Kg),biigle.$declare("annotations.stores.images",nm),biigle.$declare("annotations.stores.styles",Ph);i("qYb1");var ym=ft({components:{powerToggle:ie},data:function(){return{mode:"default",modes:["default","volare","lawnmower","randomSampling","regularSampling"],restoreKeys:["randomSamplingNumber","regularSamplingRows","regularSamplingColumns"],randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3}},computed:{isVolareActive:function(){return"volare"===this.mode},isLawnmowerActive:function(){return"lawnmower"===this.mode},isRandomSamplingActive:function(){return"randomSampling"===this.mode},isRegularSamplingActive:function(){return"regularSampling"===this.mode}},methods:{startVolare:function(){this.setMode("volare")},startLawnmower:function(){this.setMode("lawnmower")},startRandomSampling:function(){this.setMode("randomSampling")},startRegularSampling:function(){this.setMode("regularSampling")},setMode:function(t){-1!==this.modes.indexOf(t)&&(this.mode=t)},resetMode:function(){this.mode="default"},emitAttachLabel:function(){this.$emit("attach-label")},emitCreateSample:function(){this.$emit("create-sample")}},watch:{mode:function(t,e){switch(e){case"volare":oe.off("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":oe.off("Enter",this.emitCreateSample)}switch(t){case"volare":oe.on("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":oe.on("Enter",this.emitCreateSample)}switch(t){case"randomSampling":this.$emit("change",t,this.randomSamplingNumber);break;case"regularSampling":this.$emit("change",t,[this.regularSamplingRows,this.regularSamplingColumns]);break;default:this.$emit("change",t)}},randomSamplingNumber:function(t){gm.set("randomSamplingNumber",t)},regularSamplingRows:function(t){gm.set("regularSamplingRows",t)},regularSamplingColumns:function(t){gm.set("regularSamplingColumns",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){return t[e]=gm.get(e)}));var e=Xt.get("annotationMode");e&&re.$once("images.change",(function(){return t.setMode(e)}))}},void 0,void 0,!1,null,null,null).exports,_m=ft({data:function(){return{isBrightnessRgbActive:!1,colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0]}}},methods:{resetType:function(t,e){void 0!==e?this.colorAdjustment[t].splice(e,1,0):this.colorAdjustment[t]=this.colorAdjustment[t].map((function(){return 0}))},reset:function(){for(var t in this.colorAdjustment)this.colorAdjustment.hasOwnProperty(t)&&this.resetType(t)},toggleBrightnessRgb:function(){this.isBrightnessRgbActive?this.resetType("brightnessRGB"):this.resetType("brightnessContrast",0),this.isBrightnessRgbActive=!this.isBrightnessRgbActive}},watch:{colorAdjustment:{handler:function(){this.$emit("change",this.colorAdjustment)},deep:!0}}},void 0,void 0,!1,null,null,null).exports,bm=ft({mixins:[le],components:{imageLabelList:ei},props:{imageId:{required:!0,type:Number},selectedLabel:{type:Object,default:null}},data:function(){return{cache:{},open:!1,currentLabels:[],saving:!1,userId:null,isAdmin:!1}},computed:{hasLabels:function(){return this.currentLabels.length>0},hasSelectedLabel:function(){return null!==this.selectedLabel},canAttachSelectedLabel:function(){if(this.hasSelectedLabel){for(var t=this.currentLabels.length-1;t>=0;t--)if(this.currentLabels[t].label.id===this.selectedLabel.id)return!1;return!0}return!1},proposedLabelTitle:function(){return this.hasSelectedLabel?this.canAttachSelectedLabel?"Attach '".concat(this.selectedLabel.name,"' as new image label"):"The selected label is already attached.":"Please select a label first."}},methods:{startSaving:function(){this.saving=!0},finishSaving:function(){this.saving=!1},showImageLabels:function(t){this.cache.hasOwnProperty(t)||(this.startLoading(),this.currentLabels=[],this.cache[t]=Qe.query({image_id:t}),this.cache[t].finally(this.finishLoading)),this.cache[t].then(this.updateCurrentLabels,Qt)},updateCurrentLabels:function(t){this.currentLabels=t.body},handleDeletedLabel:function(t){for(var e=this.currentLabels.length-1;e>=0;e--)if(this.currentLabels[e].id===t.id){this.currentLabels.splice(e,1);break}},attachSelectedLabel:function(){this.startSaving();var t=this.currentLabels;Qe.save({image_id:this.imageId},{label_id:this.selectedLabel.id}).then((function(e){t.push(e.data)}),Qt).finally(this.finishSaving)}},watch:{imageId:function(t){this.open&&this.showImageLabels(t)},open:function(t){t&&this.showImageLabels(this.imageId)}},created:function(){var t=this;this.userId=biigle.$require("annotations.userId"),this.isAdmin=biigle.$require("annotations.isAdmin"),this.$parent.$watch("open",(function(e){return t.open=e}))}},void 0,void 0,!1,null,null,null).exports,wm=ft(Vue.extend({mixins:[rm],data:function(){return{name:"session",sessions:[],placeholder:"session name"}},computed:{items:function(){return this.sessions.map((function(t){return t.starts_at=new Date(t.starts_at),t.ends_at=new Date(t.ends_at),t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem,i={};return e.users.forEach((function(t){i[t.id]=null})),t.filter((function(t){for(var n=t.labels.length-1;n>=0;n--)if(i.hasOwnProperty(t.labels[n].user_id)){var r=new Date(t.created_at);return r>=e.starts_at&&r<e.ends_at}return!1}))}}}),void 0,void 0,!1,null,null,null).exports,xm=Vue.resource("api/v1/volumes{/id}/images/area");function Sm(t){return(Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Cm=ft({mixins:[le],components:{sidebar:se,sidebarTab:ae,annotationsTab:um,labelsTab:cm,annotationModesTab:ym,colorAdjustmentTab:_m,imageLabelTab:bm,settingsTab:vm,annotationCanvas:Wg},data:function(){return{allImagesIds:[],volumeId:null,isEditor:!1,imageIndex:null,image:null,annotations:[],annotationFilter:null,annotationFilters:[],lastCreatedAnnotation:null,lastCreatedAnnotationTimeout:null,annotationOpacity:1,mapCenter:void 0,mapResolution:void 0,selectedLabel:null,annotationMode:"default",focussedAnnotationIndex:null,annotationModeCarry:null,showMousePosition:!1,showZoomLevel:!1,showLabelTooltip:!1,showMeasureTooltip:!1,showMinimap:!0,showScaleLine:!1,imagesArea:null,openTab:null,userUpdatedVolareResolution:!1}},computed:{imageId:function(){return this.imagesIds[this.imageIndex]},hasAnnotationFilter:function(){return null!==this.annotationFilter},filteredAnnotations:function(){var t=this.annotations.filter((function(t){return!t.markedForDeletion}));return this.annotationFilter?this.annotationFilter.filter(t):t},selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.selected}))},supportsColorAdjustment:function(){return nm.supportsColorAdjustment},focussedAnnotation:function(){return this.filteredAnnotations[this.focussedAnnotationIndex]},isDefaultAnnotationMode:function(){return"default"===this.annotationMode},isVolareAnnotationMode:function(){return"volare"===this.annotationMode},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")},imagesIds:function(){var t=this.allImagesIds.slice(),e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".images"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},methods:{getImageAndAnnotationsPromises:function(t){return[nm.fetchAndDrawImage(t),Kg.fetchAnnotations(t)]},setCurrentImageAndAnnotations:function(t){t?(this.image=t[0],this.annotations=t[1]):(this.image=null,this.annotations=[])},updateUrlSlug:function(){Xt.setSlug(this.imageId)},getNextIndex:function(t){return(t+1)%this.imagesIds.length},getPreviousIndex:function(t){return(t+this.imagesIds.length-1)%this.imagesIds.length},handleNext:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex<this.filteredAnnotations.length-1)return void this.focussedAnnotationIndex++;this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=Math.min(1,this.filteredAnnotations.length-1):this.focussedAnnotationIndex=-1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showNextImageSection())return;this.annotationModeCarry=0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showNextSamplingLocation())return;this.annotationModeCarry=0}this.imageIndex=this.getNextIndex(this.imageIndex)}},handlePrevious:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex>0)return void this.focussedAnnotationIndex--;this.focussedAnnotationIndex===-1/0?this.focussedAnnotationIndex=Math.max(this.filteredAnnotations.length-2,0):this.focussedAnnotationIndex=1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showPreviousImageSection())return;this.annotationModeCarry=1/0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showPreviousSamplingLocation())return;this.annotationModeCarry=1/0}this.imageIndex=this.getPreviousIndex(this.imageIndex)}},maybeUpdateFocussedAnnotation:function(){this.isVolareAnnotationMode?this.filteredAnnotations.length>0?this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=this.filteredAnnotations.length-1:this.focussedAnnotationIndex=0:(this.focussedAnnotationIndex=null,this.$refs.canvas.fitImage()):this.focussedAnnotationIndex=null},maybeUpdateShownImageSection:function(){this.isLawnmowerAnnotationMode&&(this.annotationModeCarry===1/0?this.$refs.canvas.showLastImageSection():this.$refs.canvas.showFirstImageSection())},maybeUpdateShownSampling:function(t){this.isSamplingAnnotationMode&&(this.$refs.canvas.setSamplingData(this.annotationMode,t),this.annotationModeCarry===1/0?this.$nextTick(this.$refs.canvas.showLastSamplingLocation):this.$nextTick(this.$refs.canvas.showFirstSamplingLocation))},maybeUpdateAnnotationMode:function(t){this.maybeUpdateFocussedAnnotation(),this.maybeUpdateShownImageSection(),this.maybeUpdateShownSampling(t)},handleMapMoveend:function(t){this.mapCenter=t.center,this.mapResolution=t.resolution,Xt.set({r:Math.round(100*t.resolution),x:Math.round(t.center[0]),y:Math.round(t.center[1])})},handleSelectAnnotation:function(t,e){!0===e||"object"===Sm(e)&&e.shiftKey?t.selected=!0:this.annotations.forEach((function(e){e.selected=t.id===e.id}))},handleSelectAnnotations:function(t,e){t.forEach((function(t){t.selected=!0})),e.forEach((function(t){t.selected=!1}))},handleDeselectAnnotation:function(t){t?t.selected=!1:this.annotations.forEach((function(t){t.selected=!1}))},focusAnnotation:function(t,e,i){this.$refs.canvas.focusAnnotation(t,e,i)},handleDetachAnnotationLabel:function(t,e){this.isEditor&&(t.labels.length>1?Kg.detachLabel(t,e).catch(Qt):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&this.handleDeleteAnnotation(t))},handleDeleteAnnotation:function(t){this.isEditor&&(this.lastCreatedAnnotation&&this.lastCreatedAnnotation.id===t.id&&(this.lastCreatedAnnotation=null),Vue.set(t,"markedForDeletion",!0),Kg.delete(t).catch((function(e){t.markedForDeletion=!1,Qt(e)})))},handleDeleteAnnotations:function(t){t.forEach(this.handleDeleteAnnotation)},handleUpdateAnnotations:function(t){this.isEditor&&Vue.Promise.all(t.map(Kg.update)).catch(Qt)},selectAndFocusAnnotation:function(t,e){this.selectedAnnotations.forEach((function(t){t.selected=!1})),t.selected=!0,this.focusAnnotation(t,!0,e)},handleFilter:function(t){this.annotationFilter=t},resetFilter:function(){this.annotationFilter&&this.annotationFilter.reset(),this.annotationFilter=null},handleSelectedLabel:function(t){this.selectedLabel=t},handleNewAnnotation:function(t,e){this.isEditor&&(t.label_id=this.selectedLabel.id,t.confidence=1,Kg.create(this.imageId,t).then(this.setLastCreatedAnnotation).catch(Qt).finally(e))},handleAttachLabel:function(t,e){if(e=e||this.selectedLabel,this.isEditor&&e){var i={label_id:e.id,confidence:1};Kg.attachLabel(t,i).catch(Qt)}},handleAttachAllSelected:function(){this.selectedAnnotations.forEach(this.handleAttachLabel)},emitImageChanged:function(){re.$emit("images.change",this.imageId,this.image)},cachePreviousAndNext:function(){var t=this.imagesIds[this.getPreviousIndex(this.imageIndex)],e=this.imagesIds[this.getNextIndex(this.imageIndex)];t!==this.imageId&&Vue.Promise.all([Kg.fetchAnnotations(e),nm.fetchImage(e),Kg.fetchAnnotations(t),nm.fetchImage(t)]).catch((function(){}))},setLastCreatedAnnotation:function(t){var e=this;this.lastCreatedAnnotationTimeout&&window.clearTimeout(this.lastCreatedAnnotationTimeout),this.lastCreatedAnnotation=t,this.lastCreatedAnnotationTimeout=window.setTimeout((function(){e.lastCreatedAnnotation=null}),1e4)},updateColorAdjustment:function(t){var e=this.$refs.canvas;Kt((function(){nm.updateColorAdjustment(t),e.render()}),100,"annotations.color-adjustment.update")},handleSettingsChange:function(t,e){switch(t){case"annotationOpacity":this.annotationOpacity=e;break;case"mousePosition":this.showMousePosition=e;break;case"zoomLevel":this.showZoomLevel=e;break;case"scaleLine":this.showScaleLine=e;break;case"labelTooltip":this.showLabelTooltip=e;break;case"measureTooltip":this.showMeasureTooltip=e;break;case"minimap":this.showMinimap=e}},handleAnnotationModeChange:function(t,e){this.annotationMode=t,this.annotationModeCarry=null,this.maybeUpdateAnnotationMode(e)},handleOpenedTab:function(t){gm.set("openTab",t)},handleClosedTab:function(){gm.delete("openTab")},handleLoadingError:function(t){te.danger(t)},createSampledAnnotation:function(){this.$refs.canvas.createSampledAnnotation()},fetchImagesArea:function(){this.imagesArea||(this.imagesArea={},xm.get({id:this.volumeId}).then(this.setImagesArea,Qt))},setImagesArea:function(t){this.imagesArea=t.body},handleRequiresSelectedLabel:function(){te.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},maybeShowTilingInProgressMessage:function(){this.image.tilingInProgress&&te.warning("This image is currently being processed. Please retry later.")}},watch:{imageId:function(t){t&&(this.startLoading(),Vue.Promise.all(this.getImageAndAnnotationsPromises(t)).then(this.setCurrentImageAndAnnotations).then(this.updateUrlSlug).then(this.maybeUpdateAnnotationMode).then(this.emitImageChanged).then(this.maybeShowTilingInProgressMessage).then(this.cachePreviousAndNext).catch(this.handleLoadingError).finally(this.finishLoading))},focussedAnnotation:function(t){t&&this.selectAndFocusAnnotation(t,this.userUpdatedVolareResolution)},annotationFilter:function(){this.maybeUpdateFocussedAnnotation()},showScaleLine:function(t){t&&this.fetchImagesArea()},showMeasureTooltip:function(t){t&&this.fetchImagesArea()},isVolareAnnotationMode:function(t){t||(this.userUpdatedVolareResolution=!1)},mapResolution:function(){this.isVolareAnnotationMode&&(this.userUpdatedVolareResolution=!0)},annotations:function(t){this.annotationFilters[0].annotations=t,this.annotationFilters[1].annotations=t}},created:function(){var t=this;if(this.allImagesIds=biigle.$require("annotations.imagesIds"),this.volumeId=biigle.$require("annotations.volumeId"),this.isEditor=biigle.$require("annotations.isEditor"),this.annotationFilters=[new om,new am,new sm({data:{shapes:biigle.$require("annotations.shapes")}}),new wm({data:{sessions:biigle.$require("annotations.sessions")}})],0!==this.imagesIds.length){var e=this.imagesIds.indexOf(biigle.$require("annotations.imageId"));if(-1===e&&(e=0,te.info("The requested image does not exist in your current volume filtering. Switching to the first image.")),this.imageIndex=e,re.$emit("images.sequence",this.imagesIds),void 0!==Xt.get("r")&&(this.mapResolution=parseInt(Xt.get("r"),10)/100),void 0!==Xt.get("x")&&void 0!==Xt.get("y")&&(this.mapCenter=[parseInt(Xt.get("x"),10),parseInt(Xt.get("y"),10)]),re.$on("annotations.select",this.handleSelectAnnotation),re.$on("annotations.deselect",this.handleDeselectAnnotation),re.$on("annotations.detachLabel",this.handleDetachAnnotationLabel),re.$on("annotations.delete",this.handleDeleteAnnotation),re.$on("annotations.focus",this.focusAnnotation),Xt.get("annotation")){var i=parseInt(Xt.get("annotation"));re.$once("images.change",(function(){for(var e=t.annotations,n=e.length-1;n>=0;n--)if(e[n].id===i)return void t.selectAndFocusAnnotation(e[n])}))}gm.has("openTab")&&(this.openTab=gm.get("openTab"))}else te.info("Your current volume filtering contains no images.")},mounted:function(){re.$emit("annotations.map.init",this.$refs.canvas.map)}},void 0,void 0,!1,null,null,null).exports,Tm=ft({mixins:[dm],data:function(){return{imageIds:[],imageIdsLeft:[],initialImageId:null,showIndicator:!0}},computed:{progressPath:function(){return"M 2 1 A 1 1 0 "+(this.progress>=.5?1:0)+" 1 "+this.arcPosition(this.progress).join(" ")+"L 1 1"},initialProgressPath:function(){return"M 1 1 L "+this.arcPosition(this.initialProgress).join(" ")},progressTitle:function(){var t=["started at ".concat(this.initialImageNumber)];return this.hasSeenAllImages&&t.push("seen all"),"Image ".concat(this.currentImageNumber," of ").concat(this.imageIds.length," (").concat(t.join(", "),")")},currentImageNumber:function(){return this.currentImageId?this.imageIds.indexOf(this.currentImageId)+1:0},progress:function(){return this.currentImageNumber/this.imageIds.length},initialImageNumber:function(){return null===this.initialImageId?1:this.imageIds.indexOf(this.initialImageId)+1},initialProgress:function(){return this.initialImageNumber/this.imageIds.length},hasSeenAllImages:function(){return 0===this.imageIdsLeft.length},showInitialProgressMarker:function(){return 1!==this.initialImageNumber},indicatorClass:function(){return this.hasSeenAllImages?"progress-indicator--all":""},filenameClass:function(){return this.hasSeenAllImages?"text-success":""},filenameTitle:function(){return this.hasSeenAllImages?"You have seen all images":""}},methods:{arcPosition:function(t){return[Math.cos(2*Math.PI*t)+1,Math.sin(2*Math.PI*t)+1]},setInitialImageId:function(t){this.initialImageId=t},updateShowIndicator:function(t){this.showIndicator=!1!==t}},watch:{currentImageId:function(t){for(var e=this.imageIdsLeft,i=e.length-1;i>=0;i--)if(e[i]===t){e.splice(i,1);break}},currentImageFilename:function(t){document.title="Annotate ".concat(t)}},created:function(){var t=this;this.imageIds=biigle.$require("annotations.imagesIds").slice(),this.imageIdsLeft=biigle.$require("annotations.imagesIds").slice(),re.$on("images.sequence",(function(e){t.imageIds=e.slice(),t.imageIdsLeft=e.slice()})),re.$once("images.change",this.setInitialImageId),this.updateShowIndicator(gm.get("progressIndicator")),gm.watch("progressIndicator",this.updateShowIndicator)},mounted:function(){this.defaultFilename=this.$el.attributes.getNamedItem("default-filename").value}},void 0,void 0,!1,null,null,null).exports;biigle.$mount("annotator-container",Cm),biigle.$mount("annotations-navbar",Tm);i("lmcn");var Em=ft({mixins:[le],mounted:function(){this.$refs.nameInput.focus()}},void 0,void 0,!1,null,null,null).exports,Im=ft({components:{previewThumbnail:Ne}},void 0,void 0,!1,null,null,null).exports,km=Vue.resource("api/v1/video-annotations{/id}",{},{query:{method:"GET",url:"api/v1/videos{/id}/annotations"},save:{method:"POST",url:"api/v1/videos{/id}/annotations"},split:{method:"POST",url:"api/v1/video-annotations{/id}/split"},link:{method:"POST",url:"api/v1/video-annotations{/id}/link"},attachLabel:{method:"POST",url:"api/v1/video-annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/video-annotation-labels{/id}"}});const Am=void 0;function Pm(t){return"string"==typeof t}const Rm=Math,Lm=Rm.abs,Mm=Rm.min,Fm=Rm.max,Om=Rm.floor,Dm=Rm.round,jm=Rm.sqrt,$m=Rm.pow,Nm=Rm.cos,Bm=Rm.asin,Um=Rm.sin,Gm=Rm.tan,zm=Rm.PI,Vm=$m(2,-52);function qm(){throw new Error(Array.prototype.join.call(arguments," "))}function Wm(t,e){for(let i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t}var Km="undefined"!=typeof window&&window.navigator.userAgent;const Xm=/(MSIE |Trident\/|Edge\/)/i.test(Km)?Array:Float32Array;function Hm(t){return new Xm(t)}function Ym(t,e,i,n){return jm((t-i)*(t-i)+(e-n)*(e-n))}function Zm(t,e,i){let n=i.length;if(i[n-2]!==i[0]||i[n-1]!==i[1])return;const r=i.slice(2);let o,s;n=r.length;for(let i=0;i<n;i+=6){const n=Ym(t,e,r[i],r[i+1]);(s===Am||n<s)&&(s=n,o=i)}!function(t,e){const i=t.length,n=i-e,r=Hm(e);let o;for(o=0;o<e;o++)r[o]=t[o];for(o=e;o<i;o++)t[o-e]=t[o];for(o=0;o<e;o++)t[n+o]=r[o]}(r,o),i[0]=r[n-2],i[1]=r[n-1];for(let t=0;t<r.length;t++)i[t+2]=r[t]}function Jm(t,e){let i=e-t.length;const n=Math.ceil(i/t.length),r=Hm(e);r[0]=t[0],r[1]=t[1];let o=1,s=1;for(;s<e-1;){r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o];const e=r[++s]=t[++o],a=r[++s]=t[++o];if(i)for(let t=0;t<n&&i;t++)r[s+5]=r[s+3]=r[s+1]=e,r[s+6]=r[s+4]=r[s+2]=a,s+=6,i-=6}return r}function Qm(t,e){return e.p-t.p}function tv(t,e,i){const n=ev(t),r=ev(e),o=i.origin,s=o.x,a=o.y,l=o.absolute;n.length!==r.length&&("fill"===i.optimize?function t(e,i,n){const r=e.length,o=i.length;if(r<o)return t(i,e,n);i.length=r;for(let t=o;t<r;t++){const r=e[t],o=Hm(r.d.length);for(let t=0;t<r.d.length;t+=2)o[t]=n.absolute?n.x:r.x+r.w*n.x,o[t+1]=n.absolute?n.y:r.y+r.y*n.y;i[t]=Wm({d:o},r)}}(n,r,i.origin):qm("optimize:none requires equal lengths"));const u=Array(2);if(u[0]=n.map(iv),u[1]=r.map(iv),"none"!==i.optimize)for(let t=0;t<n.length;t++){const e=n[t],i=r[t];Zm(l?s:e.x+e.w*s,l?a:e.y+e.h*a,u[0][t]),Zm(l?s:i.x+i.w*s,l?a:i.y+i.h*a,u[1][t])}return"fill"===i.optimize&&function(t,e){const i=t[0].length;for(let n=0;n<i;n++){const i=t[0][n],r=t[1][n],o=Fm(i.length+e,r.length+e);t[0][n]=Jm(i,o),t[1][n]=Jm(r,o)}}(u,6*i.addPoints),u}function ev(t){return t.data.slice().sort(Qm)}function iv(t){return t.d}const nv={addPoints:0,optimize:"fill",origin:{x:0,y:0},precision:0};function rv(t,e){e=Wm(e,nv),(!t||t.length<2)&&qm("invalid arguments");const i=t.length-1,n=Array(i);for(let r=0;r<i;r++)n[r]=ov(t[r],t[r+1],e);const r=e.precision?t=>t.toFixed(e.precision):Dm;return t=>{const e=i*t,o=Mm(Om(e),i-1);return function(t,e){if(Pm(t))return t;let i=[];for(let n=0;n<t.length;n++){const r=t[n];let o;i.push("M",e(r[0]),e(r[1]),"C");for(let t=2;t<r.length;t+=6){const n=e(r[t]),s=e(r[t+1]),a=e(r[t+2]),l=e(r[t+3]),u=e(r[t+4]),h=e(r[t+5]);n==u&&a==u&&s==h&&l==h&&o==(o=""+n+s+a+l+u+h)||i.push(n,s,a,l,u,h)}}return i.join(" ")}(n[o]((e-o)/(o+1)),r)}}function ov(t,e,i){const n=tv(t,e,i),r=n[0].length;return i=>{if(Lm(i-0)<Vm)return t.path;if(Lm(i-1)<Vm)return e.path;const o=Array(r);for(let t=0;t<r;t++)o[t]=sv(n[0][t],n[1][t],i);return o}}function sv(t,e,i){const n=t.length,r=Hm(n);for(let o=0;o<n;o++)r[o]=t[o]+(e[o]-t[o])*i;return r}function av(t,e){return t===Am?e:t}const lv=120*zm/180,uv=2*zm;function hv(t,e,i,n,r,o,s,a,l,u,h,c,d){if(i<=0||n<=0)return[t,e,a,l,a,l];const p=zm/180*(+r||0),f=Nm(p),g=Um(p),m=!!u;if(!m){const r=t,p=a,m=((t=r*f-e*-g)-(a=p*f-l*-g))/2,v=((e=r*-g+e*f)-(l=p*-g+l*f))/2;let y=m*m/(i*i)+v*v/(n*n);y>1&&(y=jm(y),i*=y,n*=y);const _=(o===s?-1:1)*jm(Lm((i*i*n*n-i*i*v*v-n*n*m*m)/(i*i*v*v+n*n*m*m)));c=_*i*v/n+(t+a)/2,u=Bm((e-(d=_*-n*m/i+(e+l)/2))/n),h=Bm((l-d)/n),t<c&&(u=zm-u),a<c&&(h=zm-h),u<0&&(u+=uv),h<0&&(h+=uv),s&&u>h&&(u-=uv),!s&&h>u&&(h-=uv)}let v;if(Lm(h-u)>lv){const t=h,e=a,o=l;v=hv(a=c+i*Nm(h=u+lv*(s&&h>u?1:-1)),l=d+n*Um(h),i,n,r,0,s,e,o,h,t,c,d)}else v=[];const y=4/3*Gm((h-u)/4);if(v.splice(0,0,2*t-(t+y*i*Um(u)),2*e-(e-y*n*Nm(u)),a+y*i*Um(h),l-y*n*Nm(h),a,l),!m)for(let t=0,e=v.length;t<e;t+=2){const e=v[t],i=v[t+1];v[t]=e*f-i*g,v[t+1]=e*g+i*f}return v}const cv={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function dv(t,e,i,n,r,o,s){const a=t.x,l=t.y;t.x=av(o,a),t.y=av(s,l),t.p.push(av(e,a),i=av(i,l),n=av(n,a),r=av(r,l),t.x,t.y),t.lc=t.c}function pv(t){const e=t.c,i=t.t,n=t.x,r=t.y;if("V"===e)i[0]+=r;else if("H"===e)i[0]+=n;else if("A"===e)i[5]+=n,i[6]+=r;else for(let t=0;t<i.length;t+=2)i[t]+=n,i[t+1]+=r}function fv(t){return t.split(" ").map(gv)}function gv(t,e){return 0===e?t:+t}function mv(t){const e={x:0,y:0,s:[]},i=function(t){return t.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(fv)}(t);for(let t=0;t<i.length;t++){const n=i[t],r=n[0],o=r.toUpperCase(),s="Z"!==o&&o!==r;e.c=o;const a=cv[o],l=n;let u=1;do{e.t=1===l.length?l:l.slice(u,u+a),s&&pv(e);const t=e.t,i=e.x,n=e.y;let r,h,c,d,p,f;if("M"===o)e.s.push(e.p=[e.x=t[0],e.y=t[1]]);else if("H"===o)dv(e,Am,Am,Am,Am,t[0],Am);else if("V"===o)dv(e,Am,Am,Am,Am,Am,t[0]);else if("L"===o)dv(e,Am,Am,Am,Am,t[0],t[1]);else if("Z"===o)dv(e,Am,Am,Am,Am,e.p[0],e.p[1]);else if("C"===o)dv(e,t[0],t[1],t[2],t[3],t[4],t[5]),e.cx=t[2],e.cy=t[3];else if("S"===o){const o="S"!==e.lc&&"C"!==e.lc;r=o?Am:2*i-e.cx,h=o?Am:2*n-e.cy,dv(e,r,h,t[0],t[1],t[2],t[3]),e.cx=t[0],e.cy=t[1]}else if("Q"===o){const r=t[0],o=t[1];c=t[2],d=t[3],dv(e,i+2/3*(r-i),n+2/3*(o-n),c+2/3*(r-c),d+2/3*(o-d),c,d),e.cx=r,e.cy=o}else if("T"===o)c=t[0],d=t[1],"Q"===e.lc||"T"===e.lc?(r=i+(2*i-e.cx-i)*(2/3),h=n+(2*n-e.cy-n)*(2/3),p=c+(2*i-e.cx-c)*(2/3),f=d+(2*n-e.cy-d)*(2/3)):(r=p=i,h=f=n),dv(e,r,h,p,f,c,d),e.cx=p,e.cy=f;else if("A"===o){const r=hv(i,n,t[0],t[1],t[2],t[3],t[4],t[5],t[6]);for(let t=0;t<r.length;t+=6)dv(e,r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}else qm(e.c," is not supported");u+=a}while(u<l.length)}return e.s}function vv(t){const e=t.length;let i=t[e-2],n=t[e-1],r=0;for(let o=0;o<e;o+=6)r+=Ym(t[o],t[o+1],i,n),i=t[o],n=t[o+1];return Om(r)}function yv(t){let e=t[0],i=t[1],n=i,r=e;for(let o=2;o<t.length;o+=6){let s=t[o+4],a=t[o+5];e=Mm(e,s),r=Fm(r,s),i=Mm(i,a),n=Fm(n,a)}return{d:t,x:e,y:i,w:r-e,h:n-i,p:vv(t)}}const _v=/^([#|\.]|path)/i;function bv(t){return function(t){return{path:t,data:mv(t).map(yv)}}(function(t){if(Pm(t)){if(!_v.test(t))return t;t=document.querySelector(t)}return t.getAttribute("d")}(t))}var wv=ft(Vue.extend({data:function(){return{id:0,frames:[],points:[],video_id:0,shape_id:0,created_at:"",updated_at:"",labels:[],selected:!1,revision:1,tracking:!1}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},interpolationPoints:function(){switch(this.shape){case"Rectangle":case"Ellipse":return this.points.map(this.rectangleToInterpolationPoints);case"LineString":case"Polygon":return this.points.map(this.polygonToSvgPath);default:return this.points}},gapRanges:function(){var t=[];return this.frames.map((function(e,i,n){null===e&&t.push([n[i-1],n[i+1]])})),t},isSelected:function(){return!1!==this.selected},isClip:function(){return this.frames.length>1}},methods:{startPollTracking:function(){this.tracking=!0,this.continuePollTracking()},pollTracking:function(){km.get({id:this.id}).then(this.maybeFinishPollTracking,this.cancelPollTracking)},maybeFinishPollTracking:function(t){var e=t.body;e.frames.length>1?(this.tracking=!1,this.frames=e.frames,this.points=e.points):this.continuePollTracking()},continuePollTracking:function(){this.pollTimeout=window.setTimeout(this.pollTracking,5e3)},cancelPollTracking:function(){te.danger("Tracking of annotation ".concat(this.id," failed.")),this.tracking=!1,this.$emit("tracking-failed",this)},interpolatePoints:function(t){if(t<this.startFrame||t>this.endFrame)return[];if(this.hasGapAt(t))return[];for(var e=this.frames,i=e.length-1;i>=0&&!(e[i]<=t&&null!==e[i]);i--);if(e[i]===t)return this.points[i];var n=(t-e[i])/(e[i+1]-e[i]);return this.interpolateBetweenFrames(i,i+1,n)},interpolateBetweenFrames:function(t,e,i){var n=this.interpolationPoints[t],r=this.interpolationPoints[e];switch(this.shape){case"Rectangle":case"Ellipse":return this.interpolationPointsToRectangle(this.interpolateNaive(n,r,i));case"LineString":case"Polygon":return this.interpolatePolymorph(n,r,i);default:return this.interpolateNaive(n,r,i)}},interpolateNaive:function(t,e,i){return t.map((function(t,n){return t+(e[n]-t)*i}))},interpolatePolymorph:function(t,e,i){var n;return rv([t,e].map(bv),n||{})(i).replace(/[MCL\s]+/g," ").trim().split(" ").map((function(t){return parseInt(t,10)}))},rectangleToInterpolationPoints:function(t){var e=[t[2]-t[0],t[3]-t[1]],i=[t[6]-t[0],t[7]-t[1]],n=Math.sqrt(i[0]*i[0]+i[1]*i[1]),r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=[e[0]/r,e[1]/r],s=[(t[0]+t[2]+t[4]+t[6])/4,(t[1]+t[3]+t[5]+t[7])/4];return[s[0],s[1],o[0],o[1],n,r]},interpolationPointsToRectangle:function(t){var e=[t[2],t[3]],i=[-e[1],e[0]],n=t[4]/2*i[0],r=t[4]/2*i[1],o=t[5]/2*e[0],s=t[5]/2*e[1];return[t[0]-o-n,t[1]-s-r,t[0]+o-n,t[1]+s-r,t[0]+o+n,t[1]+s+r,t[0]-o+n,t[1]-s+r]},polygonToSvgPath:function(t){return(t=t.slice()).unshift("M"),t.splice(3,0,"L"),t.join(" ")},hasGapAt:function(t){if(t<this.startFrame||t>this.endFrame)return!1;for(var e=this.gapRanges.length-1;e>=0;e--)if(this.gapRanges[e][0]<t&&this.gapRanges[e][1]>t)return!0;return!1},detachAnnotationLabel:function(t){var e=this.labels.indexOf(t);return-1!==e&&this.labels.splice(e,1),km.detachLabel({id:t.id})},attachAnnotationLabel:function(t){return km.attachLabel({id:this.id},{label_id:t.id}).then(this.handleAttachedLabel)},handleAttachedLabel:function(t){return this.labels.push(t.body),t},hasKeyframe:function(t){return-1!==this.frames.indexOf(t)},modify:function(t,e){var i=this.frames.indexOf(t);if(-1!==i)this.points.splice(i,1,e);else{for(var n=this.frames.length-1;n>=0&&!(this.frames[n]<=t);n--);this.frames.splice(n+1,0,t),this.points.splice(n+1,0,e)}return km.update({id:this.id},{frames:this.frames,points:this.points})},split:function(t){return km.split({id:this.id},{time:t}).then(this.handleFinishedSplit)},handleFinishedSplit:function(t){return this.frames=t.body[0].frames,this.points=t.body[0].points,t.body=t.body[1],t},link:function(t){return km.link({id:this.id},{annotation_id:t.id}).then(this.handleFinishedLink)},handleFinishedLink:function(t){return this.frames=t.body.frames,this.points=t.body.points,this.labels=t.body.labels,t},deleteKeyframe:function(t){var e=this.frames.indexOf(t);return-1!==e?(this.frames.splice(e,1),this.points.splice(e,1),km.update({id:this.id},{frames:this.frames,points:this.points})):Vue.Promise.reject("Unknown keyframe ".concat(t," of annotation ").concat(this.id))},delete:function(){return km.delete({id:this.id})}},watch:{points:function(){this.revision+=1}},created:function(){this.shape=biigle.$require("videos.shapes")[this.shape_id]}}),void 0,void 0,!1,null,null,null).exports,xv=ft({mixins:[Zg],methods:{handleSelect:function(t,e){t.isSelected&&e?this.$emit("deselect",t):this.$emit("select",t,t.startFrame,e)}}},void 0,void 0,!1,null,null,null).exports,Sv={annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1},Cv=new ue({data:{urlParams:Object.keys(Sv),storageKey:"biigle.videos.settings",defaults:Sv}}),Tv=ft({components:{powerToggle:ie},data:function(){return{restoreKeys:["annotationOpacity","showMinimap","autoplayDraw","showLabelTooltip","showMousePosition"],annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1}},methods:{handleShowMinimap:function(){this.showMinimap=!0},handleHideMinimap:function(){this.showMinimap=!1},handleShowLabelTooltip:function(){this.showLabelTooltip=!0},handleHideLabelTooltip:function(){this.showLabelTooltip=!1},handleShowMousePosition:function(){this.showMousePosition=!0},handleHideMousePosition:function(){this.showMousePosition=!1}},watch:{annotationOpacity:function(t){t=parseFloat(t),isNaN(t)||(this.$emit("update","annotationOpacity",t),Cv.set("annotationOpacity",t))},showMinimap:function(t){this.$emit("update","showMinimap",t),Cv.set("showMinimap",t)},autoplayDraw:function(t){t=parseFloat(t),this.$emit("update","autoplayDraw",t),Cv.set("autoplayDraw",t)},showLabelTooltip:function(t){this.$emit("update","showLabelTooltip",t),Cv.set("showLabelTooltip",t)},showMousePosition:function(t){this.$emit("update","showMousePosition",t),Cv.set("showMousePosition",t)},playbackRate:function(t){t=parseFloat(t),isNaN(t)||this.$emit("update","playbackRate",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=Cv.get(e)}))}},void 0,void 0,!1,null,null,null).exports,Ev=ft({data:function(){return{renderedAnnotationMap:{}}},computed:{annotationsRevision:function(){return this.annotations.reduce((function(t,e){return t+e.revision}),0)},annotationsPreparedToRender:function(){return this.annotations.map((function(t){return{id:t.id,start:t.startFrame,end:t.endFrame,self:t}})).sort((function(t,e){return t.start-e.start}))}},methods:{refreshAnnotations:function(t){var e=this,i=this.annotationSource,n=this.selectedFeatures,r=this.annotationsPreparedToRender,o=this.renderedAnnotationMap,s={};this.renderedAnnotationMap=s;for(var a,l=[],u=!1,h=0,c=r.length;h<c;h++)if(!(r[h].end<t&&r[h].start!==t||r[h].self.hasGapAt(t))){if(r[h].start>t)break;a=r[h],u=!0,o.hasOwnProperty(a.id)?(s[a.id]=o[a.id],delete o[a.id]):l.push(a.self)}u?Object.values(o).forEach((function(t){i.removeFeature(t),n.remove(t)})):(i.clear(),n.clear());var d=l.map(this.createFeature);d.forEach((function(t){s[t.getId()]=t,t.get("annotation").isSelected&&n.push(t)})),d.length>0&&i.addFeatures(d),Object.values(s).forEach((function(i){e.updateGeometry(i,t)}))},createFeature:function(t){var e=new Ka(this.getGeometryFromPoints(t.shape,t.points[0]));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},updateGeometry:function(t,e){var i=t.get("annotation"),n=i.interpolatePoints(e);t.setGeometry(this.getGeometryFromPoints(i.shape,n))},getGeometryFromPoints:function(t,e){switch(e=this.convertPointsFromDbToOl(e),t){case"Point":return new Ts(e[0]);case"Rectangle":return new sh([e]);case"Polygon":return new Ns([e]);case"LineString":return new Xs(e);case"Circle":return new Vs(e[0],e[1][0]);case"Ellipse":return new ah([e]);default:return void console.error("Unknown annotation shape: "+t)}},getPointsFromGeometry:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},invertPointsYAxis:function(t){for(var e=this.videoCanvas.height,i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e}},created:function(){var t=this;this.$on("refresh",this.refreshAnnotations),this.$once("map-ready",(function(){t.$watch("annotationsRevision",(function(){t.refreshAnnotations(t.video.currentTime)}))}))}},void 0,void 0,!1,null,null,null).exports,Iv=ft({data:function(){return{pendingAnnotation:{},autoplayDrawTimeout:null}},computed:{hasSelectedLabel:function(){return!!this.selectedLabel},hasNoSelectedLabel:function(){return!this.selectedLabel},isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},hasPendingAnnotation:function(){return this.pendingAnnotation.shape&&this.pendingAnnotation.frames.length>0&&this.pendingAnnotation.points.length>0},cantFinishDrawAnnotation:function(){return!this.hasPendingAnnotation},cantFinishTrackAnnotation:function(){return!this.pendingAnnotation.frames||1!==this.pendingAnnotation.frames.length}},methods:{requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},initPendingAnnotationLayer:function(t){this.pendingAnnotationSource=new oh,this.pendingAnnotationLayer=new zu({opacity:.5,source:this.pendingAnnotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:Ph.editing}),t.addLayer(this.pendingAnnotationLayer)},draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasNoSelectedLabel?this.requireSelectedLabel():this.canAdd&&(this.interactionMode="draw"+t)},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},maybeUpdateDrawInteractionMode:function(t){if(this.resetPendingAnnotation(),this.drawInteraction&&(this.map.removeInteraction(this.drawInteraction),this.drawInteraction=void 0),this.isDrawing&&this.hasSelectedLabel){var e=t.slice(4);this.pause(),this.drawInteraction=new vh({source:this.pendingAnnotationSource,type:e,style:Ph.editing}),this.drawInteraction.on("drawend",this.extendPendingAnnotation),this.map.addInteraction(this.drawInteraction),this.pendingAnnotation.shape=e}},finishDrawAnnotation:function(){(this.isDrawing||this.isUsingPolygonBrush)&&(this.hasPendingAnnotation&&this.$emit("create-annotation",this.pendingAnnotation),this.resetInteractionMode())},finishTrackAnnotation:function(){this.isDrawing&&(this.hasPendingAnnotation&&this.$emit("track-annotation",this.pendingAnnotation),this.resetInteractionMode())},resetPendingAnnotation:function(){this.pendingAnnotationSource.clear(),this.pendingAnnotation={shape:"",frames:[],points:[]}},extendPendingAnnotation:function(t){var e=this.pendingAnnotation.frames[this.pendingAnnotation.frames.length-1];void 0===e||e<this.video.currentTime?(this.pendingAnnotation.frames.push(this.video.currentTime),this.pendingAnnotation.points.push(this.getPointsFromGeometry(t.feature.getGeometry())),!this.video.ended&&this.autoplayDraw>0&&(this.play(),window.clearTimeout(this.autoplayDrawTimeout),this.autoplayDrawTimeout=window.setTimeout(this.pause,1e3*this.autoplayDraw))):this.pendingAnnotationSource.once("addfeature",(function(t){this.removeFeature(t.feature)}))}},created:function(){this.$once("map-ready",this.initPendingAnnotationLayer),this.canAdd&&(this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode),oe.on("a",this.drawPoint,0,this.listenerSet),oe.on("s",this.drawRectangle,0,this.listenerSet),oe.on("d",this.drawCircle,0,this.listenerSet),oe.on("f",this.drawLineString,0,this.listenerSet),oe.on("g",this.drawPolygon,0,this.listenerSet),oe.on("Enter",this.finishDrawAnnotation,0,this.listenerSet))}},void 0,void 0,!1,null,null,null).exports,kv=ft({components:{mousePositionIndicator:uf},data:function(){return{mousePositionImageCoordinates:[0,0]}},methods:{updateMousePositionImageCoordinates:function(){this.mousePositionImageCoordinates=this.invertPointsYAxis(this.mousePosition.slice()).map(Math.round)}},watch:{mousePosition:function(){Zt(this.updateMousePositionImageCoordinates,100,"videos.update-mouse-position-ic")}}},void 0,void 0,!1,null,null,null).exports,Av=ft({data:function(){return{isTranslating:!1}},computed:{cannotSplitAnnotation:function(){return 1!==this.selectedAnnotations.length||-1===["Point","Circle","Rectangle"].indexOf(this.selectedAnnotations[0].shape)},cannotLinkAnnotations:function(){return 2!==this.selectedAnnotations.length||this.selectedAnnotations[0].shape_id!==this.selectedAnnotations[1].shape_id},isAttaching:function(){return"attachLabel"===this.interactionMode}},methods:{initModifyInteraction:function(t){this.featureRevisionMap={},this.modifyInteraction=new lf({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return xl(t)&&bl(t)}}),this.modifyInteraction.on("modifystart",this.handleModifyStart),this.modifyInteraction.on("modifyend",this.handleModifyEnd),t.addInteraction(this.modifyInteraction)},handleModifyStart:function(t){var e=this;t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleModifyEnd:function(t){var e=this,i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{annotation:t.get("annotation"),points:e.getPointsFromGeometry(t.getGeometry()),time:e.video.currentTime}}));i.length>0&&this.$emit("modify",i)},maybeUpdateModifyInteractionMode:function(t){this.modifyInteraction&&this.modifyInteraction.setActive(t)},emitDelete:function(){var t=this;this.canDelete&&this.hasSelectedAnnotations&&this.$emit("delete",this.selectedAnnotations.map((function(e){return{annotation:e,time:t.video.currentTime}})))},toggleTranslating:function(){this.resetInteractionMode(),this.isTranslating=!this.isTranslating},initTranslateInteraction:function(t){this.translateInteraction=new ng({features:this.selectedFeatures,map:t}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translatestart",this.handleModifyStart),this.translateInteraction.on("translateend",this.handleModifyEnd),this.map.addInteraction(this.translateInteraction)},maybeUpdateIsTranslating:function(t){this.translateInteraction&&!t&&(this.isTranslating=!1)},resetTranslating:function(){this.isTranslating=!1},emitSplitAnnotation:function(){this.$emit("split-annotation",this.selectedAnnotations[0],this.video.currentTime)},emitLinkAnnotations:function(){this.$emit("link-annotations",this.selectedAnnotations)},toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attachLabel"},initAttachInteraction:function(t){this.attachInteraction=new va({features:this.annotationFeatures,map:t}),this.attachInteraction.setActive(!1),this.attachInteraction.on("attach",this.handleAttachLabel),this.map.addInteraction(this.attachInteraction)},handleAttachLabel:function(t){this.$emit("attach-label",t.feature.get("annotation"),this.selectedLabel)},maybeResetAttaching:function(t){this.isAttaching&&t&&this.resetInteractionMode()}},watch:{isTranslating:function(t){this.translateInteraction&&(this.translateInteraction.setActive(t),t?this.modifyInteraction.setActive(!1):this.isDefaultInteractionMode&&this.modifyInteraction.setActive(!0))},isAttaching:function(t){this.attachInteraction&&this.attachInteraction.setActive(t)}},created:function(){var t=this;this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initModifyInteraction),t.$once("map-ready",t.initTranslateInteraction),t.$once("map-ready",t.initAttachInteraction)})),this.$watch("isDefaultInteractionMode",this.maybeUpdateModifyInteractionMode),this.$watch("isDefaultInteractionMode",this.maybeUpdateIsTranslating),this.$watch("hasNoSelectedLabel",this.maybeResetAttaching),oe.on("m",this.toggleTranslating,0,this.listenerSet),oe.on("Escape",this.resetTranslating,0,this.listenerSet),oe.on("l",this.toggleAttaching,0,this.listenerSet)),this.canDelete&&oe.on("Delete",this.emitDelete)}},void 0,void 0,!1,null,null,null).exports,Pv=ft({data:function(){return{polygonBrushRadius:50}},computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},togglePolygonBrushInteraction:function(t){t?this.hasSelectedLabel&&(this.polygonBrushInteraction=new Tf({source:this.pendingAnnotationSource,style:Ph.editing,brushRadius:this.polygonBrushRadius}),this.polygonBrushInteraction.on("drawend",this.extendPendingAnnotation),this.pendingAnnotation.shape="Polygon",this.map.addInteraction(this.polygonBrushInteraction)):(this.polygonBrushRadius=this.polygonBrushInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonBrushInteraction))},togglePolygonEraserInteraction:function(t){t?(this.polygonEraserInteraction=new If({features:this.selectInteraction.getFeatures(),style:Ph.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:_l,subtractCondition:wl}),this.polygonEraserInteraction.on("modifystart",this.handleModifyStart),this.polygonEraserInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonEraserInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonEraserInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonEraserInteraction),this.polygonEraserInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},togglePolygonFillInteraction:function(t){t?(this.polygonFillInteraction=new If({features:this.selectInteraction.getFeatures(),style:Ph.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:wl,subtractCondition:_l}),this.polygonFillInteraction.on("modifystart",this.handleModifyStart),this.polygonFillInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonFillInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonFillInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonFillInteraction),this.polygonFillInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},initShiftSelectInteraction:function(){this.shiftClickSelectInteraction=new Df({condition:function(t){return vl(t)&&xl(t)},style:Ph.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0}),this.shiftClickSelectInteraction.on("select",this.handleFeatureSelect)}},created:function(){var t=this;this.canAdd&&(this.$watch("isUsingPolygonBrush",this.togglePolygonBrushInteraction),oe.on("e",this.togglePolygonBrush,0,this.listenerSet)),this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initShiftSelectInteraction)})),this.$watch("isUsingPolygonEraser",this.togglePolygonEraserInteraction),oe.on("r",this.togglePolygonEraser,0,this.listenerSet),this.$watch("isUsingPolygonFill",this.togglePolygonFillInteraction),oe.on("t",this.togglePolygonFill,0,this.listenerSet))}},void 0,void 0,!1,null,null,null).exports,Rv=ft({components:{labelTooltip:Or},data:function(){return{hoveredFeaturesHash:""}},computed:{showTooltip:function(){return this.isDefaultInteractionMode&&this.showLabelTooltip}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])},updateTooltipEventListeners:function(){this.showTooltip?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}},watch:{showTooltip:function(){this.updateTooltipEventListeners()}},created:function(){this.$once("map-created",this.updateTooltipEventListeners)}},void 0,void 0,!1,null,null,null).exports,Lv=ft({data:function(){return{playing:!1,animationFrameId:null,refreshRate:30,renderCurrentTime:-1,refreshLastTime:Date.now(),extent:[0,0,0,0],minResolution:.01}},methods:{initVideoLayer:function(t){var e=t[0];this.videoCanvas.width=this.video.videoWidth,this.videoCanvas.height=this.video.videoHeight,this.extent=[0,0,this.videoCanvas.width,this.videoCanvas.height];var i=new yo({code:"biigle-image",units:"pixels",extent:this.extent});this.videoLayer=new Fh({name:"image",source:new Ba({canvas:this.videoCanvas,projection:i,canvasExtent:this.extent,canvasSize:[this.extent[0],this.extent[1]]})}),e.addLayer(this.videoLayer),e.setView(new td({center:[0,0],projection:i,minResolution:this.minResolution,extent:this.extent})),e.getView().fit(this.extent)},renderVideo:function(t){if(t||this.renderCurrentTime!==this.video.currentTime){this.renderCurrentTime=this.video.currentTime,this.videoCanvasCtx.drawImage(this.video,0,0,this.video.videoWidth,this.video.videoHeight),this.videoLayer.changed();var e=Date.now();(t||e-this.refreshLastTime>=this.refreshRate)&&(this.$emit("refresh",this.video.currentTime),this.refreshLastTime=e)}},startRenderLoop:function(){this.renderVideo(),this.animationFrameId=window.requestAnimationFrame(this.startRenderLoop)},stopRenderLoop:function(){window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null,this.renderVideo(!0)},setPlaying:function(){this.playing=!0},setPaused:function(){this.playing=!1},togglePlaying:function(){this.playing?this.pause():this.play()},play:function(){this.video.play()},pause:function(){this.video.pause(),this.renderVideo(!0)},emitMapReady:function(){this.$emit("map-ready",this.map)}},watch:{playing:function(t){t&&!this.animationFrameId?this.startRenderLoop():t||this.stopRenderLoop()}},created:function(){var t=this;this.videoCanvas=document.createElement("canvas"),this.videoCanvasCtx=this.videoCanvas.getContext("2d"),this.video.addEventListener("play",this.setPlaying),this.video.addEventListener("pause",this.setPaused),this.video.addEventListener("seeked",this.renderVideo),this.video.addEventListener("loadeddata",this.renderVideo);var e=new Vue.Promise((function(e){t.$once("map-created",e)})),i=new Vue.Promise((function(e){t.video.addEventListener("loadedmetadata",e)}));Vue.Promise.all([e,i]).then(this.initVideoLayer).then(this.emitMapReady),oe.on(" ",this.togglePlaying)}},void 0,void 0,!1,null,null,null),Mv=ft({mixins:[Lv.exports,Ev,Iv,Av,Rv,kv,Pv],components:{controlButton:Wa,minimap:Qp},props:{annotations:{type:Array,default:function(){return[]}},annotationOpacity:{type:Number,default:1},autoplayDraw:{type:Number,default:0},canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},initialCenter:{type:Array,default:function(){return[0,0]}},initialResolution:{type:Number,default:0},listenerSet:{type:String,default:"default"},selectedAnnotations:{type:Array,default:function(){return[]}},selectedLabel:{type:Object},showLabelTooltip:{type:Boolean,default:!1},showMinimap:{type:Boolean,default:!0},showMousePosition:{type:Boolean,default:!0},video:{type:HTMLVideoElement,required:!0},heightOffset:{type:Number,default:0}},data:function(){return{interactionMode:"default",mousePosition:[0,0]}},computed:{showModifyBar:function(){return this.canModify||this.canDelete},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasNoSelectedAnnotations:function(){return!this.hasSelectedAnnotations},isDefaultInteractionMode:function(){return"default"===this.interactionMode},styleObject:function(){return 0!==this.heightOffset?"height: calc(65% + ".concat(this.heightOffset,"px);"):""}},methods:{createMap:function(){var t=new Zp({controls:[new hd,new Dg({tipLabel:"Zoom to show whole video",label:""})],interactions:jd({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1})});return t.addControl(new qg({label:""})),t},initLayersAndInteractions:function(t){this.annotationFeatures=new qa,this.annotationSource=new oh({features:this.annotationFeatures}),this.annotationLayer=new zu({source:this.annotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:Ph.features,opacity:this.annotationOpacity,name:"annotations"}),this.selectInteraction=new Df({condition:vl,style:Ph.highlight,layers:[this.annotationLayer],multi:!0}),this.selectedFeatures=this.selectInteraction.getFeatures(),this.selectInteraction.on("select",this.handleFeatureSelect),t.addLayer(this.annotationLayer),t.addInteraction(this.selectInteraction)},emitCreateBookmark:function(){this.$emit("create-bookmark",this.video.currentTime)},resetInteractionMode:function(){this.interactionMode="default"},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature),this.video.currentTime)},updateMousePosition:function(t){this.mousePosition=t.coordinate},emitTrack:function(){this.$emit("track")},emitMoveend:function(t){var e=t.target.getView();this.$emit("moveend",e.getCenter(),e.getResolution())},initInitialCenterAndResolution:function(t){var e=t.getView();0!==this.initialResolution&&e.setResolution(Math.min(e.getMaxResolution(),Math.max(e.getMinResolution(),this.initialResolution))),0===this.initialCenter[0]&&0===this.initialCenter[1]||!Qn(this.extent,this.initialCenter)||e.setCenter(this.initialCenter)},updateSize:function(){var t=this;this.$nextTick((function(){return t.map.updateSize()}))}},watch:{selectedAnnotations:function(t){var e,i=this.annotationSource,n=this.selectedFeatures;i&&n&&(n.clear(),t.forEach((function(t){(e=i.getFeatureById(t.id))&&n.push(e)})))},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t)},annotationOpacity:function(t){this.annotationLayer&&this.annotationLayer.setOpacity(t)},heightOffset:function(){this.updateSize()}},created:function(){this.$once("map-ready",this.initLayersAndInteractions),this.$once("map-ready",this.initInitialCenterAndResolution),this.map=this.createMap(),this.$emit("map-created",this.map),this.map.on("pointermove",this.updateMousePosition),this.map.on("moveend",this.emitMoveend),oe.on("Escape",this.resetInteractionMode,0,this.listenerSet)},mounted:function(){this.map.setTarget(this.$el)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-screen",style:t.styleObject},[t.showMinimap?i("minimap",{attrs:{extent:t.extent}}):t._e(),t._v(" "),i("label-tooltip",{attrs:{watch:"hoverFeatures",show:t.showLabelTooltip,position:t.mousePosition}}),t._v(" "),i("div",{staticClass:"controls"},[i("div",{staticClass:"btn-group"},[t.playing?i("control-button",{attrs:{icon:"fa-pause",title:"Pause "},on:{click:t.pause}}):i("control-button",{attrs:{icon:"fa-play",title:"Play "},on:{click:t.play}})],1),t._v(" "),t.canAdd?i("div",{staticClass:"btn-group"},[i("control-button",{attrs:{icon:"icon-point",title:"Start a point annotation ",hover:!1,open:t.isDrawingPoint,active:t.isDrawingPoint},on:{click:t.drawPoint}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the point annotation ",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the point annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-rectangle",title:"Start a rectangle annotation ",hover:!1,open:t.isDrawingRectangle,active:t.isDrawingRectangle},on:{click:t.drawRectangle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the rectangle annotation ",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-circle",title:"Start a circle annotation ",hover:!1,open:t.isDrawingCircle,active:t.isDrawingCircle},on:{click:t.drawCircle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the circle annotation ",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the circle annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-linestring",title:"Start a line annotation ",hover:!1,open:t.isDrawingLineString,active:t.isDrawingLineString},on:{click:t.drawLineString}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the line annotation ",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-polygon",title:"Start a polygon annotation ",open:t.isDrawingPolygon,active:t.isDrawingPolygon},on:{click:t.drawPolygon}},[t.isDrawingPolygon||t.isUsingPolygonBrush?i("control-button",{attrs:{icon:"fa-check",title:"Finish the polygon annotation ",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}):t._e(),t._v(" "),i("control-button",{attrs:{icon:"fa-paint-brush",title:"Draw a polygon using the brush tool ",active:t.isUsingPolygonBrush},on:{click:t.togglePolygonBrush}}),t._v(" "),i("control-button",{attrs:{icon:"fa-eraser",title:"Modify selected polygons using the eraser tool ",active:t.isUsingPolygonEraser},on:{click:t.togglePolygonEraser}}),t._v(" "),i("control-button",{attrs:{icon:"fa-fill-drip",title:"Modify selected polygons using the fill tool ",active:t.isUsingPolygonFill},on:{click:t.togglePolygonFill}})],1)],1):t._e(),t._v(" "),t.showModifyBar?i("div",{staticClass:"btn-group"},[t.canModify?i("control-button",{attrs:{icon:"fa-tag",title:"Attach the currently selected label to existing annotations ",active:t.isAttaching,disabled:t.hasNoSelectedLabel},on:{click:t.toggleAttaching}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-arrows-alt",title:"Move selected annotations ",active:t.isTranslating},on:{click:t.toggleTranslating}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-link",title:"Link selected annotations",disabled:t.cannotLinkAnnotations},on:{click:t.emitLinkAnnotations}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-unlink",title:"Split selected annotation",disabled:t.cannotSplitAnnotation},on:{click:t.emitSplitAnnotation}}):t._e(),t._v(" "),t.canDelete?i("control-button",{attrs:{icon:"fa-trash",title:"Delete selected annotations/keyframes ",disabled:t.hasNoSelectedAnnotations},on:{click:t.emitDelete}}):t._e()],1):t._e()]),t._v(" "),i("div",{staticClass:"indicators indicators--left"},[t.showMousePosition?i("mouse-position-indicator",{attrs:{position:t.mousePositionImageCoordinates}}):t._e()],1),t._v(" "),i("div",{staticClass:"indicators indicators--right"},[t.selectedLabel?i("div",{staticClass:"indicator",domProps:{textContent:t._s(t.selectedLabel.name)}}):t._e()])],1)}),[],!1,null,null,null).exports,Fv=ft({props:{currentTime:{type:Number,required:!0},hoverTime:{type:Number,default:0},seeking:{type:Boolean,default:!1}},computed:{currentTimeText:function(){return Vue.filter("videoTime")(this.currentTime)},hoverTimeText:function(){return Vue.filter("videoTime")(this.hoverTime)},classObject:function(){return{"current-time--seeking":this.seeking,"current-time--hover":this.showHoverTime}},showHoverTime:function(){return 0!==this.hoverTime}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"current-time",class:this.classObject},[e("span",{domProps:{textContent:this._s(this.currentTimeText)}}),this._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:this.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time",domProps:{textContent:this._s(this.hoverTimeText)}})])}),[],!1,null,null,null).exports,Ov=ft({props:{frame:{type:Object,required:!0},startFrame:{type:Number,required:!0},segmentDuration:{type:Number,required:!0},color:{type:String,required:!0}},computed:{offset:function(){return(this.frame.time-this.startFrame)/this.segmentDuration},style:function(){return{left:100*this.offset+"%","background-color":this.color}},classObj:function(){return{"annotation-keyframe--selected":this.frame.selected}}},methods:{emitSelect:function(t){this.$emit("select",this.frame,t.shiftKey)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"annotation-keyframe",class:t.classObj,style:t.style,on:{click:function(e){return e.stopPropagation(),t.emitSelect(e)}}})}),[],!1,null,null,null),Dv=ft({components:{keyframe:Ov.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},frames:{type:Array,required:!0},gap:{type:Boolean,default:!1},clipDuration:{type:Number,required:!0}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},segmentDuration:function(){return this.endFrame-this.startFrame},classObject:function(){return{"annotation-segment--gap":this.gap}},width:function(){return 100*this.segmentDuration/this.clipDuration},color:function(){return"#"+(this.label.color||"000000")},style:function(){var t={width:this.width+"%"};return this.gap?t["border-top-color"]=this.color:t["background-color"]=this.color+"66",t},keyframes:function(){if(this.gap)return[];var t=this.annotation.selected;return this.frames.map((function(e){return{time:e,selected:t===e}}))}},methods:{selectFrame:function(t,e){this.$emit("select",t.time,e)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-segment",class:t.classObject,style:t.style},t._l(t.keyframes,(function(e){return i("keyframe",{key:e.time,attrs:{frame:e,"start-frame":t.startFrame,"segment-duration":t.segmentDuration,color:t.color},on:{select:t.selectFrame}})})),1)}),[],!1,null,null,null),jv=ft({components:{segment:Dv.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},computed:{startFrame:function(){return this.annotation.startFrame},endFrame:function(){return this.annotation.endFrame},offset:function(){var t=this.startFrame/this.duration*this.elementWidth;return this.annotation.isClip||(t=Math.min(t,this.elementWidth-9)),t},clipDuration:function(){return this.endFrame-this.startFrame},width:function(){return this.clipDuration/this.duration*this.elementWidth},style:function(){return{left:this.offset+"px",width:this.width+"px"}},segments:function(){for(var t,e=[this.annotation.frames.slice()],i=[!1],n=0;-1!==(t=e[n].indexOf(null));){var r=e[n];e[n]=r.slice(0,t),e.push([r[t-1],r[t+1]]),i.push(!0),e.push(r.slice(t+1)),i.push(!1),n+=2}return e.map((function(t,e){return{frames:t,gap:i[e]}}))},selected:function(){return this.annotation.isSelected},classObj:function(){return{"annotation-clip--selected":this.selected,"annotation-clip--compact":this.shouldBeCompact,"annotation-clip--more-compact":this.shouldBeMoreCompact,"annotation-clip--tracking":this.annotation.tracking,"annotation-clip--dark":this.annotation.tracking&&this.hasDarkColor}},minTimeBetweenFrames:function(){for(var t=1/0,e=this.annotation.frames.filter((function(t){return null!==t})),i=e.length-1;i>0;i--)t=Math.min(t,e[i]-e[i-1]);return t},minDistanceBetweenFrames:function(){return this.minTimeBetweenFrames/this.duration*this.elementWidth},shouldBeCompact:function(){return this.minDistanceBetweenFrames<=18},shouldBeMoreCompact:function(){return this.minDistanceBetweenFrames<=6},title:function(){return this.annotation.tracking?"Tracking in progress":""},hasDarkColor:function(){var t=this.label.color||"000000",e=parseInt(t,16);return.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)<128}},methods:{emitSelect:function(t,e){this.selected&&e?this.$emit("deselect",this.annotation):this.$emit("select",this.annotation,t,e)},select:function(t){var e=this.startFrame+(t.clientX-this.$el.getBoundingClientRect().left)/this.$el.clientWidth*this.clipDuration;this.emitSelect(e,t.shiftKey)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.duration>0,expression:"duration > 0"}],staticClass:"annotation-clip",class:t.classObj,style:t.style,attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.select(e)}}},t._l(t.segments,(function(e,n){return i("segment",{key:n,attrs:{annotation:t.annotation,label:t.label,frames:e.frames,gap:e.gap,"clip-duration":t.clipDuration},on:{select:t.emitSelect}})})),1)}),[],!1,null,null,null),$v=ft({components:{annotationClip:jv.exports},props:{label:{type:Object,required:!0},lanes:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-track"},t._l(t.lanes,(function(e){return i("div",{staticClass:"annotation-lane"},t._l(e,(function(e){return i("annotation-clip",{key:e.id,attrs:{annotation:e,"element-width":t.elementWidth,label:t.label,duration:t.duration},on:{select:t.emitSelect,deselect:t.emitDeselect}})})),1)})),0)}),[],!1,null,null,null),Nv=ft({components:{annotationTrack:$v.exports},props:{tracks:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},data:function(){return{dragging:!1,scrollTop:0,scrollHeight:0,clientHeight:0}},computed:{hasOverflowTop:function(){return this.scrollTop>0},hasOverflowBottom:function(){var t=this.scrollHeight-this.clientHeight-1;return t>0&&this.scrollTop<t}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(){this.$emit("deselect")},emitDeselectAnnotation:function(t){this.$emit("deselect",t)},emitDragX:function(t){this.$emit("drag-x",t)},startDragging:function(t){this.dragging=1===t.buttons},stopDragging:function(){this.dragging=!1},continueDragging:function(t){this.dragging&&(1!==t.buttons?this.stopDragging():(this.$el.scrollTop-=t.movementY,0!==t.movementX&&this.emitDragX(t.movementX)))},updateScrollTop:function(){this.scrollTop=this.$el.scrollTop},updateScrollHeight:function(){this.scrollHeight=this.$el.scrollHeight},updateClientHeight:function(){this.clientHeight=this.$el.clientHeight}},watch:{tracks:function(){this.$nextTick(this.updateScrollHeight)},hasOverflowTop:function(t){this.$emit("overflow-top",t)},hasOverflowBottom:function(t){this.$emit("overflow-bottom",t)},scrollTop:function(t){this.$emit("scroll-y",t)}},created:function(){window.addEventListener("resize",this.updateClientHeight)},mounted:function(){this.$nextTick(this.updateClientHeight)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tracks",on:{click:t.emitDeselect,mousedown:t.startDragging,mouseup:t.stopDragging,mousemove:t.continueDragging,scroll:function(e){return e.stopPropagation(),t.updateScrollTop(e)}}},t._l(t.tracks,(function(e){return i("annotation-track",{key:e.id,attrs:{label:e.label,lanes:e.lanes,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselectAnnotation}})})),1)}),[],!1,null,null,null).exports,Bv=ft({props:{bookmark:{type:Object,required:!0}},computed:{style:function(){var t=this.bookmark.time/this.$parent.duration*this.$parent.elementWidth;return"left: ".concat(t,"px")}},methods:{emitSelect:function(){this.$emit("select",this.bookmark)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"bookmark",style:t.style,on:{click:function(e){return e.stopPropagation(),t.emitSelect(e)}}})}),[],!1,null,null,null).exports,Uv=ft({props:{time:{type:Number,required:!0}},computed:{style:function(){var t=this.time/this.$parent.duration*this.$parent.elementWidth;return"left: ".concat(t,"px")},text:function(){return Vue.filter("videoTime")(this.time)}}},(function(){var t=this.$createElement;return(this._self._c||t)("span",{staticClass:"tick",style:this.style,domProps:{textContent:this._s(this.text)}})}),[],!1,null,null,null).exports,Gv=ft({props:{duration:{type:Number,required:!0},bookmarks:{type:Array,default:function(){return[]}},elementWidth:{type:Number,required:!0}},components:{bookmark:Bv,tick:Uv},data:function(){return{tickSpacing:100}},computed:{tickCount:function(){return Math.floor(this.elementWidth/this.tickSpacing)},ticks:function(){if(!this.hasTicks)return[];var t=this.duration/this.tickCount;return Array.apply(null,{length:this.tickCount}).map((function(e,i){return t*i}))},hasTicks:function(){return this.tickCount>0&&this.duration>0}},methods:{emitSeek:function(t){this.$emit("seek",(t.clientX-t.target.getBoundingClientRect().left)/t.target.clientWidth*this.duration)},emitSelectBookmark:function(t){this.$emit("seek",t.time)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-progress",on:{click:t.emitSeek}},[t._l(t.bookmarks,(function(e){return i("bookmark",{key:e.time,attrs:{bookmark:e},on:{select:t.emitSelectBookmark}})})),t._v(" "),t._l(t.ticks,(function(t){return i("tick",{key:t,attrs:{time:t}})}))],2)}),[],!1,null,null,null),zv=ft({components:{videoProgress:Gv.exports,annotationTracks:Nv},props:{tracks:{type:Array,required:function(){return[]}},bookmarks:{type:Array,required:function(){return[]}},duration:{type:Number,required:!0},currentTime:{type:Number,required:!0},seeking:{type:Boolean,default:!1}},data:function(){return{zoom:1,zoomFactor:.3,scrollFactor:10,initialElementWidth:0,scrollLeft:0,hoverTime:0,hasOverflowTop:!1,hasOverflowBottom:!1}},computed:{currentTimePosition:function(){return this.duration>0?this.elementWidth*this.currentTime/this.duration:0},timeIndicatorClass:function(){return{"time-indicator--seeking":this.seeking}},timeIndicatorStyle:function(){return"transform: translateX(".concat(this.currentTimePosition,"px);")},hoverTimeIndicatorStyle:function(){return"transform: translateX(".concat(this.hoverPosition,"px);")},scrollerStyle:function(){return{width:100*this.zoom+"%",left:this.scrollLeft+"px"}},elementWidth:function(){return this.initialElementWidth*this.zoom},hoverPosition:function(){return this.duration>0?this.elementWidth*this.hoverTime/this.duration:0},showHoverTime:function(){return 0!==this.hoverTime},hasOverflowLeft:function(){return this.scrollLeft<0},hasOverflowRight:function(){return this.elementWidth+this.scrollLeft>this.initialElementWidth}},methods:{updateInitialElementWidth:function(){this.initialElementWidth=this.$el.clientWidth},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},emitScrollY:function(t){this.$emit("scroll-y",t)},handleWheel:function(t){t.shiftKey?0!==t.deltaY&&this.updateZoom(t):t.deltaX<0?this.updateScrollLeft(this.scrollLeft+this.scrollFactor):t.deltaX>0&&this.updateScrollLeft(this.scrollLeft-this.scrollFactor)},updateZoom:function(t){var e=this,i=t.clientX-this.$el.getBoundingClientRect().left,n=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth,r=t.deltaY<0?this.zoomFactor:-1*this.zoomFactor;this.zoom=Math.max(1,this.zoom+r),this.$nextTick((function(){var t=n*e.elementWidth;e.updateScrollLeft(i-t)}))},handleHideHoverTime:function(){this.hoverTime=0},handleUpdateHoverTime:function(t){this.hoverTime=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth*this.duration},updateScrollLeft:function(t){this.scrollLeft=Math.max(Math.min(0,t),this.initialElementWidth-this.elementWidth)},updateOverflowTop:function(t){this.hasOverflowTop=t},updateOverflowBottom:function(t){this.hasOverflowBottom=t},handleDragX:function(t){this.updateScrollLeft(this.scrollLeft+t)},updateHeight:function(){this.$refs.annotationTracks.updateClientHeight()}},watch:{hoverTime:function(t){this.$emit("hover-time",t)},initialElementWidth:function(t,e){this.updateScrollLeft(this.scrollLeft*t/e)}},created:function(){var t=this;window.addEventListener("resize",this.updateInitialElementWidth),re.$on("sidebar.toggle",(function(){t.$nextTick(t.updateInitialElementWidth)})),oe.on(" ",(function(t){t.preventDefault()}))},mounted:function(){this.$nextTick(this.updateInitialElementWidth)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scroll-strip",on:{wheel:function(e){return e.stopPropagation(),t.handleWheel(e)},mouseleave:t.handleHideHoverTime}},[i("div",{ref:"scroller",staticClass:"scroll-strip__scroller",style:t.scrollerStyle,on:{mousemove:t.handleUpdateHoverTime}},[i("video-progress",{attrs:{bookmarks:t.bookmarks,duration:t.duration,"element-width":t.elementWidth},on:{seek:t.emitSeek}}),t._v(" "),i("div",{staticClass:"annotation-tracks-wrapper"},[i("annotation-tracks",{ref:"annotationTracks",attrs:{tracks:t.tracks,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.emitScrollY,"drag-x":t.handleDragX,"overflow-top":t.updateOverflowTop,"overflow-bottom":t.updateOverflowBottom}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowTop,expression:"hasOverflowTop"}],staticClass:"overflow-shadow overflow-shadow--top"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowBottom,expression:"hasOverflowBottom"}],staticClass:"overflow-shadow overflow-shadow--bottom"})],1),t._v(" "),i("span",{staticClass:"time-indicator",class:t.timeIndicatorClass,style:t.timeIndicatorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time-indicator",style:t.hoverTimeIndicatorStyle})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowLeft,expression:"hasOverflowLeft"}],staticClass:"overflow-shadow overflow-shadow--left"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowRight,expression:"hasOverflowRight"}],staticClass:"overflow-shadow overflow-shadow--right"})])}),[],!1,null,null,null).exports,Vv=ft({props:{tracks:{type:Array,required:!0},scrollTop:{type:Number,default:0}},watch:{scrollTop:function(t){this.$el.scrollTop=t}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"track-headers"},t._l(t.tracks,(function(e){return i("div",{staticClass:"track-header"},[i("div",{staticClass:"label-name",attrs:{title:e.label.name},domProps:{textContent:t._s(e.label.name)}}),t._v(" "),t._l(e.lanes,(function(t){return i("div",{staticClass:"lane-dummy"})}))],2)})),0)}),[],!1,null,null,null),qv=ft({components:{currentTime:Fv,trackHeaders:Vv.exports,scrollStrip:zv},props:{annotations:{type:Array,default:function(){return[]}},video:{type:HTMLVideoElement,required:!0},bookmarks:{type:Array,default:function(){return[]}},seeking:{type:Boolean,default:!1},heightOffset:{type:Number,default:0}},data:function(){return{animationFrameId:null,refreshRate:30,refreshLastTime:Date.now(),currentTime:0,duration:0,scrollTop:0,hoverTime:0}},computed:{labelMap:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t.hasOwnProperty(e.label_id)||(t[e.label_id]=e.label)}))})),t},annotationTracks:function(){var t=this,e={};return this.annotations.forEach((function(t){t.labels.forEach((function(i){e.hasOwnProperty(i.label_id)||(e[i.label_id]=[]),e[i.label_id].push(t)}))})),Object.keys(e).map((function(i){return{id:i,label:t.labelMap[i],lanes:t.getAnnotationTrackLanes(e[i])}}))},styleObject:function(){return 0!==this.heightOffset?"height: calc(35% + ".concat(this.heightOffset,"px);"):""}},methods:{startUpdateLoop:function(){var t=Date.now();t-this.refreshLastTime>=this.refreshRate&&(this.updateCurrentTime(),this.refreshLastTime=t),this.animationFrameId=window.requestAnimationFrame(this.startUpdateLoop)},stopUpdateLoop:function(){this.updateCurrentTime(),window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null},updateCurrentTime:function(){this.currentTime=this.video.currentTime},setDuration:function(){this.duration=this.video.duration},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},handleScrollY:function(t){this.scrollTop=t},getAnnotationTrackLanes:function(t){var e=this,i=[[]],n=[[]];return t.forEach((function(t){var r=[t.startFrame,t.endFrame],o=0,s=!1;t:for(;!s;){if(n[o]){for(var a=i[o].length-1;a>=0;a--)if(e.rangesCollide(i[o][a],r)){o+=1;continue t}}else i[o]=[],n[o]=[];i[o].push(r),n[o].push(t),s=!0}})),n},rangesCollide:function(t,e){return t[0]>=e[0]&&t[0]<e[1]||t[1]>e[0]&&t[1]<=e[1]||e[0]>=t[0]&&e[0]<t[1]||e[1]>t[0]&&e[1]<=t[1]||t[0]===e[0]&&t[1]===e[1]},updateHoverTime:function(t){this.hoverTime=t},emitStartResize:function(t){this.$emit("start-resize",t)}},watch:{heightOffset:function(){this.$refs.scrollStrip.updateHeight()}},created:function(){this.video.addEventListener("play",this.startUpdateLoop),this.video.addEventListener("pause",this.stopUpdateLoop),this.video.addEventListener("loadedmetadata",this.setDuration),this.video.addEventListener("seeked",this.updateCurrentTime)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-timeline",style:t.styleObject},[i("div",{staticClass:"grab-border",on:{mousedown:t.emitStartResize}}),t._v(" "),i("div",{staticClass:"static-strip"},[i("current-time",{attrs:{"current-time":t.currentTime,"hover-time":t.hoverTime,seeking:t.seeking}}),t._v(" "),i("track-headers",{ref:"trackheaders",attrs:{tracks:t.annotationTracks,"scroll-top":t.scrollTop}})],1),t._v(" "),i("scroll-strip",{ref:"scrollStrip",attrs:{tracks:t.annotationTracks,duration:t.duration,"current-time":t.currentTime,bookmarks:t.bookmarks,seeking:t.seeking},on:{seek:t.emitSeek,select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.handleScrollY,"hover-time":t.updateHoverTime}})],1)}),[],!1,null,null,null),Wv=ft({mixins:[le],components:{videoScreen:Mv,videoTimeline:qv.exports,sidebar:se,sidebarTab:ae,labelTrees:_e,settingsTab:Tv,annotationsTab:xv},data:function(){return{videoId:null,shapes:[],canEdit:!1,video:null,labelTrees:[],selectedLabel:null,bookmarks:[],annotations:[],seeking:!1,settings:{annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1},openTab:"",urlParams:{x:0,y:0,r:0,t:0},initialCurrentTime:0,initialMapCenter:[0,0],initialMapResolution:0,annotationFilters:[],activeAnnotationFilter:null,resizingTimeline:!1,timelineOffsetReference:0,timelineHeightReference:0,fixedTimelineOffset:0,currentTimelineOffset:0}},computed:{selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.isSelected}))},filteredAnnotations:function(){return this.activeAnnotationFilter?this.activeAnnotationFilter.filter(this.annotations):this.annotations},hasActiveAnnotationFilter:function(){return null!==this.activeAnnotationFilter},timelineHeightOffset:function(){return this.fixedTimelineOffset+this.currentTimelineOffset},screenHeightOffset:function(){return-1*this.timelineHeightOffset},classObject:function(){return this.resizingTimeline?"resizing-timeline":""}},methods:{prepareAnnotation:function(t){return new wv({data:t})},setAnnotations:function(t){this.annotations=t.body.map(this.prepareAnnotation)},addCreatedAnnotation:function(t){var e=this.prepareAnnotation(t.body);return e.$on("tracking-failed",this.removeAnnotation),this.annotations.push(e),e},seek:function(t){this.seeking||this.video.currentTime===t||(this.seeking=!0,this.video.currentTime=t)},selectAnnotation:function(t,e,i){i?this.selectAnnotations([t],[],e):this.selectAnnotations([t],this.selectedAnnotations,e)},selectAnnotations:function(t,e,i){e.forEach((function(t){t.selected=!1}));var n=this.selectedAnnotations.length>0;t.forEach((function(t){t.selected=i})),void 0!==i&&!1===n&&this.seek(i)},deselectAnnotation:function(t){t?t.selected=!1:this.selectedAnnotations.forEach((function(t){t.selected=!1}))},createBookmark:function(t){this.bookmarks.reduce((function(e,i){return e||i.time===t}),!1)||this.bookmarks.push({time:t})},createAnnotation:function(t){var e=Object.assign(t,{shape_id:this.shapes[t.shape],label_id:this.selectedLabel?this.selectedLabel.id:0});return delete e.shape,km.save({id:this.videoId},e).then(this.addCreatedAnnotation,Qt)},trackAnnotation:function(t){t.track=!0,this.createAnnotation(t).then(this.startPollTrackingAnnotation)},startPollTrackingAnnotation:function(t){t&&t.startPollTracking()},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},deleteAnnotationsOrKeyframes:function(t){confirm("Are you sure that you want to delete all selected annotations/keyframes?")&&t.forEach(this.deleteAnnotationOrKeyframe)},deleteAnnotationOrKeyframe:function(t){var e=this,i=t.annotation;i.isClip&&i.hasKeyframe(t.time)?i.deleteKeyframe(t.time).catch(Qt):i.delete().then((function(){return e.removeAnnotation(i)})).catch(Qt)},handleVideoSeeked:function(){this.seeking=!1},modifyAnnotations:function(t){t.forEach(this.modifyAnnotation)},modifyAnnotation:function(t){t.annotation.modify(t.time,t.points).catch(Qt)},handleUpdatedSettings:function(t,e){this.settings[t]=e},handleOpenedTab:function(t){Cv.set("openTab",t)},handleClosedTab:function(){Cv.delete("openTab")},handleToggledTab:function(){this.$refs.videoScreen.updateSize()},removeAnnotation:function(t){var e=this.annotations.indexOf(t);-1!==e&&this.annotations.splice(e,1)},splitAnnotation:function(t,e){t.split(e).then(this.addCreatedAnnotation,Qt)},linkAnnotations:function(t){var e=this;t[0].link(t[1]).then((function(){return e.removeAnnotation(t[1])})).catch(Qt)},updateMapUrlParams:function(t,e){this.urlParams.x=Math.round(t[0]),this.urlParams.y=Math.round(t[1]),this.urlParams.r=Math.round(100*e)},updateVideoUrlParams:function(){this.urlParams.t=Math.round(100*this.video.currentTime)},restoreUrlParams:function(){void 0!==Xt.get("r")&&(this.initialMapResolution=parseInt(Xt.get("r"),10)/100),void 0!==Xt.get("x")&&void 0!==Xt.get("y")&&(this.initialMapCenter=[parseInt(Xt.get("x"),10),parseInt(Xt.get("y"),10)]),void 0!==Xt.get("t")&&(this.initialCurrentTime=parseInt(Xt.get("t"),10)/100)},maybeInitCurrentTime:function(){var t=this;if(0===this.initialCurrentTime)return Vue.Promise.resolve();var e=new Vue.Promise((function(e,i){t.video.addEventListener("seeked",e),t.video.addEventListener("error",i)}));return this.seek(this.initialCurrentTime),e},detachAnnotationLabel:function(t,e){var i=this;t.labels.length>1?t.detachAnnotationLabel(e).catch(Qt):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&t.delete().then((function(){return i.removeAnnotation(t)})).catch(Qt)},attachAnnotationLabel:function(t,e){t.attachAnnotationLabel(e).catch(Qt)},initAnnotationFilters:function(){this.annotationFilters=[new om({data:{annotations:this.annotations}}),new am({data:{annotations:this.annotations}}),new sm({data:{shapes:this.shapes}})]},setActiveAnnotationFilter:function(t){this.activeAnnotationFilter=t},resetAnnotationFilter:function(){this.activeAnnotationFilter&&this.activeAnnotationFilter.reset(),this.activeAnnotationFilter=null},handleRequiresSelectedLabel:function(){te.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},startUpdateTimelineHeight:function(t){t.preventDefault(),this.resizingTimeline=!0,this.timelineOffsetReference=t.clientY,this.timelineHeightReference=this.$refs.videoTimeline.$el.offsetHeight},updateTimelineHeight:function(t){this.resizingTimeline&&(t.preventDefault(),this.currentTimelineOffset=this.timelineOffsetReference-t.clientY)},finishUpdateTimelineHeight:function(){this.resizingTimeline&&(this.resizingTimeline=!1,this.fixedTimelineOffset=this.fixedTimelineOffset+this.$refs.videoTimeline.$el.offsetHeight-this.timelineHeightReference,this.currentTimelineOffset=0)}},watch:{"settings.playbackRate":function(t){this.video.playbackRate=t},urlParams:{deep:!0,handler:function(t){Xt.set(t)}}},created:function(){var t=this,e=biigle.$require("videos.shapes"),i={};Object.keys(e).forEach((function(t){i[e[t]]=parseInt(t)})),this.shapes=i,this.video=document.createElement("video"),this.videoId=biigle.$require("videos.id"),this.canEdit=biigle.$require("videos.isEditor"),this.labelTrees=biigle.$require("videos.labelTrees"),this.restoreUrlParams(),this.video.muted=!0,this.video.addEventListener("error",(function(t){t.target.error.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED?te.danger("The video codec is not supported by your browser."):t.target.error.code!==MediaError.MEDIA_ERR_ABORTED&&te.danger("Error while loading video file.")})),this.video.addEventListener("seeked",this.handleVideoSeeked),this.video.addEventListener("pause",this.updateVideoUrlParams),this.video.addEventListener("seeked",this.updateVideoUrlParams),this.startLoading();var n=new Vue.Promise((function(e){t.video.addEventListener("canplay",e)})),r=km.query({id:this.videoId});r.then(this.setAnnotations,Qt).then(this.initAnnotationFilters),Vue.Promise.all([n,r]).then(this.maybeInitCurrentTime).then(this.finishLoading),Cv.has("openTab")&&(this.openTab=Cv.get("openTab"))},mounted:function(){this.video.src=biigle.$require("videos.src")}},void 0,void 0,!1,null,null,null).exports,Kv=Vue.resource("api/v1/videos{/id}",{},{save:{method:"POST",url:"api/v1/projects{/id}/videos"}}),Xv=ft({mixins:[le,qt],components:{previewThumbnail:Ne},data:function(){return{project:null,videos:[],filterString:"",fullHeight:0}},computed:{filteredVideos:function(){if(this.hasFiltering){var t=this.filterString.toLowerCase();return this.videos.filter((function(e){return-1!==e.name.toLowerCase().indexOf(t)}))}return this.videos},hasFiltering:function(){return this.filterString.length>0},filterInputClass:function(){return this.hasFiltering?"panel-filter--active":""},hasVideos:function(){return this.videos.length>0},panelStyle:function(){return this.hasFiltering?{height:this.fullHeight+"px"}:{}},hasNoMatchingVideos:function(){return this.hasVideos&&0===this.filteredVideos.length}},methods:{deleteVideo:function(t,e){Kv.delete({id:t.id},{force:!!e}).then(this.videoDeleted(t),this.maybeForceDelete(t))},maybeForceDelete:function(t){var e=this;return function(i){422!==i.status?Qt(i):confirm("Deleting the video would delete annotations. Do you want to delete the video and the annotations?")&&e.deleteVideo(t,!0)}},videoDeleted:function(t){var e=this;return function(){var i=e.videos.indexOf(t);-1!==i&&e.videos.splice(i,1),e.$nextTick(e.updateFullHeight)}},clearFiltering:function(){this.filterString=""},updateFullHeight:function(){this.fullHeight=this.$el.offsetHeight}},created:function(){this.project=biigle.$require("projects.project"),this.videos=biigle.$require("projects.videos")},mounted:function(){this.updateFullHeight()}},void 0,void 0,!1,null,null,null).exports;biigle.$mount("create-video-form",Em),biigle.$mount("projects-show-video-list",Xv),biigle.$mount("search-results",Im),biigle.$mount("video-container",Wv)},OpTr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cWyK"),r=i("AKIq"),o=i("z8fI"),s=i("sk2A"),a=i("BQ1l");e.default=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");var i=r.getType(t);if(i!==r.getType(e))throw new Error("features must be of the same type");if("Point"===i)throw new Error("Point geometry not supported");if(new a({precision:6}).compare(t,e))return!1;var l=0;switch(i){case"MultiPoint":var u=n.coordAll(t),h=n.coordAll(e);u.forEach((function(t){h.forEach((function(e){t[0]===e[0]&&t[1]===e[1]&&l++}))}));break;case"LineString":case"MultiLineString":n.segmentEach(t,(function(t){n.segmentEach(e,(function(e){o.default(t,e).features.length&&l++}))}));break;case"Polygon":case"MultiPolygon":n.segmentEach(t,(function(t){n.segmentEach(e,(function(e){s.default(t,e).features.length&&l++}))}))}return l>0}},"QJ+7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cWyK");e.default=function(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},Qnnh:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Zsd0"),r=i("AKIq"),o=i("/rf6");e.default=function(t,e,i){void 0===i&&(i={});var s=r.getGeom(t).coordinates,a=r.getGeom(e).coordinates,l=n.union(s,a);return 0===l.length?null:1===l.length?o.polygon(l[0],i.properties):o.multiPolygon(l,i.properties)}},RLeF:function(t,e,i){"use strict";var n=i("D3zA"),r=i("6ayh")("%Function%"),o=r.apply,s=r.call;t.exports=function(){return n.apply(s,arguments)},t.exports.apply=function(){return n.apply(o,arguments)}},RZZ2:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("AKIq");function r(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!i;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(n=!n)}return n}e.default=function(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var o=n.getCoord(t),s=n.getGeom(e),a=s.type,l=e.bbox,u=s.coordinates;if(l&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(o,l))return!1;"Polygon"===a&&(u=[u]);for(var h=!1,c=0;c<u.length&&!h;c++)if(r(o,u[c][0],i.ignoreBoundary)){for(var d=!1,p=1;p<u[c].length&&!d;)r(o,u[c][p],!i.ignoreBoundary)&&(d=!0),p++;d||(h=!0)}return h}},T1Mv:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n[tabs] > .tab-content {\n  margin: 15px 0;\n}\n",""])},URgk:function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i("YBdB"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i("yLpj"))},UVaH:function(t,e,i){"use strict";(function(e){var n=e.Symbol,r=i("FpZJ");t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&r())))}}).call(this,i("yLpj"))},"V+xs":function(t,e,i){"use strict";var n=i("VwiP"),r=i("82c2").supportsDescriptors,o=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!r)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return n}},VwiP:function(t,e,i){"use strict";var n=Object,r=TypeError;t.exports=function(){if(null!=this&&this!==n(this))throw new r("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},WDQk:function(t,e,i){"use strict";var n=i("1u+m");t.exports=function(){return"function"==typeof Object.is?Object.is:n}},XPUu:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=n(i("QJ+7")),o=n(i("RZZ2")),s=n(i("lXTj")),a=i("AKIq");function l(t,e){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(m(t.coordinates[i],e.coordinates)){n=!0;break}return n}function u(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){for(var r=n[i],o=!1,s=0,a=t.coordinates;s<a.length;s++){if(m(r,a[s])){o=!0;break}}if(!o)return!1}return!0}function h(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(s.default(o,t,{ignoreEndVertices:!0})&&(i=!0),!s.default(o,t))return!1}return!!i}function c(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){var r=n[i];if(!o.default(r,t,{ignoreBoundary:!0}))return!1}return!0}function d(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(s.default({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(i=!0),!s.default({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return i}function p(t,e){var i=!1,n=0;if(!g(r.default(t),r.default(e)))return!1;for(;n<e.coordinates.length-1;n++){var s=v(e.coordinates[n],e.coordinates[n+1]);if(o.default({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){i=!0;break}}return i}function f(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!g(r.default(t),r.default(e)))return!1;for(var i=0,n=a.getGeom(e).coordinates;i<n.length;i++)for(var s=0,l=n[i];s<l.length;s++){var u=l[s];if(!o.default(u,t))return!1}return!0}function g(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function m(t,e){return t[0]===e[0]&&t[1]===e[1]}function v(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}e.default=function(t,e){var i=a.getGeom(t),n=a.getGeom(e),r=a.getType(t),g=a.getType(e),v=a.getCoords(t),y=a.getCoords(e);switch(r){case"Point":switch(g){case"Point":return m(v,y);default:throw new Error("feature2 "+g+" geometry not supported")}case"MultiPoint":switch(g){case"Point":return l(i,n);case"MultiPoint":return u(i,n);default:throw new Error("feature2 "+g+" geometry not supported")}case"LineString":switch(g){case"Point":return s.default(n,i,{ignoreEndVertices:!0});case"LineString":return d(i,n);case"MultiPoint":return h(i,n);default:throw new Error("feature2 "+g+" geometry not supported")}case"Polygon":switch(g){case"Point":return o.default(n,i,{ignoreBoundary:!0});case"LineString":return p(i,n);case"Polygon":return f(i,n);case"MultiPoint":return c(i,n);default:throw new Error("feature2 "+g+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}},e.isPointInMultiPoint=l,e.isMultiPointInMultiPoint=u,e.isMultiPointOnLine=h,e.isMultiPointInPoly=c,e.isLineOnLine=d,e.isLineInPoly=p,e.isPolyInPoly=f,e.doBBoxOverlap=g,e.compareCoords=m,e.getMidpoint=v},Xf4S:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.datepicker {\n  position: relative;\n  display: inline-block;\n}\n.datepicker-block {\n    display: block;\n}\ninput.datepicker-input.with-reset-button {\n  padding-right: 25px;\n}\n.datepicker > button.close {\n  position: absolute;\n  top: 0;\n  right: 0;\n  outline: none;\n  z-index: 2;\n  display: block;\n  width: 34px;\n  height: 34px;\n  line-height: 34px;\n  text-align: center;\n}\n.datepicker > button.close:focus {\n  opacity: .2;\n}\n.datepicker-popup {\n  position: absolute;\n  border: 1px solid #555;\n  border-radius: 5px;\n  background-color: #222;\n  margin-top: 2px;\n  z-index: 1000;\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.5);\n}\n.datepicker-inner {\n  width: 218px;\n}\n.datepicker-body {\n  padding: 10px 10px;\n}\n.datepicker-ctrl p,\n.datepicker-ctrl span,\n.datepicker-body span {\n  display: inline-block;\n  width: 28px;\n  line-height: 28px;\n  height: 28px;\n  border-radius: 4px;\n}\n.datepicker-ctrl p {\n  width: 65%;\n}\n.datepicker-ctrl span {\n  position: absolute;\n}\n.datepicker-body span {\n  text-align: center;\n}\n.datepicker-monthRange span {\n  width: 48px;\n  height: 50px;\n  line-height: 45px;\n}\n.datepicker-item-disable {\n  cursor: not-allowed!important;\n}\n.decadeRange span:first-child,\n.decadeRange span:last-child,\n.datepicker-item-disable,\n.datepicker-item-gray {\n  opacity: .65;\n}\n.datepicker-dateRange-item-active:hover,\n.datepicker-dateRange-item-active {\n  background: rgb(50, 118, 177)!important;\n  color: white!important;\n}\n.datepicker-monthRange {\n  margin-top: 10px\n}\n.datepicker-monthRange span,\n.datepicker-ctrl span,\n.datepicker-ctrl p,\n.datepicker-dateRange span {\n  cursor: pointer;\n}\n.datepicker-monthRange span:hover,\n.datepicker-ctrl p:hover,\n.datepicker-ctrl i:hover,\n.datepicker-dateRange span:hover,\n.datepicker-dateRange-item-hover {\n  background-color : #090909;\n}\n.datepicker-weekRange span {\n  font-weight: bold;\n}\n.datepicker-label {\n  background-color: #f8f8f8;\n  font-weight: 700;\n  padding: 7px 0;\n  text-align: center;\n}\n.datepicker-ctrl {\n  position: relative;\n  height: 30px;\n  line-height: 30px;\n  font-weight: bold;\n  text-align: center;\n}\n.month-btn {\n  font-weight: bold;\n  -webkit-user-select:none;\n  -moz-user-select:none;\n  -ms-user-select:none;\n  user-select:none;\n}\n.datepicker-preBtn {\n  left: 2px;\n}\n.datepicker-nextBtn {\n  right: 2px;\n}\n",""])},XikC:function(t,e,i){var n=i("K6oq");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},XuX8:function(t,e,i){t.exports=i("INkZ")},YBdB:function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,r,o,s,a,l=1,u={},h=!1,c=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){f(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){f(t.data)},n=function(t){o.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,n=function(t){var e=c.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):n=function(t){setTimeout(f,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&f(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),n=function(e){t.postMessage(s+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return u[l]=r,n(l),l++},d.clearImmediate=p}function p(t){delete u[t]}function f(t){if(h)setTimeout(f,0,t);else{var e=u[t];if(e){h=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{p(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i("yLpj"),i("8oxB"))},YcpW:function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,r,o,s){!function e(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=n-r+1,u=Math.log(a),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(a-h)/a)*(l-a/2<0?-1:1),d=Math.max(r,Math.floor(n-l*h/a+c)),p=Math.min(o,Math.floor(n+(a-l)*h/a+c));e(i,n,d,p,s)}var f=i[n],g=r,m=o;for(t(i,r,n),s(i[o],f)>0&&t(i,r,o);g<m;){for(t(i,g,m),g++,m--;s(i[g],f)<0;)g++;for(;s(i[m],f)>0;)m--}0===s(i[r],f)?t(i,r,m):(m++,t(i,m,o)),m<=n&&(r=m+1),n<=m&&(o=m-1)}}(i,n,r||0,o||i.length-1,s||e)}}()},Yeox:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/rf6"),r=i("AKIq");e.default=function(t,e,i,o){void 0===o&&(o={});var s=r.getCoord(t),a=n.degreesToRadians(s[0]),l=n.degreesToRadians(s[1]),u=n.degreesToRadians(i),h=n.lengthToRadians(e,o.units),c=Math.asin(Math.sin(l)*Math.cos(h)+Math.cos(l)*Math.sin(h)*Math.cos(u)),d=a+Math.atan2(Math.sin(u)*Math.sin(h)*Math.cos(l),Math.cos(h)-Math.sin(l)*Math.sin(c)),p=n.radiansToDegrees(d),f=n.radiansToDegrees(c);return n.point([p,f],o.properties)}},Zsd0:function(t,e,i){!function(t){"use strict";function e(t,e){return t>e?1:t<e?-1:0}var i=function(t,i){void 0===t&&(t=e),void 0===i&&(i=!1),this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!i},n={size:{configurable:!0}};function r(t,e,i){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!o(e,i)||e.isVertical()?e.prevInResult:e)),t.inResult=o(t,i)}function o(t,e){switch(t.type){case 0:switch(e){case 0:return!t.otherInOut;case 1:return t.otherInOut;case 2:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case 3:return!0}break;case 2:return 0===e||1===e;case 3:return 2===e;case 1:return!1}return!1}i.prototype.rotateLeft=function(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e},i.prototype.rotateRight=function(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e},i.prototype._splay=function(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}},i.prototype.splay=function(t){for(var e,i,n,r,o;t.parent;)(i=(e=t.parent).parent)&&i.parent?((n=i.parent).left===i?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),r=t.left,o=t.right,t===e.left?(i&&(i.left===e?(e.right?(i.left=e.right,i.left.parent=i):i.left=null,e.right=i,i.parent=e):(r?(i.right=r,r.parent=i):i.right=null,t.left=i,i.parent=t)),o?(e.left=o,o.parent=e):e.left=null,t.right=e,e.parent=t):(i&&(i.right===e?(e.left?(i.right=e.left,i.right.parent=i):i.right=null,e.left=i,i.parent=e):(o?(i.left=o,o.parent=i):i.left=null,t.right=i,i.parent=t)),r?(e.right=r,r.parent=e):e.right=null,t.left=e,e.parent=t)},i.prototype.replace=function(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)},i.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.insert=function(t,e){var i=this._root,n=null,r=this._compare;if(this._noDuplicates)for(;i;){if(n=i,0===r(i.key,t))return;i=r(i.key,t)<0?i.right:i.left}else for(;i;)n=i,i=r(i.key,t)<0?i.right:i.left;return i={key:t,data:e,left:null,right:null,parent:n},n?r(n.key,i.key)<0?n.right=i:n.left=i:this._root=i,this.splay(i),this._size++,i},i.prototype.find=function(t){for(var e=this._root,i=this._compare;e;){var n=i(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null},i.prototype.contains=function(t){for(var e=this._root,i=this._compare;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},i.prototype.remove=function(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0},i.prototype.removeNode=function(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0},i.prototype.erase=function(t){var e=this.find(t);if(e){this.splay(e);var i=e.left,n=e.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),n&&(i?r.right=n:this._root=n,n.parent=r),this._size--}},i.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},i.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},i.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},i.prototype.forEach=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)e?(i.push(e),e=e.left):i.length>0?(t(e=i.pop(),r++),e=e.right):n=!0;return this},i.prototype.range=function(t,e,i,n){for(var r=[],o=this._compare,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},i.prototype.keys=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.key),t=t.right):n=!0;return i},i.prototype.values=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.data),t=t.right):n=!0;return i},i.prototype.at=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},i.prototype.load=function(t,e,i){if(void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=!1),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return i&&function t(e,i,n,r,o){if(!(n>=r)){for(var s=e[n+r>>1],a=n-1,l=r+1;;){do{a++}while(o(e[a],s)<0);do{l--}while(o(e[l],s)>0);if(a>=l)break;var u=e[a];e[a]=e[l],e[l]=u,u=i[a],i[a]=i[l],i[l]=u}t(e,i,n,l,o),t(e,i,l+1,r,o)}}(t,e,0,n-1,this._compare),this._root=function t(e,i,n,r,o){var s=o-r;if(s>0){var a=r+Math.floor(s/2),l={key:i[a],data:n[a],parent:e};return l.left=t(l,i,n,r,a),l.right=t(l,i,n,a+1,o),l}return null}(null,t,e,0,n),this._size=n,this},i.prototype.min=function(){var t=this.minNode(this._root);return t?t.key:null},i.prototype.max=function(){var t=this.maxNode(this._root);return t?t.key:null},i.prototype.isEmpty=function(){return null===this._root},n.size.get=function(){return this._size},i.createTree=function(t,e,n,r,o){return new i(n,o).load(t,e,r)},Object.defineProperties(i.prototype,n);var s=function(t,e,i,n,r){this.left=e,this.point=t,this.otherEvent=i,this.isSubject=n,this.type=r||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0};function a(t,e){return t[0]===e[0]&&t[1]===e[1]}function l(t,e,i){return(t[0]-i[0])*(e[1]-i[1])-(e[0]-i[0])*(t[1]-i[1])}function u(t,e){var i=t.point,n=e.point;return i[0]>n[0]?1:i[0]<n[0]?-1:i[1]!==n[1]?i[1]>n[1]?1:-1:function(t,e,i,n){return t.left!==e.left?t.left?1:-1:0!==l(i,t.otherEvent.point,e.otherEvent.point)?t.isBelow(e.otherEvent.point)?-1:1:!t.isSubject&&e.isSubject?1:-1}(t,e,i)}function h(t,e,i){var n=new s(e,!1,t,t.isSubject),r=new s(e,!0,t.otherEvent,t.isSubject);return a(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=r.contourId=t.contourId,u(r,t.otherEvent)>0&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=n,i.push(r),i.push(n),i}function c(t,e){return t[0]*e[1]-t[1]*e[0]}function d(t,e){return t[0]*e[0]+t[1]*e[1]}function p(t,e,i){var n=function(t,e,i,n,r){var o=[e[0]-t[0],e[1]-t[1]],s=[n[0]-i[0],n[1]-i[1]];function a(t,e,i){return[t[0]+e*i[0],t[1]+e*i[1]]}var l=[i[0]-t[0],i[1]-t[1]],u=c(o,s),h=u*u,p=d(o,o);if(h>0){var f=c(l,s)/u;if(f<0||f>1)return null;var g=c(l,o)/u;return g<0||g>1?null:0===f||1===f?r?null:[a(t,f,o)]:0===g||1===g?r?null:[a(i,g,s)]:[a(t,f,o)]}if((h=(u=c(l,o))*u)>0)return null;var m=d(o,l)/p,v=m+d(o,s)/p,y=Math.min(m,v),_=Math.max(m,v);return y<=1&&_>=0?1===y?r?null:[a(t,y>0?y:0,o)]:0===_?r?null:[a(t,_<1?_:1,o)]:r&&0===y&&1===_?null:[a(t,y>0?y:0,o),a(t,_<1?_:1,o)]:null}(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=n?n.length:0;if(0===r)return 0;if(1===r&&(a(t.point,e.point)||a(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return a(t.point,n[0])||a(t.otherEvent.point,n[0])||h(t,n[0],i),a(e.point,n[0])||a(e.otherEvent.point,n[0])||h(e,n[0],i),1;var o=[],s=!1,l=!1;return a(t.point,e.point)?s=!0:1===u(t,e)?o.push(e,t):o.push(t,e),a(t.otherEvent.point,e.otherEvent.point)?l=!0:1===u(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&l||s?(e.type=1,t.type=e.inOut===t.inOut?2:3,s&&!l&&h(o[1].otherEvent,o[0].point,i),2):l?(h(o[0],o[1].point,i),3):o[0]!==o[3].otherEvent?(h(o[0],o[1].point,i),h(o[1],o[2].point,i),3):(h(o[0],o[1].point,i),h(o[3].otherEvent,o[2].point,i),3)}function f(t,e){if(t===e)return 0;if(0!==l(t.point,t.otherEvent.point,e.point)||0!==l(t.point,t.otherEvent.point,e.otherEvent.point))return a(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===u(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var i=t.point,n=e.point;return i[0]===n[0]&&i[1]===n[1]?(i=t.otherEvent.point,n=e.otherEvent.point,i[0]===n[0]&&i[1]===n[1]?0:t.contourId>e.contourId?1:-1):1===u(t,e)?1:-1}function g(t,e,i,n){var r=t+1,o=e.length;if(r>o-1)return t-1;for(var s=e[t].point,a=e[r].point;r<o&&a[0]===s[0]&&a[1]===s[1];){if(!i[r])return r;a=e[++r].point}for(r=t-1;i[r]&&r>=n;)r--;return r}function m(t,e){var i,n,r,o=function(t){var e,i,n,r,o=[];for(i=0,n=t.length;i<n;i++)((e=t[i]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,i=0,n=o.length;i<n;i++)i+1<n&&1===u(o[i],o[i+1])&&(r=o[i],o[i]=o[i+1],o[i+1]=r,s=!1);for(i=0,n=o.length;i<n;i++)(e=o[i]).pos=i;for(i=0,n=o.length;i<n;i++)(e=o[i]).left||(r=e.pos,e.pos=e.otherEvent.pos,e.otherEvent.pos=r);return o}(t),s={},a=[];for(i=0,n=o.length;i<n;i++)if(!s[i]){var l=[[]];o[i].isExteriorRing?2===e&&!o[i].isSubject&&a.length>1?a[a.length-1].push(l[0]):a.push(l):2!==e||o[i].isSubject||0!==a.length?0===a.length?a.push([[l]]):a[a.length-1].push(l[0]):a.push(l);var h=a.length-1,c=i,d=o[i].point;for(l[0].push(d);c>=i;)r=o[c],s[c]=!0,r.left?(r.resultInOut=!1,r.contourId=h):(r.otherEvent.resultInOut=!0,r.otherEvent.contourId=h),s[c=r.pos]=!0,l[0].push(o[c].point),c=g(c,o,s,i);r=o[c=-1===c?i:c],s[c]=s[r.pos]=!0,r.otherEvent.resultInOut=!0,r.otherEvent.contourId=h}return a}s.prototype.isBelow=function(t){var e=this.point,i=this.otherEvent.point;return this.left?(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0:(i[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(i[1]-t[1])>0},s.prototype.isAbove=function(t){return!this.isBelow(t)},s.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},s.prototype.clone=function(){var t=new s(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.inResult=this.inResult,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t};var v=_,y=_;function _(t,e){if(!(this instanceof _))return new _(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||b,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function b(t,e){return t<e?-1:t>e?1:0}_.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&i(e[s],a)<0&&(o=s,a=e[s]),i(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},v.default=y;var w=Math.max,x=Math.min,S=0;function C(t,e,i,n,r,o){var a,l,h,c,d,p;for(a=0,l=t.length-1;a<l;a++)if(h=t[a],c=t[a+1],d=new s(h,!1,void 0,e),p=new s(c,!1,d,e),d.otherEvent=p,h[0]!==c[0]||h[1]!==c[1]){d.contourId=p.contourId=i,o||(d.isExteriorRing=!1,p.isExteriorRing=!1),u(d,p)>0?p.left=!0:d.left=!0;var f=h[0],g=h[1];r[0]=x(r[0],f),r[1]=x(r[1],g),r[2]=w(r[2],f),r[3]=w(r[3],g),n.push(d),n.push(p)}}var T=[];function E(t,e,n){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var o=function(t,e,i){var n=null;return t.length*e.length==0&&(0===i?n=T:2===i?n=t:1!==i&&3!==i||(n=0===t.length?e:t)),n}(t,e,n);if(o)return o===T?null:o;var s=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],l=function(t,e,i,n,r){var o,s,a,l,h,c,d=new v(null,u);for(a=0,l=t.length;a<l;a++)for(h=0,c=(o=t[a]).length;h<c;h++)(s=0===h)&&S++,C(o[h],!0,S,d,i,s);for(a=0,l=e.length;a<l;a++)for(h=0,c=(o=e[a]).length;h<c;h++)s=0===h,2===r&&(s=!1),s&&S++,C(o[h],!1,S,d,n,s);return d}(t,e,s,a,n);return(o=function(t,e,i,n,r){var o=null;return(i[0]>n[2]||n[0]>i[2]||i[1]>n[3]||n[1]>i[3])&&(0===r?o=T:2===r?o=t:1!==r&&3!==r||(o=t.concat(e))),o}(t,e,s,a,n))?o===T?null:o:m(function(t,e,n,o,s,a){for(var l,u,h,c=new i(f),d=[],g=Math.min(o[2],s[2]);0!==t.length;){var m=t.pop();if(d.push(m),0===a&&m.point[0]>g||2===a&&m.point[0]>o[2])break;if(m.left){u=l=c.insert(m),l=l!==(h=c.minNode())?c.prev(l):null,u=c.next(u);var v=l?l.key:null;if(r(m,v,a),u&&2===p(m,u.key,t)&&(r(m,v,a),r(m,u.key,a)),l&&2===p(l.key,m,t)){var y=l;r(v,(y=y!==h?c.prev(y):null)?y.key:null,a),r(m,v,a)}}else m=m.otherEvent,u=l=c.find(m),l&&u&&(l=l!==h?c.prev(l):null,u=c.next(u),c.remove(m),u&&l&&p(l.key,u.key,t))}return d}(l,0,0,s,a,n),n)}var I={UNION:1,DIFFERENCE:2,INTERSECTION:0,XOR:3};t.union=function(t,e){return E(t,e,1)},t.diff=function(t,e){return E(t,e,2)},t.xor=function(t,e){return E(t,e,3)},t.intersection=function(t,e){return E(t,e,0)},t.operations=I,Object.defineProperty(t,"__esModule",{value:!0})}(e)},"aET+":function(t,e,i){var n,r,o={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),a=function(t,e){return e?e.querySelector(t):document.querySelector(t)},l=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=a.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),u=null,h=0,c=[],d=i("9tPo");function p(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=o[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(_(n.parts[s],e))}else{var a=[];for(s=0;s<n.parts.length;s++)a.push(_(n.parts[s],e));o[n.id]={id:n.id,refs:1,parts:a}}}}function f(t,e){for(var i=[],n={},r=0;r<t.length;r++){var o=t[r],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[s]?n[s].parts.push(a):i.push(n[s]={id:s,parts:[a]})}return i}function g(t,e){var i=l(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),c.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=l(t.insertAt.before,i);i.insertBefore(e,r)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return y(e,t.attrs),g(t,e),e}function y(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function _(t,e){var i,n,r,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var s=h++;i=u||(u=v(e)),n=x.bind(null,i,s,!1),r=x.bind(null,i,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",y(e,t.attrs),g(t,e),e}(e),n=C.bind(null,i,e),r=function(){m(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(e),n=S.bind(null,i),r=function(){m(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=f(t,e);return p(i,e),function(t){for(var n=[],r=0;r<i.length;r++){var s=i[r];(a=o[s.id]).refs--,n.push(a)}t&&p(f(t,e),e);for(r=0;r<n.length;r++){var a;if(0===(a=n[r]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete o[a.id]}}}};var b,w=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function x(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function S(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function C(t,e,i){var n=i.css,r=i.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(n=d(n)),r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}},aI7X:function(t,e,i){"use strict";var n="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,o=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==o.call(e))throw new TypeError(n+e);for(var i,s=r.call(arguments,1),a=function(){if(this instanceof i){var n=e.apply(this,s.concat(r.call(arguments)));return Object(n)===n?n:this}return e.apply(t,s.concat(r.call(arguments)))},l=Math.max(0,e.length-s.length),u=[],h=0;h<l;h++)u.push("$"+h);if(i=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(a),e.prototype){var c=function(){};c.prototype=e.prototype,i.prototype=new c,c.prototype=null}return i}},aZEm:function(t,e,i){var n=i("A1R+"),r=i("/rf6"),o=i("cWyK"),s=i("QJ+7").default,a=o.featureEach,l=(o.coordEach,r.polygon,r.featureCollection);function u(t){var e=n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return l(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},b7qQ:function(t,e,i){var n=i("gg1Z");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},bbcx:function(t,e,i){"use strict";var n=i("82c2"),r=i("RLeF"),o=i("1u+m"),s=i("WDQk"),a=i("wVpn"),l=r(s(),Object);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},cISd:function(t,e){var i;MagicWand=((i={}).floodFill=function(t,e,i,n,r,o){return o?function(t,e,i,n,r){var o,s,a,l,u,h,c,d,p,f,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),T=new Uint8Array(r||m*v);if(1===T[S])return null;var E=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(l=I.shift(),f=!1,s=l.left+1;s<l.right;s++)if(c=l.y*m,S=(c+s)*y,1!==T[c+s]&&(f=!0,C[c+s]=1,T[c+s]=1,!((o=g[S]-E[0])>n||o<-n||(o=g[S+1]-E[1])>n||o<-n||(o=g[S+2]-E[2])>n||o<-n))){for(h=s-1;h>-1&&(S=(d=c+h)*y,1!==T[d])&&(C[d]=1,T[d]=1,h--,!((o=g[S]-E[0])>n||o<-n))&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n););for(u=s+1;u<m&&(S=(p=c+u)*y,1!==T[p])&&(C[p]=1,T[p]=1,u++,!((o=g[S]-E[0])>n||o<-n))&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n););h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}f&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r):function(t,e,i,n,r){var o,s,a,l,u,h,c,d,p,f,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),T=new Uint8Array(r||m*v);if(1===T[S])return null;var E=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(l=I.shift(),f=!1,s=l.left+1;s<l.right;s++)if(c=l.y*m,S=(c+s)*y,1!==T[c+s]&&!((o=g[S]-E[0])>n||o<-n||(o=g[S+1]-E[1])>n||o<-n||(o=g[S+2]-E[2])>n||o<-n)){for(f=!0,C[c+s]=1,T[c+s]=1,h=s-1;h>-1&&(S=(d=c+h)*y,1!==T[d])&&!((o=g[S]-E[0])>n||o<-n)&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n);)C[d]=1,T[d]=1,h--;for(u=s+1;u<m&&(S=(p=c+u)*y,1!==T[p])&&!((o=g[S]-E[0])>n||o<-n)&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n);)C[p]=1,T[p]=1,u++;h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}f&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r)},i.gaussBlur=function(t,e){var i,n,r,o,s,a,l,u=2*e+1,h=e*e,c=new Float32Array(u),d=0,p=t.width,f=t.height,g=t.data,m=t.bounds.minX,v=t.bounds.maxX,y=t.bounds.minY,_=t.bounds.maxY;for(i=0;i<e;i++){var b=(e-i)*(e-i),w=Math.exp(-b/(2*h))/(2*Math.PI*h);c[e+i]=c[e-i]=w,d+=2*w}for(i=0;i<u;i++)c[i]/=d;var x=new Uint8Array(p*f),S=e+p,C=e+f;for(s=y;s<_+1;s++)for(o=m;o<v+1;o++){for(a=0,l=S-o<u?S-o:u,r=(n=s*p+o)-e,i=e-o>0?e-o:0;i<l;i++)a+=g[r+i]*c[i];for(l=C-s<u?C-s:u,r=n-e*p,i=e-s>0?e-s:0;i<l;i++)a+=g[r+i*p]*c[i];x[n]=a>.5?1:0}return{data:x,width:p,height:f,bounds:{minX:m,minY:y,maxX:v,maxY:_}}},i.gaussBlurOnlyBorder=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,p=function(t,e,i){var n,r,o,s,a,l,u,h=t.width,c=t.height,d=t.data,p=new Uint8Array(d),f=t.bounds.minX,g=t.bounds.maxX,m=t.bounds.minY,v=t.bounds.maxY,y=h*c,_=new Uint8Array(y),b=[],w=Math.max(f,1),x=Math.min(g,h-2),S=Math.max(m,1),C=Math.min(v,c-2);if(i&&i.length>0)for(a=0;a<y;a++)1===i[a]&&(p[a]=1);for(s=S;s<C+1;s++)for(n=w;n<x+1;n++)0!==d[a=s*h+n]&&(l=a+h,u=a-h,0!==p[a+1]&&0!==p[a-1]&&0!==p[l]&&0!==p[l+1]&&0!==p[l-1]&&0!==p[u]&&0!==p[u+1]&&0!==p[u-1]||b.push(a));if(0==f)for(s=m;s<v+1;s++)1===d[s*h]&&b.push(s*h);if(g==h-1)for(s=m;s<v+1;s++)1===d[s*h+g]&&b.push(s*h+g);if(0==m)for(n=f;n<g+1;n++)1===d[n]&&b.push(n);if(v==c-1)for(n=f;n<g+1;n++)1===d[v*h+n]&&b.push(v*h+n);var T,E=[],I=e+h,k=e+c,A=2*e+1;for(y=b.length,o=0;o<y;o++){for(_[a=b[o]]=1,E.push(a),s=(a-(n=a%h))/h,T=I-n<A?I-n:A,l=a-e,r=e-n>0?e-n:0;r<T;r++)0===_[u=l+r]&&(_[u]=1,E.push(u));for(T=k-s<A?k-s:A,l=a-e*h,r=e-s>0?e-s:0;r<T;r++)0===_[u=l+r*h]&&(_[u]=1,E.push(u))}return E}(t,e,i),f=2*e+1,g=2*e*e,m=new Float32Array(f),v=0,y=t.width,_=t.height,b=t.data,w=t.bounds.minX,x=t.bounds.maxX,S=t.bounds.minY,C=t.bounds.maxY,T=p.length;for(o=0;o<e;o++)r=(e-o)*(e-o),n=Math.exp(-r/g)/Math.PI,m[e+o]=m[e-o]=n,v+=2*n;for(o=0;o<f;o++)m[o]/=v;var E=new Uint8Array(b),I=e+y,k=e+_;for(o=0;o<T;o++){for(c=0,h=((a=p[o])-(u=a%y))/y,d=I-u<f?I-u:f,l=a-e,s=e-u>0?e-u:0;s<d;s++)c+=b[l+s]*m[s];if(c>.5)E[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h);else{for(d=k-h<f?k-h:f,l=a-e*y,s=e-h>0?e-h:0;s<d;s++)c+=b[l+s*y]*m[s];c>.5?(E[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h)):E[a]=0}}return{data:E,width:y,height:_,bounds:{minX:w,minY:S,maxX:x,maxY:C}}},i.createBorderMask=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=t.bounds.minX,h=t.bounds.maxX,c=t.bounds.minY,d=t.bounds.maxY,p=h-u+1,f=d-c+1,g=new Uint8Array(p*f),m=Math.max(u,1),v=Math.min(h,s-2),y=Math.max(c,1),_=Math.min(d,a-2);for(i=y;i<_+1;i++)for(e=m;e<v+1;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||(g[(i-c)*p+(e-u)]=1));if(0==u)for(i=c;i<d+1;i++)1===l[i*s]&&(g[(i-c)*p]=1);if(h==s-1)for(i=c;i<d+1;i++)1===l[i*s+h]&&(g[(i-c)*p+(h-u)]=1);if(0==c)for(e=u;e<h+1;e++)1===l[e]&&(g[e-u]=1);if(d==a-1)for(e=u;e<h+1;e++)1===l[d*s+e]&&(g[(d-c)*p+(e-u)]=1);return{data:g,width:p,height:f,offset:{x:u,y:c}}},i.getBorderIndices=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=[],h=s-1,c=a-1;for(i=1;i<c;i++)for(e=1;e<h;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||u.push(n));for(i=0;i<a;i++)1===l[i*s]&&u.push(i*s);for(e=0;e<s;e++)1===l[e]&&u.push(e);for(n=s-1,i=0;i<a;i++)1===l[i*s+n]&&u.push(i*s+n);for(n=(a-1)*s,e=0;e<s;e++)1===l[n+e]&&u.push(n+e);return u},i.traceContours=function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m=function(t){var e,i,n=t.width,r=t.data,o=t.bounds.minX,s=t.bounds.maxX,a=t.bounds.minY,l=t.bounds.maxY,u=s-o+3,h=l-a+3,c=new Uint8Array(u*h);for(i=a;i<l+1;i++)for(e=o;e<s+1;e++)1===r[i*n+e]&&(c[(i-a+1)*u+(e-o+1)]=1);return{data:c,width:u,height:h,offset:{x:o-1,y:a-1}}}(t),v=[],y=0,_=m.width,b=2*_,w=m.height,x=m.data,S=m.offset.x,C=m.offset.y,T=new Uint8Array(x),E=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(r=1;r<w-1;r++)for(n=1;n<_-1;n++)if(1===x[o=r*_+n])for(e=-_;e<b;e+=b)if(0===x[o+e]&&0===T[o+e]){for(y++,a=[],u=(l=e===_)?2:6,d=p=h={x:n,y:r},c=null;;){for(T[d.y*_+d.x]=y,i=0;i<8;i++){if(g=E[u=(u+1)%8],1===x[s=(f={x:d.x+g[0],y:d.y+g[1]}).y*_+f.x]){T[s]=y;break}T[s]=-1,f=null}if(null===f)break;if(d=f,c){if(p.x===h.x&&p.y===h.y&&d.x===c.x&&d.y===c.y)break}else c=f;a.push({x:p.x+S,y:p.y+C}),p=d,u=(u+4)%8}null!=f&&(a.push({x:h.x+S,y:h.y+C}),v.push({inner:l,label:y,points:a}))}return v},i.simplifyContours=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,p,f,g,m,v,y,_,b,w,x,S,C=t.length,T=[];for(r=0;r<C;r++)if(a=(s=t[r]).points,(l=s.points.length)<i){for(u=[],o=0;o<l;o++)u.push({x:a[o].x,y:a[o].y});T.push({inner:s.inner,label:s.label,points:u,initialCount:l})}else{h=[0,l-1],c=[{first:0,last:l-1}];do{if(!((d=c.shift()).last<=d.first+1)){for(p=-1,f=d.first,n=d.first+1;n<d.last;n++)w=a[n],x=a[d.first],S=a[d.last],_=w.x-x.x,b=w.y-x.y,m=Math.sqrt(_*_+b*b),_=w.x-S.x,b=w.y-S.y,v=Math.sqrt(_*_+b*b),_=x.x-S.x,b=x.y-S.y,y=Math.sqrt(_*_+b*b),(g=m>=Math.sqrt(v*v+y*y)?v:v>=Math.sqrt(m*m+y*y)?m:Math.abs((b*w.x-_*w.y+x.x*S.y-S.x*x.y)/y))>p&&(f=n,p=g);p>e&&(h.push(f),c.push({first:d.first,last:f}),c.push({first:f,last:d.last}))}}while(c.length>0);for(u=[],l=h.length,h.sort((function(t,e){return t-e})),o=0;o<l;o++)u.push({x:a[h[o]].x,y:a[h[o]].y});T.push({inner:s.inner,label:s.label,points:u,initialCount:s.points.length})}return T},i),t.exports=MagicWand},cWyK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/rf6");function r(t,e,i){if(null!==t)for(var n,o,s,a,l,u,h,c,d=0,p=0,f=t.type,g="FeatureCollection"===f,m="Feature"===f,v=g?t.features.length:1,y=0;y<v;y++){l=(c=!!(h=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<l;_++){var b=0,w=0;if(null!==(a=c?h.geometries[_]:h)){u=a.coordinates;var x=a.type;switch(d=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,p,y,b,w))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],p,y,b,w))return!1;p++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-d;o++){if(!1===e(u[n][o],p,y,b,w))return!1;p++}"MultiLineString"===x&&b++,"Polygon"===x&&w++}"Polygon"===x&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(w=0,o=0;o<u[n].length;o++){for(s=0;s<u[n][o].length-d;s++){if(!1===e(u[n][o][s],p,y,b,w))return!1;p++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===r(a.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function a(t,e){var i,n,r,o,s,a,l,u,h,c,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,g=p?t.features.length:1;for(i=0;i<g;i++){for(a=p?t.features[i].geometry:f?t.geometry:t,u=p?t.features[i].properties:f?t.properties:{},h=p?t.features[i].bbox:f?t.bbox:void 0,c=p?t.features[i].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function l(t,e){a(t,(function(t,i,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,r,{bbox:o,id:s}),i,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var h={type:a,coordinates:t.coordinates[u]};if(!1===e(n.feature(h,r),i,u))return!1}}))}function u(t,e){l(t,(function(t,i,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,h=0,c=0;return!1!==r(t,(function(r,a,d,p,f){if(void 0===l||i>u||p>h||f>c)return l=r,u=i,h=p,c=f,void(s=0);var g=n.lineString([l,r],t.properties);if(!1===e(g,i,o,f,s))return!1;s++,l=r}))&&void 0}}}))}function h(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,i,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,i,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(n.lineString(s[a],t.properties),i,r,a))return!1}}}))}e.coordEach=r,e.coordReduce=function(t,e,i,n){var o=i;return r(t,(function(t,n,r,s,a){o=0===n&&void 0===i?t:e(o,t,n,r,s,a)}),n),o},e.propEach=o,e.propReduce=function(t,e,i){var n=i;return o(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.featureEach=s,e.featureReduce=function(t,e,i){var n=i;return s(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.geomEach=a,e.geomReduce=function(t,e,i){var n=i;return a(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n},e.flattenEach=l,e.flattenReduce=function(t,e,i){var n=i;return l(t,(function(t,r,o){n=0===r&&0===o&&void 0===i?t:e(n,t,r,o)})),n},e.segmentEach=u,e.segmentReduce=function(t,e,i){var n=i,r=!1;return u(t,(function(t,o,s,a,l){n=!1===r&&void 0===i?t:e(n,t,o,s,a,l),r=!0})),n},e.lineEach=h,e.lineReduce=function(t,e,i){var n=i;return h(t,(function(t,r,o,s){n=0===r&&void 0===i?t:e(n,t,r,o,s)})),n},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),n.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),n.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),n.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),n.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":return n.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),n.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),n.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),n.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),n.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),n.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")}},e9hN:function(t,e){},eSxo:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("qhoL"),r=i("j3ZU"),o=i("Yeox"),s=i("sk2A"),a=i("cWyK"),l=i("/rf6"),u=i("AKIq");e.default=function(t,e,i){void 0===i&&(i={});var h=l.point([1/0,1/0],{dist:1/0}),c=0;return a.flattenEach(t,(function(t){for(var a=u.getCoords(t),d=0;d<a.length-1;d++){var p=l.point(a[d]);p.properties.dist=r.default(e,p,i);var f=l.point(a[d+1]);f.properties.dist=r.default(e,f,i);var g=r.default(p,f,i),m=Math.max(p.properties.dist,f.properties.dist),v=n.default(p,f),y=o.default(e,m,v+90,i),_=o.default(e,m,v-90,i),b=s.default(l.lineString([y.geometry.coordinates,_.geometry.coordinates]),l.lineString([p.geometry.coordinates,f.geometry.coordinates])),w=null;b.features.length>0&&((w=b.features[0]).properties.dist=r.default(e,w,i),w.properties.location=c+r.default(p,w,i)),p.properties.dist<h.properties.dist&&((h=p).properties.index=d,h.properties.location=c),f.properties.dist<h.properties.dist&&((h=f).properties.index=d+1,h.properties.location=c+g),w&&w.properties.dist<h.properties.dist&&((h=w).properties.index=d),c+=g}})),h}},f66B:function(t,e,i){var n=i("1seS"),r=i("45zb"),o=i("bbcx"),s=i("2Nju"),a=i("5xAX"),l=i("DmXP"),u=Date.prototype.getTime;function h(t,e,i){var p=i||{};return!!(p.strict?o(t,e):t===e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?p.strict?o(t,e):t==e:function(t,e,i){var o,p;if(typeof t!=typeof e)return!1;if(c(t)||c(e))return!1;if(t.prototype!==e.prototype)return!1;if(r(t)!==r(e))return!1;var f=s(t),g=s(e);if(f!==g)return!1;if(f||g)return t.source===e.source&&a(t)===a(e);if(l(t)&&l(e))return u.call(t)===u.call(e);var m=d(t),v=d(e);if(m!==v)return!1;if(m||v){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!=typeof e)return!1;try{var y=n(t),_=n(e)}catch(t){return!1}if(y.length!==_.length)return!1;for(y.sort(),_.sort(),o=y.length-1;o>=0;o--)if(y[o]!=_[o])return!1;for(o=y.length-1;o>=0;o--)if(p=y[o],!h(t[p],e[p],i))return!1;return!0}(t,e,p))}function c(t){return null==t}function d(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=h},gg1Z:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.tab-content .tab-pane { display: none;\n}\n.tab-content .tab-pane.active { display: block;\n}\n",""])},j3ZU:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("AKIq"),r=i("/rf6");e.default=function(t,e,i){void 0===i&&(i={});var o=n.getCoord(t),s=n.getCoord(e),a=r.degreesToRadians(s[1]-o[1]),l=r.degreesToRadians(s[0]-o[0]),u=r.degreesToRadians(o[1]),h=r.degreesToRadians(s[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(h);return r.radiansToLength(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i.units)}},kFuP:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,'.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 2px solid blue;\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: rgba(0,60,136,0.3);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n.ol-scale-line-inner {\n  border: 1px solid #eee;\n  border-top: none;\n  color: #eee;\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n}\n.ol-overlay-container {\n  will-change: left,right,top,bottom;\n}\n\n.ol-unsupported {\n  display: none;\n}\n.ol-viewport, .ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n}\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n.ol-control {\n  position: absolute;\n  background-color: rgba(255,255,255,0.4);\n  border-radius: 4px;\n  padding: 2px;\n}\n.ol-control:hover {\n  background-color: rgba(255,255,255,0.6);\n}\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n@media print {\n  .ol-control {\n    display: none;\n  }\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: white;\n  font-size: 1.14em;\n  font-weight: bold;\n  text-decoration: none;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: rgba(0,60,136,0.5);\n  border: none;\n  border-radius: 2px;\n}\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  font-size: 1.2em;\n  will-change: transform;\n}\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  background-color: rgba(0,60,136,0.7);\n}\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 0 .5em;\n  font-size: .7rem;\n  line-height: 1.375em;\n  color: #000;\n  text-shadow: 0 0 2px #fff;\n}\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n  line-height: inherit;\n}\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n.ol-attribution ul, .ol-attribution button {\n  display: inline-block;\n}\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n.ol-attribution:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n  height: 1.1em;\n  line-height: 1em;\n}\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: inline-block;\n}\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid #7b98bc;\n  height: 150px;\n  margin: 2px;\n  width: 150px;\n}\n.ol-overviewmap:not(.ol-collapsed) button{\n  bottom: 1px;\n  left: 2px;\n  position: absolute;\n}\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n.ol-overviewmap:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.ol-overviewmap-box {\n  border: 2px dotted rgba(0,60,136,0.7);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""])},khZw:function(t,e,i){var n=i("11/I");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},ktXi:function(t,e,i){"use strict";var n=i("HQVW");i.n(n).a},lXTj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("AKIq");function r(t,e,i,n){var r=i[0],o=i[1],s=t[0],a=t[1],l=e[0],u=e[1],h=l-s,c=u-a;return 0==(i[0]-s)*c-(i[1]-a)*h&&(n?"start"===n?Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<=l:l<=r&&r<s:c>0?a<o&&o<=u:u<=o&&o<a:"end"===n?Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<l:l<r&&r<=s:c>0?a<=o&&o<u:u<o&&o<=a:"both"===n&&(Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<l:l<r&&r<s:c>0?a<o&&o<u:u<o&&o<a):Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<=l:l<=r&&r<=s:c>0?a<=o&&o<=u:u<=o&&o<=a)}e.default=function(t,e,i){void 0===i&&(i={});for(var o=n.getCoord(t),s=n.getCoords(e),a=0;a<s.length-1;a++){var l=!1;if(i.ignoreEndVertices&&(0===a&&(l="start"),a===s.length-2&&(l="end"),0===a&&a+1===s.length-1&&(l="both")),r(s[a],s[a+1],o,l))return!0}return!1}},lmcn:function(t,e){var i=new Date(0);Vue.filter("videoTime",(function(t){return i.setTime(1e3*t),i.toISOString().split("T")[1].slice(0,-2)}))},oNNP:function(t,e,i){"use strict";var n=i("D3zA");t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},qNH4:function(t,e,i){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var r=n(i("A/RR")),o=n(i("O3R+")),s=i("/rf6"),a=i("AKIq"),l=i("cWyK");function u(t){switch(t.type){case"Polygon":return o(t)>1?t:null;case"MultiPolygon":var e=[];if(l.flattenEach(t,(function(t){o(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}t.exports=function(t,e){var i=a.getGeom(t),n=a.getGeom(e),o=t.properties||{};if(i=u(i),n=u(n),!i)return null;if(!n)return s.feature(i,o);var l=r.diff(i.coordinates,n.coordinates);return 0===l.length?null:1===l.length?s.polygon(l[0],o):s.multiPolygon(l,o)}},qYb1:function(t,e,i){var n=i("kFuP");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,r);n.locals&&(t.exports=n.locals)},qhoL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/rf6"),r=i("AKIq");function o(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=o(e,t);return i=(i+180)%360}(t,e);var s=r.getCoord(t),a=r.getCoord(e),l=n.degreesToRadians(s[0]),u=n.degreesToRadians(a[0]),h=n.degreesToRadians(s[1]),c=n.degreesToRadians(a[1]),d=Math.sin(u-l)*Math.cos(c),p=Math.cos(h)*Math.sin(c)-Math.sin(h)*Math.cos(c)*Math.cos(u-l);return n.radiansToDegrees(Math.atan2(d,p))}e.default=o},sYn3:function(t,e,i){"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=i("1KsK"),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===o.call(t),n=s(t),a=e&&"[object String]"===o.call(t),d=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var f=u&&i;if(a&&t.length>0&&!r.call(t,0))for(var g=0;g<t.length;++g)d.push(String(g));if(n&&t.length>0)for(var m=0;m<t.length;++m)d.push(String(m));else for(var v in t)f&&"prototype"===v||!r.call(t,v)||d.push(String(v));if(l)for(var y=function(t){if("undefined"==typeof window||!p)return c(t);try{return c(t)}catch(t){return!1}}(t),_=0;_<h.length;++_)y&&"constructor"===h[_]||!r.call(t,h[_])||d.push(h[_]);return d}}t.exports=n},sk2A:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=i("/rf6"),o=i("AKIq"),s=n(i("+mSJ")),a=i("cWyK"),l=n(i("aZEm"));function u(t,e){var i=o.getCoords(t),n=o.getCoords(e);if(2!==i.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var s=i[0][0],a=i[0][1],l=i[1][0],u=i[1][1],h=n[0][0],c=n[0][1],d=n[1][0],p=n[1][1],f=(p-c)*(l-s)-(d-h)*(u-a),g=(d-h)*(a-c)-(p-c)*(s-h),m=(l-s)*(a-c)-(u-a)*(s-h);if(0===f)return null;var v=g/f,y=m/f;if(v>=0&&v<=1&&y>=0&&y<=1){var _=s+v*(l-s),b=a+v*(u-a);return r.point([_,b])}return null}e.default=function(t,e){var i={},n=[];if("LineString"===t.type&&(t=r.feature(t)),"LineString"===e.type&&(e=r.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var h=u(t,e);return h&&n.push(h),r.featureCollection(n)}var c=l.default();return c.load(s.default(e)),a.featureEach(s.default(t),(function(t){a.featureEach(c.search(t),(function(e){var r=u(t,e);if(r){var s=o.getCoords(r).join(",");i[s]||(i[s]=!0,n.push(r))}}))})),r.featureCollection(n)}},vvbw:function(t,e,i){"use strict";var n=i("khZw");i.n(n).a},wVpn:function(t,e,i){"use strict";var n=i("WDQk"),r=i("82c2");t.exports=function(){var t=n();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},y653:function(t,e,i){"use strict";var n=i("BO+Y");i.n(n).a},yLpj:function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},z8fI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("aZEm"),r=i("+mSJ"),o=i("eSxo"),s=i("lXTj"),a=i("AKIq"),l=i("cWyK"),u=i("/rf6"),h=i("f66B");function c(t,e){var i=a.getCoords(e),n=a.getCoords(t),r=n[0],o=n[n.length-1],s=t.geometry.coordinates;return h(i[0],r)?s.unshift(i[1]):h(i[0],o)?s.push(i[1]):h(i[1],r)?s.unshift(i[0]):h(i[1],o)&&s.push(i[0]),t}e.default=function(t,e,i){if(void 0===i&&(i={}),i=i||{},!u.isObject(i))throw new Error("options is invalid");var d,p=i.tolerance||0,f=[],g=n.default(),m=r.default(t);return g.load(m),l.segmentEach(e,(function(t){var e=!1;l.featureEach(g.search(t),(function(i){if(!1===e){var n=a.getCoords(t).sort(),r=a.getCoords(i).sort();h(n,r)||(0===p?s.default(n[0],i)&&s.default(n[1],i):o.default(i,n[0]).properties.dist<=p&&o.default(i,n[1]).properties.dist<=p)?(e=!0,d=d?c(d,t):t):(0===p?s.default(r[0],t)&&s.default(r[1],t):o.default(t,r[0]).properties.dist<=p&&o.default(t,r[1]).properties.dist<=p)&&(d=d?c(d,i):i)}})),!1===e&&d&&(f.push(d),d=void 0)})),d&&f.push(d),u.featureCollection(f)}}});